(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const $ of document.querySelectorAll('link[rel="modulepreload"]'))F($);new MutationObserver($=>{for(const Y of $)if(Y.type==="childList")for(const V of Y.addedNodes)V.tagName==="LINK"&&V.rel==="modulepreload"&&F(V)}).observe(document,{childList:!0,subtree:!0});function C($){const Y={};return $.integrity&&(Y.integrity=$.integrity),$.referrerPolicy&&(Y.referrerPolicy=$.referrerPolicy),$.crossOrigin==="use-credentials"?Y.credentials="include":$.crossOrigin==="anonymous"?Y.credentials="omit":Y.credentials="same-origin",Y}function F($){if($.ep)return;$.ep=!0;const Y=C($);fetch($.href,Y)}})();const mobileVhHack=()=>{const J=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${J}px`)};mobileVhHack();window.addEventListener("resize",mobileVhHack);var __awaiter$j=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class PlayerApi{constructor(e){this.messageBus=e}get id(){if(!this.messageBus.userId)throw Error("Unable to get user ID: not ready");return this.messageBus.userId}getSelection(){return __awaiter$j(this,void 0,void 0,function*(){const{selection:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_SELECTION",{});return e})}select(e,C){return __awaiter$j(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:e,replace:C})})}deselect(e){return __awaiter$j(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_DESELECt",{items:e})})}getName(){return __awaiter$j(this,void 0,void 0,function*(){const{name:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_NAME",{});return e})}setName(e){return __awaiter$j(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_NAME",{name:e})})}getColor(){return __awaiter$j(this,void 0,void 0,function*(){const{color:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_COLOR",{});return e})}setColor(e){return __awaiter$j(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_COLOR",{color:e})})}getSyncView(){return __awaiter$j(this,void 0,void 0,function*(){const{syncView:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_SYNC_VIEW",{});return e})}setSyncView(e){return __awaiter$j(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_SYNC_VIEW",{syncView:e})})}getId(){return __awaiter$j(this,void 0,void 0,function*(){const{id:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_ID",{});return e})}getRole(){return __awaiter$j(this,void 0,void 0,function*(){const{role:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_ROLE",{});return e})}getMetadata(){return __awaiter$j(this,void 0,void 0,function*(){const{metadata:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_METADATA",{});return e})}setMetadata(e){return __awaiter$j(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_METADATA",{update:e})})}hasPermission(e){return __awaiter$j(this,void 0,void 0,function*(){if((yield this.getRole())==="GM")return!0;const{permissions:F}=yield this.messageBus.sendAsync("OBR_ROOM_GET_PERMISSIONS",{});return F.indexOf(e)===-1})}getConnectionId(){return __awaiter$j(this,void 0,void 0,function*(){const{connectionId:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_CONNECTION_ID",{});return e})}onChange(e){const C=F=>{e(F.player)};return this.messageBus.send("OBR_PLAYER_SUBSCRIBE",{}),this.messageBus.on("OBR_PLAYER_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_PLAYER_UNSUBSCRIBE",{}),this.messageBus.off("OBR_PLAYER_EVENT_CHANGE",C)}}}var __awaiter$i=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class ViewportApi{constructor(e){this.messageBus=e}reset(){return __awaiter$i(this,void 0,void 0,function*(){const{transform:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_RESET",{});return e})}animateTo(e){return __awaiter$i(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_ANIMATE_TO",{transform:e})})}animateToBounds(e){return __awaiter$i(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_ANIMATE_TO_BOUNDS",{bounds:e})})}getPosition(){return __awaiter$i(this,void 0,void 0,function*(){const{position:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_POSITION",{});return e})}setPosition(e){return __awaiter$i(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_SET_POSITION",{position:e})})}getScale(){return __awaiter$i(this,void 0,void 0,function*(){const{scale:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_SCALE",{});return e})}setScale(e){return __awaiter$i(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_SET_SCALE",{scale:e})})}getWidth(){return __awaiter$i(this,void 0,void 0,function*(){const{width:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_WIDTH",{});return e})}getHeight(){return __awaiter$i(this,void 0,void 0,function*(){const{height:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_HEIGHT",{});return e})}transformPoint(e){return __awaiter$i(this,void 0,void 0,function*(){const{point:C}=yield this.messageBus.sendAsync("OBR_VIEWPORT_TRANSFORM_POINT",{point:e});return C})}inverseTransformPoint(e){return __awaiter$i(this,void 0,void 0,function*(){const{point:C}=yield this.messageBus.sendAsync("OBR_VIEWPORT_INVERSE_TRANSFORM_POINT",{point:e});return C})}}function isMessage(J){return typeof J.id=="string"}function getAugmentedNamespace(J){if(J.__esModule)return J;var e=J.default;if(typeof e=="function"){var C=function F(){if(this instanceof F){var $=[null];$.push.apply($,arguments);var Y=Function.bind.apply(e,$);return new Y}return e.apply(this,arguments)};C.prototype=e.prototype}else C={};return Object.defineProperty(C,"__esModule",{value:!0}),Object.keys(J).forEach(function(F){var $=Object.getOwnPropertyDescriptor(J,F);Object.defineProperty(C,F,$.get?$:{enumerable:!0,get:function(){return J[F]}})}),C}var events={exports:{}},R$1=typeof Reflect=="object"?Reflect:null,ReflectApply=R$1&&typeof R$1.apply=="function"?R$1.apply:function(e,C,F){return Function.prototype.apply.call(e,C,F)},ReflectOwnKeys;R$1&&typeof R$1.ownKeys=="function"?ReflectOwnKeys=R$1.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ReflectOwnKeys=function(e){return Object.getOwnPropertyNames(e)};function ProcessEmitWarning(J){console&&console.warn&&console.warn(J)}var NumberIsNaN=Number.isNaN||function(e){return e!==e};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter;events.exports.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(J){if(typeof J!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof J)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(J){if(typeof J!="number"||J<0||NumberIsNaN(J))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+J+".");defaultMaxListeners=J}});EventEmitter.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function _getMaxListeners(J){return J._maxListeners===void 0?EventEmitter.defaultMaxListeners:J._maxListeners}EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function(e){for(var C=[],F=1;F<arguments.length;F++)C.push(arguments[F]);var $=e==="error",Y=this._events;if(Y!==void 0)$=$&&Y.error===void 0;else if(!$)return!1;if($){var V;if(C.length>0&&(V=C[0]),V instanceof Error)throw V;var te=new Error("Unhandled error."+(V?" ("+V.message+")":""));throw te.context=V,te}var se=Y[e];if(se===void 0)return!1;if(typeof se=="function")ReflectApply(se,this,C);else for(var ne=se.length,ee=arrayClone(se,ne),F=0;F<ne;++F)ReflectApply(ee[F],this,C);return!0};function _addListener(J,e,C,F){var $,Y,V;if(checkListener(C),Y=J._events,Y===void 0?(Y=J._events=Object.create(null),J._eventsCount=0):(Y.newListener!==void 0&&(J.emit("newListener",e,C.listener?C.listener:C),Y=J._events),V=Y[e]),V===void 0)V=Y[e]=C,++J._eventsCount;else if(typeof V=="function"?V=Y[e]=F?[C,V]:[V,C]:F?V.unshift(C):V.push(C),$=_getMaxListeners(J),$>0&&V.length>$&&!V.warned){V.warned=!0;var te=new Error("Possible EventEmitter memory leak detected. "+V.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");te.name="MaxListenersExceededWarning",te.emitter=J,te.type=e,te.count=V.length,ProcessEmitWarning(te)}return J}EventEmitter.prototype.addListener=function(e,C){return _addListener(this,e,C,!1)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function(e,C){return _addListener(this,e,C,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(J,e,C){var F={fired:!1,wrapFn:void 0,target:J,type:e,listener:C},$=onceWrapper.bind(F);return $.listener=C,F.wrapFn=$,$}EventEmitter.prototype.once=function(e,C){return checkListener(C),this.on(e,_onceWrap(this,e,C)),this};EventEmitter.prototype.prependOnceListener=function(e,C){return checkListener(C),this.prependListener(e,_onceWrap(this,e,C)),this};EventEmitter.prototype.removeListener=function(e,C){var F,$,Y,V,te;if(checkListener(C),$=this._events,$===void 0)return this;if(F=$[e],F===void 0)return this;if(F===C||F.listener===C)--this._eventsCount===0?this._events=Object.create(null):(delete $[e],$.removeListener&&this.emit("removeListener",e,F.listener||C));else if(typeof F!="function"){for(Y=-1,V=F.length-1;V>=0;V--)if(F[V]===C||F[V].listener===C){te=F[V].listener,Y=V;break}if(Y<0)return this;Y===0?F.shift():spliceOne(F,Y),F.length===1&&($[e]=F[0]),$.removeListener!==void 0&&this.emit("removeListener",e,te||C)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function(e){var C,F,$;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete F[e]),this;if(arguments.length===0){var Y=Object.keys(F),V;for($=0;$<Y.length;++$)V=Y[$],V!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(C=F[e],typeof C=="function")this.removeListener(e,C);else if(C!==void 0)for($=C.length-1;$>=0;$--)this.removeListener(e,C[$]);return this};function _listeners(J,e,C){var F=J._events;if(F===void 0)return[];var $=F[e];return $===void 0?[]:typeof $=="function"?C?[$.listener||$]:[$]:C?unwrapListeners($):arrayClone($,$.length)}EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)};EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)};EventEmitter.listenerCount=function(J,e){return typeof J.listenerCount=="function"?J.listenerCount(e):listenerCount.call(J,e)};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(J){var e=this._events;if(e!==void 0){var C=e[J];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(J,e){for(var C=new Array(e),F=0;F<e;++F)C[F]=J[F];return C}function spliceOne(J,e){for(;e+1<J.length;e++)J[e]=J[e+1];J.pop()}function unwrapListeners(J){for(var e=new Array(J.length),C=0;C<e.length;++C)e[C]=J[C].listener||J[C];return e}function once(J,e){return new Promise(function(C,F){function $(V){J.removeListener(e,Y),F(V)}function Y(){typeof J.removeListener=="function"&&J.removeListener("error",$),C([].slice.call(arguments))}eventTargetAgnosticAddListener(J,e,Y,{once:!0}),e!=="error"&&addErrorHandlerIfEventEmitter(J,$,{once:!0})})}function addErrorHandlerIfEventEmitter(J,e,C){typeof J.on=="function"&&eventTargetAgnosticAddListener(J,"error",e,C)}function eventTargetAgnosticAddListener(J,e,C,F){if(typeof J.on=="function")F.once?J.once(e,C):J.on(e,C);else if(typeof J.addEventListener=="function")J.addEventListener(e,function $(Y){F.once&&J.removeEventListener(e,$),C(Y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof J)}var eventsExports=events.exports;let getRandomValues$1;const rnds8$1=new Uint8Array(16);function rng$1(){if(!getRandomValues$1&&(getRandomValues$1=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues$1))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues$1(rnds8$1)}const byteToHex$1=[];for(let J=0;J<256;++J)byteToHex$1.push((J+256).toString(16).slice(1));function unsafeStringify(J,e=0){return(byteToHex$1[J[e+0]]+byteToHex$1[J[e+1]]+byteToHex$1[J[e+2]]+byteToHex$1[J[e+3]]+"-"+byteToHex$1[J[e+4]]+byteToHex$1[J[e+5]]+"-"+byteToHex$1[J[e+6]]+byteToHex$1[J[e+7]]+"-"+byteToHex$1[J[e+8]]+byteToHex$1[J[e+9]]+"-"+byteToHex$1[J[e+10]]+byteToHex$1[J[e+11]]+byteToHex$1[J[e+12]]+byteToHex$1[J[e+13]]+byteToHex$1[J[e+14]]+byteToHex$1[J[e+15]]).toLowerCase()}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4$1(J,e,C){if(native.randomUUID&&!e&&!J)return native.randomUUID();J=J||{};const F=J.random||(J.rng||rng$1)();if(F[6]=F[6]&15|64,F[8]=F[8]&63|128,e){C=C||0;for(let $=0;$<16;++$)e[C+$]=F[$];return e}return unsafeStringify(F)}class MessageBus extends eventsExports.EventEmitter{constructor(e,C){super(),this.ready=!1,this.userId=null,this.ref=null,this.handleMessage=F=>{const $=F.data;if(F.origin===this.targetOrigin&&isMessage($)){if($.id==="OBR_READY"){this.ready=!0;const Y=$.data;this.ref=Y.ref,this.userId=Y.userId}this.emit($.id,$.data)}},this.send=(F,$,Y)=>{var V;if(!this.ref)throw Error("Unable to send message: not ready");(V=window.parent)===null||V===void 0||V.postMessage({id:F,data:$,ref:this.ref,nonce:Y},this.targetOrigin)},this.sendAsync=(F,$,Y=5e3)=>{const V=`_${v4$1()}`;return this.send(F,$,V),Promise.race([new Promise((te,se)=>{const ne=this;function ee(ae){ne.off(`${F}_RESPONSE${V}`,ee),ne.off(`${F}_ERROR${V}`,ie),te(ae)}function ie(ae){ne.off(`${F}_RESPONSE${V}`,ee),ne.off(`${F}_ERROR${V}`,ie),se(ae)}this.on(`${F}_RESPONSE${V}`,ee),this.on(`${F}_ERROR${V}`,ie)}),new Promise((te,se)=>window.setTimeout(()=>se(new Error(`Message ${F} took longer than ${Y}ms to get a result`)),Y))])},this.roomId=C,this.targetOrigin=e,window.addEventListener("message",this.handleMessage),this.setMaxListeners(100)}destroy(){window.removeEventListener("message",this.handleMessage)}}var __awaiter$h=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class NotificationApi{constructor(e){this.messageBus=e}show(e,C){return __awaiter$h(this,void 0,void 0,function*(){const{id:F}=yield this.messageBus.sendAsync("OBR_NOTIFICATION_SHOW",{message:e,variant:C});return F})}close(e){return __awaiter$h(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_NOTIFICATION_CLOSE",{id:e})})}}var __awaiter$g=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class SceneFogApi{constructor(e){this.messageBus=e}getColor(){return __awaiter$g(this,void 0,void 0,function*(){const{color:e}=yield this.messageBus.sendAsync("OBR_SCENE_FOG_GET_COLOR",{});return e})}setColor(e){return __awaiter$g(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_FOG_SET_COLOR",{color:e})})}getStrokeWidth(){return __awaiter$g(this,void 0,void 0,function*(){const{strokeWidth:e}=yield this.messageBus.sendAsync("OBR_SCENE_FOG_GET_STROKE_WIDTH",{});return e})}setStrokeWidth(e){return __awaiter$g(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_FOG_SET_STROKE_WIDTH",{strokeWidth:e})})}getFilled(){return __awaiter$g(this,void 0,void 0,function*(){const{filled:e}=yield this.messageBus.sendAsync("OBR_SCENE_FOG_GET_FILLED",{});return e})}setFilled(e){return __awaiter$g(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_FOG_SET_FILLED",{filled:e})})}onChange(e){const C=F=>{e(F.fog)};return this.messageBus.send("OBR_SCENE_FOG_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_FOG_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_SCENE_FOG_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_FOG_EVENT_CHANGE",C)}}}var __awaiter$f=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class SceneGridApi{constructor(e){this.messageBus=e}getDpi(){return __awaiter$f(this,void 0,void 0,function*(){const{dpi:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_DPI",{});return e})}getScale(){return __awaiter$f(this,void 0,void 0,function*(){return yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_SCALE",{})})}setScale(e){return __awaiter$f(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_SCALE",{scale:e})})}getColor(){return __awaiter$f(this,void 0,void 0,function*(){const{color:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_COLOR",{});return e})}setColor(e){return __awaiter$f(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_COLOR",{color:e})})}getOpacity(){return __awaiter$f(this,void 0,void 0,function*(){const{opacity:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_OPACITY",{});return e})}setOpacity(e){return __awaiter$f(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_OPACITY",{opacity:e})})}getType(){return __awaiter$f(this,void 0,void 0,function*(){const{type:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_TYPE",{});return e})}setType(e){return __awaiter$f(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_TYPE",{type:e})})}getLineType(){return __awaiter$f(this,void 0,void 0,function*(){const{lineType:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_LINE_TYPE",{});return e})}setLineType(e){return __awaiter$f(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_LINE_TYPE",{lineType:e})})}getMeasurement(){return __awaiter$f(this,void 0,void 0,function*(){const{measurement:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_MEASUREMENT",{});return e})}setMeasurement(e){return __awaiter$f(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_MEASUREMENT",{measurement:e})})}snapPosition(e,C,F){return __awaiter$f(this,void 0,void 0,function*(){const{position:$}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_SNAP_POSITION",{position:e,snappingSensitivity:C,useCorners:F});return $})}getDistance(e,C){return __awaiter$f(this,void 0,void 0,function*(){const{distance:F}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_DISTANCE",{from:e,to:C});return F})}onChange(e){const C=F=>{e(F.grid)};return this.messageBus.send("OBR_SCENE_GRID_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_GRID_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_SCENE_GRID_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_GRID_EVENT_CHANGE",C)}}}var __awaiter$e=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class SceneHistoryApi{constructor(e){this.messageBus=e}undo(){return __awaiter$e(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_UNDO",{})})}redo(){return __awaiter$e(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_REDO",{})})}canUndo(){return __awaiter$e(this,void 0,void 0,function*(){const{canUndo:e}=yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_CAN_UNDO",{});return e})}canRedo(){return __awaiter$e(this,void 0,void 0,function*(){const{canRedo:e}=yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_CAN_REDO",{});return e})}}function n$2(J){for(var e=arguments.length,C=Array(e>1?e-1:0),F=1;F<e;F++)C[F-1]=arguments[F];throw Error("[Immer] minified error nr: "+J+(C.length?" "+C.map(function($){return"'"+$+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function r(J){return!!J&&!!J[Q]}function t(J){var e;return!!J&&(function(C){if(!C||typeof C!="object")return!1;var F=Object.getPrototypeOf(C);if(F===null)return!0;var $=Object.hasOwnProperty.call(F,"constructor")&&F.constructor;return $===Object||typeof $=="function"&&Function.toString.call($)===Z}(J)||Array.isArray(J)||!!J[L]||!!(!((e=J.constructor)===null||e===void 0)&&e[L])||s(J)||v(J))}function i$1(J,e,C){C===void 0&&(C=!1),o(J)===0?(C?Object.keys:nn)(J).forEach(function(F){C&&typeof F=="symbol"||e(F,J[F],J)}):J.forEach(function(F,$){return e($,F,J)})}function o(J){var e=J[Q];return e?e.i>3?e.i-4:e.i:Array.isArray(J)?1:s(J)?2:v(J)?3:0}function u$1(J,e){return o(J)===2?J.has(e):Object.prototype.hasOwnProperty.call(J,e)}function a(J,e){return o(J)===2?J.get(e):J[e]}function f(J,e,C){var F=o(J);F===2?J.set(e,C):F===3?J.add(C):J[e]=C}function c(J,e){return J===e?J!==0||1/J==1/e:J!=J&&e!=e}function s(J){return X&&J instanceof Map}function v(J){return q&&J instanceof Set}function p(J){return J.o||J.t}function l$1(J){if(Array.isArray(J))return Array.prototype.slice.call(J);var e=rn(J);delete e[Q];for(var C=nn(e),F=0;F<C.length;F++){var $=C[F],Y=e[$];Y.writable===!1&&(Y.writable=!0,Y.configurable=!0),(Y.get||Y.set)&&(e[$]={configurable:!0,writable:!0,enumerable:Y.enumerable,value:J[$]})}return Object.create(Object.getPrototypeOf(J),e)}function d$1(J,e){return e===void 0&&(e=!1),y(J)||r(J)||!t(J)||(o(J)>1&&(J.set=J.add=J.clear=J.delete=h$1),Object.freeze(J),e&&i$1(J,function(C,F){return d$1(F,!0)},!0)),J}function h$1(){n$2(2)}function y(J){return J==null||typeof J!="object"||Object.isFrozen(J)}function b(J){var e=tn[J];return e||n$2(18,J),e}function m(J,e){tn[J]||(tn[J]=e)}function _(){return U}function j(J,e){e&&(b("Patches"),J.u=[],J.s=[],J.v=e)}function g(J){O(J),J.p.forEach(S$2),J.p=null}function O(J){J===U&&(U=J.l)}function w(J){return U={p:[],l:U,h:J,m:!0,_:0}}function S$2(J){var e=J[Q];e.i===0||e.i===1?e.j():e.g=!0}function P(J,e){e._=e.p.length;var C=e.p[0],F=J!==void 0&&J!==C;return e.h.O||b("ES5").S(e,J,F),F?(C[Q].P&&(g(e),n$2(4)),t(J)&&(J=M(e,J),e.l||x$1(e,J)),e.u&&b("Patches").M(C[Q].t,J,e.u,e.s)):J=M(e,C,[]),g(e),e.u&&e.v(e.u,e.s),J!==H$1?J:void 0}function M(J,e,C){if(y(e))return e;var F=e[Q];if(!F)return i$1(e,function(te,se){return A(J,F,e,te,se,C)},!0),e;if(F.A!==J)return e;if(!F.P)return x$1(J,F.t,!0),F.t;if(!F.I){F.I=!0,F.A._--;var $=F.i===4||F.i===5?F.o=l$1(F.k):F.o,Y=$,V=!1;F.i===3&&(Y=new Set($),$.clear(),V=!0),i$1(Y,function(te,se){return A(J,F,$,te,se,C,V)}),x$1(J,$,!1),C&&J.u&&b("Patches").N(F,C,J.u,J.s)}return F.o}function A(J,e,C,F,$,Y,V){if(r($)){var te=M(J,$,Y&&e&&e.i!==3&&!u$1(e.R,F)?Y.concat(F):void 0);if(f(C,F,te),!r(te))return;J.m=!1}else V&&C.add($);if(t($)&&!y($)){if(!J.h.D&&J._<1)return;M(J,$),e&&e.A.l||x$1(J,$)}}function x$1(J,e,C){C===void 0&&(C=!1),!J.l&&J.h.D&&J.m&&d$1(e,C)}function z$1(J,e){var C=J[Q];return(C?p(C):J)[e]}function I(J,e){if(e in J)for(var C=Object.getPrototypeOf(J);C;){var F=Object.getOwnPropertyDescriptor(C,e);if(F)return F;C=Object.getPrototypeOf(C)}}function k(J){J.P||(J.P=!0,J.l&&k(J.l))}function E(J){J.o||(J.o=l$1(J.t))}function N(J,e,C){var F=s(e)?b("MapSet").F(e,C):v(e)?b("MapSet").T(e,C):J.O?function($,Y){var V=Array.isArray($),te={i:V?1:0,A:Y?Y.A:_(),P:!1,I:!1,R:{},l:Y,t:$,k:null,o:null,j:null,C:!1},se=te,ne=en;V&&(se=[te],ne=on);var ee=Proxy.revocable(se,ne),ie=ee.revoke,ae=ee.proxy;return te.k=ae,te.j=ie,ae}(e,C):b("ES5").J(e,C);return(C?C.A:_()).p.push(F),F}function R(J){return r(J)||n$2(22,J),function e(C){if(!t(C))return C;var F,$=C[Q],Y=o(C);if($){if(!$.P&&($.i<4||!b("ES5").K($)))return $.t;$.I=!0,F=D(C,Y),$.I=!1}else F=D(C,Y);return i$1(F,function(V,te){$&&a($.t,V)===te||f(F,V,e(te))}),Y===3?new Set(F):F}(J)}function D(J,e){switch(e){case 2:return new Map(J);case 3:return Array.from(J)}return l$1(J)}function T$2(){function J(F){if(!t(F))return F;if(Array.isArray(F))return F.map(J);if(s(F))return new Map(Array.from(F.entries()).map(function(V){return[V[0],J(V[1])]}));if(v(F))return new Set(Array.from(F).map(J));var $=Object.create(Object.getPrototypeOf(F));for(var Y in F)$[Y]=J(F[Y]);return u$1(F,L)&&($[L]=F[L]),$}function e(F){return r(F)?J(F):F}var C="add";m("Patches",{$:function(F,$){return $.forEach(function(Y){for(var V=Y.path,te=Y.op,se=F,ne=0;ne<V.length-1;ne++){var ee=o(se),ie=V[ne];typeof ie!="string"&&typeof ie!="number"&&(ie=""+ie),ee!==0&&ee!==1||ie!=="__proto__"&&ie!=="constructor"||n$2(24),typeof se=="function"&&ie==="prototype"&&n$2(24),typeof(se=a(se,ie))!="object"&&n$2(15,V.join("/"))}var ae=o(se),re=J(Y.value),oe=V[V.length-1];switch(te){case"replace":switch(ae){case 2:return se.set(oe,re);case 3:n$2(16);default:return se[oe]=re}case C:switch(ae){case 1:return oe==="-"?se.push(re):se.splice(oe,0,re);case 2:return se.set(oe,re);case 3:return se.add(re);default:return se[oe]=re}case"remove":switch(ae){case 1:return se.splice(oe,1);case 2:return se.delete(oe);case 3:return se.delete(Y.value);default:return delete se[oe]}default:n$2(17,te)}}),F},N:function(F,$,Y,V){switch(F.i){case 0:case 4:case 2:return function(te,se,ne,ee){var ie=te.t,ae=te.o;i$1(te.R,function(re,oe){var ce=a(ie,re),he=a(ae,re),de=oe?u$1(ie,re)?"replace":C:"remove";if(ce!==he||de!=="replace"){var pe=se.concat(re);ne.push(de==="remove"?{op:de,path:pe}:{op:de,path:pe,value:he}),ee.push(de===C?{op:"remove",path:pe}:de==="remove"?{op:C,path:pe,value:e(ce)}:{op:"replace",path:pe,value:e(ce)})}})}(F,$,Y,V);case 5:case 1:return function(te,se,ne,ee){var ie=te.t,ae=te.R,re=te.o;if(re.length<ie.length){var oe=[re,ie];ie=oe[0],re=oe[1];var ce=[ee,ne];ne=ce[0],ee=ce[1]}for(var he=0;he<ie.length;he++)if(ae[he]&&re[he]!==ie[he]){var de=se.concat([he]);ne.push({op:"replace",path:de,value:e(re[he])}),ee.push({op:"replace",path:de,value:e(ie[he])})}for(var pe=ie.length;pe<re.length;pe++){var fe=se.concat([pe]);ne.push({op:C,path:fe,value:e(re[pe])})}ie.length<re.length&&ee.push({op:"replace",path:se.concat(["length"]),value:ie.length})}(F,$,Y,V);case 3:return function(te,se,ne,ee){var ie=te.t,ae=te.o,re=0;ie.forEach(function(oe){if(!ae.has(oe)){var ce=se.concat([re]);ne.push({op:"remove",path:ce,value:oe}),ee.unshift({op:C,path:ce,value:oe})}re++}),re=0,ae.forEach(function(oe){if(!ie.has(oe)){var ce=se.concat([re]);ne.push({op:C,path:ce,value:oe}),ee.unshift({op:"remove",path:ce,value:oe})}re++})}(F,$,Y,V)}},M:function(F,$,Y,V){Y.push({op:"replace",path:[],value:$===H$1?void 0:$}),V.push({op:"replace",path:[],value:F})}})}var G$2,U,W$3=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",X=typeof Map<"u",q=typeof Set<"u",B=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",H$1=W$3?Symbol.for("immer-nothing"):((G$2={})["immer-nothing"]=!0,G$2),L=W$3?Symbol.for("immer-draftable"):"__$immer_draftable",Q=W$3?Symbol.for("immer-state"):"__$immer_state",Z=""+Object.prototype.constructor,nn=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(J){return Object.getOwnPropertyNames(J).concat(Object.getOwnPropertySymbols(J))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(J){var e={};return nn(J).forEach(function(C){e[C]=Object.getOwnPropertyDescriptor(J,C)}),e},tn={},en={get:function(J,e){if(e===Q)return J;var C=p(J);if(!u$1(C,e))return function($,Y,V){var te,se=I(Y,V);return se?"value"in se?se.value:(te=se.get)===null||te===void 0?void 0:te.call($.k):void 0}(J,C,e);var F=C[e];return J.I||!t(F)?F:F===z$1(J.t,e)?(E(J),J.o[e]=N(J.A.h,F,J)):F},has:function(J,e){return e in p(J)},ownKeys:function(J){return Reflect.ownKeys(p(J))},set:function(J,e,C){var F=I(p(J),e);if(F?.set)return F.set.call(J.k,C),!0;if(!J.P){var $=z$1(p(J),e),Y=$?.[Q];if(Y&&Y.t===C)return J.o[e]=C,J.R[e]=!1,!0;if(c(C,$)&&(C!==void 0||u$1(J.t,e)))return!0;E(J),k(J)}return J.o[e]===C&&(C!==void 0||e in J.o)||Number.isNaN(C)&&Number.isNaN(J.o[e])||(J.o[e]=C,J.R[e]=!0),!0},deleteProperty:function(J,e){return z$1(J.t,e)!==void 0||e in J.t?(J.R[e]=!1,E(J),k(J)):delete J.R[e],J.o&&delete J.o[e],!0},getOwnPropertyDescriptor:function(J,e){var C=p(J),F=Reflect.getOwnPropertyDescriptor(C,e);return F&&{writable:!0,configurable:J.i!==1||e!=="length",enumerable:F.enumerable,value:C[e]}},defineProperty:function(){n$2(11)},getPrototypeOf:function(J){return Object.getPrototypeOf(J.t)},setPrototypeOf:function(){n$2(12)}},on={};i$1(en,function(J,e){on[J]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),on.deleteProperty=function(J,e){return on.set.call(this,J,e,void 0)},on.set=function(J,e,C){return en.set.call(this,J[0],e,C,J[0])};var un=function(){function J(C){var F=this;this.O=B,this.D=!0,this.produce=function($,Y,V){if(typeof $=="function"&&typeof Y!="function"){var te=Y;Y=$;var se=F;return function(ce){var he=this;ce===void 0&&(ce=te);for(var de=arguments.length,pe=Array(de>1?de-1:0),fe=1;fe<de;fe++)pe[fe-1]=arguments[fe];return se.produce(ce,function(ye){var _e;return(_e=Y).call.apply(_e,[he,ye].concat(pe))})}}var ne;if(typeof Y!="function"&&n$2(6),V!==void 0&&typeof V!="function"&&n$2(7),t($)){var ee=w(F),ie=N(F,$,void 0),ae=!0;try{ne=Y(ie),ae=!1}finally{ae?g(ee):O(ee)}return typeof Promise<"u"&&ne instanceof Promise?ne.then(function(ce){return j(ee,V),P(ce,ee)},function(ce){throw g(ee),ce}):(j(ee,V),P(ne,ee))}if(!$||typeof $!="object"){if((ne=Y($))===void 0&&(ne=$),ne===H$1&&(ne=void 0),F.D&&d$1(ne,!0),V){var re=[],oe=[];b("Patches").M($,ne,re,oe),V(re,oe)}return ne}n$2(21,$)},this.produceWithPatches=function($,Y){if(typeof $=="function")return function(ne){for(var ee=arguments.length,ie=Array(ee>1?ee-1:0),ae=1;ae<ee;ae++)ie[ae-1]=arguments[ae];return F.produceWithPatches(ne,function(re){return $.apply(void 0,[re].concat(ie))})};var V,te,se=F.produce($,Y,function(ne,ee){V=ne,te=ee});return typeof Promise<"u"&&se instanceof Promise?se.then(function(ne){return[ne,V,te]}):[se,V,te]},typeof C?.useProxies=="boolean"&&this.setUseProxies(C.useProxies),typeof C?.autoFreeze=="boolean"&&this.setAutoFreeze(C.autoFreeze)}var e=J.prototype;return e.createDraft=function(C){t(C)||n$2(8),r(C)&&(C=R(C));var F=w(this),$=N(this,C,void 0);return $[Q].C=!0,O(F),$},e.finishDraft=function(C,F){var $=C&&C[Q],Y=$.A;return j(Y,F),P(void 0,Y)},e.setAutoFreeze=function(C){this.D=C},e.setUseProxies=function(C){C&&!B&&n$2(20),this.O=C},e.applyPatches=function(C,F){var $;for($=F.length-1;$>=0;$--){var Y=F[$];if(Y.path.length===0&&Y.op==="replace"){C=Y.value;break}}$>-1&&(F=F.slice($+1));var V=b("Patches").$;return r(C)?V(C,F):this.produce(C,function(te){return V(te,F)})},J}(),an=new un;an.produce;var cn=an.produceWithPatches.bind(an);an.setAutoFreeze.bind(an);an.setUseProxies.bind(an);an.applyPatches.bind(an);an.createDraft.bind(an);an.finishDraft.bind(an);var __awaiter$d=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};T$2();class SceneItemsApi{constructor(e){this.messageBus=e}getItems(e){return __awaiter$d(this,void 0,void 0,function*(){if(Array.isArray(e)){const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ITEMS",{ids:e});return C}else if(e){const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ALL_ITEMS",{});return C.filter(e)}else{const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ALL_ITEMS",{});return C}})}isItemArray(e){return Array.isArray(e)&&e.every(C=>typeof C!="string")}updateItems(e,C){return __awaiter$d(this,void 0,void 0,function*(){let F;this.isItemArray(e)?F=e:F=yield this.getItems(e);const[$,Y]=cn(F,C),V=$.map(te=>({id:te.id,type:te.type}));for(const te of Y){const[se,ne]=te.path;typeof se=="number"&&typeof ne=="string"&&(V[se][ne]=$[se][ne])}yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_UPDATE_ITEMS",{updates:V})})}addItems(e){return __awaiter$d(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_ADD_ITEMS",{items:e})})}deleteItems(e){return __awaiter$d(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_DELETE_ITEMS",{ids:e})})}getItemAttachments(e){return __awaiter$d(this,void 0,void 0,function*(){const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ITEM_ATTACHMENTS",{ids:e});return C})}getItemBounds(e){return __awaiter$d(this,void 0,void 0,function*(){const{bounds:C}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ITEM_BOUNDS",{ids:e});return C})}onChange(e){const C=F=>{e(F.items)};return this.messageBus.send("OBR_SCENE_ITEMS_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_ITEMS_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_SCENE_ITEMS_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_ITEMS_EVENT_CHANGE",C)}}}var __awaiter$c=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};T$2();class SceneLocalApi{constructor(e){this.messageBus=e}getItems(e){return __awaiter$c(this,void 0,void 0,function*(){if(Array.isArray(e)){const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ITEMS",{ids:e});return C}else if(e){const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ALL_ITEMS",{});return C.filter(e)}else{const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ALL_ITEMS",{});return C}})}updateItems(e,C,F){return __awaiter$c(this,void 0,void 0,function*(){const $=yield this.getItems(e),[Y,V]=cn($,C),te=Y.map(se=>({id:se.id,type:se.type}));for(const se of V){const[ne,ee]=se.path;typeof ne=="number"&&typeof ee=="string"&&(te[ne][ee]=Y[ne][ee])}yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_UPDATE_ITEMS",{updates:te,fastUpdate:F})})}addItems(e){return __awaiter$c(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_ADD_ITEMS",{items:e})})}deleteItems(e){return __awaiter$c(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_DELETE_ITEMS",{ids:e})})}getItemAttachments(e){return __awaiter$c(this,void 0,void 0,function*(){const{items:C}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ITEM_ATTACHMENTS",{ids:e});return C})}getItemBounds(e){return __awaiter$c(this,void 0,void 0,function*(){const{bounds:C}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ITEM_BOUNDS",{ids:e});return C})}onChange(e){const C=F=>{e(F.items)};return this.messageBus.send("OBR_SCENE_LOCAL_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_LOCAL_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_SCENE_LOCAL_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_LOCAL_EVENT_CHANGE",C)}}}var __awaiter$b=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class SceneApi{constructor(e){this.messageBus=e,this.grid=new SceneGridApi(e),this.fog=new SceneFogApi(e),this.history=new SceneHistoryApi(e),this.items=new SceneItemsApi(e),this.local=new SceneLocalApi(e)}isReady(){return __awaiter$b(this,void 0,void 0,function*(){const{ready:e}=yield this.messageBus.sendAsync("OBR_SCENE_IS_READY",{});return e})}onReadyChange(e){const C=F=>{e(F.ready)};return this.messageBus.send("OBR_SCENE_READY_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_EVENT_READY_CHANGE",C),()=>{this.messageBus.send("OBR_SCENE_READY_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_EVENT_READY_CHANGE",C)}}getMetadata(){return __awaiter$b(this,void 0,void 0,function*(){const{metadata:e}=yield this.messageBus.sendAsync("OBR_SCENE_GET_METADATA",{});return e})}setMetadata(e){return __awaiter$b(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_SET_METADATA",{update:e})})}onMetadataChange(e){const C=F=>{e(F.metadata)};return this.messageBus.send("OBR_SCENE_METADATA_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_METADATA_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_SCENE_METADATA_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_METADATA_EVENT_CHANGE",C)}}}function normalizeIconPaths(J){return J.map(e=>Object.assign(Object.assign({},e),{icon:e.icon.startsWith("http")?e.icon:`${window.location.origin}${e.icon}`}))}function normalizeUrlObject(J){return Object.assign(Object.assign({},J),{url:J.url.startsWith("http")?J.url:`${window.location.origin}${J.url}`})}var __awaiter$a=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class ContextMenuApi{constructor(e){this.contextMenus={},this.handleClick=C=>{const F=this.contextMenus[C.id];F&&F.onClick(C.context,C.elementId)},this.messageBus=e,e.on("OBR_CONTEXT_MENU_EVENT_CLICK",this.handleClick)}create(e){return __awaiter$a(this,void 0,void 0,function*(){this.messageBus.sendAsync("OBR_CONTEXT_MENU_CREATE",{id:e.id,shortcut:e.shortcut,icons:normalizeIconPaths(e.icons)}),this.contextMenus[e.id]=e})}remove(e){return __awaiter$a(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_CONTEXT_MENU_REMOVE",{id:e}),delete this.contextMenus[e]})}}var __awaiter$9=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class ToolApi{constructor(e){this.tools={},this.toolActions={},this.toolModes={},this.handleToolClick=C=>{const F=this.tools[C.id];if(F)if(F.onClick){const $=F.onClick(C.context,C.elementId);Promise.resolve($).then(Y=>{Y&&this.messageBus.send("OBR_TOOL_ACTIVATE",{id:C.id})})}else this.messageBus.send("OBR_TOOL_ACTIVATE",{id:C.id})},this.handleToolActionClick=C=>{var F;const $=this.toolActions[C.id];$&&((F=$.onClick)===null||F===void 0||F.call($,C.context,C.elementId))},this.handleToolModeClick=C=>{const F=this.toolModes[C.id];if(F)if(F.onClick){const $=F.onClick(C.context,C.elementId);Promise.resolve($).then(Y=>{Y&&this.messageBus.send("OBR_TOOL_MODE_ACTIVATE",{toolId:C.context.activeTool,modeId:C.id})})}else this.messageBus.send("OBR_TOOL_MODE_ACTIVATE",{toolId:C.context.activeTool,modeId:C.id})},this.handleToolModeToolClick=C=>{const F=this.toolModes[C.id];if(F)if(F.onToolClick){const $=F.onToolClick(C.context,C.event);Promise.resolve($).then(Y=>{Y&&C.event.target&&!C.event.target.locked&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[C.event.target.id]})})}else C.event.target&&!C.event.target.locked&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[C.event.target.id]})},this.handleToolModeToolDoubleClick=C=>{const F=this.toolModes[C.id];if(F)if(F.onToolDoubleClick){const $=F.onToolDoubleClick(C.context,C.event);Promise.resolve($).then(Y=>{Y&&C.event.target&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[C.event.target.id]})})}else C.event.target&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[C.event.target.id]})},this.handleToolModeToolDown=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolDown)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeToolMove=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolMove)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeToolUp=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolUp)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeToolDragStart=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolDragStart)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeToolDragMove=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolDragMove)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeToolDragEnd=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolDragEnd)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeToolDragCancel=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onToolDragCancel)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeKeyDown=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onKeyDown)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeKeyUp=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onKeyUp)===null||F===void 0||F.call($,C.context,C.event))},this.handleToolModeActivate=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onActivate)===null||F===void 0||F.call($,C.context))},this.handleToolModeDeactivate=C=>{var F;const $=this.toolModes[C.id];$&&((F=$.onDeactivate)===null||F===void 0||F.call($,C.context))},this.messageBus=e,e.on("OBR_TOOL_EVENT_CLICK",this.handleToolClick),e.on("OBR_TOOL_ACTION_EVENT_CLICK",this.handleToolActionClick),e.on("OBR_TOOL_MODE_EVENT_CLICK",this.handleToolModeClick),e.on("OBR_TOOL_MODE_EVENT_TOOL_CLICK",this.handleToolModeToolClick),e.on("OBR_TOOL_MODE_EVENT_TOOL_DOUBLE_CLICK",this.handleToolModeToolDoubleClick),e.on("OBR_TOOL_MODE_EVENT_TOOL_DOWN",this.handleToolModeToolDown),e.on("OBR_TOOL_MODE_EVENT_TOOL_MOVE",this.handleToolModeToolMove),e.on("OBR_TOOL_MODE_EVENT_TOOL_UP",this.handleToolModeToolUp),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_START",this.handleToolModeToolDragStart),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_MOVE",this.handleToolModeToolDragMove),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_END",this.handleToolModeToolDragEnd),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_CANCEL",this.handleToolModeToolDragCancel),e.on("OBR_TOOL_MODE_EVENT_KEY_DOWN",this.handleToolModeKeyDown),e.on("OBR_TOOL_MODE_EVENT_KEY_UP",this.handleToolModeKeyUp),e.on("OBR_TOOL_MODE_EVENT_ACTIVATE",this.handleToolModeActivate),e.on("OBR_TOOL_MODE_EVENT_DEACTIVATE",this.handleToolModeDeactivate)}create(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_CREATE",{id:e.id,shortcut:e.shortcut,defaultMode:e.defaultMode,defaultMetadata:e.defaultMetadata,icons:normalizeIconPaths(e.icons),disabled:e.disabled}),this.tools[e.id]=e})}remove(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_REMOVE",{id:e}),delete this.tools[e]})}activateTool(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_ACTIVATE",{id:e})})}getMetadata(e){return __awaiter$9(this,void 0,void 0,function*(){const{metadata:C}=yield this.messageBus.sendAsync("OBR_TOOL_GET_METADATA",{id:e});return C})}setMetadata(e,C){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_SET_METADATA",{toolId:e,update:C})})}createAction(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_ACTION_CREATE",{id:e.id,shortcut:e.shortcut,icons:normalizeIconPaths(e.icons),disabled:e.disabled}),this.toolActions[e.id]=e})}removeAction(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_ACTION_REMOVE",{id:e}),delete this.tools[e]})}createMode(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_MODE_CREATE",{id:e.id,shortcut:e.shortcut,icons:normalizeIconPaths(e.icons),preventDrag:e.preventDrag,disabled:e.disabled,cursors:e.cursors}),this.toolModes[e.id]=e})}removeMode(e){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_MODE_REMOVE",{id:e}),delete this.tools[e]})}activateMode(e,C){return __awaiter$9(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_MODE_ACTIVATE",{toolId:e,modeId:C})})}}var __awaiter$8=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class PopoverApi{constructor(e){this.messageBus=e}open(e){return __awaiter$8(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_OPEN",Object.assign({},normalizeUrlObject(e)))})}close(e){return __awaiter$8(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_CLOSE",{id:e})})}getWidth(e){return __awaiter$8(this,void 0,void 0,function*(){const{width:C}=yield this.messageBus.sendAsync("OBR_POPOVER_GET_WIDTH",{id:e});return C})}setWidth(e,C){return __awaiter$8(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_SET_WIDTH",{id:e,width:C})})}getHeight(e){return __awaiter$8(this,void 0,void 0,function*(){const{height:C}=yield this.messageBus.sendAsync("OBR_POPOVER_GET_HEIGHT",{id:e});return C})}setHeight(e,C){return __awaiter$8(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_SET_HEIGHT",{id:e,height:C})})}}var __awaiter$7=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class ModalApi{constructor(e){this.messageBus=e}open(e){return __awaiter$7(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_MODAL_OPEN",Object.assign({},normalizeUrlObject(e)))})}close(e){return __awaiter$7(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_MODAL_CLOSE",{id:e})})}}var __awaiter$6=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class ActionApi{constructor(e){this.messageBus=e}getWidth(){return __awaiter$6(this,void 0,void 0,function*(){const{width:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_WIDTH",{});return e})}setWidth(e){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_WIDTH",{width:e})})}getHeight(){return __awaiter$6(this,void 0,void 0,function*(){const{height:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_HEIGHT",{});return e})}setHeight(e){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_HEIGHT",{height:e})})}getBadgeText(){return __awaiter$6(this,void 0,void 0,function*(){const{badgeText:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_BADGE_TEXT",{});return e})}setBadgeText(e){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_BADGE_TEXT",{badgeText:e})})}getBadgeBackgroundColor(){return __awaiter$6(this,void 0,void 0,function*(){const{badgeBackgroundColor:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_BADGE_BACKGROUND_COLOR",{});return e})}setBadgeBackgroundColor(e){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_BADGE_BACKGROUND_COLOR",{badgeBackgroundColor:e})})}getIcon(){return __awaiter$6(this,void 0,void 0,function*(){const{icon:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_ICON",{});return e})}setIcon(e){return __awaiter$6(this,void 0,void 0,function*(){const C=normalizeIconPaths([{icon:e}]);yield this.messageBus.sendAsync("OBR_ACTION_SET_ICON",{icon:C[0].icon})})}getTitle(){return __awaiter$6(this,void 0,void 0,function*(){const{title:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_TITLE",{});return e})}setTitle(e){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_TITLE",{title:e})})}isOpen(){return __awaiter$6(this,void 0,void 0,function*(){const{isOpen:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_IS_OPEN",{});return e})}open(){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_OPEN",{})})}close(){return __awaiter$6(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_CLOSE",{})})}onOpenChange(e){const C=F=>{e(F.isOpen)};return this.messageBus.send("OBR_ACTION_IS_OPEN_SUBSCRIBE",{}),this.messageBus.on("OBR_ACTION_IS_OPEN_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_IS_OPEN_ACTION_UNSUBSCRIBE",{}),this.messageBus.off("OBR_ACTION_IS_OPEN_EVENT_CHANGE",C)}}}var __awaiter$5=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};T$2();class InteractionApi{constructor(e){this.messageBus=e}startItemInteraction(e){return __awaiter$5(this,void 0,void 0,function*(){const{id:C}=yield this.messageBus.sendAsync("OBR_INTERACTION_START_ITEM_INTERACTION",{baseState:e});let F=e;return[V=>{const[te,se]=cn(F,V);return F=te,this.messageBus.send("OBR_INTERACTION_UPDATE_ITEM_INTERACTION",{id:C,patches:se}),te},()=>{this.messageBus.send("OBR_INTERACTION_STOP_ITEM_INTERACTION",{id:C})}]})}}var __awaiter$4=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class PartyApi{constructor(e){this.messageBus=e}getPlayers(){return __awaiter$4(this,void 0,void 0,function*(){const{players:e}=yield this.messageBus.sendAsync("OBR_PARTY_GET_PLAYERS",{});return e})}onChange(e){const C=F=>{e(F.players)};return this.messageBus.send("OBR_PARTY_SUBSCRIBE",{}),this.messageBus.on("OBR_PARTY_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_PARTY_UNSUBSCRIBE",{}),this.messageBus.off("OBR_PARTY_EVENT_CHANGE",C)}}}var __awaiter$3=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class RoomApi{constructor(e){this.messageBus=e}get id(){return this.messageBus.roomId}getPermissions(){return __awaiter$3(this,void 0,void 0,function*(){const{permissions:e}=yield this.messageBus.sendAsync("OBR_ROOM_GET_PERMISSIONS",{});return e})}getMetadata(){return __awaiter$3(this,void 0,void 0,function*(){const{metadata:e}=yield this.messageBus.sendAsync("OBR_ROOM_GET_METADATA",{});return e})}setMetadata(e){return __awaiter$3(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ROOM_SET_METADATA",{update:e})})}onMetadataChange(e){const C=F=>{e(F.metadata)};return this.messageBus.send("OBR_ROOM_METADATA_SUBSCRIBE",{}),this.messageBus.on("OBR_ROOM_METADATA_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_METADATA_ROOM_UNSUBSCRIBE",{}),this.messageBus.off("OBR_ROOM_METADATA_EVENT_CHANGE",C)}}onPermissionsChange(e){const C=F=>{e(F.permissions)};return this.messageBus.send("OBR_ROOM_PERMISSIONS_SUBSCRIBE",{}),this.messageBus.on("OBR_ROOM_PERMISSIONS_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_PERMISSIONS_ROOM_UNSUBSCRIBE",{}),this.messageBus.off("OBR_ROOM_PERMISSIONS_EVENT_CHANGE",C)}}}var __awaiter$2=globalThis&&globalThis.__awaiter||function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class ThemeApi{constructor(e){this.messageBus=e}getTheme(){return __awaiter$2(this,void 0,void 0,function*(){const{theme:e}=yield this.messageBus.sendAsync("OBR_THEME_GET_THEME",{});return e})}onChange(e){const C=F=>{e(F.theme)};return this.messageBus.send("OBR_THEME_SUBSCRIBE",{}),this.messageBus.on("OBR_THEME_EVENT_CHANGE",C),()=>{this.messageBus.send("OBR_THEME_UNSUBSCRIBE",{}),this.messageBus.off("OBR_THEME_EVENT_CHANGE",C)}}}const _hasatob=typeof atob=="function",_hasBuffer=typeof Buffer=="function",_TD=typeof TextDecoder=="function"?new TextDecoder:void 0;typeof TextEncoder=="function"&&new TextEncoder;const b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b64chs=Array.prototype.slice.call(b64ch),b64tab=(J=>{let e={};return J.forEach((C,F)=>e[C]=F),e})(b64chs),b64re=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,_fromCC=String.fromCharCode.bind(String),_U8Afrom=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):J=>new Uint8Array(Array.prototype.slice.call(J,0)),_tidyB64=J=>J.replace(/[^A-Za-z0-9\+\/]/g,""),re_btou=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,cb_btou=J=>{switch(J.length){case 4:var e=(7&J.charCodeAt(0))<<18|(63&J.charCodeAt(1))<<12|(63&J.charCodeAt(2))<<6|63&J.charCodeAt(3),C=e-65536;return _fromCC((C>>>10)+55296)+_fromCC((C&1023)+56320);case 3:return _fromCC((15&J.charCodeAt(0))<<12|(63&J.charCodeAt(1))<<6|63&J.charCodeAt(2));default:return _fromCC((31&J.charCodeAt(0))<<6|63&J.charCodeAt(1))}},btou=J=>J.replace(re_btou,cb_btou),atobPolyfill=J=>{if(J=J.replace(/\s+/g,""),!b64re.test(J))throw new TypeError("malformed base64.");J+="==".slice(2-(J.length&3));let e,C="",F,$;for(let Y=0;Y<J.length;)e=b64tab[J.charAt(Y++)]<<18|b64tab[J.charAt(Y++)]<<12|(F=b64tab[J.charAt(Y++)])<<6|($=b64tab[J.charAt(Y++)]),C+=F===64?_fromCC(e>>16&255):$===64?_fromCC(e>>16&255,e>>8&255):_fromCC(e>>16&255,e>>8&255,e&255);return C},_atob=_hasatob?J=>atob(_tidyB64(J)):_hasBuffer?J=>Buffer.from(J,"base64").toString("binary"):atobPolyfill,_toUint8Array=_hasBuffer?J=>_U8Afrom(Buffer.from(J,"base64")):J=>_U8Afrom(_atob(J).split("").map(e=>e.charCodeAt(0))),_decode=_hasBuffer?J=>Buffer.from(J,"base64").toString("utf8"):_TD?J=>_TD.decode(_toUint8Array(J)):J=>btou(_atob(J)),_unURI=J=>_tidyB64(J.replace(/[-_]/g,e=>e=="-"?"+":"/")),decode=J=>_decode(_unURI(J));function getDetails(){const e=new URLSearchParams(window.location.search).get("obrref");let C="",F="";if(e){const Y=decode(e).split(" ");Y.length===2&&(C=Y[0],F=Y[1])}return{origin:C,roomId:F}}var Command;(function(J){J[J.MOVE=0]="MOVE",J[J.LINE=1]="LINE",J[J.QUAD=2]="QUAD",J[J.CONIC=3]="CONIC",J[J.CUBIC=4]="CUBIC",J[J.CLOSE=5]="CLOSE"})(Command||(Command={}));const details=getDetails(),messageBus=new MessageBus(details.origin,details.roomId),viewportApi=new ViewportApi(messageBus),playerApi=new PlayerApi(messageBus),partyApi=new PartyApi(messageBus),notificationApi=new NotificationApi(messageBus),sceneApi=new SceneApi(messageBus),contextMenuApi=new ContextMenuApi(messageBus),toolApi=new ToolApi(messageBus),popoverApi=new PopoverApi(messageBus),modalApi=new ModalApi(messageBus),actionApi=new ActionApi(messageBus),interactionApi=new InteractionApi(messageBus),roomApi=new RoomApi(messageBus),themeApi=new ThemeApi(messageBus),OBR={onReady:J=>{messageBus.ready?J():messageBus.once("OBR_READY",()=>J())},get isReady(){return messageBus.ready},viewport:viewportApi,player:playerApi,party:partyApi,notification:notificationApi,scene:sceneApi,contextMenu:contextMenuApi,tool:toolApi,popover:popoverApi,modal:modalApi,action:actionApi,interaction:interactionApi,room:roomApi,theme:themeApi,isAvailable:!!details.origin};function commonjsRequire(J){throw new Error('Could not dynamically require "'+J+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,C){module.exports=C()})(globalThis,()=>(()=>{var __webpack_modules__=[,(J,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationStateModelType=e.AnnotationReviewState=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationMarkedState=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=ue,e.bytesToString=Le,e.createValidAbsoluteUrl=ve,e.getModificationDate=mt,e.getVerbosityLevel=Ie,e.info=Oe,e.isArrayBuffer=gt,e.isArrayEqual=ot,e.normalizeUnicode=yt,e.objectFromMap=Ke,e.objectSize=je,e.setVerbosityLevel=We,e.shadow=le,e.string32=Ve,e.stringToBytes=ze,e.stringToPDFString=it,e.stringToUTF8String=lt,e.unreachable=ge,e.utf8StringToString=rt,e.warn=Pe;const C=[1,0,0,1,0,0];e.IDENTITY_MATRIX=C;const F=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=F;const $=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=$;const Y=1.35;e.LINE_FACTOR=Y;const V=.35;e.LINE_DESCENT_FACTOR=V;const te=V/Y;e.BASELINE_FACTOR=te;const se={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=se;const ne={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=ne;const ee="pdfjs_internal_editor_";e.AnnotationEditorPrefix=ee;const ie={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};e.AnnotationEditorType=ie;const ae={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};e.AnnotationEditorParamsType=ae;const re={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=re;const oe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=oe;const ce={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=ce;const he={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=he;const de={MARKED:"Marked",REVIEW:"Review"};e.AnnotationStateModelType=de;const pe={MARKED:"Marked",UNMARKED:"Unmarked"};e.AnnotationMarkedState=pe;const fe={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};e.AnnotationReviewState=fe;const ye={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=ye;const _e={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=_e;const Ee={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=Ee;const be={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=be;const Ae={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=Ae;const we={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=we;const Te={O:"PageOpen",C:"PageClose"};e.PageActionEventType=Te;const Me={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=Me;const Be={NONE:0,BINARY:1};e.CMapCompressionType=Be;const $e={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=$e;const Fe={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=Fe;let Xe=Me.WARNINGS;function We(qe){Number.isInteger(qe)&&(Xe=qe)}function Ie(){return Xe}function Oe(qe){Xe>=Me.INFOS&&console.log(`Info: ${qe}`)}function Pe(qe){Xe>=Me.WARNINGS&&console.log(`Warning: ${qe}`)}function ge(qe){throw new Error(qe)}function ue(qe,He){qe||ge(He)}function xe(qe){switch(qe?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ve(qe,He=null,Ue=null){if(!qe)return null;try{if(Ue&&typeof qe=="string"&&(Ue.addDefaultProtocol&&qe.startsWith("www.")&&qe.match(/\./g)?.length>=2&&(qe=`http://${qe}`),Ue.tryConvertEncoding))try{qe=lt(qe)}catch{}const Qe=He?new URL(qe,He):new URL(qe);if(xe(Qe))return Qe}catch{}return null}function le(qe,He,Ue,Qe=!1){return Object.defineProperty(qe,He,{value:Ue,enumerable:!Qe,configurable:!0,writable:!1}),Ue}const me=function(){function He(Ue,Qe){this.constructor===He&&ge("Cannot initialize BaseException."),this.message=Ue,this.name=Qe}return He.prototype=new Error,He.constructor=He,He}();e.BaseException=me;class Ce extends me{constructor(He,Ue){super(He,"PasswordException"),this.code=Ue}}e.PasswordException=Ce;class Se extends me{constructor(He,Ue){super(He,"UnknownErrorException"),this.details=Ue}}e.UnknownErrorException=Se;class Re extends me{constructor(He){super(He,"InvalidPDFException")}}e.InvalidPDFException=Re;class ke extends me{constructor(He){super(He,"MissingPDFException")}}e.MissingPDFException=ke;class De extends me{constructor(He,Ue){super(He,"UnexpectedResponseException"),this.status=Ue}}e.UnexpectedResponseException=De;class Ne extends me{constructor(He){super(He,"FormatError")}}e.FormatError=Ne;class Ge extends me{constructor(He){super(He,"AbortException")}}e.AbortException=Ge;function Le(qe){(typeof qe!="object"||qe?.length===void 0)&&ge("Invalid argument for bytesToString");const He=qe.length,Ue=8192;if(He<Ue)return String.fromCharCode.apply(null,qe);const Qe=[];for(let st=0;st<He;st+=Ue){const ct=Math.min(st+Ue,He),at=qe.subarray(st,ct);Qe.push(String.fromCharCode.apply(null,at))}return Qe.join("")}function ze(qe){typeof qe!="string"&&ge("Invalid argument for stringToBytes");const He=qe.length,Ue=new Uint8Array(He);for(let Qe=0;Qe<He;++Qe)Ue[Qe]=qe.charCodeAt(Qe)&255;return Ue}function Ve(qe){return String.fromCharCode(qe>>24&255,qe>>16&255,qe>>8&255,qe&255)}function je(qe){return Object.keys(qe).length}function Ke(qe){const He=Object.create(null);for(const[Ue,Qe]of qe)He[Ue]=Qe;return He}function Ye(){const qe=new Uint8Array(4);return qe[0]=1,new Uint32Array(qe.buffer,0,1)[0]===1}function Ze(){try{return new Function(""),!0}catch{return!1}}class Je{static get isLittleEndian(){return le(this,"isLittleEndian",Ye())}static get isEvalSupported(){return le(this,"isEvalSupported",Ze())}static get isOffscreenCanvasSupported(){return le(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?le(this,"platform",{isWin:!1,isMac:!1}):le(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}e.FeatureTest=Je;const tt=[...Array(256).keys()].map(qe=>qe.toString(16).padStart(2,"0"));class nt{static makeHexColor(He,Ue,Qe){return`#${tt[He]}${tt[Ue]}${tt[Qe]}`}static scaleMinMax(He,Ue){let Qe;He[0]?(He[0]<0&&(Qe=Ue[0],Ue[0]=Ue[1],Ue[1]=Qe),Ue[0]*=He[0],Ue[1]*=He[0],He[3]<0&&(Qe=Ue[2],Ue[2]=Ue[3],Ue[3]=Qe),Ue[2]*=He[3],Ue[3]*=He[3]):(Qe=Ue[0],Ue[0]=Ue[2],Ue[2]=Qe,Qe=Ue[1],Ue[1]=Ue[3],Ue[3]=Qe,He[1]<0&&(Qe=Ue[2],Ue[2]=Ue[3],Ue[3]=Qe),Ue[2]*=He[1],Ue[3]*=He[1],He[2]<0&&(Qe=Ue[0],Ue[0]=Ue[1],Ue[1]=Qe),Ue[0]*=He[2],Ue[1]*=He[2]),Ue[0]+=He[4],Ue[1]+=He[4],Ue[2]+=He[5],Ue[3]+=He[5]}static transform(He,Ue){return[He[0]*Ue[0]+He[2]*Ue[1],He[1]*Ue[0]+He[3]*Ue[1],He[0]*Ue[2]+He[2]*Ue[3],He[1]*Ue[2]+He[3]*Ue[3],He[0]*Ue[4]+He[2]*Ue[5]+He[4],He[1]*Ue[4]+He[3]*Ue[5]+He[5]]}static applyTransform(He,Ue){const Qe=He[0]*Ue[0]+He[1]*Ue[2]+Ue[4],st=He[0]*Ue[1]+He[1]*Ue[3]+Ue[5];return[Qe,st]}static applyInverseTransform(He,Ue){const Qe=Ue[0]*Ue[3]-Ue[1]*Ue[2],st=(He[0]*Ue[3]-He[1]*Ue[2]+Ue[2]*Ue[5]-Ue[4]*Ue[3])/Qe,ct=(-He[0]*Ue[1]+He[1]*Ue[0]+Ue[4]*Ue[1]-Ue[5]*Ue[0])/Qe;return[st,ct]}static getAxialAlignedBoundingBox(He,Ue){const Qe=nt.applyTransform(He,Ue),st=nt.applyTransform(He.slice(2,4),Ue),ct=nt.applyTransform([He[0],He[3]],Ue),at=nt.applyTransform([He[2],He[1]],Ue);return[Math.min(Qe[0],st[0],ct[0],at[0]),Math.min(Qe[1],st[1],ct[1],at[1]),Math.max(Qe[0],st[0],ct[0],at[0]),Math.max(Qe[1],st[1],ct[1],at[1])]}static inverseTransform(He){const Ue=He[0]*He[3]-He[1]*He[2];return[He[3]/Ue,-He[1]/Ue,-He[2]/Ue,He[0]/Ue,(He[2]*He[5]-He[4]*He[3])/Ue,(He[4]*He[1]-He[5]*He[0])/Ue]}static singularValueDecompose2dScale(He){const Ue=[He[0],He[2],He[1],He[3]],Qe=He[0]*Ue[0]+He[1]*Ue[2],st=He[0]*Ue[1]+He[1]*Ue[3],ct=He[2]*Ue[0]+He[3]*Ue[2],at=He[2]*Ue[1]+He[3]*Ue[3],_t=(Qe+at)/2,At=Math.sqrt((Qe+at)**2-4*(Qe*at-ct*st))/2,xt=_t+At||1,ut=_t-At||1;return[Math.sqrt(xt),Math.sqrt(ut)]}static normalizeRect(He){const Ue=He.slice(0);return He[0]>He[2]&&(Ue[0]=He[2],Ue[2]=He[0]),He[1]>He[3]&&(Ue[1]=He[3],Ue[3]=He[1]),Ue}static intersect(He,Ue){const Qe=Math.max(Math.min(He[0],He[2]),Math.min(Ue[0],Ue[2])),st=Math.min(Math.max(He[0],He[2]),Math.max(Ue[0],Ue[2]));if(Qe>st)return null;const ct=Math.max(Math.min(He[1],He[3]),Math.min(Ue[1],Ue[3])),at=Math.min(Math.max(He[1],He[3]),Math.max(Ue[1],Ue[3]));return ct>at?null:[Qe,ct,st,at]}static bezierBoundingBox(He,Ue,Qe,st,ct,at,_t,At){const xt=[],ut=[[],[]];let bt,Ct,vt,dt,Tt,Rt,Pt,kt;for(let Dt=0;Dt<2;++Dt){if(Dt===0?(Ct=6*He-12*Qe+6*ct,bt=-3*He+9*Qe-9*ct+3*_t,vt=3*Qe-3*He):(Ct=6*Ue-12*st+6*at,bt=-3*Ue+9*st-9*at+3*At,vt=3*st-3*Ue),Math.abs(bt)<1e-12){if(Math.abs(Ct)<1e-12)continue;dt=-vt/Ct,0<dt&&dt<1&&xt.push(dt);continue}Pt=Ct*Ct-4*vt*bt,kt=Math.sqrt(Pt),!(Pt<0)&&(Tt=(-Ct+kt)/(2*bt),0<Tt&&Tt<1&&xt.push(Tt),Rt=(-Ct-kt)/(2*bt),0<Rt&&Rt<1&&xt.push(Rt))}let St=xt.length,ft;const Et=St;for(;St--;)dt=xt[St],ft=1-dt,ut[0][St]=ft*ft*ft*He+3*ft*ft*dt*Qe+3*ft*dt*dt*ct+dt*dt*dt*_t,ut[1][St]=ft*ft*ft*Ue+3*ft*ft*dt*st+3*ft*dt*dt*at+dt*dt*dt*At;return ut[0][Et]=He,ut[1][Et]=Ue,ut[0][Et+1]=_t,ut[1][Et+1]=At,ut[0].length=ut[1].length=Et+2,[Math.min(...ut[0]),Math.min(...ut[1]),Math.max(...ut[0]),Math.max(...ut[1])]}}e.Util=nt;const et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function it(qe){if(qe[0]>="ï"){let Ue;if(qe[0]==="þ"&&qe[1]==="ÿ"?Ue="utf-16be":qe[0]==="ÿ"&&qe[1]==="þ"?Ue="utf-16le":qe[0]==="ï"&&qe[1]==="»"&&qe[2]==="¿"&&(Ue="utf-8"),Ue)try{const Qe=new TextDecoder(Ue,{fatal:!0}),st=ze(qe);return Qe.decode(st)}catch(Qe){Pe(`stringToPDFString: "${Qe}".`)}}const He=[];for(let Ue=0,Qe=qe.length;Ue<Qe;Ue++){const st=et[qe.charCodeAt(Ue)];He.push(st?String.fromCharCode(st):qe.charAt(Ue))}return He.join("")}function lt(qe){return decodeURIComponent(escape(qe))}function rt(qe){return unescape(encodeURIComponent(qe))}function gt(qe){return typeof qe=="object"&&qe?.byteLength!==void 0}function ot(qe,He){if(qe.length!==He.length)return!1;for(let Ue=0,Qe=qe.length;Ue<Qe;Ue++)if(qe[Ue]!==He[Ue])return!1;return!0}function mt(qe=new Date){return[qe.getUTCFullYear().toString(),(qe.getUTCMonth()+1).toString().padStart(2,"0"),qe.getUTCDate().toString().padStart(2,"0"),qe.getUTCHours().toString().padStart(2,"0"),qe.getUTCMinutes().toString().padStart(2,"0"),qe.getUTCSeconds().toString().padStart(2,"0")].join("")}class ht{#e=!1;constructor(){this.promise=new Promise((He,Ue)=>{this.resolve=Qe=>{this.#e=!0,He(Qe)},this.reject=Qe=>{this.#e=!0,Ue(Qe)}})}get settled(){return this.#e}}e.PromiseCapability=ht;let pt=null,wt=null;function yt(qe){return pt||(pt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,wt=new Map([["ﬅ","ſt"]])),qe.replaceAll(pt,(He,Ue,Qe)=>Ue?Ue.normalize("NFKC"):wt.get(Qe))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:J,NodeCMapReaderFactory:e,NodeFilterFactory:C,NodeStandardFontDataFactory:F}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=J,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultFilterFactory=DefaultFilterFactory=C,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=F}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:J}=__w_pdfjs_require__(21);createPDFNetworkStream=e=>new J(e)}else{const{PDFNetworkStream:J}=__w_pdfjs_require__(24),{PDFFetchStream:e}=__w_pdfjs_require__(25);createPDFNetworkStream=C=>(0,_display_utils.isValidFetchUrl)(C.url)?new e(C):new J(C)}function getDocument(J){if(typeof J=="string"||J instanceof URL?J={url:J}:(0,_util.isArrayBuffer)(J)&&(J={data:J}),typeof J!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!J.url&&!J.data&&!J.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,{docId:C}=e,F=J.url?getUrlProp(J.url):null,$=J.data?getDataProp(J.data):null,Y=J.httpHeaders||null,V=J.withCredentials===!0,te=J.password??null,se=J.range instanceof PDFDataRangeTransport?J.range:null,ne=Number.isInteger(J.rangeChunkSize)&&J.rangeChunkSize>0?J.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ee=J.worker instanceof _PDFWorker?J.worker:null;const ie=J.verbosity,ae=typeof J.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(J.docBaseUrl)?J.docBaseUrl:null,re=typeof J.cMapUrl=="string"?J.cMapUrl:null,oe=J.cMapPacked!==!1,ce=J.CMapReaderFactory||DefaultCMapReaderFactory,he=typeof J.standardFontDataUrl=="string"?J.standardFontDataUrl:null,de=J.StandardFontDataFactory||DefaultStandardFontDataFactory,pe=J.stopAtErrors!==!0,fe=Number.isInteger(J.maxImageSize)&&J.maxImageSize>-1?J.maxImageSize:-1,ye=J.isEvalSupported!==!1,_e=typeof J.isOffscreenCanvasSupported=="boolean"?J.isOffscreenCanvasSupported:!_is_node.isNodeJS,Ee=Number.isInteger(J.canvasMaxAreaInBytes)?J.canvasMaxAreaInBytes:-1,be=typeof J.disableFontFace=="boolean"?J.disableFontFace:_is_node.isNodeJS,Ae=J.fontExtraProperties===!0,we=J.enableXfa===!0,Te=J.ownerDocument||globalThis.document,Me=J.disableRange===!0,Be=J.disableStream===!0,$e=J.disableAutoFetch===!0,Fe=J.pdfBug===!0,Xe=se?se.length:J.length??NaN,We=typeof J.useSystemFonts=="boolean"?J.useSystemFonts:!_is_node.isNodeJS&&!be,Ie=typeof J.useWorkerFetch=="boolean"?J.useWorkerFetch:ce===_display_utils.DOMCMapReaderFactory&&de===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(re,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(he,document.baseURI),Oe=J.canvasFactory||new DefaultCanvasFactory({ownerDocument:Te}),Pe=J.filterFactory||new DefaultFilterFactory({docId:C,ownerDocument:Te}),ge=null;(0,_util.setVerbosityLevel)(ie);const ue={canvasFactory:Oe,filterFactory:Pe};if(Ie||(ue.cMapReaderFactory=new ce({baseUrl:re,isCompressed:oe}),ue.standardFontDataFactory=new de({baseUrl:he})),!ee){const le={verbosity:ie,port:_worker_options.GlobalWorkerOptions.workerPort};ee=le.port?_PDFWorker.fromPort(le):new _PDFWorker(le),e._worker=ee}const xe={docId:C,apiVersion:"3.6.172",data:$,password:te,disableAutoFetch:$e,rangeChunkSize:ne,length:Xe,docBaseUrl:ae,enableXfa:we,evaluatorOptions:{maxImageSize:fe,disableFontFace:be,ignoreErrors:pe,isEvalSupported:ye,isOffscreenCanvasSupported:_e,canvasMaxAreaInBytes:Ee,fontExtraProperties:Ae,useSystemFonts:We,cMapUrl:Ie?re:null,standardFontDataUrl:Ie?he:null}},ve={ignoreErrors:pe,isEvalSupported:ye,disableFontFace:be,fontExtraProperties:Ae,enableXfa:we,ownerDocument:Te,disableAutoFetch:$e,pdfBug:Fe,styleElement:ge};return ee.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const le=_fetchDocument(ee,xe),me=new Promise(function(Ce){let Se;se?Se=new _transport_stream.PDFDataTransportStream({length:Xe,initialData:se.initialData,progressiveDone:se.progressiveDone,contentDispositionFilename:se.contentDispositionFilename,disableRange:Me,disableStream:Be},se):$||(Se=createPDFNetworkStream({url:F,length:Xe,httpHeaders:Y,withCredentials:V,rangeChunkSize:ne,disableRange:Me,disableStream:Be})),Ce(Se)});return Promise.all([le,me]).then(function([Ce,Se]){if(e.destroyed)throw new Error("Loading aborted");const Re=new _message_handler.MessageHandler(C,Ce,ee.port),ke=new WorkerTransport(Re,e,Se,ve,ue);e._transport=ke,Re.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(J,e){if(J.destroyed)throw new Error("Worker was destroyed");const C=await J.messageHandler.sendWithPromise("GetDocRequest",e,e.data?[e.data.buffer]:null);if(J.destroyed)throw new Error("Worker was destroyed");return C}function getUrlProp(J){if(J instanceof URL)return J.href;try{return new URL(J,window.location).href}catch{if(_is_node.isNodeJS&&typeof J=="string")return J}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(J){if(_is_node.isNodeJS&&typeof Buffer<"u"&&J instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(J);if(J instanceof Uint8Array&&J.byteLength===J.buffer.byteLength)return J;if(typeof J=="string")return(0,_util.stringToBytes)(J);if(typeof J=="object"&&!isNaN(J?.length)||(0,_util.isArrayBuffer)(J))return new Uint8Array(J);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,C,F=!1,$=null){this.length=e,this.initialData=C,this.progressiveDone=F,this.contentDispositionFilename=$,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,C){for(const F of this._rangeListeners)F(e,C)}onDataProgress(e,C){this._readyCapability.promise.then(()=>{for(const F of this._progressListeners)F(e,C)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const C of this._progressiveReadListeners)C(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,C){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,C){this._pdfInfo=e,this._transport=C}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(e,C,F,$=!1){this._pageIndex=e,this._pageInfo=C,this._transport=F,this._stats=$?new _display_utils.StatTimer:null,this._pdfBug=$,this.commonObjs=F.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:C=this.rotate,offsetX:F=0,offsetY:$=0,dontFlip:Y=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:C,offsetX:F,offsetY:$,dontFlip:Y})}getAnnotations({intent:e="display"}={}){const C=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,C.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:C,intent:F="display",annotationMode:$=_util.AnnotationMode.ENABLE,transform:Y=null,background:V=null,optionalContentConfigPromise:te=null,annotationCanvasMap:se=null,pageColors:ne=null,printAnnotationStorage:ee=null}){if(arguments[0]?.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");this._stats?.time("Overall");const ie=this._transport.getRenderingIntent(F,$,ee);this.#t=!1,this.#n(),te||(te=this._transport.getOptionalContentConfig());let ae=this._intentStates.get(ie.cacheKey);ae||(ae=Object.create(null),this._intentStates.set(ie.cacheKey,ae)),ae.streamReaderCancelTimeout&&(clearTimeout(ae.streamReaderCancelTimeout),ae.streamReaderCancelTimeout=null);const re=!!(ie.renderingIntent&_util.RenderingIntentFlag.PRINT);ae.displayReadyCapability||(ae.displayReadyCapability=new _util.PromiseCapability,ae.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(ie));const oe=de=>{ae.renderTasks.delete(ce),(this._maybeCleanupAfterRender||re)&&(this.#t=!0),this.#s(!re),de?(ce.capability.reject(de),this._abortOperatorList({intentState:ae,reason:de instanceof Error?de:new Error(de)})):ce.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},ce=new InternalRenderTask({callback:oe,params:{canvasContext:e,viewport:C,transform:Y,background:V},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:se,operatorList:ae.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!re,pdfBug:this._pdfBug,pageColors:ne});(ae.renderTasks||=new Set).add(ce);const he=ce.task;return Promise.all([ae.displayReadyCapability.promise,te]).then(([de,pe])=>{if(this.#t){oe();return}this._stats?.time("Rendering"),ce.initializeGraphics({transparency:de,optionalContentConfig:pe}),ce.operatorListChanged()}).catch(oe),he}getOperatorList({intent:e="display",annotationMode:C=_util.AnnotationMode.ENABLE,printAnnotationStorage:F=null}={}){function $(){V.operatorList.lastChunk&&(V.opListReadCapability.resolve(V.operatorList),V.renderTasks.delete(te))}const Y=this._transport.getRenderingIntent(e,C,F,!0);let V=this._intentStates.get(Y.cacheKey);V||(V=Object.create(null),this._intentStates.set(Y.cacheKey,V));let te;return V.opListReadCapability||(te=Object.create(null),te.operatorListChanged=$,V.opListReadCapability=new _util.PromiseCapability,(V.renderTasks||=new Set).add(te),V.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(Y)),V.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:C=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:C===!0},{highWaterMark:100,size($){return $.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(F=>_xfa_text.XfaText.textContent(F));const C=this.streamTextContent(e);return new Promise(function(F,$){function Y(){V.read().then(function({value:se,done:ne}){if(ne){F(te);return}Object.assign(te.styles,se.styles),te.items.push(...se.items),Y()},$)}const V=C.getReader(),te={items:[],styles:Object.create(null)};Y()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const C of this._intentStates.values())if(this._abortOperatorList({intentState:C,reason:new Error("Page was destroyed."),force:!0}),!C.opListReadCapability)for(const F of C.renderTasks)e.push(F.completed),F.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const C=this.#s(!1);return e&&C&&(this._stats&&=new _display_utils.StatTimer),C}#s(e=!1){if(this.#n(),!this.#t)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#s(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:C,operatorList:F}of this._intentStates.values())if(C.size>0||!F.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,C){const F=this._intentStates.get(C);F&&(this._stats?.timeEnd("Page Request"),F.displayReadyCapability?.resolve(e))}_renderPageChunk(e,C){for(let F=0,$=e.length;F<$;F++)C.operatorList.fnArray.push(e.fnArray[F]),C.operatorList.argsArray.push(e.argsArray[F]);C.operatorList.lastChunk=e.lastChunk,C.operatorList.separateAnnots=e.separateAnnots;for(const F of C.renderTasks)F.operatorListChanged();e.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:C,annotationStorageMap:F}){const Y=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:C,annotationStorage:F}).getReader(),V=this._intentStates.get(C);V.streamReader=Y;const te=()=>{Y.read().then(({value:se,done:ne})=>{if(ne){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(se,V),te())},se=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const ne of V.renderTasks)ne.operatorListChanged();this.#s(!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject(se);else if(V.opListReadCapability)V.opListReadCapability.reject(se);else throw se}})};te()}_abortOperatorList({intentState:e,reason:C,force:F=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!F){if(e.renderTasks.size>0)return;if(C instanceof _display_utils.RenderingCancelledException){let $=RENDERING_CANCELLED_TIMEOUT;C.extraDelay>0&&C.extraDelay<1e3&&($+=C.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:C,force:!0})},$);return}}if(e.streamReader.cancel(new _util.AbortException(C.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[$,Y]of this._intentStates)if(Y===e){this._intentStates.delete($);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(e,C){const F={data:structuredClone(e,C?{transfer:C}:null)};this.#t.then(()=>{for(const $ of this.#e)$.call(this,F)})}addEventListener(e,C){this.#e.add(C)}removeEventListener(e,C){this.#e.delete(C)}terminate(){this.#e.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const J=document?.currentScript?.src;J&&(PDFWorkerUtil.fallbackWorkerSrc=J.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(J,e){let C;try{if(C=new URL(J),!C.origin||C.origin==="null")return!1}catch{return!1}const F=new URL(e,C);return C.origin===F.origin},PDFWorkerUtil.createCDNWrapper=function(J){const e=`importScripts("${J}");`;return URL.createObjectURL(new Blob([e]))}}class _PDFWorker{static#workerPorts=new WeakMap;constructor({name:J=null,port:e=null,verbosity:C=(0,_util.getVerbosityLevel)()}={}){if(e&&_PDFWorker.#workerPorts.has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=J,this.destroyed=!1,this.verbosity=C,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,e){_PDFWorker.#workerPorts.set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(J){this._port=J,this._messageHandler=new _message_handler.MessageHandler("main","worker",J),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:J}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,J)||(J=PDFWorkerUtil.createCDNWrapper(new URL(J,window.location).href));const e=new Worker(J),C=new _message_handler.MessageHandler("main","worker",e),F=()=>{e.removeEventListener("error",$),C.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},$=()=>{this._webWorker||F()};e.addEventListener("error",$),C.on("test",V=>{if(e.removeEventListener("error",$),this.destroyed){F();return}V?(this._messageHandler=C,this._port=e,this._webWorker=e,this._readyCapability.resolve(),C.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),C.destroy(),e.terminate())}),C.on("ready",V=>{if(e.removeEventListener("error",$),this.destroyed){F();return}try{Y()}catch{this._setupFakeWorker()}});const Y=()=>{const V=new Uint8Array;C.send("test",V,[V.buffer])};Y();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(J=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const C=`fake${PDFWorkerUtil.fakeWorkerId++}`,F=new _message_handler.MessageHandler(C+"_worker",C,e);J.setup(F,e);const $=new _message_handler.MessageHandler(C,C+"_worker",e);this._messageHandler=$,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})}).catch(J=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${J.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(J){if(!J?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(J.port)?this.#workerPorts.get(J.port):new _PDFWorker(J)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=_PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#s=new Map;constructor(e,C,F,$,Y){this.messageHandler=e,this.loadingTask=C,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:$.ownerDocument,styleElement:$.styleElement}),this._params=$,this.canvasFactory=Y.canvasFactory,this.filterFactory=Y.filterFactory,this.cMapReaderFactory=Y.cMapReaderFactory,this.standardFontDataFactory=Y.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=F,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#n(e,C=null){const F=this.#e.get(e);if(F)return F;const $=this.messageHandler.sendWithPromise(e,C);return this.#e.set(e,$),$}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,C=_util.AnnotationMode.ENABLE,F=null,$=!1){let Y=_util.RenderingIntentFlag.DISPLAY,V=null;switch(e){case"any":Y=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Y=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(C){case _util.AnnotationMode.DISABLE:Y+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Y+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Y+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,V=(Y&_util.RenderingIntentFlag.PRINT&&F instanceof _annotation_storage.PrintAnnotationStorage?F:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${C}`)}return $&&(Y+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Y,cacheKey:`${Y}_${_annotation_storage.AnnotationStorage.getHash(V)}`,annotationStorageMap:V}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const F of this.#t.values())e.push(F._destroy());this.#t.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const C=this.messageHandler.sendWithPromise("Terminate",null);return e.push(C),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:C}=this;e.on("GetReader",(F,$)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Y=>{this._lastProgress={loaded:Y.loaded,total:Y.total}},$.onPull=()=>{this._fullReader.read().then(function({value:Y,done:V}){if(V){$.close();return}(0,_util.assert)(Y instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(Y),1,[Y])}).catch(Y=>{$.error(Y)})},$.onCancel=Y=>{this._fullReader.cancel(Y),$.ready.catch(V=>{if(!this.destroyed)throw V})}}),e.on("ReaderHeadersReady",F=>{const $=new _util.PromiseCapability,Y=this._fullReader;return Y.headersReady.then(()=>{(!Y.isStreamingSupported||!Y.isRangeSupported)&&(this._lastProgress&&C.onProgress?.(this._lastProgress),Y.onProgress=V=>{C.onProgress?.({loaded:V.loaded,total:V.total})}),$.resolve({isStreamingSupported:Y.isStreamingSupported,isRangeSupported:Y.isRangeSupported,contentLength:Y.contentLength})},$.reject),$.promise}),e.on("GetRangeReader",(F,$)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Y=this._networkStream.getRangeReader(F.begin,F.end);if(!Y){$.close();return}$.onPull=()=>{Y.read().then(function({value:V,done:te}){if(te){$.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(V),1,[V])}).catch(V=>{$.error(V)})},$.onCancel=V=>{Y.cancel(V),$.ready.catch(te=>{if(!this.destroyed)throw te})}}),e.on("GetDoc",({pdfInfo:F})=>{this._numPages=F.numPages,this._htmlForXfa=F.htmlForXfa,delete F.htmlForXfa,C._capability.resolve(new PDFDocumentProxy(F,this))}),e.on("DocException",function(F){let $;switch(F.name){case"PasswordException":$=new _util.PasswordException(F.message,F.code);break;case"InvalidPDFException":$=new _util.InvalidPDFException(F.message);break;case"MissingPDFException":$=new _util.MissingPDFException(F.message);break;case"UnexpectedResponseException":$=new _util.UnexpectedResponseException(F.message,F.status);break;case"UnknownErrorException":$=new _util.UnknownErrorException(F.message,F.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}C._capability.reject($)}),e.on("PasswordRequest",F=>{if(this._passwordCapability=new _util.PromiseCapability,C.onPassword){const $=Y=>{Y instanceof Error?this._passwordCapability.reject(Y):this._passwordCapability.resolve({password:Y})};try{C.onPassword($,F.code)}catch(Y){this._passwordCapability.reject(Y)}}else this._passwordCapability.reject(new _util.PasswordException(F.message,F.code));return this._passwordCapability.promise}),e.on("DataLoaded",F=>{C.onProgress?.({loaded:F.length,total:F.length}),this.downloadInfoCapability.resolve(F)}),e.on("StartRenderPage",F=>{if(this.destroyed)return;this.#t.get(F.pageIndex)._startRenderPage(F.transparency,F.cacheKey)}),e.on("commonobj",([F,$,Y])=>{if(!this.destroyed&&!this.commonObjs.has(F))switch($){case"Font":const V=this._params;if("error"in Y){const ne=Y.error;(0,_util.warn)(`Error during font loading: ${ne}`),this.commonObjs.resolve(F,ne);break}const te=V.pdfBug&&globalThis.FontInspector?.enabled?(ne,ee)=>globalThis.FontInspector.fontAdded(ne,ee):null,se=new _font_loader.FontFaceObject(Y,{isEvalSupported:V.isEvalSupported,disableFontFace:V.disableFontFace,ignoreErrors:V.ignoreErrors,inspectFont:te});this.fontLoader.bind(se).catch(ne=>e.sendWithPromise("FontFallback",{id:F})).finally(()=>{!V.fontExtraProperties&&se.data&&(se.data=null),this.commonObjs.resolve(F,se)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(F,Y);break;default:throw new Error(`Got unknown common object type ${$}`)}}),e.on("obj",([F,$,Y,V])=>{if(this.destroyed)return;const te=this.#t.get($);if(!te.objs.has(F))switch(Y){case"Image":if(te.objs.resolve(F,V),V){let se;if(V.bitmap){const{width:ne,height:ee}=V;se=ne*ee*4}else se=V.data?.length||0;se>_util.MAX_IMAGE_SIZE_TO_CACHE&&(te._maybeCleanupAfterRender=!0)}break;case"Pattern":te.objs.resolve(F,V);break;default:throw new Error(`Got unknown object type ${Y}`)}}),e.on("DocProgress",F=>{this.destroyed||C.onProgress?.({loaded:F.loaded,total:F.total})}),e.on("FetchBuiltInCMap",F=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(F):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",F=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(F):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const C=e-1,F=this.#s.get(C);if(F)return F;const $=this.messageHandler.sendWithPromise("GetPage",{pageIndex:C}).then(Y=>{if(this.destroyed)throw new Error("Transport destroyed");const V=new PDFPageProxy(C,Y,this,this._params.pdfBug);return this.#t.set(C,V),V});return this.#s.set(C,$),$}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,C){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:C})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",C=this.#e.get(e);if(C)return C;const F=this.messageHandler.sendWithPromise(e,null).then($=>({info:$[0],metadata:$[1]?new _metadata.Metadata($[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,F),F}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const C of this.#t.values())if(!C.cleanup())throw new Error(`startCleanup: Page ${C.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:e,enableXfa:C}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:C})}}class PDFObjects{#e=Object.create(null);#t(e){const C=this.#e[e];return C||(this.#e[e]={capability:new _util.PromiseCapability,data:null})}get(e,C=null){if(C){const $=this.#t(e);return $.capability.promise.then(()=>C($.data)),null}const F=this.#e[e];if(!F?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return F.data}has(e){return this.#e[e]?.capability.settled||!1}resolve(e,C=null){const F=this.#t(e);F.data=C,F.capability.resolve()}clear(){for(const e in this.#e){const{data:C}=this.#e[e];C?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:C}=this.#e;return e.form||e.canvas&&C?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:e,params:C,objs:F,commonObjs:$,annotationCanvasMap:Y,operatorList:V,pageIndex:te,canvasFactory:se,filterFactory:ne,useRequestAnimationFrame:ee=!1,pdfBug:ie=!1,pageColors:ae=null}){this.callback=e,this.params=C,this.objs=F,this.commonObjs=$,this.annotationCanvasMap=Y,this.operatorListIdx=null,this.operatorList=V,this._pageIndex=te,this.canvasFactory=se,this.filterFactory=ne,this._pdfBug=ie,this.pageColors=ae,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ee===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=C.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:C}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:F,viewport:$,transform:Y,background:V}=this.params;this.gfx=new _canvas.CanvasGraphics(F,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:C},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Y,viewport:$,transparency:e,background:V}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,C=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#e.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",C))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#e.delete(this._canvas),this.callback())))}}const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var F=C(1),$=C(4),Y=C(8);class V{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(ne,ee){const ie=this.#t.get(ne);return ie===void 0?ee:Object.assign(ee,ie)}getRawValue(ne){return this.#t.get(ne)}remove(ne){if(this.#t.delete(ne),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const ee of this.#t.values())if(ee instanceof $.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(ne,ee){const ie=this.#t.get(ne);let ae=!1;if(ie!==void 0)for(const[re,oe]of Object.entries(ee))ie[re]!==oe&&(ae=!0,ie[re]=oe);else ae=!0,this.#t.set(ne,ee);ae&&this.#s(),ee instanceof $.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(ee.constructor._type)}has(ne){return this.#t.has(ne)}getAll(){return this.#t.size>0?(0,F.objectFromMap)(this.#t):null}setAll(ne){for(const[ee,ie]of Object.entries(ne))this.setValue(ee,ie)}get size(){return this.#t.size}#s(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new te(this)}get serializable(){if(this.#t.size===0)return null;const ne=new Map;for(const[ee,ie]of this.#t){const ae=ie instanceof $.AnnotationEditor?ie.serialize():ie;ae&&ne.set(ee,ae)}return ne}static getHash(ne){if(!ne)return"";const ee=new Y.MurmurHash3_64;for(const[ie,ae]of ne)ee.update(`${ie}:${JSON.stringify(ae)}`);return ee.hexdigest()}}e.AnnotationStorage=V;class te extends V{#e=null;constructor(ne){super(),this.#e=structuredClone(ne.serializable)}get print(){(0,F.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}e.PrintAnnotationStorage=te},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var F=C(5),$=C(1);class Y{#e=this.focusin.bind(this);#t=this.focusout.bind(this);#s=!1;#n=!1;#r=!1;_uiManager=null;#d=Y._zIndex++;static _colorManager=new F.ColorManager;static _zIndex=1;constructor(te){this.constructor===Y&&(0,$.unreachable)("Cannot initialize AnnotationEditor."),this.parent=te.parent,this.id=te.id,this.width=this.height=null,this.pageIndex=te.parent.pageIndex,this.name=te.name,this.div=null,this._uiManager=te.uiManager;const{rotation:se,rawDims:{pageWidth:ne,pageHeight:ee,pageX:ie,pageY:ae}}=this.parent.viewport;this.rotation=se,this.pageRotation=(360+se-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[ne,ee],this.pageTranslation=[ie,ae];const[re,oe]=this.parentDimensions;this.x=te.x/re,this.y=te.y/oe,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,$.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(te){this._uiManager.addCommands(te)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#d}setParent(te){te!==null&&(this.pageIndex=te.pageIndex,this.pageDimensions=te.pageDimensions),this.parent=te}focusin(te){this.#s?this.#s=!1:this.parent.setSelected(this)}focusout(te){!this.isAttachedToDOM||te.relatedTarget?.closest(`#${this.id}`)||(te.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(te){const se=this.parent.div.getBoundingClientRect();this.startX=te.clientX-se.x,this.startY=te.clientY-se.y,te.dataTransfer.setData("text/plain",this.id),te.dataTransfer.effectAllowed="move"}setAt(te,se,ne,ee){const[ie,ae]=this.parentDimensions;[ne,ee]=this.screenToPageTranslation(ne,ee),this.x=(te+ne)/ie,this.y=(se+ee)/ae,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(te,se){const[ne,ee]=this.parentDimensions;[te,se]=this.screenToPageTranslation(te,se),this.x+=te/ne,this.y+=se/ee,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(te,se){switch(this.parentRotation){case 90:return[se,-te];case 180:return[-te,-se];case 270:return[-se,te];default:return[te,se]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:te}=this._uiManager.viewParameters,[se,ne]=this.pageDimensions;return[se*te,ne*te]}setDims(te,se){const[ne,ee]=this.parentDimensions;this.div.style.width=`${100*te/ne}%`,this.div.style.height=`${100*se/ee}%`}fixDims(){const{style:te}=this.div,{height:se,width:ne}=te,ee=ne.endsWith("%"),ie=se.endsWith("%");if(ee&&ie)return;const[ae,re]=this.parentDimensions;ee||(te.width=`${100*parseFloat(ne)/ae}%`),ie||(te.height=`${100*parseFloat(se)/re}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#e),this.div.addEventListener("focusout",this.#t);const[te,se]=this.getInitialTranslation();return this.translate(te,se),(0,F.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(te){const{isMac:se}=$.FeatureTest.platform;if(te.button!==0||te.ctrlKey&&se){te.preventDefault();return}te.ctrlKey&&!se||te.shiftKey||te.metaKey&&se?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#s=!0}getRect(te,se){const ne=this.parentScale,[ee,ie]=this.pageDimensions,[ae,re]=this.pageTranslation,oe=te/ne,ce=se/ne,he=this.x*ee,de=this.y*ie,pe=this.width*ee,fe=this.height*ie;switch(this.rotation){case 0:return[he+oe+ae,ie-de-ce-fe+re,he+oe+pe+ae,ie-de-ce+re];case 90:return[he+ce+ae,ie-de+oe+re,he+ce+fe+ae,ie-de+oe+pe+re];case 180:return[he-oe-pe+ae,ie-de+ce+re,he-oe+ae,ie-de+ce+fe+re];case 270:return[he-ce-fe+ae,ie-de-oe-pe+re,he-ce+ae,ie-de-oe+re];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(te,se){const[ne,ee,ie,ae]=te,re=ie-ne,oe=ae-ee;switch(this.rotation){case 0:return[ne,se-ae,re,oe];case 90:return[ne,se-ee,oe,re];case 180:return[ie,se-ee,re,oe];case 270:return[ie,se-ae,oe,re];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#e)}serialize(){(0,$.unreachable)("An editor must be serializable")}static deserialize(te,se,ne){const ee=new this.prototype.constructor({parent:se,id:se.getNextId(),uiManager:ne});ee.rotation=te.rotation;const[ie,ae]=ee.pageDimensions,[re,oe,ce,he]=ee.getRectInCurrentCoords(te.rect,ae);return ee.x=re/ie,ee.y=oe/ae,ee.width=ce/ie,ee.height=he/ae,ee}remove(){this.div.removeEventListener("focusin",this.#e),this.div.removeEventListener("focusout",this.#t),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(te,se){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#n}set isEditing(te){this.#n=te,te?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}e.AnnotationEditor=Y},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=Y,e.opacityToHex=V;var F=C(1),$=C(6);function Y(ae,re,oe){for(const ce of oe)re.addEventListener(ce,ae[ce].bind(ae))}function V(ae){return Math.round(Math.min(255,Math.max(1,255*ae))).toString(16).padStart(2,"0")}class te{#e=0;getId(){return`${F.AnnotationEditorPrefix}${this.#e++}`}}class se{#e=[];#t=!1;#s;#n=-1;constructor(re=128){this.#s=re}add({cmd:re,undo:oe,mustExec:ce,type:he=NaN,overwriteIfSameType:de=!1,keepUndo:pe=!1}){if(ce&&re(),this.#t)return;const fe={cmd:re,undo:oe,type:he};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(fe);return}if(de&&this.#e[this.#n].type===he){pe&&(fe.undo=this.#e[this.#n].undo),this.#e[this.#n]=fe;return}const ye=this.#n+1;ye===this.#s?this.#e.splice(0,1):(this.#n=ye,ye<this.#e.length&&this.#e.splice(ye)),this.#e.push(fe)}undo(){this.#n!==-1&&(this.#t=!0,this.#e[this.#n].undo(),this.#t=!1,this.#n-=1)}redo(){this.#n<this.#e.length-1&&(this.#n+=1,this.#t=!0,this.#e[this.#n].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}destroy(){this.#e=null}}e.CommandManager=se;class ne{constructor(re){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:oe}=F.FeatureTest.platform;for(const[ce,he]of re)for(const de of ce){const pe=de.startsWith("mac+");oe&&pe?(this.callbacks.set(de.slice(4),he),this.allKeys.add(de.split("+").at(-1))):!oe&&!pe&&(this.callbacks.set(de,he),this.allKeys.add(de.split("+").at(-1)))}}#e(re){re.altKey&&this.buffer.push("alt"),re.ctrlKey&&this.buffer.push("ctrl"),re.metaKey&&this.buffer.push("meta"),re.shiftKey&&this.buffer.push("shift"),this.buffer.push(re.key);const oe=this.buffer.join("+");return this.buffer.length=0,oe}exec(re,oe){if(!this.allKeys.has(oe.key))return;const ce=this.callbacks.get(this.#e(oe));ce&&(ce.bind(re)(),oe.stopPropagation(),oe.preventDefault())}}e.KeyboardManager=ne;class ee{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const re=new Map([["CanvasText",null],["Canvas",null]]);return(0,$.getColorValues)(re),(0,F.shadow)(this,"_colors",re)}convert(re){const oe=(0,$.getRGB)(re);if(!window.matchMedia("(forced-colors: active)").matches)return oe;for(const[ce,he]of this._colors)if(he.every((de,pe)=>de===oe[pe]))return ee._colorsMapping.get(ce);return oe}getHexCode(re){const oe=this._colors.get(re);return oe?F.Util.makeHexColor(...oe):re}}e.ColorManager=ee;class ie{#e=null;#t=new Map;#s=new Map;#n=null;#r=new se;#d=0;#l=null;#i=new Set;#a=null;#h=new te;#c=!1;#u=F.AnnotationEditorType.NONE;#o=new Set;#m=this.copy.bind(this);#S=this.cut.bind(this);#E=this.paste.bind(this);#v=this.keydown.bind(this);#T=this.onEditingAction.bind(this);#C=this.onPageChanging.bind(this);#R=this.onScaleChanging.bind(this);#P=this.onRotationChanging.bind(this);#k={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#p=null;static _keyboardManager=new ne([[["ctrl+a","mac+meta+a"],ie.prototype.selectAll],[["ctrl+z","mac+meta+z"],ie.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ie.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ie.prototype.delete],[["Escape","mac+Escape"],ie.prototype.unselectAll]]);constructor(re,oe,ce){this.#p=re,this.#a=oe,this.#a._on("editingaction",this.#T),this.#a._on("pagechanging",this.#C),this.#a._on("scalechanging",this.#R),this.#a._on("rotationchanging",this.#P),this.#n=ce,this.viewParameters={realScale:$.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#y(),this.#a._off("editingaction",this.#T),this.#a._off("pagechanging",this.#C),this.#a._off("scalechanging",this.#R),this.#a._off("rotationchanging",this.#P);for(const re of this.#s.values())re.destroy();this.#s.clear(),this.#t.clear(),this.#i.clear(),this.#e=null,this.#o.clear(),this.#r.destroy()}onPageChanging({pageNumber:re}){this.#d=re-1}focusMainContainer(){this.#p.focus()}addShouldRescale(re){this.#i.add(re)}removeShouldRescale(re){this.#i.delete(re)}onScaleChanging({scale:re}){this.commitOrRemove(),this.viewParameters.realScale=re*$.PixelsPerInch.PDF_TO_CSS_UNITS;for(const oe of this.#i)oe.onScaleChanging()}onRotationChanging({pagesRotation:re}){this.commitOrRemove(),this.viewParameters.rotation=re}addToAnnotationStorage(re){!re.isEmpty()&&this.#n&&!this.#n.has(re.id)&&this.#n.setValue(re.id,re)}#D(){this.#p.addEventListener("keydown",this.#v)}#y(){this.#p.removeEventListener("keydown",this.#v)}#w(){document.addEventListener("copy",this.#m),document.addEventListener("cut",this.#S),document.addEventListener("paste",this.#E)}#A(){document.removeEventListener("copy",this.#m),document.removeEventListener("cut",this.#S),document.removeEventListener("paste",this.#E)}copy(re){if(re.preventDefault(),this.#e&&this.#e.commitOrRemove(),!this.hasSelection)return;const oe=[];for(const ce of this.#o)ce.isEmpty()||oe.push(ce.serialize());oe.length!==0&&re.clipboardData.setData("application/pdfjs",JSON.stringify(oe))}cut(re){this.copy(re),this.delete()}paste(re){re.preventDefault();let oe=re.clipboardData.getData("application/pdfjs");if(!oe)return;try{oe=JSON.parse(oe)}catch(he){(0,F.warn)(`paste: "${he.message}".`);return}if(!Array.isArray(oe))return;this.unselectAll();const ce=this.#s.get(this.#d);try{const he=[];for(const fe of oe){const ye=ce.deserialize(fe);if(!ye)return;he.push(ye)}const de=()=>{for(const fe of he)this.#M(fe);this.#x(he)},pe=()=>{for(const fe of he)fe.remove()};this.addCommands({cmd:de,undo:pe,mustExec:!0})}catch(he){(0,F.warn)(`paste: "${he.message}".`)}}keydown(re){this.getActive()?.shouldGetKeyboardEvents()||ie._keyboardManager.exec(this,re)}onEditingAction(re){["undo","redo","delete","selectAll"].includes(re.name)&&this[re.name]()}#f(re){Object.entries(re).some(([ce,he])=>this.#k[ce]!==he)&&this.#a.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#k,re)})}#g(re){this.#a.dispatch("annotationeditorparamschanged",{source:this,details:re})}setEditingState(re){re?(this.#D(),this.#w(),this.#f({isEditing:this.#u!==F.AnnotationEditorType.NONE,isEmpty:this.#_(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#y(),this.#A(),this.#f({isEditing:!1}))}registerEditorTypes(re){if(!this.#l){this.#l=re;for(const oe of this.#l)this.#g(oe.defaultPropertiesToUpdate)}}getId(){return this.#h.getId()}get currentLayer(){return this.#s.get(this.#d)}get currentPageIndex(){return this.#d}addLayer(re){this.#s.set(re.pageIndex,re),this.#c?re.enable():re.disable()}removeLayer(re){this.#s.delete(re.pageIndex)}updateMode(re){if(this.#u=re,re===F.AnnotationEditorType.NONE)this.setEditingState(!1),this.#B();else{this.setEditingState(!0),this.#I();for(const oe of this.#s.values())oe.updateMode(re)}}updateToolbar(re){re!==this.#u&&this.#a.dispatch("switchannotationeditormode",{source:this,mode:re})}updateParams(re,oe){if(this.#l){for(const ce of this.#o)ce.updateParams(re,oe);for(const ce of this.#l)ce.updateDefaultParams(re,oe)}}#I(){if(!this.#c){this.#c=!0;for(const re of this.#s.values())re.enable()}}#B(){if(this.unselectAll(),this.#c){this.#c=!1;for(const re of this.#s.values())re.disable()}}getEditors(re){const oe=[];for(const ce of this.#t.values())ce.pageIndex===re&&oe.push(ce);return oe}getEditor(re){return this.#t.get(re)}addEditor(re){this.#t.set(re.id,re)}removeEditor(re){this.#t.delete(re.id),this.unselect(re),this.#n?.remove(re.id)}#M(re){const oe=this.#s.get(re.pageIndex);oe?oe.addOrRebuild(re):this.addEditor(re)}setActiveEditor(re){this.#e!==re&&(this.#e=re,re&&this.#g(re.propertiesToUpdate))}toggleSelected(re){if(this.#o.has(re)){this.#o.delete(re),re.unselect(),this.#f({hasSelectedEditor:this.hasSelection});return}this.#o.add(re),re.select(),this.#g(re.propertiesToUpdate),this.#f({hasSelectedEditor:!0})}setSelected(re){for(const oe of this.#o)oe!==re&&oe.unselect();this.#o.clear(),this.#o.add(re),re.select(),this.#g(re.propertiesToUpdate),this.#f({hasSelectedEditor:!0})}isSelected(re){return this.#o.has(re)}unselect(re){re.unselect(),this.#o.delete(re),this.#f({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#o.size!==0}undo(){this.#r.undo(),this.#f({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#_()})}redo(){this.#r.redo(),this.#f({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#_()})}addCommands(re){this.#r.add(re),this.#f({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#_()})}#_(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(const re of this.#t.values())return re.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const re=[...this.#o],oe=()=>{for(const he of re)he.remove()},ce=()=>{for(const he of re)this.#M(he)};this.addCommands({cmd:oe,undo:ce,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}#x(re){this.#o.clear();for(const oe of re)oe.isEmpty()||(this.#o.add(oe),oe.select());this.#f({hasSelectedEditor:!0})}selectAll(){for(const re of this.#o)re.commit();this.#x(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.#o.size!==0){for(const re of this.#o)re.unselect();this.#o.clear(),this.#f({hasSelectedEditor:!1})}}isActive(re){return this.#e===re}getActive(){return this.#e}getMode(){return this.#u}}e.AnnotationEditorUIManager=ie},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=be,e.getColorValues=Be,e.getCurrentTransform=$e,e.getCurrentTransformInverse=Fe,e.getFilenameFromUrl=pe,e.getPdfFilenameFromUrl=fe,e.getRGB=Me,e.getXfaPageViewport=Te,e.isDataScheme=he,e.isPdfFile=de,e.isValidFetchUrl=_e,e.loadScript=Ee,e.setLayerDimensions=Xe;var F=C(7),$=C(1);const Y="http://www.w3.org/2000/svg",V="pdfjs_internal_id_";e.AnnotationPrefix=V;class te{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}e.PixelsPerInch=te;class se extends F.BaseFilterFactory{#e;#t;#s;#n;#r;#d;#l;#i=0;constructor({docId:Ie,ownerDocument:Oe=globalThis.document}={}){super(),this.#s=Ie,this.#n=Oe}get#a(){return this.#e||=new Map}get#h(){if(!this.#t){const Ie=this.#n.createElement("div"),{style:Oe}=Ie;Oe.visibility="hidden",Oe.contain="strict",Oe.width=Oe.height=0,Oe.position="absolute",Oe.top=Oe.left=0,Oe.zIndex=-1;const Pe=this.#n.createElementNS(Y,"svg");Pe.setAttribute("width",0),Pe.setAttribute("height",0),this.#t=this.#n.createElementNS(Y,"defs"),Ie.append(Pe),Pe.append(this.#t),this.#n.body.append(Ie)}return this.#t}#c(Ie,Oe,Pe){const ge=this.#n.createElementNS(Y,Oe);ge.setAttribute("type","discrete"),ge.setAttribute("tableValues",Pe),Ie.append(ge)}addFilter(Ie){if(!Ie)return"none";let Oe=this.#a.get(Ie);if(Oe)return Oe;let Pe,ge,ue,xe;if(Ie.length===1){const Se=Ie[0],Re=new Array(256);for(let ke=0;ke<256;ke++)Re[ke]=Se[ke]/255;xe=Pe=ge=ue=Re.join(",")}else{const[Se,Re,ke]=Ie,De=new Array(256),Ne=new Array(256),Ge=new Array(256);for(let Le=0;Le<256;Le++)De[Le]=Se[Le]/255,Ne[Le]=Re[Le]/255,Ge[Le]=ke[Le]/255;Pe=De.join(","),ge=Ne.join(","),ue=Ge.join(","),xe=`${Pe}${ge}${ue}`}if(Oe=this.#a.get(xe),Oe)return this.#a.set(Ie,Oe),Oe;const ve=`g_${this.#s}_transfer_map_${this.#i++}`,le=`url(#${ve})`;this.#a.set(Ie,le),this.#a.set(xe,le);const me=this.#n.createElementNS(Y,"filter",Y);me.setAttribute("id",ve),me.setAttribute("color-interpolation-filters","sRGB");const Ce=this.#n.createElementNS(Y,"feComponentTransfer");return me.append(Ce),this.#c(Ce,"feFuncR",Pe),this.#c(Ce,"feFuncG",ge),this.#c(Ce,"feFuncB",ue),this.#h.append(me),le}addHCMFilter(Ie,Oe){const Pe=`${Ie}-${Oe}`;if(this.#d===Pe)return this.#l;if(this.#d=Pe,this.#l="none",this.#r?.remove(),!Ie||!Oe)return this.#l;this.#h.style.color=Ie,Ie=getComputedStyle(this.#h).getPropertyValue("color");const ge=Me(Ie);Ie=$.Util.makeHexColor(...ge),this.#h.style.color=Oe,Oe=getComputedStyle(this.#h).getPropertyValue("color");const ue=Me(Oe);if(Oe=$.Util.makeHexColor(...ue),this.#h.style.color="",Ie==="#000000"&&Oe==="#ffffff"||Ie===Oe)return this.#l;const xe=new Array(256);for(let ke=0;ke<=255;ke++){const De=ke/255;xe[ke]=De<=.03928?De/12.92:((De+.055)/1.055)**2.4}const ve=xe.join(","),le=`g_${this.#s}_hcm_filter`,me=this.#r=this.#n.createElementNS(Y,"filter",Y);me.setAttribute("id",le),me.setAttribute("color-interpolation-filters","sRGB");let Ce=this.#n.createElementNS(Y,"feComponentTransfer");me.append(Ce),this.#c(Ce,"feFuncR",ve),this.#c(Ce,"feFuncG",ve),this.#c(Ce,"feFuncB",ve);const Se=this.#n.createElementNS(Y,"feColorMatrix");Se.setAttribute("type","matrix"),Se.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),me.append(Se),Ce=this.#n.createElementNS(Y,"feComponentTransfer"),me.append(Ce);const Re=(ke,De)=>{const Ne=ge[ke]/255,Ge=ue[ke]/255,Le=new Array(De+1);for(let ze=0;ze<=De;ze++)Le[ze]=Ne+ze/De*(Ge-Ne);return Le.join(",")};return this.#c(Ce,"feFuncR",Re(0,5)),this.#c(Ce,"feFuncG",Re(1,5)),this.#c(Ce,"feFuncB",Re(2,5)),this.#h.append(me),this.#l=`url(#${le})`,this.#l}destroy(Ie=!1){Ie&&this.#l||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#i=0)}}e.DOMFilterFactory=se;class ne extends F.BaseCanvasFactory{constructor({ownerDocument:Ie=globalThis.document}={}){super(),this._document=Ie}_createCanvas(Ie,Oe){const Pe=this._document.createElement("canvas");return Pe.width=Ie,Pe.height=Oe,Pe}}e.DOMCanvasFactory=ne;async function ee(We,Ie=!1){if(_e(We,document.baseURI)){const Oe=await fetch(We);if(!Oe.ok)throw new Error(Oe.statusText);return Ie?new Uint8Array(await Oe.arrayBuffer()):(0,$.stringToBytes)(await Oe.text())}return new Promise((Oe,Pe)=>{const ge=new XMLHttpRequest;ge.open("GET",We,!0),Ie&&(ge.responseType="arraybuffer"),ge.onreadystatechange=()=>{if(ge.readyState===XMLHttpRequest.DONE){if(ge.status===200||ge.status===0){let ue;if(Ie&&ge.response?ue=new Uint8Array(ge.response):!Ie&&ge.responseText&&(ue=(0,$.stringToBytes)(ge.responseText)),ue){Oe(ue);return}}Pe(new Error(ge.statusText))}},ge.send(null)})}class ie extends F.BaseCMapReaderFactory{_fetchData(Ie,Oe){return ee(Ie,this.isCompressed).then(Pe=>({cMapData:Pe,compressionType:Oe}))}}e.DOMCMapReaderFactory=ie;class ae extends F.BaseStandardFontDataFactory{_fetchData(Ie){return ee(Ie,!0)}}e.DOMStandardFontDataFactory=ae;class re extends F.BaseSVGFactory{_createSVG(Ie){return document.createElementNS(Y,Ie)}}e.DOMSVGFactory=re;class oe{constructor({viewBox:Ie,scale:Oe,rotation:Pe,offsetX:ge=0,offsetY:ue=0,dontFlip:xe=!1}){this.viewBox=Ie,this.scale=Oe,this.rotation=Pe,this.offsetX=ge,this.offsetY=ue;const ve=(Ie[2]+Ie[0])/2,le=(Ie[3]+Ie[1])/2;let me,Ce,Se,Re;switch(Pe%=360,Pe<0&&(Pe+=360),Pe){case 180:me=-1,Ce=0,Se=0,Re=1;break;case 90:me=0,Ce=1,Se=1,Re=0;break;case 270:me=0,Ce=-1,Se=-1,Re=0;break;case 0:me=1,Ce=0,Se=0,Re=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}xe&&(Se=-Se,Re=-Re);let ke,De,Ne,Ge;me===0?(ke=Math.abs(le-Ie[1])*Oe+ge,De=Math.abs(ve-Ie[0])*Oe+ue,Ne=(Ie[3]-Ie[1])*Oe,Ge=(Ie[2]-Ie[0])*Oe):(ke=Math.abs(ve-Ie[0])*Oe+ge,De=Math.abs(le-Ie[1])*Oe+ue,Ne=(Ie[2]-Ie[0])*Oe,Ge=(Ie[3]-Ie[1])*Oe),this.transform=[me*Oe,Ce*Oe,Se*Oe,Re*Oe,ke-me*Oe*ve-Se*Oe*le,De-Ce*Oe*ve-Re*Oe*le],this.width=Ne,this.height=Ge}get rawDims(){const{viewBox:Ie}=this;return(0,$.shadow)(this,"rawDims",{pageWidth:Ie[2]-Ie[0],pageHeight:Ie[3]-Ie[1],pageX:Ie[0],pageY:Ie[1]})}clone({scale:Ie=this.scale,rotation:Oe=this.rotation,offsetX:Pe=this.offsetX,offsetY:ge=this.offsetY,dontFlip:ue=!1}={}){return new oe({viewBox:this.viewBox.slice(),scale:Ie,rotation:Oe,offsetX:Pe,offsetY:ge,dontFlip:ue})}convertToViewportPoint(Ie,Oe){return $.Util.applyTransform([Ie,Oe],this.transform)}convertToViewportRectangle(Ie){const Oe=$.Util.applyTransform([Ie[0],Ie[1]],this.transform),Pe=$.Util.applyTransform([Ie[2],Ie[3]],this.transform);return[Oe[0],Oe[1],Pe[0],Pe[1]]}convertToPdfPoint(Ie,Oe){return $.Util.applyInverseTransform([Ie,Oe],this.transform)}}e.PageViewport=oe;class ce extends $.BaseException{constructor(Ie,Oe,Pe=0){super(Ie,"RenderingCancelledException"),this.type=Oe,this.extraDelay=Pe}}e.RenderingCancelledException=ce;function he(We){const Ie=We.length;let Oe=0;for(;Oe<Ie&&We[Oe].trim()==="";)Oe++;return We.substring(Oe,Oe+5).toLowerCase()==="data:"}function de(We){return typeof We=="string"&&/\.pdf$/i.test(We)}function pe(We,Ie=!1){return Ie||([We]=We.split(/[#?]/,1)),We.substring(We.lastIndexOf("/")+1)}function fe(We,Ie="document.pdf"){if(typeof We!="string")return Ie;if(he(We))return(0,$.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ie;const Oe=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Pe=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ge=Oe.exec(We);let ue=Pe.exec(ge[1])||Pe.exec(ge[2])||Pe.exec(ge[3]);if(ue&&(ue=ue[0],ue.includes("%")))try{ue=Pe.exec(decodeURIComponent(ue))[0]}catch{}return ue||Ie}class ye{started=Object.create(null);times=[];time(Ie){Ie in this.started&&(0,$.warn)(`Timer is already running for ${Ie}`),this.started[Ie]=Date.now()}timeEnd(Ie){Ie in this.started||(0,$.warn)(`Timer has not been started for ${Ie}`),this.times.push({name:Ie,start:this.started[Ie],end:Date.now()}),delete this.started[Ie]}toString(){const Ie=[];let Oe=0;for(const{name:Pe}of this.times)Oe=Math.max(Pe.length,Oe);for(const{name:Pe,start:ge,end:ue}of this.times)Ie.push(`${Pe.padEnd(Oe)} ${ue-ge}ms
`);return Ie.join("")}}e.StatTimer=ye;function _e(We,Ie){try{const{protocol:Oe}=Ie?new URL(We,Ie):new URL(We);return Oe==="http:"||Oe==="https:"}catch{return!1}}function Ee(We,Ie=!1){return new Promise((Oe,Pe)=>{const ge=document.createElement("script");ge.src=We,ge.onload=function(ue){Ie&&ge.remove(),Oe(ue)},ge.onerror=function(){Pe(new Error(`Cannot load script at: ${ge.src}`))},(document.head||document.documentElement).append(ge)})}function be(We){console.log("Deprecated API usage: "+We)}let Ae;class we{static toDateObject(Ie){if(!Ie||typeof Ie!="string")return null;Ae||(Ae=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Oe=Ae.exec(Ie);if(!Oe)return null;const Pe=parseInt(Oe[1],10);let ge=parseInt(Oe[2],10);ge=ge>=1&&ge<=12?ge-1:0;let ue=parseInt(Oe[3],10);ue=ue>=1&&ue<=31?ue:1;let xe=parseInt(Oe[4],10);xe=xe>=0&&xe<=23?xe:0;let ve=parseInt(Oe[5],10);ve=ve>=0&&ve<=59?ve:0;let le=parseInt(Oe[6],10);le=le>=0&&le<=59?le:0;const me=Oe[7]||"Z";let Ce=parseInt(Oe[8],10);Ce=Ce>=0&&Ce<=23?Ce:0;let Se=parseInt(Oe[9],10)||0;return Se=Se>=0&&Se<=59?Se:0,me==="-"?(xe+=Ce,ve+=Se):me==="+"&&(xe-=Ce,ve-=Se),new Date(Date.UTC(Pe,ge,ue,xe,ve,le))}}e.PDFDateString=we;function Te(We,{scale:Ie=1,rotation:Oe=0}){const{width:Pe,height:ge}=We.attributes.style,ue=[0,0,parseInt(Pe),parseInt(ge)];return new oe({viewBox:ue,scale:Ie,rotation:Oe})}function Me(We){if(We.startsWith("#")){const Ie=parseInt(We.slice(1),16);return[(Ie&16711680)>>16,(Ie&65280)>>8,Ie&255]}return We.startsWith("rgb(")?We.slice(4,-1).split(",").map(Ie=>parseInt(Ie)):We.startsWith("rgba(")?We.slice(5,-1).split(",").map(Ie=>parseInt(Ie)).slice(0,3):((0,$.warn)(`Not a valid color format: "${We}"`),[0,0,0])}function Be(We){const Ie=document.createElement("span");Ie.style.visibility="hidden",document.body.append(Ie);for(const Oe of We.keys()){Ie.style.color=Oe;const Pe=window.getComputedStyle(Ie).color;We.set(Oe,Me(Pe))}Ie.remove()}function $e(We){const{a:Ie,b:Oe,c:Pe,d:ge,e:ue,f:xe}=We.getTransform();return[Ie,Oe,Pe,ge,ue,xe]}function Fe(We){const{a:Ie,b:Oe,c:Pe,d:ge,e:ue,f:xe}=We.getTransform().invertSelf();return[Ie,Oe,Pe,ge,ue,xe]}function Xe(We,Ie,Oe=!1,Pe=!0){if(Ie instanceof oe){const{pageWidth:ge,pageHeight:ue}=Ie.rawDims,{style:xe}=We,ve=`calc(var(--scale-factor) * ${ge}px)`,le=`calc(var(--scale-factor) * ${ue}px)`;!Oe||Ie.rotation%180===0?(xe.width=ve,xe.height=le):(xe.width=le,xe.height=ve)}Pe&&We.setAttribute("data-main-rotation",Ie.rotation)}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var F=C(1);class ${constructor(){this.constructor===$&&(0,F.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(ee){return"none"}addHCMFilter(ee,ie){return"none"}destroy(ee=!1){}}e.BaseFilterFactory=$;class Y{constructor(){this.constructor===Y&&(0,F.unreachable)("Cannot initialize BaseCanvasFactory.")}create(ee,ie){if(ee<=0||ie<=0)throw new Error("Invalid canvas size");const ae=this._createCanvas(ee,ie);return{canvas:ae,context:ae.getContext("2d")}}reset(ee,ie,ae){if(!ee.canvas)throw new Error("Canvas is not specified");if(ie<=0||ae<=0)throw new Error("Invalid canvas size");ee.canvas.width=ie,ee.canvas.height=ae}destroy(ee){if(!ee.canvas)throw new Error("Canvas is not specified");ee.canvas.width=0,ee.canvas.height=0,ee.canvas=null,ee.context=null}_createCanvas(ee,ie){(0,F.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=Y;class V{constructor({baseUrl:ee=null,isCompressed:ie=!0}){this.constructor===V&&(0,F.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=ee,this.isCompressed=ie}async fetch({name:ee}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!ee)throw new Error("CMap name must be specified.");const ie=this.baseUrl+ee+(this.isCompressed?".bcmap":""),ae=this.isCompressed?F.CMapCompressionType.BINARY:F.CMapCompressionType.NONE;return this._fetchData(ie,ae).catch(re=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${ie}`)})}_fetchData(ee,ie){(0,F.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=V;class te{constructor({baseUrl:ee=null}){this.constructor===te&&(0,F.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=ee}async fetch({filename:ee}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!ee)throw new Error("Font filename must be specified.");const ie=`${this.baseUrl}${ee}`;return this._fetchData(ie).catch(ae=>{throw new Error(`Unable to load font data at: ${ie}`)})}_fetchData(ee){(0,F.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=te;class se{constructor(){this.constructor===se&&(0,F.unreachable)("Cannot initialize BaseSVGFactory.")}create(ee,ie,ae=!1){if(ee<=0||ie<=0)throw new Error("Invalid SVG dimensions");const re=this._createSVG("svg:svg");return re.setAttribute("version","1.1"),ae||(re.setAttribute("width",`${ee}px`),re.setAttribute("height",`${ie}px`)),re.setAttribute("preserveAspectRatio","none"),re.setAttribute("viewBox",`0 0 ${ee} ${ie}`),re}createElement(ee){if(typeof ee!="string")throw new Error("Invalid SVG element type");return this._createSVG(ee)}_createSVG(ee){(0,F.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=se},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var F=C(1);const $=3285377520,Y=4294901760,V=65535;class te{constructor(ne){this.h1=ne?ne&4294967295:$,this.h2=ne?ne&4294967295:$}update(ne){let ee,ie;if(typeof ne=="string"){ee=new Uint8Array(ne.length*2),ie=0;for(let be=0,Ae=ne.length;be<Ae;be++){const we=ne.charCodeAt(be);we<=255?ee[ie++]=we:(ee[ie++]=we>>>8,ee[ie++]=we&255)}}else if((0,F.isArrayBuffer)(ne))ee=ne.slice(),ie=ee.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const ae=ie>>2,re=ie-ae*4,oe=new Uint32Array(ee.buffer,0,ae);let ce=0,he=0,de=this.h1,pe=this.h2;const fe=3432918353,ye=461845907,_e=fe&V,Ee=ye&V;for(let be=0;be<ae;be++)be&1?(ce=oe[be],ce=ce*fe&Y|ce*_e&V,ce=ce<<15|ce>>>17,ce=ce*ye&Y|ce*Ee&V,de^=ce,de=de<<13|de>>>19,de=de*5+3864292196):(he=oe[be],he=he*fe&Y|he*_e&V,he=he<<15|he>>>17,he=he*ye&Y|he*Ee&V,pe^=he,pe=pe<<13|pe>>>19,pe=pe*5+3864292196);switch(ce=0,re){case 3:ce^=ee[ae*4+2]<<16;case 2:ce^=ee[ae*4+1]<<8;case 1:ce^=ee[ae*4],ce=ce*fe&Y|ce*_e&V,ce=ce<<15|ce>>>17,ce=ce*ye&Y|ce*Ee&V,ae&1?de^=ce:pe^=ce}this.h1=de,this.h2=pe}hexdigest(){let ne=this.h1,ee=this.h2;return ne^=ee>>>1,ne=ne*3981806797&Y|ne*36045&V,ee=ee*4283543511&Y|((ee<<16|ne>>>16)*2950163797&Y)>>>16,ne^=ee>>>1,ne=ne*444984403&Y|ne*60499&V,ee=ee*3301882366&Y|((ee<<16|ne>>>16)*3120437893&Y)>>>16,ne^=ee>>>1,(ne>>>0).toString(16).padStart(8,"0")+(ee>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=te},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var F=C(1),$=C(10);class Y{constructor({ownerDocument:se=globalThis.document,styleElement:ne=null}){this._document=se,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(se){this.nativeFontFaces.push(se),this._document.fonts.add(se)}insertRule(se){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const ne=this.styleElement.sheet;ne.insertRule(se,ne.cssRules.length)}clear(){for(const se of this.nativeFontFaces)this._document.fonts.delete(se);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(se){if(se.attached||se.missingFile)return;if(se.attached=!0,this.isFontLoadingAPISupported){const ee=se.createNativeFontFace();if(ee){this.addNativeFontFace(ee);try{await ee.loaded}catch(ie){throw(0,F.warn)(`Failed to load font '${ee.family}': '${ie}'.`),se.disableFontFace=!0,ie}}return}const ne=se.createFontFaceRule();if(ne){if(this.insertRule(ne),this.isSyncFontLoadingSupported)return;await new Promise(ee=>{const ie=this._queueLoadingCallback(ee);this._prepareFontLoadEvent(se,ie)})}}get isFontLoadingAPISupported(){const se=!!this._document?.fonts;return(0,F.shadow)(this,"isFontLoadingAPISupported",se)}get isSyncFontLoadingSupported(){let se=!1;return($.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(se=!0),(0,F.shadow)(this,"isSyncFontLoadingSupported",se)}_queueLoadingCallback(se){function ne(){for((0,F.assert)(!ie.done,"completeRequest() cannot be called twice."),ie.done=!0;ee.length>0&&ee[0].done;){const ae=ee.shift();setTimeout(ae.callback,0)}}const{loadingRequests:ee}=this,ie={done:!1,complete:ne,callback:se};return ee.push(ie),ie}get _loadTestFont(){const se=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,F.shadow)(this,"_loadTestFont",se)}_prepareFontLoadEvent(se,ne){function ee(Me,Be){return Me.charCodeAt(Be)<<24|Me.charCodeAt(Be+1)<<16|Me.charCodeAt(Be+2)<<8|Me.charCodeAt(Be+3)&255}function ie(Me,Be,$e,Fe){const Xe=Me.substring(0,Be),We=Me.substring(Be+$e);return Xe+Fe+We}let ae,re;const oe=this._document.createElement("canvas");oe.width=1,oe.height=1;const ce=oe.getContext("2d");let he=0;function de(Me,Be){if(++he>30){(0,F.warn)("Load test font never loaded."),Be();return}if(ce.font="30px "+Me,ce.fillText(".",0,20),ce.getImageData(0,0,1,1).data[3]>0){Be();return}setTimeout(de.bind(null,Me,Be))}const pe=`lt${Date.now()}${this.loadTestFontId++}`;let fe=this._loadTestFont;fe=ie(fe,976,pe.length,pe);const _e=16,Ee=1482184792;let be=ee(fe,_e);for(ae=0,re=pe.length-3;ae<re;ae+=4)be=be-Ee+ee(pe,ae)|0;ae<pe.length&&(be=be-Ee+ee(pe+"XXX",ae)|0),fe=ie(fe,_e,4,(0,F.string32)(be));const Ae=`url(data:font/opentype;base64,${btoa(fe)});`,we=`@font-face {font-family:"${pe}";src:${Ae}}`;this.insertRule(we);const Te=this._document.createElement("div");Te.style.visibility="hidden",Te.style.width=Te.style.height="10px",Te.style.position="absolute",Te.style.top=Te.style.left="0px";for(const Me of[se.loadedName,pe]){const Be=this._document.createElement("span");Be.textContent="Hi",Be.style.fontFamily=Me,Te.append(Be)}this._document.body.append(Te),de(pe,()=>{Te.remove(),ne.complete()})}}e.FontLoader=Y;class V{constructor(se,{isEvalSupported:ne=!0,disableFontFace:ee=!1,ignoreErrors:ie=!1,inspectFont:ae=null}){this.compiledGlyphs=Object.create(null);for(const re in se)this[re]=se[re];this.isEvalSupported=ne!==!1,this.disableFontFace=ee===!0,this.ignoreErrors=ie===!0,this._inspectFont=ae}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let se;if(!this.cssFontInfo)se=new FontFace(this.loadedName,this.data,{});else{const ne={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(ne.style=`oblique ${this.cssFontInfo.italicAngle}deg`),se=new FontFace(this.cssFontInfo.fontFamily,this.data,ne)}return this._inspectFont?.(this),se}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const se=(0,F.bytesToString)(this.data),ne=`url(data:${this.mimetype};base64,${btoa(se)});`;let ee;if(!this.cssFontInfo)ee=`@font-face {font-family:"${this.loadedName}";src:${ne}}`;else{let ie=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(ie+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),ee=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${ie}src:${ne}}`}return this._inspectFont?.(this,ne),ee}getPathGenerator(se,ne){if(this.compiledGlyphs[ne]!==void 0)return this.compiledGlyphs[ne];let ee;try{ee=se.get(this.loadedName+"_path_"+ne)}catch(ie){if(!this.ignoreErrors)throw ie;return(0,F.warn)(`getPathGenerator - ignoring character: "${ie}".`),this.compiledGlyphs[ne]=function(ae,re){}}if(this.isEvalSupported&&F.FeatureTest.isEvalSupported){const ie=[];for(const ae of ee){const re=ae.args!==void 0?ae.args.join(","):"";ie.push("c.",ae.cmd,"(",re,`);
`)}return this.compiledGlyphs[ne]=new Function("c","size",ie.join(""))}return this.compiledGlyphs[ne]=function(ie,ae){for(const re of ee)re.cmd==="scale"&&(re.args=[ae,-ae]),ie[re.cmd].apply(ie,re.args)}}}e.FontFaceObject=V},(J,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeJS=void 0;const C=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=C},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var F=C(1),$=C(6),Y=C(12),V=C(13),te=C(10);const se=16,ne=100,ee=4096,ie=15,ae=10,re=1e3,oe=16;function ce(Pe,ge){if(Pe._removeMirroring)throw new Error("Context is already forwarding operations.");Pe.__originalSave=Pe.save,Pe.__originalRestore=Pe.restore,Pe.__originalRotate=Pe.rotate,Pe.__originalScale=Pe.scale,Pe.__originalTranslate=Pe.translate,Pe.__originalTransform=Pe.transform,Pe.__originalSetTransform=Pe.setTransform,Pe.__originalResetTransform=Pe.resetTransform,Pe.__originalClip=Pe.clip,Pe.__originalMoveTo=Pe.moveTo,Pe.__originalLineTo=Pe.lineTo,Pe.__originalBezierCurveTo=Pe.bezierCurveTo,Pe.__originalRect=Pe.rect,Pe.__originalClosePath=Pe.closePath,Pe.__originalBeginPath=Pe.beginPath,Pe._removeMirroring=()=>{Pe.save=Pe.__originalSave,Pe.restore=Pe.__originalRestore,Pe.rotate=Pe.__originalRotate,Pe.scale=Pe.__originalScale,Pe.translate=Pe.__originalTranslate,Pe.transform=Pe.__originalTransform,Pe.setTransform=Pe.__originalSetTransform,Pe.resetTransform=Pe.__originalResetTransform,Pe.clip=Pe.__originalClip,Pe.moveTo=Pe.__originalMoveTo,Pe.lineTo=Pe.__originalLineTo,Pe.bezierCurveTo=Pe.__originalBezierCurveTo,Pe.rect=Pe.__originalRect,Pe.closePath=Pe.__originalClosePath,Pe.beginPath=Pe.__originalBeginPath,delete Pe._removeMirroring},Pe.save=function(){ge.save(),this.__originalSave()},Pe.restore=function(){ge.restore(),this.__originalRestore()},Pe.translate=function(xe,ve){ge.translate(xe,ve),this.__originalTranslate(xe,ve)},Pe.scale=function(xe,ve){ge.scale(xe,ve),this.__originalScale(xe,ve)},Pe.transform=function(xe,ve,le,me,Ce,Se){ge.transform(xe,ve,le,me,Ce,Se),this.__originalTransform(xe,ve,le,me,Ce,Se)},Pe.setTransform=function(xe,ve,le,me,Ce,Se){ge.setTransform(xe,ve,le,me,Ce,Se),this.__originalSetTransform(xe,ve,le,me,Ce,Se)},Pe.resetTransform=function(){ge.resetTransform(),this.__originalResetTransform()},Pe.rotate=function(xe){ge.rotate(xe),this.__originalRotate(xe)},Pe.clip=function(xe){ge.clip(xe),this.__originalClip(xe)},Pe.moveTo=function(ue,xe){ge.moveTo(ue,xe),this.__originalMoveTo(ue,xe)},Pe.lineTo=function(ue,xe){ge.lineTo(ue,xe),this.__originalLineTo(ue,xe)},Pe.bezierCurveTo=function(ue,xe,ve,le,me,Ce){ge.bezierCurveTo(ue,xe,ve,le,me,Ce),this.__originalBezierCurveTo(ue,xe,ve,le,me,Ce)},Pe.rect=function(ue,xe,ve,le){ge.rect(ue,xe,ve,le),this.__originalRect(ue,xe,ve,le)},Pe.closePath=function(){ge.closePath(),this.__originalClosePath()},Pe.beginPath=function(){ge.beginPath(),this.__originalBeginPath()}}class he{constructor(ge){this.canvasFactory=ge,this.cache=Object.create(null)}getCanvas(ge,ue,xe){let ve;return this.cache[ge]!==void 0?(ve=this.cache[ge],this.canvasFactory.reset(ve,ue,xe)):(ve=this.canvasFactory.create(ue,xe),this.cache[ge]=ve),ve}delete(ge){delete this.cache[ge]}clear(){for(const ge in this.cache){const ue=this.cache[ge];this.canvasFactory.destroy(ue),delete this.cache[ge]}}}function de(Pe,ge,ue,xe,ve,le,me,Ce,Se,Re){const[ke,De,Ne,Ge,Le,ze]=(0,$.getCurrentTransform)(Pe);if(De===0&&Ne===0){const Ke=me*ke+Le,Ye=Math.round(Ke),Ze=Ce*Ge+ze,Je=Math.round(Ze),tt=(me+Se)*ke+Le,nt=Math.abs(Math.round(tt)-Ye)||1,et=(Ce+Re)*Ge+ze,it=Math.abs(Math.round(et)-Je)||1;return Pe.setTransform(Math.sign(ke),0,0,Math.sign(Ge),Ye,Je),Pe.drawImage(ge,ue,xe,ve,le,0,0,nt,it),Pe.setTransform(ke,De,Ne,Ge,Le,ze),[nt,it]}if(ke===0&&Ge===0){const Ke=Ce*Ne+Le,Ye=Math.round(Ke),Ze=me*De+ze,Je=Math.round(Ze),tt=(Ce+Re)*Ne+Le,nt=Math.abs(Math.round(tt)-Ye)||1,et=(me+Se)*De+ze,it=Math.abs(Math.round(et)-Je)||1;return Pe.setTransform(0,Math.sign(De),Math.sign(Ne),0,Ye,Je),Pe.drawImage(ge,ue,xe,ve,le,0,0,it,nt),Pe.setTransform(ke,De,Ne,Ge,Le,ze),[it,nt]}Pe.drawImage(ge,ue,xe,ve,le,me,Ce,Se,Re);const Ve=Math.hypot(ke,De),je=Math.hypot(Ne,Ge);return[Ve*Se,je*Re]}function pe(Pe){const{width:ge,height:ue}=Pe;if(ge>re||ue>re)return null;const xe=1e3,ve=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),le=ge+1;let me=new Uint8Array(le*(ue+1)),Ce,Se,Re;const ke=ge+7&-8;let De=new Uint8Array(ke*ue),Ne=0;for(const je of Pe.data){let Ke=128;for(;Ke>0;)De[Ne++]=je&Ke?0:255,Ke>>=1}let Ge=0;for(Ne=0,De[Ne]!==0&&(me[0]=1,++Ge),Se=1;Se<ge;Se++)De[Ne]!==De[Ne+1]&&(me[Se]=De[Ne]?2:1,++Ge),Ne++;for(De[Ne]!==0&&(me[Se]=2,++Ge),Ce=1;Ce<ue;Ce++){Ne=Ce*ke,Re=Ce*le,De[Ne-ke]!==De[Ne]&&(me[Re]=De[Ne]?1:8,++Ge);let je=(De[Ne]?4:0)+(De[Ne-ke]?8:0);for(Se=1;Se<ge;Se++)je=(je>>2)+(De[Ne+1]?4:0)+(De[Ne-ke+1]?8:0),ve[je]&&(me[Re+Se]=ve[je],++Ge),Ne++;if(De[Ne-ke]!==De[Ne]&&(me[Re+Se]=De[Ne]?2:4,++Ge),Ge>xe)return null}for(Ne=ke*(ue-1),Re=Ce*le,De[Ne]!==0&&(me[Re]=8,++Ge),Se=1;Se<ge;Se++)De[Ne]!==De[Ne+1]&&(me[Re+Se]=De[Ne]?4:8,++Ge),Ne++;if(De[Ne]!==0&&(me[Re+Se]=4,++Ge),Ge>xe)return null;const Le=new Int32Array([0,le,-1,0,-le,0,0,0,1]),ze=new Path2D;for(Ce=0;Ge&&Ce<=ue;Ce++){let je=Ce*le;const Ke=je+ge;for(;je<Ke&&!me[je];)je++;if(je===Ke)continue;ze.moveTo(je%le,Ce);const Ye=je;let Ze=me[je];do{const Je=Le[Ze];do je+=Je;while(!me[je]);const tt=me[je];tt!==5&&tt!==10?(Ze=tt,me[je]=0):(Ze=tt&51*Ze>>4,me[je]&=Ze>>2|Ze<<2),ze.lineTo(je%le,je/le|0),me[je]||--Ge}while(Ye!==je);--Ce}return De=null,me=null,function(je){je.save(),je.scale(1/ge,-1/ue),je.translate(0,-ue),je.fill(ze),je.beginPath(),je.restore()}}class fe{constructor(ge,ue){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=F.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=F.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=F.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ge,ue])}clone(){const ge=Object.create(this);return ge.clipBox=this.clipBox.slice(),ge}setCurrentPoint(ge,ue){this.x=ge,this.y=ue}updatePathMinMax(ge,ue,xe){[ue,xe]=F.Util.applyTransform([ue,xe],ge),this.minX=Math.min(this.minX,ue),this.minY=Math.min(this.minY,xe),this.maxX=Math.max(this.maxX,ue),this.maxY=Math.max(this.maxY,xe)}updateRectMinMax(ge,ue){const xe=F.Util.applyTransform(ue,ge),ve=F.Util.applyTransform(ue.slice(2),ge);this.minX=Math.min(this.minX,xe[0],ve[0]),this.minY=Math.min(this.minY,xe[1],ve[1]),this.maxX=Math.max(this.maxX,xe[0],ve[0]),this.maxY=Math.max(this.maxY,xe[1],ve[1])}updateScalingPathMinMax(ge,ue){F.Util.scaleMinMax(ge,ue),this.minX=Math.min(this.minX,ue[0]),this.maxX=Math.max(this.maxX,ue[1]),this.minY=Math.min(this.minY,ue[2]),this.maxY=Math.max(this.maxY,ue[3])}updateCurvePathMinMax(ge,ue,xe,ve,le,me,Ce,Se,Re,ke){const De=F.Util.bezierBoundingBox(ue,xe,ve,le,me,Ce,Se,Re);if(ke){ke[0]=Math.min(ke[0],De[0],De[2]),ke[1]=Math.max(ke[1],De[0],De[2]),ke[2]=Math.min(ke[2],De[1],De[3]),ke[3]=Math.max(ke[3],De[1],De[3]);return}this.updateRectMinMax(ge,De)}getPathBoundingBox(ge=Y.PathType.FILL,ue=null){const xe=[this.minX,this.minY,this.maxX,this.maxY];if(ge===Y.PathType.STROKE){ue||(0,F.unreachable)("Stroke bounding box must include transform.");const ve=F.Util.singularValueDecompose2dScale(ue),le=ve[0]*this.lineWidth/2,me=ve[1]*this.lineWidth/2;xe[0]-=le,xe[1]-=me,xe[2]+=le,xe[3]+=me}return xe}updateClipFromPath(){const ge=F.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ge||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ge){this.clipBox=ge,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ge=Y.PathType.FILL,ue=null){return F.Util.intersect(this.clipBox,this.getPathBoundingBox(ge,ue))}}function ye(Pe,ge){if(typeof ImageData<"u"&&ge instanceof ImageData){Pe.putImageData(ge,0,0);return}const ue=ge.height,xe=ge.width,ve=ue%oe,le=(ue-ve)/oe,me=ve===0?le:le+1,Ce=Pe.createImageData(xe,oe);let Se=0,Re;const ke=ge.data,De=Ce.data;let Ne,Ge,Le,ze;if(ge.kind===F.ImageKind.GRAYSCALE_1BPP){const Ve=ke.byteLength,je=new Uint32Array(De.buffer,0,De.byteLength>>2),Ke=je.length,Ye=xe+7>>3,Ze=4294967295,Je=F.FeatureTest.isLittleEndian?4278190080:255;for(Ne=0;Ne<me;Ne++){for(Le=Ne<le?oe:ve,Re=0,Ge=0;Ge<Le;Ge++){const tt=Ve-Se;let nt=0;const et=tt>Ye?xe:tt*8-7,it=et&-8;let lt=0,rt=0;for(;nt<it;nt+=8)rt=ke[Se++],je[Re++]=rt&128?Ze:Je,je[Re++]=rt&64?Ze:Je,je[Re++]=rt&32?Ze:Je,je[Re++]=rt&16?Ze:Je,je[Re++]=rt&8?Ze:Je,je[Re++]=rt&4?Ze:Je,je[Re++]=rt&2?Ze:Je,je[Re++]=rt&1?Ze:Je;for(;nt<et;nt++)lt===0&&(rt=ke[Se++],lt=128),je[Re++]=rt&lt?Ze:Je,lt>>=1}for(;Re<Ke;)je[Re++]=0;Pe.putImageData(Ce,0,Ne*oe)}}else if(ge.kind===F.ImageKind.RGBA_32BPP){for(Ge=0,ze=xe*oe*4,Ne=0;Ne<le;Ne++)De.set(ke.subarray(Se,Se+ze)),Se+=ze,Pe.putImageData(Ce,0,Ge),Ge+=oe;Ne<me&&(ze=xe*ve*4,De.set(ke.subarray(Se,Se+ze)),Pe.putImageData(Ce,0,Ge))}else if(ge.kind===F.ImageKind.RGB_24BPP)for(Le=oe,ze=xe*Le,Ne=0;Ne<me;Ne++){for(Ne>=le&&(Le=ve,ze=xe*Le),Re=0,Ge=ze;Ge--;)De[Re++]=ke[Se++],De[Re++]=ke[Se++],De[Re++]=ke[Se++],De[Re++]=255;Pe.putImageData(Ce,0,Ne*oe)}else throw new Error(`bad image kind: ${ge.kind}`)}function _e(Pe,ge){if(ge.bitmap){Pe.drawImage(ge.bitmap,0,0);return}const ue=ge.height,xe=ge.width,ve=ue%oe,le=(ue-ve)/oe,me=ve===0?le:le+1,Ce=Pe.createImageData(xe,oe);let Se=0;const Re=ge.data,ke=Ce.data;for(let De=0;De<me;De++){const Ne=De<le?oe:ve;({srcPos:Se}=(0,V.convertBlackAndWhiteToRGBA)({src:Re,srcPos:Se,dest:ke,width:xe,height:Ne,nonBlackColor:0})),Pe.putImageData(Ce,0,De*oe)}}function Ee(Pe,ge){const ue=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const xe of ue)Pe[xe]!==void 0&&(ge[xe]=Pe[xe]);Pe.setLineDash!==void 0&&(ge.setLineDash(Pe.getLineDash()),ge.lineDashOffset=Pe.lineDashOffset)}function be(Pe){Pe.strokeStyle=Pe.fillStyle="#000000",Pe.fillRule="nonzero",Pe.globalAlpha=1,Pe.lineWidth=1,Pe.lineCap="butt",Pe.lineJoin="miter",Pe.miterLimit=10,Pe.globalCompositeOperation="source-over",Pe.font="10px sans-serif",Pe.setLineDash!==void 0&&(Pe.setLineDash([]),Pe.lineDashOffset=0),te.isNodeJS||(Pe.filter="none")}function Ae(Pe,ge,ue,xe){const ve=Pe.length;for(let le=3;le<ve;le+=4){const me=Pe[le];if(me===0)Pe[le-3]=ge,Pe[le-2]=ue,Pe[le-1]=xe;else if(me<255){const Ce=255-me;Pe[le-3]=Pe[le-3]*me+ge*Ce>>8,Pe[le-2]=Pe[le-2]*me+ue*Ce>>8,Pe[le-1]=Pe[le-1]*me+xe*Ce>>8}}}function we(Pe,ge,ue){const xe=Pe.length,ve=1/255;for(let le=3;le<xe;le+=4){const me=ue?ue[Pe[le]]:Pe[le];ge[le]=ge[le]*me*ve|0}}function Te(Pe,ge,ue){const xe=Pe.length;for(let ve=3;ve<xe;ve+=4){const le=Pe[ve-3]*77+Pe[ve-2]*152+Pe[ve-1]*28;ge[ve]=ue?ge[ve]*ue[le>>8]>>8:ge[ve]*le>>16}}function Me(Pe,ge,ue,xe,ve,le,me,Ce,Se,Re,ke){const De=!!le,Ne=De?le[0]:0,Ge=De?le[1]:0,Le=De?le[2]:0;let ze;ve==="Luminosity"?ze=Te:ze=we;const je=Math.min(xe,Math.ceil(1048576/ue));for(let Ke=0;Ke<xe;Ke+=je){const Ye=Math.min(je,xe-Ke),Ze=Pe.getImageData(Ce-Re,Ke+(Se-ke),ue,Ye),Je=ge.getImageData(Ce,Ke+Se,ue,Ye);De&&Ae(Ze.data,Ne,Ge,Le),ze(Ze.data,Je.data,me),ge.putImageData(Je,Ce,Ke+Se)}}function Be(Pe,ge,ue,xe){const ve=xe[0],le=xe[1],me=xe[2]-ve,Ce=xe[3]-le;me===0||Ce===0||(Me(ge.context,ue,me,Ce,ge.subtype,ge.backdrop,ge.transferMap,ve,le,ge.offsetX,ge.offsetY),Pe.save(),Pe.globalAlpha=1,Pe.globalCompositeOperation="source-over",Pe.setTransform(1,0,0,1,0,0),Pe.drawImage(ue.canvas,0,0),Pe.restore())}function $e(Pe,ge){const ue=F.Util.singularValueDecompose2dScale(Pe);ue[0]=Math.fround(ue[0]),ue[1]=Math.fround(ue[1]);const xe=Math.fround((globalThis.devicePixelRatio||1)*$.PixelsPerInch.PDF_TO_CSS_UNITS);return ge!==void 0?ge:ue[0]<=xe||ue[1]<=xe}const Fe=["butt","round","square"],Xe=["miter","round","bevel"],We={},Ie={};class Oe{constructor(ge,ue,xe,ve,le,{optionalContentConfig:me,markedContentStack:Ce=null},Se,Re){this.ctx=ge,this.current=new fe(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=ue,this.objs=xe,this.canvasFactory=ve,this.filterFactory=le,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Ce||[],this.optionalContentConfig=me,this.cachedCanvases=new he(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Se,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Re,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ge,ue=null){return typeof ge=="string"?ge.startsWith("g_")?this.commonObjs.get(ge):this.objs.get(ge):ue}beginDrawing({transform:ge,viewport:ue,transparency:xe=!1,background:ve=null}){const le=this.ctx.canvas.width,me=this.ctx.canvas.height,Ce=this.ctx.fillStyle;if(this.ctx.fillStyle=ve||"#ffffff",this.ctx.fillRect(0,0,le,me),this.ctx.fillStyle=Ce,xe){const Se=this.cachedCanvases.getCanvas("transparent",le,me);this.compositeCtx=this.ctx,this.transparentCanvas=Se.canvas,this.ctx=Se.context,this.ctx.save(),this.ctx.transform(...(0,$.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),be(this.ctx),ge&&(this.ctx.transform(...ge),this.outputScaleX=ge[0],this.outputScaleY=ge[0]),this.ctx.transform(...ue.transform),this.viewportScale=ue.scale,this.baseTransform=(0,$.getCurrentTransform)(this.ctx)}executeOperatorList(ge,ue,xe,ve){const le=ge.argsArray,me=ge.fnArray;let Ce=ue||0;const Se=le.length;if(Se===Ce)return Ce;const Re=Se-Ce>ae&&typeof xe=="function",ke=Re?Date.now()+ie:0;let De=0;const Ne=this.commonObjs,Ge=this.objs;let Le;for(;;){if(ve!==void 0&&Ce===ve.nextBreakPoint)return ve.breakIt(Ce,xe),Ce;if(Le=me[Ce],Le!==F.OPS.dependency)this[Le].apply(this,le[Ce]);else for(const ze of le[Ce]){const Ve=ze.startsWith("g_")?Ne:Ge;if(!Ve.has(ze))return Ve.get(ze,xe),Ce}if(Ce++,Ce===Se)return Ce;if(Re&&++De>ae){if(Date.now()>ke)return xe(),Ce;De=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ge of this._cachedBitmapsMap.values()){for(const ue of ge.values())typeof HTMLCanvasElement<"u"&&ue instanceof HTMLCanvasElement&&(ue.width=ue.height=0);ge.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const ge=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ge!=="none"){const ue=this.ctx.filter;this.ctx.filter=ge,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=ue}}}_scaleImage(ge,ue){const xe=ge.width,ve=ge.height;let le=Math.max(Math.hypot(ue[0],ue[1]),1),me=Math.max(Math.hypot(ue[2],ue[3]),1),Ce=xe,Se=ve,Re="prescale1",ke,De;for(;le>2&&Ce>1||me>2&&Se>1;){let Ne=Ce,Ge=Se;le>2&&Ce>1&&(Ne=Ce>=16384?Math.floor(Ce/2)-1||1:Math.ceil(Ce/2),le/=Ce/Ne),me>2&&Se>1&&(Ge=Se>=16384?Math.floor(Se/2)-1||1:Math.ceil(Se)/2,me/=Se/Ge),ke=this.cachedCanvases.getCanvas(Re,Ne,Ge),De=ke.context,De.clearRect(0,0,Ne,Ge),De.drawImage(ge,0,0,Ce,Se,0,0,Ne,Ge),ge=ke.canvas,Ce=Ne,Se=Ge,Re=Re==="prescale1"?"prescale2":"prescale1"}return{img:ge,paintWidth:Ce,paintHeight:Se}}_createMaskCanvas(ge){const ue=this.ctx,{width:xe,height:ve}=ge,le=this.current.fillColor,me=this.current.patternFill,Ce=(0,$.getCurrentTransform)(ue);let Se,Re,ke,De;if((ge.bitmap||ge.data)&&ge.count>1){const nt=ge.bitmap||ge.data.buffer;Re=JSON.stringify(me?Ce:[Ce.slice(0,4),le]),Se=this._cachedBitmapsMap.get(nt),Se||(Se=new Map,this._cachedBitmapsMap.set(nt,Se));const et=Se.get(Re);if(et&&!me){const it=Math.round(Math.min(Ce[0],Ce[2])+Ce[4]),lt=Math.round(Math.min(Ce[1],Ce[3])+Ce[5]);return{canvas:et,offsetX:it,offsetY:lt}}ke=et}ke||(De=this.cachedCanvases.getCanvas("maskCanvas",xe,ve),_e(De.context,ge));let Ne=F.Util.transform(Ce,[1/xe,0,0,-1/ve,0,0]);Ne=F.Util.transform(Ne,[1,0,0,1,0,-ve]);const Ge=F.Util.applyTransform([0,0],Ne),Le=F.Util.applyTransform([xe,ve],Ne),ze=F.Util.normalizeRect([Ge[0],Ge[1],Le[0],Le[1]]),Ve=Math.round(ze[2]-ze[0])||1,je=Math.round(ze[3]-ze[1])||1,Ke=this.cachedCanvases.getCanvas("fillCanvas",Ve,je),Ye=Ke.context,Ze=Math.min(Ge[0],Le[0]),Je=Math.min(Ge[1],Le[1]);Ye.translate(-Ze,-Je),Ye.transform(...Ne),ke||(ke=this._scaleImage(De.canvas,(0,$.getCurrentTransformInverse)(Ye)),ke=ke.img,Se&&me&&Se.set(Re,ke)),Ye.imageSmoothingEnabled=$e((0,$.getCurrentTransform)(Ye),ge.interpolate),de(Ye,ke,0,0,ke.width,ke.height,0,0,xe,ve),Ye.globalCompositeOperation="source-in";const tt=F.Util.transform((0,$.getCurrentTransformInverse)(Ye),[1,0,0,1,-Ze,-Je]);return Ye.fillStyle=me?le.getPattern(ue,this,tt,Y.PathType.FILL):le,Ye.fillRect(0,0,xe,ve),Se&&!me&&(this.cachedCanvases.delete("fillCanvas"),Se.set(Re,Ke.canvas)),{canvas:Ke.canvas,offsetX:Math.round(Ze),offsetY:Math.round(Je)}}setLineWidth(ge){ge!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=ge,this.ctx.lineWidth=ge}setLineCap(ge){this.ctx.lineCap=Fe[ge]}setLineJoin(ge){this.ctx.lineJoin=Xe[ge]}setMiterLimit(ge){this.ctx.miterLimit=ge}setDash(ge,ue){const xe=this.ctx;xe.setLineDash!==void 0&&(xe.setLineDash(ge),xe.lineDashOffset=ue)}setRenderingIntent(ge){}setFlatness(ge){}setGState(ge){for(const[ue,xe]of ge)switch(ue){case"LW":this.setLineWidth(xe);break;case"LC":this.setLineCap(xe);break;case"LJ":this.setLineJoin(xe);break;case"ML":this.setMiterLimit(xe);break;case"D":this.setDash(xe[0],xe[1]);break;case"RI":this.setRenderingIntent(xe);break;case"FL":this.setFlatness(xe);break;case"Font":this.setFont(xe[0],xe[1]);break;case"CA":this.current.strokeAlpha=xe;break;case"ca":this.current.fillAlpha=xe,this.ctx.globalAlpha=xe;break;case"BM":this.ctx.globalCompositeOperation=xe;break;case"SMask":this.current.activeSMask=xe?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(xe);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ge=this.inSMaskMode;this.current.activeSMask&&!ge?this.beginSMaskMode():!this.current.activeSMask&&ge&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ge=this.ctx.canvas.width,ue=this.ctx.canvas.height,xe="smaskGroupAt"+this.groupLevel,ve=this.cachedCanvases.getCanvas(xe,ge,ue);this.suspendedCtx=this.ctx,this.ctx=ve.context;const le=this.ctx;le.setTransform(...(0,$.getCurrentTransform)(this.suspendedCtx)),Ee(this.suspendedCtx,le),ce(le,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ee(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ge){if(!this.current.activeSMask)return;ge?(ge[0]=Math.floor(ge[0]),ge[1]=Math.floor(ge[1]),ge[2]=Math.ceil(ge[2]),ge[3]=Math.ceil(ge[3])):ge=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const ue=this.current.activeSMask,xe=this.suspendedCtx;Be(xe,ue,this.ctx,ge),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Ee(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ge=this.current;this.stateStack.push(ge),this.current=ge.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Ee(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(ge,ue,xe,ve,le,me){this.ctx.transform(ge,ue,xe,ve,le,me),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(ge,ue,xe){const ve=this.ctx,le=this.current;let me=le.x,Ce=le.y,Se,Re;const ke=(0,$.getCurrentTransform)(ve),De=ke[0]===0&&ke[3]===0||ke[1]===0&&ke[2]===0,Ne=De?xe.slice(0):null;for(let Ge=0,Le=0,ze=ge.length;Ge<ze;Ge++)switch(ge[Ge]|0){case F.OPS.rectangle:me=ue[Le++],Ce=ue[Le++];const Ve=ue[Le++],je=ue[Le++],Ke=me+Ve,Ye=Ce+je;ve.moveTo(me,Ce),Ve===0||je===0?ve.lineTo(Ke,Ye):(ve.lineTo(Ke,Ce),ve.lineTo(Ke,Ye),ve.lineTo(me,Ye)),De||le.updateRectMinMax(ke,[me,Ce,Ke,Ye]),ve.closePath();break;case F.OPS.moveTo:me=ue[Le++],Ce=ue[Le++],ve.moveTo(me,Ce),De||le.updatePathMinMax(ke,me,Ce);break;case F.OPS.lineTo:me=ue[Le++],Ce=ue[Le++],ve.lineTo(me,Ce),De||le.updatePathMinMax(ke,me,Ce);break;case F.OPS.curveTo:Se=me,Re=Ce,me=ue[Le+4],Ce=ue[Le+5],ve.bezierCurveTo(ue[Le],ue[Le+1],ue[Le+2],ue[Le+3],me,Ce),le.updateCurvePathMinMax(ke,Se,Re,ue[Le],ue[Le+1],ue[Le+2],ue[Le+3],me,Ce,Ne),Le+=6;break;case F.OPS.curveTo2:Se=me,Re=Ce,ve.bezierCurveTo(me,Ce,ue[Le],ue[Le+1],ue[Le+2],ue[Le+3]),le.updateCurvePathMinMax(ke,Se,Re,me,Ce,ue[Le],ue[Le+1],ue[Le+2],ue[Le+3],Ne),me=ue[Le+2],Ce=ue[Le+3],Le+=4;break;case F.OPS.curveTo3:Se=me,Re=Ce,me=ue[Le+2],Ce=ue[Le+3],ve.bezierCurveTo(ue[Le],ue[Le+1],me,Ce,me,Ce),le.updateCurvePathMinMax(ke,Se,Re,ue[Le],ue[Le+1],me,Ce,me,Ce,Ne),Le+=4;break;case F.OPS.closePath:ve.closePath();break}De&&le.updateScalingPathMinMax(ke,Ne),le.setCurrentPoint(me,Ce)}closePath(){this.ctx.closePath()}stroke(ge=!0){const ue=this.ctx,xe=this.current.strokeColor;ue.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof xe=="object"&&xe?.getPattern?(ue.save(),ue.strokeStyle=xe.getPattern(ue,this,(0,$.getCurrentTransformInverse)(ue),Y.PathType.STROKE),this.rescaleAndStroke(!1),ue.restore()):this.rescaleAndStroke(!0)),ge&&this.consumePath(this.current.getClippedPathBoundingBox()),ue.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ge=!0){const ue=this.ctx,xe=this.current.fillColor,ve=this.current.patternFill;let le=!1;ve&&(ue.save(),ue.fillStyle=xe.getPattern(ue,this,(0,$.getCurrentTransformInverse)(ue),Y.PathType.FILL),le=!0);const me=this.current.getClippedPathBoundingBox();this.contentVisible&&me!==null&&(this.pendingEOFill?(ue.fill("evenodd"),this.pendingEOFill=!1):ue.fill()),le&&ue.restore(),ge&&this.consumePath(me)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=We}eoClip(){this.pendingClip=Ie}beginText(){this.current.textMatrix=F.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ge=this.pendingTextPaths,ue=this.ctx;if(ge===void 0){ue.beginPath();return}ue.save(),ue.beginPath();for(const xe of ge)ue.setTransform(...xe.transform),ue.translate(xe.x,xe.y),xe.addToPath(ue,xe.fontSize);ue.restore(),ue.clip(),ue.beginPath(),delete this.pendingTextPaths}setCharSpacing(ge){this.current.charSpacing=ge}setWordSpacing(ge){this.current.wordSpacing=ge}setHScale(ge){this.current.textHScale=ge/100}setLeading(ge){this.current.leading=-ge}setFont(ge,ue){const xe=this.commonObjs.get(ge),ve=this.current;if(!xe)throw new Error(`Can't find font for ${ge}`);if(ve.fontMatrix=xe.fontMatrix||F.FONT_IDENTITY_MATRIX,(ve.fontMatrix[0]===0||ve.fontMatrix[3]===0)&&(0,F.warn)("Invalid font matrix for font "+ge),ue<0?(ue=-ue,ve.fontDirection=-1):ve.fontDirection=1,this.current.font=xe,this.current.fontSize=ue,xe.isType3Font)return;const le=xe.loadedName||"sans-serif";let me="normal";xe.black?me="900":xe.bold&&(me="bold");const Ce=xe.italic?"italic":"normal",Se=`"${le}", ${xe.fallbackName}`;let Re=ue;ue<se?Re=se:ue>ne&&(Re=ne),this.current.fontSizeScale=ue/Re,this.ctx.font=`${Ce} ${me} ${Re}px ${Se}`}setTextRenderingMode(ge){this.current.textRenderingMode=ge}setTextRise(ge){this.current.textRise=ge}moveText(ge,ue){this.current.x=this.current.lineX+=ge,this.current.y=this.current.lineY+=ue}setLeadingMoveText(ge,ue){this.setLeading(-ue),this.moveText(ge,ue)}setTextMatrix(ge,ue,xe,ve,le,me){this.current.textMatrix=[ge,ue,xe,ve,le,me],this.current.textMatrixScale=Math.hypot(ge,ue),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ge,ue,xe,ve){const le=this.ctx,me=this.current,Ce=me.font,Se=me.textRenderingMode,Re=me.fontSize/me.fontSizeScale,ke=Se&F.TextRenderingMode.FILL_STROKE_MASK,De=!!(Se&F.TextRenderingMode.ADD_TO_PATH_FLAG),Ne=me.patternFill&&!Ce.missingFile;let Ge;(Ce.disableFontFace||De||Ne)&&(Ge=Ce.getPathGenerator(this.commonObjs,ge)),Ce.disableFontFace||Ne?(le.save(),le.translate(ue,xe),le.beginPath(),Ge(le,Re),ve&&le.setTransform(...ve),(ke===F.TextRenderingMode.FILL||ke===F.TextRenderingMode.FILL_STROKE)&&le.fill(),(ke===F.TextRenderingMode.STROKE||ke===F.TextRenderingMode.FILL_STROKE)&&le.stroke(),le.restore()):((ke===F.TextRenderingMode.FILL||ke===F.TextRenderingMode.FILL_STROKE)&&le.fillText(ge,ue,xe),(ke===F.TextRenderingMode.STROKE||ke===F.TextRenderingMode.FILL_STROKE)&&le.strokeText(ge,ue,xe)),De&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,$.getCurrentTransform)(le),x:ue,y:xe,fontSize:Re,addToPath:Ge})}get isFontSubpixelAAEnabled(){const{context:ge}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ge.scale(1.5,1),ge.fillText("I",0,10);const ue=ge.getImageData(0,0,10,10).data;let xe=!1;for(let ve=3;ve<ue.length;ve+=4)if(ue[ve]>0&&ue[ve]<255){xe=!0;break}return(0,F.shadow)(this,"isFontSubpixelAAEnabled",xe)}showText(ge){const ue=this.current,xe=ue.font;if(xe.isType3Font)return this.showType3Text(ge);const ve=ue.fontSize;if(ve===0)return;const le=this.ctx,me=ue.fontSizeScale,Ce=ue.charSpacing,Se=ue.wordSpacing,Re=ue.fontDirection,ke=ue.textHScale*Re,De=ge.length,Ne=xe.vertical,Ge=Ne?1:-1,Le=xe.defaultVMetrics,ze=ve*ue.fontMatrix[0],Ve=ue.textRenderingMode===F.TextRenderingMode.FILL&&!xe.disableFontFace&&!ue.patternFill;le.save(),le.transform(...ue.textMatrix),le.translate(ue.x,ue.y+ue.textRise),Re>0?le.scale(ke,-1):le.scale(ke,1);let je;if(ue.patternFill){le.save();const tt=ue.fillColor.getPattern(le,this,(0,$.getCurrentTransformInverse)(le),Y.PathType.FILL);je=(0,$.getCurrentTransform)(le),le.restore(),le.fillStyle=tt}let Ke=ue.lineWidth;const Ye=ue.textMatrixScale;if(Ye===0||Ke===0){const tt=ue.textRenderingMode&F.TextRenderingMode.FILL_STROKE_MASK;(tt===F.TextRenderingMode.STROKE||tt===F.TextRenderingMode.FILL_STROKE)&&(Ke=this.getSinglePixelWidth())}else Ke/=Ye;if(me!==1&&(le.scale(me,me),Ke/=me),le.lineWidth=Ke,xe.isInvalidPDFjsFont){const tt=[];let nt=0;for(const et of ge)tt.push(et.unicode),nt+=et.width;le.fillText(tt.join(""),0,0),ue.x+=nt*ze*ke,le.restore(),this.compose();return}let Ze=0,Je;for(Je=0;Je<De;++Je){const tt=ge[Je];if(typeof tt=="number"){Ze+=Ge*tt*ve/1e3;continue}let nt=!1;const et=(tt.isSpace?Se:0)+Ce,it=tt.fontChar,lt=tt.accent;let rt,gt,ot=tt.width;if(Ne){const ht=tt.vmetric||Le,pt=-(tt.vmetric?ht[1]:ot*.5)*ze,wt=ht[2]*ze;ot=ht?-ht[0]:ot,rt=pt/me,gt=(Ze+wt)/me}else rt=Ze/me,gt=0;if(xe.remeasure&&ot>0){const ht=le.measureText(it).width*1e3/ve*me;if(ot<ht&&this.isFontSubpixelAAEnabled){const pt=ot/ht;nt=!0,le.save(),le.scale(pt,1),rt/=pt}else ot!==ht&&(rt+=(ot-ht)/2e3*ve/me)}if(this.contentVisible&&(tt.isInFont||xe.missingFile)){if(Ve&&!lt)le.fillText(it,rt,gt);else if(this.paintChar(it,rt,gt,je),lt){const ht=rt+ve*lt.offset.x/me,pt=gt-ve*lt.offset.y/me;this.paintChar(lt.fontChar,ht,pt,je)}}let mt;Ne?mt=ot*ze-et*Re:mt=ot*ze+et*Re,Ze+=mt,nt&&le.restore()}Ne?ue.y-=Ze:ue.x+=Ze*ke,le.restore(),this.compose()}showType3Text(ge){const ue=this.ctx,xe=this.current,ve=xe.font,le=xe.fontSize,me=xe.fontDirection,Ce=ve.vertical?1:-1,Se=xe.charSpacing,Re=xe.wordSpacing,ke=xe.textHScale*me,De=xe.fontMatrix||F.FONT_IDENTITY_MATRIX,Ne=ge.length,Ge=xe.textRenderingMode===F.TextRenderingMode.INVISIBLE;let Le,ze,Ve,je;if(!(Ge||le===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,ue.save(),ue.transform(...xe.textMatrix),ue.translate(xe.x,xe.y),ue.scale(ke,me),Le=0;Le<Ne;++Le){if(ze=ge[Le],typeof ze=="number"){je=Ce*ze*le/1e3,this.ctx.translate(je,0),xe.x+=je*ke;continue}const Ke=(ze.isSpace?Re:0)+Se,Ye=ve.charProcOperatorList[ze.operatorListId];if(!Ye){(0,F.warn)(`Type3 character "${ze.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ze,this.save(),ue.scale(le,le),ue.transform(...De),this.executeOperatorList(Ye),this.restore()),Ve=F.Util.applyTransform([ze.width,0],De)[0]*le+Ke,ue.translate(Ve,0),xe.x+=Ve*ke}ue.restore(),this.processingType3=null}}setCharWidth(ge,ue){}setCharWidthAndBounds(ge,ue,xe,ve,le,me){this.ctx.rect(xe,ve,le-xe,me-ve),this.ctx.clip(),this.endPath()}getColorN_Pattern(ge){let ue;if(ge[0]==="TilingPattern"){const xe=ge[1],ve=this.baseTransform||(0,$.getCurrentTransform)(this.ctx),le={createCanvasGraphics:me=>new Oe(me,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};ue=new Y.TilingPattern(ge,xe,this.ctx,le,ve)}else ue=this._getPattern(ge[1],ge[2]);return ue}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ge,ue,xe){const ve=F.Util.makeHexColor(ge,ue,xe);this.ctx.strokeStyle=ve,this.current.strokeColor=ve}setFillRGBColor(ge,ue,xe){const ve=F.Util.makeHexColor(ge,ue,xe);this.ctx.fillStyle=ve,this.current.fillColor=ve,this.current.patternFill=!1}_getPattern(ge,ue=null){let xe;return this.cachedPatterns.has(ge)?xe=this.cachedPatterns.get(ge):(xe=(0,Y.getShadingPattern)(this.getObject(ge)),this.cachedPatterns.set(ge,xe)),ue&&(xe.matrix=ue),xe}shadingFill(ge){if(!this.contentVisible)return;const ue=this.ctx;this.save();const xe=this._getPattern(ge);ue.fillStyle=xe.getPattern(ue,this,(0,$.getCurrentTransformInverse)(ue),Y.PathType.SHADING);const ve=(0,$.getCurrentTransformInverse)(ue);if(ve){const le=ue.canvas,me=le.width,Ce=le.height,Se=F.Util.applyTransform([0,0],ve),Re=F.Util.applyTransform([0,Ce],ve),ke=F.Util.applyTransform([me,0],ve),De=F.Util.applyTransform([me,Ce],ve),Ne=Math.min(Se[0],Re[0],ke[0],De[0]),Ge=Math.min(Se[1],Re[1],ke[1],De[1]),Le=Math.max(Se[0],Re[0],ke[0],De[0]),ze=Math.max(Se[1],Re[1],ke[1],De[1]);this.ctx.fillRect(Ne,Ge,Le-Ne,ze-Ge)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,F.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,F.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ge,ue){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ge)&&ge.length===6&&this.transform(...ge),this.baseTransform=(0,$.getCurrentTransform)(this.ctx),ue)){const xe=ue[2]-ue[0],ve=ue[3]-ue[1];this.ctx.rect(ue[0],ue[1],xe,ve),this.current.updateRectMinMax((0,$.getCurrentTransform)(this.ctx),ue),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ge){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const ue=this.ctx;ge.isolated||(0,F.info)("TODO: Support non-isolated groups."),ge.knockout&&(0,F.warn)("Knockout groups not supported.");const xe=(0,$.getCurrentTransform)(ue);if(ge.matrix&&ue.transform(...ge.matrix),!ge.bbox)throw new Error("Bounding box is required.");let ve=F.Util.getAxialAlignedBoundingBox(ge.bbox,(0,$.getCurrentTransform)(ue));const le=[0,0,ue.canvas.width,ue.canvas.height];ve=F.Util.intersect(ve,le)||[0,0,0,0];const me=Math.floor(ve[0]),Ce=Math.floor(ve[1]);let Se=Math.max(Math.ceil(ve[2])-me,1),Re=Math.max(Math.ceil(ve[3])-Ce,1),ke=1,De=1;Se>ee&&(ke=Se/ee,Se=ee),Re>ee&&(De=Re/ee,Re=ee),this.current.startNewPathAndClipBox([0,0,Se,Re]);let Ne="groupAt"+this.groupLevel;ge.smask&&(Ne+="_smask_"+this.smaskCounter++%2);const Ge=this.cachedCanvases.getCanvas(Ne,Se,Re),Le=Ge.context;Le.scale(1/ke,1/De),Le.translate(-me,-Ce),Le.transform(...xe),ge.smask?this.smaskStack.push({canvas:Ge.canvas,context:Le,offsetX:me,offsetY:Ce,scaleX:ke,scaleY:De,subtype:ge.smask.subtype,backdrop:ge.smask.backdrop,transferMap:ge.smask.transferMap||null,startTransformInverse:null}):(ue.setTransform(1,0,0,1,0,0),ue.translate(me,Ce),ue.scale(ke,De),ue.save()),Ee(ue,Le),this.ctx=Le,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(ue),this.groupLevel++}endGroup(ge){if(!this.contentVisible)return;this.groupLevel--;const ue=this.ctx,xe=this.groupStack.pop();if(this.ctx=xe,this.ctx.imageSmoothingEnabled=!1,ge.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const ve=(0,$.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...ve);const le=F.Util.getAxialAlignedBoundingBox([0,0,ue.canvas.width,ue.canvas.height],ve);this.ctx.drawImage(ue.canvas,0,0),this.ctx.restore(),this.compose(le)}}beginAnnotation(ge,ue,xe,ve,le){if(this.#e(),be(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(ue)&&ue.length===4){const me=ue[2]-ue[0],Ce=ue[3]-ue[1];if(le&&this.annotationCanvasMap){xe=xe.slice(),xe[4]-=ue[0],xe[5]-=ue[1],ue=ue.slice(),ue[0]=ue[1]=0,ue[2]=me,ue[3]=Ce;const[Se,Re]=F.Util.singularValueDecompose2dScale((0,$.getCurrentTransform)(this.ctx)),{viewportScale:ke}=this,De=Math.ceil(me*this.outputScaleX*ke),Ne=Math.ceil(Ce*this.outputScaleY*ke);this.annotationCanvas=this.canvasFactory.create(De,Ne);const{canvas:Ge,context:Le}=this.annotationCanvas;this.annotationCanvasMap.set(ge,Ge),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Le,this.ctx.save(),this.ctx.setTransform(Se,0,0,-Re,0,Ce*Re),be(this.ctx)}else be(this.ctx),this.ctx.rect(ue[0],ue[1],me,Ce),this.ctx.clip(),this.endPath()}this.current=new fe(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...xe),this.transform(...ve)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ge){if(!this.contentVisible)return;const ue=ge.count;ge=this.getObject(ge.data,ge),ge.count=ue;const xe=this.ctx,ve=this.processingType3;if(ve&&(ve.compiled===void 0&&(ve.compiled=pe(ge)),ve.compiled)){ve.compiled(xe);return}const le=this._createMaskCanvas(ge),me=le.canvas;xe.save(),xe.setTransform(1,0,0,1,0,0),xe.drawImage(me,le.offsetX,le.offsetY),xe.restore(),this.compose()}paintImageMaskXObjectRepeat(ge,ue,xe=0,ve=0,le,me){if(!this.contentVisible)return;ge=this.getObject(ge.data,ge);const Ce=this.ctx;Ce.save();const Se=(0,$.getCurrentTransform)(Ce);Ce.transform(ue,xe,ve,le,0,0);const Re=this._createMaskCanvas(ge);Ce.setTransform(1,0,0,1,Re.offsetX-Se[4],Re.offsetY-Se[5]);for(let ke=0,De=me.length;ke<De;ke+=2){const Ne=F.Util.transform(Se,[ue,xe,ve,le,me[ke],me[ke+1]]),[Ge,Le]=F.Util.applyTransform([0,0],Ne);Ce.drawImage(Re.canvas,Ge,Le)}Ce.restore(),this.compose()}paintImageMaskXObjectGroup(ge){if(!this.contentVisible)return;const ue=this.ctx,xe=this.current.fillColor,ve=this.current.patternFill;for(const le of ge){const{data:me,width:Ce,height:Se,transform:Re}=le,ke=this.cachedCanvases.getCanvas("maskCanvas",Ce,Se),De=ke.context;De.save();const Ne=this.getObject(me,le);_e(De,Ne),De.globalCompositeOperation="source-in",De.fillStyle=ve?xe.getPattern(De,this,(0,$.getCurrentTransformInverse)(ue),Y.PathType.FILL):xe,De.fillRect(0,0,Ce,Se),De.restore(),ue.save(),ue.transform(...Re),ue.scale(1,-1),de(ue,ke.canvas,0,0,Ce,Se,0,-1,1,1),ue.restore()}this.compose()}paintImageXObject(ge){if(!this.contentVisible)return;const ue=this.getObject(ge);if(!ue){(0,F.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(ue)}paintImageXObjectRepeat(ge,ue,xe,ve){if(!this.contentVisible)return;const le=this.getObject(ge);if(!le){(0,F.warn)("Dependent image isn't ready yet");return}const me=le.width,Ce=le.height,Se=[];for(let Re=0,ke=ve.length;Re<ke;Re+=2)Se.push({transform:[ue,0,0,xe,ve[Re],ve[Re+1]],x:0,y:0,w:me,h:Ce});this.paintInlineImageXObjectGroup(le,Se)}applyTransferMapsToCanvas(ge){return this.current.transferMaps!=="none"&&(ge.filter=this.current.transferMaps,ge.drawImage(ge.canvas,0,0),ge.filter="none"),ge.canvas}applyTransferMapsToBitmap(ge){if(this.current.transferMaps==="none")return ge.bitmap;const{bitmap:ue,width:xe,height:ve}=ge,le=this.cachedCanvases.getCanvas("inlineImage",xe,ve),me=le.context;return me.filter=this.current.transferMaps,me.drawImage(ue,0,0),me.filter="none",le.canvas}paintInlineImageXObject(ge){if(!this.contentVisible)return;const ue=ge.width,xe=ge.height,ve=this.ctx;this.save(),te.isNodeJS||(ve.filter="none"),ve.scale(1/ue,-1/xe);let le;if(ge.bitmap)le=this.applyTransferMapsToBitmap(ge);else if(typeof HTMLElement=="function"&&ge instanceof HTMLElement||!ge.data)le=ge;else{const Se=this.cachedCanvases.getCanvas("inlineImage",ue,xe).context;ye(Se,ge),le=this.applyTransferMapsToCanvas(Se)}const me=this._scaleImage(le,(0,$.getCurrentTransformInverse)(ve));ve.imageSmoothingEnabled=$e((0,$.getCurrentTransform)(ve),ge.interpolate),de(ve,me.img,0,0,me.paintWidth,me.paintHeight,0,-xe,ue,xe),this.compose(),this.restore()}paintInlineImageXObjectGroup(ge,ue){if(!this.contentVisible)return;const xe=this.ctx;let ve;if(ge.bitmap)ve=ge.bitmap;else{const le=ge.width,me=ge.height,Se=this.cachedCanvases.getCanvas("inlineImage",le,me).context;ye(Se,ge),ve=this.applyTransferMapsToCanvas(Se)}for(const le of ue)xe.save(),xe.transform(...le.transform),xe.scale(1,-1),de(xe,ve,le.x,le.y,le.w,le.h,0,-1,1,1),xe.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ge){}markPointProps(ge,ue){}beginMarkedContent(ge){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ge,ue){ge==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(ue)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ge){const ue=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ge);const xe=this.ctx;this.pendingClip&&(ue||(this.pendingClip===Ie?xe.clip("evenodd"):xe.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),xe.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ge=(0,$.getCurrentTransform)(this.ctx);if(ge[1]===0&&ge[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ge[0]),Math.abs(ge[3]));else{const ue=Math.abs(ge[0]*ge[3]-ge[2]*ge[1]),xe=Math.hypot(ge[0],ge[2]),ve=Math.hypot(ge[1],ge[3]);this._cachedGetSinglePixelWidth=Math.max(xe,ve)/ue}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:ge}=this.current,ue=(0,$.getCurrentTransform)(this.ctx);let xe,ve;if(ue[1]===0&&ue[2]===0){const le=Math.abs(ue[0]),me=Math.abs(ue[3]);if(ge===0)xe=1/le,ve=1/me;else{const Ce=le*ge,Se=me*ge;xe=Ce<1?1/Ce:1,ve=Se<1?1/Se:1}}else{const le=Math.abs(ue[0]*ue[3]-ue[2]*ue[1]),me=Math.hypot(ue[0],ue[1]),Ce=Math.hypot(ue[2],ue[3]);if(ge===0)xe=Ce/le,ve=me/le;else{const Se=ge*le;xe=Ce>Se?Ce/Se:1,ve=me>Se?me/Se:1}}this._cachedScaleForStroking=[xe,ve]}return this._cachedScaleForStroking}rescaleAndStroke(ge){const{ctx:ue}=this,{lineWidth:xe}=this.current,[ve,le]=this.getScaleForStroking();if(ue.lineWidth=xe||1,ve===1&&le===1){ue.stroke();return}let me,Ce,Se;ge&&(me=(0,$.getCurrentTransform)(ue),Ce=ue.getLineDash().slice(),Se=ue.lineDashOffset),ue.scale(ve,le);const Re=Math.max(ve,le);ue.setLineDash(ue.getLineDash().map(ke=>ke/Re)),ue.lineDashOffset/=Re,ue.stroke(),ge&&(ue.setTransform(...me),ue.setLineDash(Ce),ue.lineDashOffset=Se)}isContentVisible(){for(let ge=this.markedContentStack.length-1;ge>=0;ge--)if(!this.markedContentStack[ge].visible)return!1;return!0}}e.CanvasGraphics=Oe;for(const Pe in F.OPS)Oe.prototype[Pe]!==void 0&&(Oe.prototype[F.OPS[Pe]]=Oe.prototype[Pe])},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=re;var F=C(1),$=C(6);const Y={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=Y;function V(he,de){if(!de)return;const pe=de[2]-de[0],fe=de[3]-de[1],ye=new Path2D;ye.rect(de[0],de[1],pe,fe),he.clip(ye)}class te{constructor(){this.constructor===te&&(0,F.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,F.unreachable)("Abstract method `getPattern` called.")}}class se extends te{constructor(de){super(),this._type=de[1],this._bbox=de[2],this._colorStops=de[3],this._p0=de[4],this._p1=de[5],this._r0=de[6],this._r1=de[7],this.matrix=null}_createGradient(de){let pe;this._type==="axial"?pe=de.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(pe=de.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const fe of this._colorStops)pe.addColorStop(fe[0],fe[1]);return pe}getPattern(de,pe,fe,ye){let _e;if(ye===Y.STROKE||ye===Y.FILL){const Ee=pe.current.getClippedPathBoundingBox(ye,(0,$.getCurrentTransform)(de))||[0,0,0,0],be=Math.ceil(Ee[2]-Ee[0])||1,Ae=Math.ceil(Ee[3]-Ee[1])||1,we=pe.cachedCanvases.getCanvas("pattern",be,Ae,!0),Te=we.context;Te.clearRect(0,0,Te.canvas.width,Te.canvas.height),Te.beginPath(),Te.rect(0,0,Te.canvas.width,Te.canvas.height),Te.translate(-Ee[0],-Ee[1]),fe=F.Util.transform(fe,[1,0,0,1,Ee[0],Ee[1]]),Te.transform(...pe.baseTransform),this.matrix&&Te.transform(...this.matrix),V(Te,this._bbox),Te.fillStyle=this._createGradient(Te),Te.fill(),_e=de.createPattern(we.canvas,"no-repeat");const Me=new DOMMatrix(fe);_e.setTransform(Me)}else V(de,this._bbox),_e=this._createGradient(de);return _e}}function ne(he,de,pe,fe,ye,_e,Ee,be){const Ae=de.coords,we=de.colors,Te=he.data,Me=he.width*4;let Be;Ae[pe+1]>Ae[fe+1]&&(Be=pe,pe=fe,fe=Be,Be=_e,_e=Ee,Ee=Be),Ae[fe+1]>Ae[ye+1]&&(Be=fe,fe=ye,ye=Be,Be=Ee,Ee=be,be=Be),Ae[pe+1]>Ae[fe+1]&&(Be=pe,pe=fe,fe=Be,Be=_e,_e=Ee,Ee=Be);const $e=(Ae[pe]+de.offsetX)*de.scaleX,Fe=(Ae[pe+1]+de.offsetY)*de.scaleY,Xe=(Ae[fe]+de.offsetX)*de.scaleX,We=(Ae[fe+1]+de.offsetY)*de.scaleY,Ie=(Ae[ye]+de.offsetX)*de.scaleX,Oe=(Ae[ye+1]+de.offsetY)*de.scaleY;if(Fe>=Oe)return;const Pe=we[_e],ge=we[_e+1],ue=we[_e+2],xe=we[Ee],ve=we[Ee+1],le=we[Ee+2],me=we[be],Ce=we[be+1],Se=we[be+2],Re=Math.round(Fe),ke=Math.round(Oe);let De,Ne,Ge,Le,ze,Ve,je,Ke;for(let Ye=Re;Ye<=ke;Ye++){if(Ye<We){let et;Ye<Fe?et=0:et=(Fe-Ye)/(Fe-We),De=$e-($e-Xe)*et,Ne=Pe-(Pe-xe)*et,Ge=ge-(ge-ve)*et,Le=ue-(ue-le)*et}else{let et;Ye>Oe?et=1:We===Oe?et=0:et=(We-Ye)/(We-Oe),De=Xe-(Xe-Ie)*et,Ne=xe-(xe-me)*et,Ge=ve-(ve-Ce)*et,Le=le-(le-Se)*et}let Ze;Ye<Fe?Ze=0:Ye>Oe?Ze=1:Ze=(Fe-Ye)/(Fe-Oe),ze=$e-($e-Ie)*Ze,Ve=Pe-(Pe-me)*Ze,je=ge-(ge-Ce)*Ze,Ke=ue-(ue-Se)*Ze;const Je=Math.round(Math.min(De,ze)),tt=Math.round(Math.max(De,ze));let nt=Me*Ye+Je*4;for(let et=Je;et<=tt;et++)Ze=(De-et)/(De-ze),Ze<0?Ze=0:Ze>1&&(Ze=1),Te[nt++]=Ne-(Ne-Ve)*Ze|0,Te[nt++]=Ge-(Ge-je)*Ze|0,Te[nt++]=Le-(Le-Ke)*Ze|0,Te[nt++]=255}}function ee(he,de,pe){const fe=de.coords,ye=de.colors;let _e,Ee;switch(de.type){case"lattice":const be=de.verticesPerRow,Ae=Math.floor(fe.length/be)-1,we=be-1;for(_e=0;_e<Ae;_e++){let Te=_e*be;for(let Me=0;Me<we;Me++,Te++)ne(he,pe,fe[Te],fe[Te+1],fe[Te+be],ye[Te],ye[Te+1],ye[Te+be]),ne(he,pe,fe[Te+be+1],fe[Te+1],fe[Te+be],ye[Te+be+1],ye[Te+1],ye[Te+be])}break;case"triangles":for(_e=0,Ee=fe.length;_e<Ee;_e+=3)ne(he,pe,fe[_e],fe[_e+1],fe[_e+2],ye[_e],ye[_e+1],ye[_e+2]);break;default:throw new Error("illegal figure")}}class ie extends te{constructor(de){super(),this._coords=de[2],this._colors=de[3],this._figures=de[4],this._bounds=de[5],this._bbox=de[7],this._background=de[8],this.matrix=null}_createMeshCanvas(de,pe,fe){const be=Math.floor(this._bounds[0]),Ae=Math.floor(this._bounds[1]),we=Math.ceil(this._bounds[2])-be,Te=Math.ceil(this._bounds[3])-Ae,Me=Math.min(Math.ceil(Math.abs(we*de[0]*1.1)),3e3),Be=Math.min(Math.ceil(Math.abs(Te*de[1]*1.1)),3e3),$e=we/Me,Fe=Te/Be,Xe={coords:this._coords,colors:this._colors,offsetX:-be,offsetY:-Ae,scaleX:1/$e,scaleY:1/Fe},We=Me+2*2,Ie=Be+2*2,Oe=fe.getCanvas("mesh",We,Ie,!1),Pe=Oe.context,ge=Pe.createImageData(Me,Be);if(pe){const xe=ge.data;for(let ve=0,le=xe.length;ve<le;ve+=4)xe[ve]=pe[0],xe[ve+1]=pe[1],xe[ve+2]=pe[2],xe[ve+3]=255}for(const xe of this._figures)ee(ge,xe,Xe);return Pe.putImageData(ge,2,2),{canvas:Oe.canvas,offsetX:be-2*$e,offsetY:Ae-2*Fe,scaleX:$e,scaleY:Fe}}getPattern(de,pe,fe,ye){V(de,this._bbox);let _e;if(ye===Y.SHADING)_e=F.Util.singularValueDecompose2dScale((0,$.getCurrentTransform)(de));else if(_e=F.Util.singularValueDecompose2dScale(pe.baseTransform),this.matrix){const be=F.Util.singularValueDecompose2dScale(this.matrix);_e=[_e[0]*be[0],_e[1]*be[1]]}const Ee=this._createMeshCanvas(_e,ye===Y.SHADING?null:this._background,pe.cachedCanvases);return ye!==Y.SHADING&&(de.setTransform(...pe.baseTransform),this.matrix&&de.transform(...this.matrix)),de.translate(Ee.offsetX,Ee.offsetY),de.scale(Ee.scaleX,Ee.scaleY),de.createPattern(Ee.canvas,"no-repeat")}}class ae extends te{getPattern(){return"hotpink"}}function re(he){switch(he[0]){case"RadialAxial":return new se(he);case"Mesh":return new ie(he);case"Dummy":return new ae}throw new Error(`Unknown IR type: ${he[0]}`)}const oe={COLORED:1,UNCOLORED:2};class ce{static MAX_PATTERN_SIZE=3e3;constructor(de,pe,fe,ye,_e){this.operatorList=de[2],this.matrix=de[3]||[1,0,0,1,0,0],this.bbox=de[4],this.xstep=de[5],this.ystep=de[6],this.paintType=de[7],this.tilingType=de[8],this.color=pe,this.ctx=fe,this.canvasGraphicsFactory=ye,this.baseTransform=_e}createPatternCanvas(de){const pe=this.operatorList,fe=this.bbox,ye=this.xstep,_e=this.ystep,Ee=this.paintType,be=this.tilingType,Ae=this.color,we=this.canvasGraphicsFactory;(0,F.info)("TilingType: "+be);const Te=fe[0],Me=fe[1],Be=fe[2],$e=fe[3],Fe=F.Util.singularValueDecompose2dScale(this.matrix),Xe=F.Util.singularValueDecompose2dScale(this.baseTransform),We=[Fe[0]*Xe[0],Fe[1]*Xe[1]],Ie=this.getSizeAndScale(ye,this.ctx.canvas.width,We[0]),Oe=this.getSizeAndScale(_e,this.ctx.canvas.height,We[1]),Pe=de.cachedCanvases.getCanvas("pattern",Ie.size,Oe.size,!0),ge=Pe.context,ue=we.createCanvasGraphics(ge);ue.groupLevel=de.groupLevel,this.setFillAndStrokeStyleToContext(ue,Ee,Ae);let xe=Te,ve=Me,le=Be,me=$e;return Te<0&&(xe=0,le+=Math.abs(Te)),Me<0&&(ve=0,me+=Math.abs(Me)),ge.translate(-(Ie.scale*xe),-(Oe.scale*ve)),ue.transform(Ie.scale,0,0,Oe.scale,0,0),ge.save(),this.clipBbox(ue,xe,ve,le,me),ue.baseTransform=(0,$.getCurrentTransform)(ue.ctx),ue.executeOperatorList(pe),ue.endDrawing(),{canvas:Pe.canvas,scaleX:Ie.scale,scaleY:Oe.scale,offsetX:xe,offsetY:ve}}getSizeAndScale(de,pe,fe){de=Math.abs(de);const ye=Math.max(ce.MAX_PATTERN_SIZE,pe);let _e=Math.ceil(de*fe);return _e>=ye?_e=ye:fe=_e/de,{scale:fe,size:_e}}clipBbox(de,pe,fe,ye,_e){const Ee=ye-pe,be=_e-fe;de.ctx.rect(pe,fe,Ee,be),de.current.updateRectMinMax((0,$.getCurrentTransform)(de.ctx),[pe,fe,ye,_e]),de.clip(),de.endPath()}setFillAndStrokeStyleToContext(de,pe,fe){const ye=de.ctx,_e=de.current;switch(pe){case oe.COLORED:const Ee=this.ctx;ye.fillStyle=Ee.fillStyle,ye.strokeStyle=Ee.strokeStyle,_e.fillColor=Ee.fillStyle,_e.strokeColor=Ee.strokeStyle;break;case oe.UNCOLORED:const be=F.Util.makeHexColor(fe[0],fe[1],fe[2]);ye.fillStyle=be,ye.strokeStyle=be,_e.fillColor=be,_e.strokeColor=be;break;default:throw new F.FormatError(`Unsupported paint type: ${pe}`)}}getPattern(de,pe,fe,ye){let _e=fe;ye!==Y.SHADING&&(_e=F.Util.transform(_e,pe.baseTransform),this.matrix&&(_e=F.Util.transform(_e,this.matrix)));const Ee=this.createPatternCanvas(pe);let be=new DOMMatrix(_e);be=be.translate(Ee.offsetX,Ee.offsetY),be=be.scale(1/Ee.scaleX,1/Ee.scaleY);const Ae=de.createPattern(Ee.canvas,"repeat");return Ae.setTransform(be),Ae}}e.TilingPattern=ce},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=Y,e.convertToRGBA=$,e.grayToRGBA=te;var F=C(1);function $(se){switch(se.kind){case F.ImageKind.GRAYSCALE_1BPP:return Y(se);case F.ImageKind.RGB_24BPP:return V(se)}return null}function Y({src:se,srcPos:ne=0,dest:ee,width:ie,height:ae,nonBlackColor:re=4294967295,inverseDecode:oe=!1}){const ce=F.FeatureTest.isLittleEndian?4278190080:255,[he,de]=oe?[re,ce]:[ce,re],pe=ie>>3,fe=ie&7,ye=se.length;ee=new Uint32Array(ee.buffer);let _e=0;for(let Ee=0;Ee<ae;Ee++){for(const Ae=ne+pe;ne<Ae;ne++){const we=ne<ye?se[ne]:255;ee[_e++]=we&128?de:he,ee[_e++]=we&64?de:he,ee[_e++]=we&32?de:he,ee[_e++]=we&16?de:he,ee[_e++]=we&8?de:he,ee[_e++]=we&4?de:he,ee[_e++]=we&2?de:he,ee[_e++]=we&1?de:he}if(fe===0)continue;const be=ne<ye?se[ne++]:255;for(let Ae=0;Ae<fe;Ae++)ee[_e++]=be&1<<7-Ae?de:he}return{srcPos:ne,destPos:_e}}function V({src:se,srcPos:ne=0,dest:ee,destPos:ie=0,width:ae,height:re}){let oe=0;const ce=se.length>>2,he=new Uint32Array(se.buffer,ne,ce);if(F.FeatureTest.isLittleEndian){for(;oe<ce-2;oe+=3,ie+=4){const de=he[oe],pe=he[oe+1],fe=he[oe+2];ee[ie]=de|4278190080,ee[ie+1]=de>>>24|pe<<8|4278190080,ee[ie+2]=pe>>>16|fe<<16|4278190080,ee[ie+3]=fe>>>8|4278190080}for(let de=oe*4,pe=se.length;de<pe;de+=3)ee[ie++]=se[de]|se[de+1]<<8|se[de+2]<<16|4278190080}else{for(;oe<ce-2;oe+=3,ie+=4){const de=he[oe],pe=he[oe+1],fe=he[oe+2];ee[ie]=de|255,ee[ie+1]=de<<24|pe>>>8|255,ee[ie+2]=pe<<16|fe>>>16|255,ee[ie+3]=fe<<8|255}for(let de=oe*4,pe=se.length;de<pe;de+=3)ee[ie++]=se[de]<<24|se[de+1]<<16|se[de+2]<<8|255}return{srcPos:ne,destPos:ie}}function te(se,ne){if(F.FeatureTest.isLittleEndian)for(let ee=0,ie=se.length;ee<ie;ee++)ne[ee]=se[ee]*65793|4278190080;else for(let ee=0,ie=se.length;ee<ie;ee++)ne[ee]=se[ee]*16843008|255}},(J,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const C=Object.create(null);e.GlobalWorkerOptions=C,C.workerPort=null,C.workerSrc=""},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var F=C(1);const $={UNKNOWN:0,DATA:1,ERROR:2},Y={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function V(se){switch(se instanceof Error||typeof se=="object"&&se!==null||(0,F.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),se.name){case"AbortException":return new F.AbortException(se.message);case"MissingPDFException":return new F.MissingPDFException(se.message);case"PasswordException":return new F.PasswordException(se.message,se.code);case"UnexpectedResponseException":return new F.UnexpectedResponseException(se.message,se.status);case"UnknownErrorException":return new F.UnknownErrorException(se.message,se.details);default:return new F.UnknownErrorException(se.message,se.toString())}}class te{constructor(ne,ee,ie){this.sourceName=ne,this.targetName=ee,this.comObj=ie,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=ae=>{const re=ae.data;if(re.targetName!==this.sourceName)return;if(re.stream){this.#t(re);return}if(re.callback){const ce=re.callbackId,he=this.callbackCapabilities[ce];if(!he)throw new Error(`Cannot resolve callback ${ce}`);if(delete this.callbackCapabilities[ce],re.callback===$.DATA)he.resolve(re.data);else if(re.callback===$.ERROR)he.reject(V(re.reason));else throw new Error("Unexpected callback case");return}const oe=this.actionHandler[re.action];if(!oe)throw new Error(`Unknown action from worker: ${re.action}`);if(re.callbackId){const ce=this.sourceName,he=re.sourceName;new Promise(function(de){de(oe(re.data))}).then(function(de){ie.postMessage({sourceName:ce,targetName:he,callback:$.DATA,callbackId:re.callbackId,data:de})},function(de){ie.postMessage({sourceName:ce,targetName:he,callback:$.ERROR,callbackId:re.callbackId,reason:V(de)})});return}if(re.streamId){this.#e(re);return}oe(re.data)},ie.addEventListener("message",this._onComObjOnMessage)}on(ne,ee){const ie=this.actionHandler;if(ie[ne])throw new Error(`There is already an actionName called "${ne}"`);ie[ne]=ee}send(ne,ee,ie){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:ne,data:ee},ie)}sendWithPromise(ne,ee,ie){const ae=this.callbackId++,re=new F.PromiseCapability;this.callbackCapabilities[ae]=re;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:ne,callbackId:ae,data:ee},ie)}catch(oe){re.reject(oe)}return re.promise}sendWithStream(ne,ee,ie,ae){const re=this.streamId++,oe=this.sourceName,ce=this.targetName,he=this.comObj;return new ReadableStream({start:de=>{const pe=new F.PromiseCapability;return this.streamControllers[re]={controller:de,startCall:pe,pullCall:null,cancelCall:null,isClosed:!1},he.postMessage({sourceName:oe,targetName:ce,action:ne,streamId:re,data:ee,desiredSize:de.desiredSize},ae),pe.promise},pull:de=>{const pe=new F.PromiseCapability;return this.streamControllers[re].pullCall=pe,he.postMessage({sourceName:oe,targetName:ce,stream:Y.PULL,streamId:re,desiredSize:de.desiredSize}),pe.promise},cancel:de=>{(0,F.assert)(de instanceof Error,"cancel must have a valid reason");const pe=new F.PromiseCapability;return this.streamControllers[re].cancelCall=pe,this.streamControllers[re].isClosed=!0,he.postMessage({sourceName:oe,targetName:ce,stream:Y.CANCEL,streamId:re,reason:V(de)}),pe.promise}},ie)}#e(ne){const ee=ne.streamId,ie=this.sourceName,ae=ne.sourceName,re=this.comObj,oe=this,ce=this.actionHandler[ne.action],he={enqueue(de,pe=1,fe){if(this.isCancelled)return;const ye=this.desiredSize;this.desiredSize-=pe,ye>0&&this.desiredSize<=0&&(this.sinkCapability=new F.PromiseCapability,this.ready=this.sinkCapability.promise),re.postMessage({sourceName:ie,targetName:ae,stream:Y.ENQUEUE,streamId:ee,chunk:de},fe)},close(){this.isCancelled||(this.isCancelled=!0,re.postMessage({sourceName:ie,targetName:ae,stream:Y.CLOSE,streamId:ee}),delete oe.streamSinks[ee])},error(de){(0,F.assert)(de instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,re.postMessage({sourceName:ie,targetName:ae,stream:Y.ERROR,streamId:ee,reason:V(de)}))},sinkCapability:new F.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:ne.desiredSize,ready:null};he.sinkCapability.resolve(),he.ready=he.sinkCapability.promise,this.streamSinks[ee]=he,new Promise(function(de){de(ce(ne.data,he))}).then(function(){re.postMessage({sourceName:ie,targetName:ae,stream:Y.START_COMPLETE,streamId:ee,success:!0})},function(de){re.postMessage({sourceName:ie,targetName:ae,stream:Y.START_COMPLETE,streamId:ee,reason:V(de)})})}#t(ne){const ee=ne.streamId,ie=this.sourceName,ae=ne.sourceName,re=this.comObj,oe=this.streamControllers[ee],ce=this.streamSinks[ee];switch(ne.stream){case Y.START_COMPLETE:ne.success?oe.startCall.resolve():oe.startCall.reject(V(ne.reason));break;case Y.PULL_COMPLETE:ne.success?oe.pullCall.resolve():oe.pullCall.reject(V(ne.reason));break;case Y.PULL:if(!ce){re.postMessage({sourceName:ie,targetName:ae,stream:Y.PULL_COMPLETE,streamId:ee,success:!0});break}ce.desiredSize<=0&&ne.desiredSize>0&&ce.sinkCapability.resolve(),ce.desiredSize=ne.desiredSize,new Promise(function(he){he(ce.onPull?.())}).then(function(){re.postMessage({sourceName:ie,targetName:ae,stream:Y.PULL_COMPLETE,streamId:ee,success:!0})},function(he){re.postMessage({sourceName:ie,targetName:ae,stream:Y.PULL_COMPLETE,streamId:ee,reason:V(he)})});break;case Y.ENQUEUE:if((0,F.assert)(oe,"enqueue should have stream controller"),oe.isClosed)break;oe.controller.enqueue(ne.chunk);break;case Y.CLOSE:if((0,F.assert)(oe,"close should have stream controller"),oe.isClosed)break;oe.isClosed=!0,oe.controller.close(),this.#s(oe,ee);break;case Y.ERROR:(0,F.assert)(oe,"error should have stream controller"),oe.controller.error(V(ne.reason)),this.#s(oe,ee);break;case Y.CANCEL_COMPLETE:ne.success?oe.cancelCall.resolve():oe.cancelCall.reject(V(ne.reason)),this.#s(oe,ee);break;case Y.CANCEL:if(!ce)break;new Promise(function(he){he(ce.onCancel?.(V(ne.reason)))}).then(function(){re.postMessage({sourceName:ie,targetName:ae,stream:Y.CANCEL_COMPLETE,streamId:ee,success:!0})},function(he){re.postMessage({sourceName:ie,targetName:ae,stream:Y.CANCEL_COMPLETE,streamId:ee,reason:V(he)})}),ce.sinkCapability.reject(V(ne.reason)),ce.isCancelled=!0,delete this.streamSinks[ee];break;default:throw new Error("Unexpected stream case")}}async#s(ne,ee){await Promise.allSettled([ne.startCall?.promise,ne.pullCall?.promise,ne.cancelCall?.promise]),delete this.streamControllers[ee]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}e.MessageHandler=te},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var F=C(1);class ${#e;#t;constructor({parsedData:V,rawData:te}){this.#e=V,this.#t=te}getRaw(){return this.#t}get(V){return this.#e.get(V)??null}getAll(){return(0,F.objectFromMap)(this.#e)}has(V){return this.#e.has(V)}}e.Metadata=$},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var F=C(1),$=C(8);const Y=Symbol("INTERNAL");class V{#e=!0;constructor(ne,ee){this.name=ne,this.intent=ee}get visible(){return this.#e}_setVisible(ne,ee){ne!==Y&&(0,F.unreachable)("Internal method `_setVisible` called."),this.#e=ee}}class te{#e=null;#t=new Map;#s=null;#n=null;constructor(ne){if(this.name=null,this.creator=null,ne!==null){this.name=ne.name,this.creator=ne.creator,this.#n=ne.order;for(const ee of ne.groups)this.#t.set(ee.id,new V(ee.name,ee.intent));if(ne.baseState==="OFF")for(const ee of this.#t.values())ee._setVisible(Y,!1);for(const ee of ne.on)this.#t.get(ee)._setVisible(Y,!0);for(const ee of ne.off)this.#t.get(ee)._setVisible(Y,!1);this.#s=this.getHash()}}#r(ne){const ee=ne.length;if(ee<2)return!0;const ie=ne[0];for(let ae=1;ae<ee;ae++){const re=ne[ae];let oe;if(Array.isArray(re))oe=this.#r(re);else if(this.#t.has(re))oe=this.#t.get(re).visible;else return(0,F.warn)(`Optional content group not found: ${re}`),!0;switch(ie){case"And":if(!oe)return!1;break;case"Or":if(oe)return!0;break;case"Not":return!oe;default:return!0}}return ie==="And"}isVisible(ne){if(this.#t.size===0)return!0;if(!ne)return(0,F.warn)("Optional content group not defined."),!0;if(ne.type==="OCG")return this.#t.has(ne.id)?this.#t.get(ne.id).visible:((0,F.warn)(`Optional content group not found: ${ne.id}`),!0);if(ne.type==="OCMD"){if(ne.expression)return this.#r(ne.expression);if(!ne.policy||ne.policy==="AnyOn"){for(const ee of ne.ids){if(!this.#t.has(ee))return(0,F.warn)(`Optional content group not found: ${ee}`),!0;if(this.#t.get(ee).visible)return!0}return!1}else if(ne.policy==="AllOn"){for(const ee of ne.ids){if(!this.#t.has(ee))return(0,F.warn)(`Optional content group not found: ${ee}`),!0;if(!this.#t.get(ee).visible)return!1}return!0}else if(ne.policy==="AnyOff"){for(const ee of ne.ids){if(!this.#t.has(ee))return(0,F.warn)(`Optional content group not found: ${ee}`),!0;if(!this.#t.get(ee).visible)return!0}return!1}else if(ne.policy==="AllOff"){for(const ee of ne.ids){if(!this.#t.has(ee))return(0,F.warn)(`Optional content group not found: ${ee}`),!0;if(this.#t.get(ee).visible)return!1}return!0}return(0,F.warn)(`Unknown optional content policy ${ne.policy}.`),!0}return(0,F.warn)(`Unknown group type ${ne.type}.`),!0}setVisibility(ne,ee=!0){if(!this.#t.has(ne)){(0,F.warn)(`Optional content group not found: ${ne}`);return}this.#t.get(ne)._setVisible(Y,!!ee),this.#e=null}get hasInitialVisibility(){return this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,F.objectFromMap)(this.#t):null}getGroup(ne){return this.#t.get(ne)||null}getHash(){if(this.#e!==null)return this.#e;const ne=new $.MurmurHash3_64;for(const[ee,ie]of this.#t)ne.update(`${ee}:${ie.visible}`);return this.#e=ne.hexdigest()}}e.OptionalContentConfig=te},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var F=C(1),$=C(6);class Y{constructor({length:ne,initialData:ee,progressiveDone:ie=!1,contentDispositionFilename:ae=null,disableRange:re=!1,disableStream:oe=!1},ce){if((0,F.assert)(ce,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=ie,this._contentDispositionFilename=ae,ee?.length>0){const he=ee instanceof Uint8Array&&ee.byteLength===ee.buffer.byteLength?ee.buffer:new Uint8Array(ee).buffer;this._queuedChunks.push(he)}this._pdfDataRangeTransport=ce,this._isStreamingSupported=!oe,this._isRangeSupported=!re,this._contentLength=ne,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((he,de)=>{this._onReceiveData({begin:he,chunk:de})}),this._pdfDataRangeTransport.addProgressListener((he,de)=>{this._onProgress({loaded:he,total:de})}),this._pdfDataRangeTransport.addProgressiveReadListener(he=>{this._onReceiveData({chunk:he})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:ne,chunk:ee}){const ie=ee instanceof Uint8Array&&ee.byteLength===ee.buffer.byteLength?ee.buffer:new Uint8Array(ee).buffer;if(ne===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(ie):this._queuedChunks.push(ie);else{const ae=this._rangeReaders.some(function(re){return re._begin!==ne?!1:(re._enqueue(ie),!0)});(0,F.assert)(ae,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(ne){ne.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:ne.loaded}):this._fullRequestReader?.onProgress?.({loaded:ne.loaded,total:ne.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(ne){const ee=this._rangeReaders.indexOf(ne);ee>=0&&this._rangeReaders.splice(ee,1)}getFullReader(){(0,F.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const ne=this._queuedChunks;return this._queuedChunks=null,new V(this,ne,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(ne,ee){if(ee<=this._progressiveDataLength)return null;const ie=new te(this,ne,ee);return this._pdfDataRangeTransport.requestDataRange(ne,ee),this._rangeReaders.push(ie),ie}cancelAllRequests(ne){this._fullRequestReader?.cancel(ne);for(const ee of this._rangeReaders.slice(0))ee.cancel(ne);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=Y;class V{constructor(ne,ee,ie=!1,ae=null){this._stream=ne,this._done=ie||!1,this._filename=(0,$.isPdfFile)(ae)?ae:null,this._queuedChunks=ee||[],this._loaded=0;for(const re of this._queuedChunks)this._loaded+=re.byteLength;this._requests=[],this._headersReady=Promise.resolve(),ne._fullRequestReader=this,this.onProgress=null}_enqueue(ne){this._done||(this._requests.length>0?this._requests.shift().resolve({value:ne,done:!1}):this._queuedChunks.push(ne),this._loaded+=ne.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const ne=new F.PromiseCapability;return this._requests.push(ne),ne.promise}cancel(ne){this._done=!0;for(const ee of this._requests)ee.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class te{constructor(ne,ee,ie){this._stream=ne,this._begin=ee,this._end=ie,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(ne){if(!this._done){if(this._requests.length===0)this._queuedChunk=ne;else{this._requests.shift().resolve({value:ne,done:!1});for(const ie of this._requests)ie.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const ee=this._queuedChunk;return this._queuedChunk=null,{value:ee,done:!1}}if(this._done)return{value:void 0,done:!0};const ne=new F.PromiseCapability;return this._requests.push(ne),ne.promise}cancel(ne){this._done=!0;for(const ee of this._requests)ee.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(J,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class C{static textContent($){const Y=[],V={items:Y,styles:Object.create(null)};function te(se){if(!se)return;let ne=null;const ee=se.name;if(ee==="#text")ne=se.value;else if(C.shouldBuildText(ee))se?.attributes?.textContent?ne=se.attributes.textContent:se.value&&(ne=se.value);else return;if(ne!==null&&Y.push({str:ne}),!!se.children)for(const ie of se.children)te(ie)}return te($),V}static shouldBuildText($){return!($==="textarea"||$==="input"||$==="option"||$==="select")}}e.XfaText=C},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var F=C(7);const $=function(ne){return new Promise((ee,ie)=>{require$$5.readFile(ne,(re,oe)=>{if(re||!oe){ie(new Error(re));return}ee(new Uint8Array(oe))})})};class Y extends F.BaseFilterFactory{}e.NodeFilterFactory=Y;class V extends F.BaseCanvasFactory{_createCanvas(ee,ie){return require$$5.createCanvas(ee,ie)}}e.NodeCanvasFactory=V;class te extends F.BaseCMapReaderFactory{_fetchData(ee,ie){return $(ee).then(ae=>({cMapData:ae,compressionType:ie}))}}e.NodeCMapReaderFactory=te;class se extends F.BaseStandardFontDataFactory{_fetchData(ee){return $(ee)}}e.NodeStandardFontDataFactory=se},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var F=C(1),$=C(22);const Y=require$$5,V=require$$5,te=require$$5,se=require$$5,ne=/^file:\/\/\/[a-zA-Z]:\//;function ee(fe){const ye=se.parse(fe);return ye.protocol==="file:"||ye.host?ye:/^[a-z]:[/\\]/i.test(fe)?se.parse(`file:///${fe}`):(ye.host||(ye.protocol="file:"),ye)}class ie{constructor(ye){this.source=ye,this.url=ee(ye.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&ye.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,F.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new de(this):new ce(this),this._fullRequestReader}getRangeReader(ye,_e){if(_e<=this._progressiveDataLength)return null;const Ee=this.isFsUrl?new pe(this,ye,_e):new he(this,ye,_e);return this._rangeRequestReaders.push(Ee),Ee}cancelAllRequests(ye){this._fullRequestReader?.cancel(ye);for(const _e of this._rangeRequestReaders.slice(0))_e.cancel(ye)}}e.PDFNodeStream=ie;class ae{constructor(ye){this._url=ye.url,this._done=!1,this._storedError=null,this.onProgress=null;const _e=ye.source;this._contentLength=_e.length,this._loaded=0,this._filename=null,this._disableRange=_e.disableRange||!1,this._rangeChunkSize=_e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!_e.disableStream,this._isRangeSupported=!_e.disableRange,this._readableStream=null,this._readCapability=new F.PromiseCapability,this._headersCapability=new F.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const ye=this._readableStream.read();return ye===null?(this._readCapability=new F.PromiseCapability,this.read()):(this._loaded+=ye.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(ye).buffer,done:!1})}cancel(ye){if(!this._readableStream){this._error(ye);return}this._readableStream.destroy(ye)}_error(ye){this._storedError=ye,this._readCapability.resolve()}_setReadableStream(ye){this._readableStream=ye,ye.on("readable",()=>{this._readCapability.resolve()}),ye.on("end",()=>{ye.destroy(),this._done=!0,this._readCapability.resolve()}),ye.on("error",_e=>{this._error(_e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new F.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class re{constructor(ye){this._url=ye.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new F.PromiseCapability;const _e=ye.source;this._isStreamingSupported=!_e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const ye=this._readableStream.read();return ye===null?(this._readCapability=new F.PromiseCapability,this.read()):(this._loaded+=ye.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(ye).buffer,done:!1})}cancel(ye){if(!this._readableStream){this._error(ye);return}this._readableStream.destroy(ye)}_error(ye){this._storedError=ye,this._readCapability.resolve()}_setReadableStream(ye){this._readableStream=ye,ye.on("readable",()=>{this._readCapability.resolve()}),ye.on("end",()=>{ye.destroy(),this._done=!0,this._readCapability.resolve()}),ye.on("error",_e=>{this._error(_e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function oe(fe,ye){return{protocol:fe.protocol,auth:fe.auth,host:fe.hostname,port:fe.port,path:fe.path,method:"GET",headers:ye}}class ce extends ae{constructor(ye){super(ye);const _e=Ee=>{if(Ee.statusCode===404){const Te=new F.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Te,this._headersCapability.reject(Te);return}this._headersCapability.resolve(),this._setReadableStream(Ee);const be=Te=>this._readableStream.headers[Te.toLowerCase()],{allowRangeRequests:Ae,suggestedLength:we}=(0,$.validateRangeRequestCapabilities)({getResponseHeader:be,isHttp:ye.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Ae,this._contentLength=we||this._contentLength,this._filename=(0,$.extractFilenameFromHeader)(be)};this._request=null,this._url.protocol==="http:"?this._request=V.request(oe(this._url,ye.httpHeaders),_e):this._request=te.request(oe(this._url,ye.httpHeaders),_e),this._request.on("error",Ee=>{this._storedError=Ee,this._headersCapability.reject(Ee)}),this._request.end()}}class he extends re{constructor(ye,_e,Ee){super(ye),this._httpHeaders={};for(const Ae in ye.httpHeaders){const we=ye.httpHeaders[Ae];we!==void 0&&(this._httpHeaders[Ae]=we)}this._httpHeaders.Range=`bytes=${_e}-${Ee-1}`;const be=Ae=>{if(Ae.statusCode===404){const we=new F.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=we;return}this._setReadableStream(Ae)};this._request=null,this._url.protocol==="http:"?this._request=V.request(oe(this._url,this._httpHeaders),be):this._request=te.request(oe(this._url,this._httpHeaders),be),this._request.on("error",Ae=>{this._storedError=Ae}),this._request.end()}}class de extends ae{constructor(ye){super(ye);let _e=decodeURIComponent(this._url.path);ne.test(this._url.href)&&(_e=_e.replace(/^\//,"")),Y.lstat(_e,(Ee,be)=>{if(Ee){Ee.code==="ENOENT"&&(Ee=new F.MissingPDFException(`Missing PDF "${_e}".`)),this._storedError=Ee,this._headersCapability.reject(Ee);return}this._contentLength=be.size,this._setReadableStream(Y.createReadStream(_e)),this._headersCapability.resolve()})}}class pe extends re{constructor(ye,_e,Ee){super(ye);let be=decodeURIComponent(this._url.path);ne.test(this._url.href)&&(be=be.replace(/^\//,"")),this._setReadableStream(Y.createReadStream(be,{start:_e,end:Ee-1}))}}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=se,e.extractFilenameFromHeader=te,e.validateRangeRequestCapabilities=V,e.validateResponseStatus=ne;var F=C(1),$=C(23),Y=C(6);function V({getResponseHeader:ee,isHttp:ie,rangeChunkSize:ae,disableRange:re}){const oe={allowRangeRequests:!1,suggestedLength:void 0},ce=parseInt(ee("Content-Length"),10);return!Number.isInteger(ce)||(oe.suggestedLength=ce,ce<=2*ae)||re||!ie||ee("Accept-Ranges")!=="bytes"||(ee("Content-Encoding")||"identity")!=="identity"||(oe.allowRangeRequests=!0),oe}function te(ee){const ie=ee("Content-Disposition");if(ie){let ae=(0,$.getFilenameFromContentDispositionHeader)(ie);if(ae.includes("%"))try{ae=decodeURIComponent(ae)}catch{}if((0,Y.isPdfFile)(ae))return ae}return null}function se(ee,ie){return ee===404||ee===0&&ie.startsWith("file:")?new F.MissingPDFException('Missing PDF "'+ie+'".'):new F.UnexpectedResponseException(`Unexpected server response (${ee}) while retrieving PDF "${ie}".`,ee)}function ne(ee){return ee===200||ee===206}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=$;var F=C(1);function $(Y){let V=!0,te=se("filename\\*","i").exec(Y);if(te){te=te[1];let ce=ae(te);return ce=unescape(ce),ce=re(ce),ce=oe(ce),ee(ce)}if(te=ie(Y),te){const ce=oe(te);return ee(ce)}if(te=se("filename","i").exec(Y),te){te=te[1];let ce=ae(te);return ce=oe(ce),ee(ce)}function se(ce,he){return new RegExp("(?:^|;)\\s*"+ce+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',he)}function ne(ce,he){if(ce){if(!/^[\x00-\xFF]+$/.test(he))return he;try{const de=new TextDecoder(ce,{fatal:!0}),pe=(0,F.stringToBytes)(he);he=de.decode(pe),V=!1}catch{}}return he}function ee(ce){return V&&/[\x80-\xff]/.test(ce)&&(ce=ne("utf-8",ce),V&&(ce=ne("iso-8859-1",ce))),ce}function ie(ce){const he=[];let de;const pe=se("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(de=pe.exec(ce))!==null;){let[,ye,_e,Ee]=de;if(ye=parseInt(ye,10),ye in he){if(ye===0)break;continue}he[ye]=[_e,Ee]}const fe=[];for(let ye=0;ye<he.length&&ye in he;++ye){let[_e,Ee]=he[ye];Ee=ae(Ee),_e&&(Ee=unescape(Ee),ye===0&&(Ee=re(Ee))),fe.push(Ee)}return fe.join("")}function ae(ce){if(ce.startsWith('"')){const he=ce.slice(1).split('\\"');for(let de=0;de<he.length;++de){const pe=he[de].indexOf('"');pe!==-1&&(he[de]=he[de].slice(0,pe),he.length=de+1),he[de]=he[de].replaceAll(/\\(.)/g,"$1")}ce=he.join('"')}return ce}function re(ce){const he=ce.indexOf("'");if(he===-1)return ce;const de=ce.slice(0,he),fe=ce.slice(he+1).replace(/^[^']*'/,"");return ne(de,fe)}function oe(ce){return!ce.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(ce)?ce:ce.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(he,de,pe,fe){if(pe==="q"||pe==="Q")return fe=fe.replaceAll("_"," "),fe=fe.replaceAll(/=([0-9a-fA-F]{2})/g,function(ye,_e){return String.fromCharCode(parseInt(_e,16))}),ne(de,fe);try{fe=atob(fe)}catch{}return ne(de,fe)})}return""}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var F=C(1),$=C(22);const Y=200,V=206;function te(ae){const re=ae.response;return typeof re!="string"?re:(0,F.stringToBytes)(re).buffer}class se{constructor(re,oe={}){this.url=re,this.isHttp=/^https?:/i.test(re),this.httpHeaders=this.isHttp&&oe.httpHeaders||Object.create(null),this.withCredentials=oe.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(re,oe,ce){const he={begin:re,end:oe};for(const de in ce)he[de]=ce[de];return this.request(he)}requestFull(re){return this.request(re)}request(re){const oe=new XMLHttpRequest,ce=this.currXhrId++,he=this.pendingRequests[ce]={xhr:oe};oe.open("GET",this.url),oe.withCredentials=this.withCredentials;for(const de in this.httpHeaders){const pe=this.httpHeaders[de];pe!==void 0&&oe.setRequestHeader(de,pe)}return this.isHttp&&"begin"in re&&"end"in re?(oe.setRequestHeader("Range",`bytes=${re.begin}-${re.end-1}`),he.expectedStatus=V):he.expectedStatus=Y,oe.responseType="arraybuffer",re.onError&&(oe.onerror=function(de){re.onError(oe.status)}),oe.onreadystatechange=this.onStateChange.bind(this,ce),oe.onprogress=this.onProgress.bind(this,ce),he.onHeadersReceived=re.onHeadersReceived,he.onDone=re.onDone,he.onError=re.onError,he.onProgress=re.onProgress,oe.send(null),ce}onProgress(re,oe){const ce=this.pendingRequests[re];ce&&ce.onProgress?.(oe)}onStateChange(re,oe){const ce=this.pendingRequests[re];if(!ce)return;const he=ce.xhr;if(he.readyState>=2&&ce.onHeadersReceived&&(ce.onHeadersReceived(),delete ce.onHeadersReceived),he.readyState!==4||!(re in this.pendingRequests))return;if(delete this.pendingRequests[re],he.status===0&&this.isHttp){ce.onError?.(he.status);return}const de=he.status||Y;if(!(de===Y&&ce.expectedStatus===V)&&de!==ce.expectedStatus){ce.onError?.(he.status);return}const fe=te(he);if(de===V){const ye=he.getResponseHeader("Content-Range"),_e=/bytes (\d+)-(\d+)\/(\d+)/.exec(ye);ce.onDone({begin:parseInt(_e[1],10),chunk:fe})}else fe?ce.onDone({begin:0,chunk:fe}):ce.onError?.(he.status)}getRequestXhr(re){return this.pendingRequests[re].xhr}isPendingRequest(re){return re in this.pendingRequests}abortRequest(re){const oe=this.pendingRequests[re].xhr;delete this.pendingRequests[re],oe.abort()}}class ne{constructor(re){this._source=re,this._manager=new se(re.url,{httpHeaders:re.httpHeaders,withCredentials:re.withCredentials}),this._rangeChunkSize=re.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(re){const oe=this._rangeRequestReaders.indexOf(re);oe>=0&&this._rangeRequestReaders.splice(oe,1)}getFullReader(){return(0,F.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ee(this._manager,this._source),this._fullRequestReader}getRangeReader(re,oe){const ce=new ie(this._manager,re,oe);return ce.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(ce),ce}cancelAllRequests(re){this._fullRequestReader?.cancel(re);for(const oe of this._rangeRequestReaders.slice(0))oe.cancel(re)}}e.PDFNetworkStream=ne;class ee{constructor(re,oe){this._manager=re;const ce={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=oe.url,this._fullRequestId=re.requestFull(ce),this._headersReceivedCapability=new F.PromiseCapability,this._disableRange=oe.disableRange||!1,this._contentLength=oe.length,this._rangeChunkSize=oe.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const re=this._fullRequestId,oe=this._manager.getRequestXhr(re),ce=pe=>oe.getResponseHeader(pe),{allowRangeRequests:he,suggestedLength:de}=(0,$.validateRangeRequestCapabilities)({getResponseHeader:ce,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});he&&(this._isRangeSupported=!0),this._contentLength=de||this._contentLength,this._filename=(0,$.extractFilenameFromHeader)(ce),this._isRangeSupported&&this._manager.abortRequest(re),this._headersReceivedCapability.resolve()}_onDone(re){if(re&&(this._requests.length>0?this._requests.shift().resolve({value:re.chunk,done:!1}):this._cachedChunks.push(re.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const oe of this._requests)oe.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(re){this._storedError=(0,$.createResponseStatusError)(re,this._url),this._headersReceivedCapability.reject(this._storedError);for(const oe of this._requests)oe.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(re){this.onProgress?.({loaded:re.loaded,total:re.lengthComputable?re.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const re=new F.PromiseCapability;return this._requests.push(re),re.promise}cancel(re){this._done=!0,this._headersReceivedCapability.reject(re);for(const oe of this._requests)oe.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ie{constructor(re,oe,ce){this._manager=re;const he={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=re.url,this._requestId=re.requestRange(oe,ce,he),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(re){const oe=re.chunk;this._requests.length>0?this._requests.shift().resolve({value:oe,done:!1}):this._queuedChunk=oe,this._done=!0;for(const ce of this._requests)ce.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(re){this._storedError=(0,$.createResponseStatusError)(re,this._url);for(const oe of this._requests)oe.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(re){this.isStreamingSupported||this.onProgress?.({loaded:re.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const oe=this._queuedChunk;return this._queuedChunk=null,{value:oe,done:!1}}if(this._done)return{value:void 0,done:!0};const re=new F.PromiseCapability;return this._requests.push(re),re.promise}cancel(re){this._done=!0;for(const oe of this._requests)oe.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var F=C(1),$=C(22);function Y(ie,ae,re){return{method:"GET",headers:ie,signal:re.signal,mode:"cors",credentials:ae?"include":"same-origin",redirect:"follow"}}function V(ie){const ae=new Headers;for(const re in ie){const oe=ie[re];oe!==void 0&&ae.append(re,oe)}return ae}function te(ie){return ie instanceof Uint8Array?ie.buffer:ie instanceof ArrayBuffer?ie:((0,F.warn)(`getArrayBuffer - unexpected data format: ${ie}`),new Uint8Array(ie).buffer)}class se{constructor(ae){this.source=ae,this.isHttp=/^https?:/i.test(ae.url),this.httpHeaders=this.isHttp&&ae.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,F.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new ne(this),this._fullRequestReader}getRangeReader(ae,re){if(re<=this._progressiveDataLength)return null;const oe=new ee(this,ae,re);return this._rangeRequestReaders.push(oe),oe}cancelAllRequests(ae){this._fullRequestReader?.cancel(ae);for(const re of this._rangeRequestReaders.slice(0))re.cancel(ae)}}e.PDFFetchStream=se;class ne{constructor(ae){this._stream=ae,this._reader=null,this._loaded=0,this._filename=null;const re=ae.source;this._withCredentials=re.withCredentials||!1,this._contentLength=re.length,this._headersCapability=new F.PromiseCapability,this._disableRange=re.disableRange||!1,this._rangeChunkSize=re.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!re.disableStream,this._isRangeSupported=!re.disableRange,this._headers=V(this._stream.httpHeaders);const oe=re.url;fetch(oe,Y(this._headers,this._withCredentials,this._abortController)).then(ce=>{if(!(0,$.validateResponseStatus)(ce.status))throw(0,$.createResponseStatusError)(ce.status,oe);this._reader=ce.body.getReader(),this._headersCapability.resolve();const he=fe=>ce.headers.get(fe),{allowRangeRequests:de,suggestedLength:pe}=(0,$.validateRangeRequestCapabilities)({getResponseHeader:he,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=de,this._contentLength=pe||this._contentLength,this._filename=(0,$.extractFilenameFromHeader)(he),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new F.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:ae,done:re}=await this._reader.read();return re?{value:ae,done:re}:(this._loaded+=ae.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:te(ae),done:!1})}cancel(ae){this._reader?.cancel(ae),this._abortController.abort()}}class ee{constructor(ae,re,oe){this._stream=ae,this._reader=null,this._loaded=0;const ce=ae.source;this._withCredentials=ce.withCredentials||!1,this._readCapability=new F.PromiseCapability,this._isStreamingSupported=!ce.disableStream,this._abortController=new AbortController,this._headers=V(this._stream.httpHeaders),this._headers.append("Range",`bytes=${re}-${oe-1}`);const he=ce.url;fetch(he,Y(this._headers,this._withCredentials,this._abortController)).then(de=>{if(!(0,$.validateResponseStatus)(de.status))throw(0,$.createResponseStatusError)(de.status,he);this._readCapability.resolve(),this._reader=de.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:ae,done:re}=await this._reader.read();return re?{value:ae,done:re}:(this._loaded+=ae.byteLength,this.onProgress?.({loaded:this._loaded}),{value:te(ae),done:!1})}cancel(ae){this._reader?.cancel(ae),this._abortController.abort()}}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=ce,e.updateTextLayer=he;var F=C(1),$=C(6);const Y=1e5,V=30,te=.8,se=new Map;function ne(de,pe){let fe;if(pe&&F.FeatureTest.isOffscreenCanvasSupported)fe=new OffscreenCanvas(de,de).getContext("2d",{alpha:!1});else{const ye=document.createElement("canvas");ye.width=ye.height=de,fe=ye.getContext("2d",{alpha:!1})}return fe}function ee(de,pe){const fe=se.get(de);if(fe)return fe;const ye=ne(V,pe);ye.font=`${V}px ${de}`;const _e=ye.measureText("");let Ee=_e.fontBoundingBoxAscent,be=Math.abs(_e.fontBoundingBoxDescent);if(Ee){const we=Ee/(Ee+be);return se.set(de,we),ye.canvas.width=ye.canvas.height=0,we}ye.strokeStyle="red",ye.clearRect(0,0,V,V),ye.strokeText("g",0,0);let Ae=ye.getImageData(0,0,V,V).data;be=0;for(let we=Ae.length-1-3;we>=0;we-=4)if(Ae[we]>0){be=Math.ceil(we/4/V);break}ye.clearRect(0,0,V,V),ye.strokeText("A",0,V),Ae=ye.getImageData(0,0,V,V).data,Ee=0;for(let we=0,Te=Ae.length;we<Te;we+=4)if(Ae[we]>0){Ee=V-Math.floor(we/4/V);break}if(ye.canvas.width=ye.canvas.height=0,Ee){const we=Ee/(Ee+be);return se.set(de,we),we}return se.set(de,te),te}function ie(de,pe,fe){const ye=document.createElement("span"),_e={angle:0,canvasWidth:0,hasText:pe.str!=="",hasEOL:pe.hasEOL,fontSize:0};de._textDivs.push(ye);const Ee=F.Util.transform(de._transform,pe.transform);let be=Math.atan2(Ee[1],Ee[0]);const Ae=fe[pe.fontName];Ae.vertical&&(be+=Math.PI/2);const we=Math.hypot(Ee[2],Ee[3]),Te=we*ee(Ae.fontFamily,de._isOffscreenCanvasSupported);let Me,Be;be===0?(Me=Ee[4],Be=Ee[5]-Te):(Me=Ee[4]+Te*Math.sin(be),Be=Ee[5]-Te*Math.cos(be));const $e="calc(var(--scale-factor)*",Fe=ye.style;de._container===de._rootContainer?(Fe.left=`${(100*Me/de._pageWidth).toFixed(2)}%`,Fe.top=`${(100*Be/de._pageHeight).toFixed(2)}%`):(Fe.left=`${$e}${Me.toFixed(2)}px)`,Fe.top=`${$e}${Be.toFixed(2)}px)`),Fe.fontSize=`${$e}${we.toFixed(2)}px)`,Fe.fontFamily=Ae.fontFamily,_e.fontSize=we,ye.setAttribute("role","presentation"),ye.textContent=pe.str,ye.dir=pe.dir,de._fontInspectorEnabled&&(ye.dataset.fontName=pe.fontName),be!==0&&(_e.angle=be*(180/Math.PI));let Xe=!1;if(pe.str.length>1)Xe=!0;else if(pe.str!==" "&&pe.transform[0]!==pe.transform[3]){const We=Math.abs(pe.transform[0]),Ie=Math.abs(pe.transform[3]);We!==Ie&&Math.max(We,Ie)/Math.min(We,Ie)>1.5&&(Xe=!0)}Xe&&(_e.canvasWidth=Ae.vertical?pe.height:pe.width),de._textDivProperties.set(ye,_e),de._isReadableStream&&de._layoutText(ye)}function ae(de){const{div:pe,scale:fe,properties:ye,ctx:_e,prevFontSize:Ee,prevFontFamily:be}=de,{style:Ae}=pe;let we="";if(ye.canvasWidth!==0&&ye.hasText){const{fontFamily:Te}=Ae,{canvasWidth:Me,fontSize:Be}=ye;(Ee!==Be||be!==Te)&&(_e.font=`${Be*fe}px ${Te}`,de.prevFontSize=Be,de.prevFontFamily=Te);const{width:$e}=_e.measureText(pe.textContent);$e>0&&(we=`scaleX(${Me*fe/$e})`)}ye.angle!==0&&(we=`rotate(${ye.angle}deg) ${we}`),we.length>0&&(Ae.transform=we)}function re(de){if(de._canceled)return;const pe=de._textDivs,fe=de._capability;if(pe.length>Y){fe.resolve();return}if(!de._isReadableStream)for(const _e of pe)de._layoutText(_e);fe.resolve()}class oe{constructor({textContentSource:pe,container:fe,viewport:ye,textDivs:_e,textDivProperties:Ee,textContentItemsStr:be,isOffscreenCanvasSupported:Ae}){this._textContentSource=pe,this._isReadableStream=pe instanceof ReadableStream,this._container=this._rootContainer=fe,this._textDivs=_e||[],this._textContentItemsStr=be||[],this._isOffscreenCanvasSupported=Ae,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=Ee||new WeakMap,this._canceled=!1,this._capability=new F.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:ye.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:ne(0,Ae)};const{pageWidth:we,pageHeight:Te,pageX:Me,pageY:Be}=ye.rawDims;this._transform=[1,0,0,-1,-Me,Be+Te],this._pageWidth=we,this._pageHeight=Te,(0,$.setLayerDimensions)(fe,ye),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new F.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new F.AbortException("TextLayer task cancelled."))}_processItems(pe,fe){for(const ye of pe){if(ye.str===void 0){if(ye.type==="beginMarkedContentProps"||ye.type==="beginMarkedContent"){const _e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),ye.id!==null&&this._container.setAttribute("id",`${ye.id}`),_e.append(this._container)}else ye.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(ye.str),ie(this,ye,fe)}}_layoutText(pe){const fe=this._layoutTextParams.properties=this._textDivProperties.get(pe);if(this._layoutTextParams.div=pe,ae(this._layoutTextParams),fe.hasText&&this._container.append(pe),fe.hasEOL){const ye=document.createElement("br");ye.setAttribute("role","presentation"),this._container.append(ye)}}_render(){const pe=new F.PromiseCapability;let fe=Object.create(null);if(this._isReadableStream){const ye=()=>{this._reader.read().then(({value:_e,done:Ee})=>{if(Ee){pe.resolve();return}Object.assign(fe,_e.styles),this._processItems(_e.items,fe),ye()},pe.reject)};this._reader=this._textContentSource.getReader(),ye()}else if(this._textContentSource){const{items:ye,styles:_e}=this._textContentSource;this._processItems(ye,_e),pe.resolve()}else throw new Error('No "textContentSource" parameter specified.');pe.promise.then(()=>{fe=null,re(this)},this._capability.reject)}}e.TextLayerRenderTask=oe;function ce(de){!de.textContentSource&&(de.textContent||de.textContentStream)&&((0,$.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),de.textContentSource=de.textContent||de.textContentStream);const{container:pe,viewport:fe}=de,ye=getComputedStyle(pe),_e=ye.getPropertyValue("visibility"),Ee=parseFloat(ye.getPropertyValue("--scale-factor"));_e==="visible"&&(!Ee||Math.abs(Ee-fe.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const be=new oe(de);return be._render(),be}function he({container:de,viewport:pe,textDivs:fe,textDivProperties:ye,isOffscreenCanvasSupported:_e,mustRotate:Ee=!0,mustRescale:be=!0}){if(Ee&&(0,$.setLayerDimensions)(de,{rotation:pe.rotation}),be){const Ae=ne(0,_e),Te={prevFontSize:null,prevFontFamily:null,div:null,scale:pe.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Ae};for(const Me of fe)Te.properties=ye.get(Me),Te.div=Me,ae(Te)}}},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var F=C(1),$=C(5),Y=C(28),V=C(29),te=C(6);class se{#e;#t=!1;#s=this.pointerup.bind(this);#n=this.pointerdown.bind(this);#r=new Map;#d=!1;#l=!1;#i;static _initialized=!1;constructor(ee){se._initialized||(se._initialized=!0,Y.FreeTextEditor.initialize(ee.l10n),V.InkEditor.initialize(ee.l10n)),ee.uiManager.registerEditorTypes([Y.FreeTextEditor,V.InkEditor]),this.#i=ee.uiManager,this.pageIndex=ee.pageIndex,this.div=ee.div,this.#e=ee.accessibilityManager,this.#i.addLayer(this)}get isEmpty(){return this.#r.size===0}updateToolbar(ee){this.#i.updateToolbar(ee)}updateMode(ee=this.#i.getMode()){this.#u(),ee===F.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#i.unselectAll(),ee!==F.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",ee===F.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",ee===F.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(ee){if(!ee&&this.#i.getMode()!==F.AnnotationEditorType.INK)return;if(!ee){for(const ae of this.#r.values())if(ae.isEmpty()){ae.setInBackground();return}}this.#c({offsetX:0,offsetY:0}).setInBackground()}setEditingState(ee){this.#i.setEditingState(ee)}addCommands(ee){this.#i.addCommands(ee)}enable(){this.div.style.pointerEvents="auto";for(const ee of this.#r.values())ee.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const ee of this.#r.values())ee.disableEditing();this.#u(),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(ee){this.#i.getActive()!==ee&&this.#i.setActiveEditor(ee)}enableClick(){this.div.addEventListener("pointerdown",this.#n),this.div.addEventListener("pointerup",this.#s)}disableClick(){this.div.removeEventListener("pointerdown",this.#n),this.div.removeEventListener("pointerup",this.#s)}attach(ee){this.#r.set(ee.id,ee)}detach(ee){this.#r.delete(ee.id),this.#e?.removePointerInTextLayer(ee.contentDiv)}remove(ee){this.#i.removeEditor(ee),this.detach(ee),ee.div.style.display="none",setTimeout(()=>{ee.div.style.display="",ee.div.remove(),ee.isAttachedToDOM=!1,document.activeElement===document.body&&this.#i.focusMainContainer()},0),this.#l||this.addInkEditorIfNeeded(!1)}#a(ee){ee.parent!==this&&(this.attach(ee),ee.parent?.detach(ee),ee.setParent(this),ee.div&&ee.isAttachedToDOM&&(ee.div.remove(),this.div.append(ee.div)))}add(ee){if(this.#a(ee),this.#i.addEditor(ee),this.attach(ee),!ee.isAttachedToDOM){const ie=ee.render();this.div.append(ie),ee.isAttachedToDOM=!0}this.moveEditorInDOM(ee),ee.onceAdded(),this.#i.addToAnnotationStorage(ee)}moveEditorInDOM(ee){this.#e?.moveElementInDOM(this.div,ee.div,ee.contentDiv,!0)}addOrRebuild(ee){ee.needsToBeRebuilt()?ee.rebuild():this.add(ee)}addANewEditor(ee){const ie=()=>{this.addOrRebuild(ee)},ae=()=>{ee.remove()};this.addCommands({cmd:ie,undo:ae,mustExec:!0})}addUndoableEditor(ee){const ie=()=>{this.addOrRebuild(ee)},ae=()=>{ee.remove()};this.addCommands({cmd:ie,undo:ae,mustExec:!1})}getNextId(){return this.#i.getId()}#h(ee){switch(this.#i.getMode()){case F.AnnotationEditorType.FREETEXT:return new Y.FreeTextEditor(ee);case F.AnnotationEditorType.INK:return new V.InkEditor(ee)}return null}deserialize(ee){switch(ee.annotationType){case F.AnnotationEditorType.FREETEXT:return Y.FreeTextEditor.deserialize(ee,this,this.#i);case F.AnnotationEditorType.INK:return V.InkEditor.deserialize(ee,this,this.#i)}return null}#c(ee){const ie=this.getNextId(),ae=this.#h({parent:this,id:ie,x:ee.offsetX,y:ee.offsetY,uiManager:this.#i});return ae&&this.add(ae),ae}setSelected(ee){this.#i.setSelected(ee)}toggleSelected(ee){this.#i.toggleSelected(ee)}isSelected(ee){return this.#i.isSelected(ee)}unselect(ee){this.#i.unselect(ee)}pointerup(ee){const{isMac:ie}=F.FeatureTest.platform;if(!(ee.button!==0||ee.ctrlKey&&ie)&&ee.target===this.div&&this.#d){if(this.#d=!1,!this.#t){this.#t=!0;return}this.#c(ee)}}pointerdown(ee){const{isMac:ie}=F.FeatureTest.platform;if(ee.button!==0||ee.ctrlKey&&ie||ee.target!==this.div)return;this.#d=!0;const ae=this.#i.getActive();this.#t=!ae||ae.isEmpty()}drop(ee){const ie=ee.dataTransfer.getData("text/plain"),ae=this.#i.getEditor(ie);if(!ae)return;ee.preventDefault(),ee.dataTransfer.dropEffect="move",this.#a(ae);const re=this.div.getBoundingClientRect(),oe=ee.clientX-re.x,ce=ee.clientY-re.y;ae.translate(oe-ae.startX,ce-ae.startY),this.moveEditorInDOM(ae),ae.div.focus()}dragover(ee){ee.preventDefault()}destroy(){this.#i.getActive()?.parent===this&&this.#i.setActiveEditor(null);for(const ee of this.#r.values())this.#e?.removePointerInTextLayer(ee.contentDiv),ee.setParent(null),ee.isAttachedToDOM=!1,ee.div.remove();this.div=null,this.#r.clear(),this.#i.removeLayer(this)}#u(){this.#l=!0;for(const ee of this.#r.values())ee.isEmpty()&&ee.remove();this.#l=!1}render({viewport:ee}){this.viewport=ee,(0,te.setLayerDimensions)(this.div,ee),(0,$.bindEvents)(this,this.div,["dragover","drop"]);for(const ie of this.#i.getEditors(this.pageIndex))this.add(ie);this.updateMode()}update({viewport:ee}){this.#i.commitOrRemove(),this.viewport=ee,(0,te.setLayerDimensions)(this.div,{rotation:ee.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:ee,pageHeight:ie}=this.viewport.rawDims;return[ee,ie]}}e.AnnotationEditorLayer=se},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var F=C(1),$=C(5),Y=C(4);class V extends Y.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#s=this.editorDivInput.bind(this);#n=this.editorDivKeydown.bind(this);#r;#d="";#l=`${this.id}-editor`;#i=!1;#a;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new $.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],V.prototype.commitOrRemove]]);static _type="freetext";constructor(se){super({...se,name:"freeTextEditor"}),this.#r=se.color||V._defaultColor||Y.AnnotationEditor._defaultLineColor,this.#a=se.fontSize||V._defaultFontSize}static initialize(se){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(ee=>[ee,se.get(ee)]));const ne=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ne.getPropertyValue("--freetext-padding"))}static updateDefaultParams(se,ne){switch(se){case F.AnnotationEditorParamsType.FREETEXT_SIZE:V._defaultFontSize=ne;break;case F.AnnotationEditorParamsType.FREETEXT_COLOR:V._defaultColor=ne;break}}updateParams(se,ne){switch(se){case F.AnnotationEditorParamsType.FREETEXT_SIZE:this.#h(ne);break;case F.AnnotationEditorParamsType.FREETEXT_COLOR:this.#c(ne);break}}static get defaultPropertiesToUpdate(){return[[F.AnnotationEditorParamsType.FREETEXT_SIZE,V._defaultFontSize],[F.AnnotationEditorParamsType.FREETEXT_COLOR,V._defaultColor||Y.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[F.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[F.AnnotationEditorParamsType.FREETEXT_COLOR,this.#r]]}#h(se){const ne=ie=>{this.editorDiv.style.fontSize=`calc(${ie}px * var(--scale-factor))`,this.translate(0,-(ie-this.#a)*this.parentScale),this.#a=ie,this.#o()},ee=this.#a;this.addCommands({cmd:()=>{ne(se)},undo:()=>{ne(ee)},mustExec:!0,type:F.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#c(se){const ne=this.#r;this.addCommands({cmd:()=>{this.#r=this.editorDiv.style.color=se},undo:()=>{this.#r=this.editorDiv.style.color=ne},mustExec:!0,type:F.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){const se=this.parentScale;return[-V._internalPadding*se,-(V._internalPadding+this.#a)*se]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(F.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#n),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#s))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#l),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#n),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#s),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(se){super.focusin(se),se.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#u(){const se=this.editorDiv.getElementsByTagName("div");if(se.length===0)return this.editorDiv.innerText;const ne=[];for(const ee of se)ne.push(ee.innerText.replace(/\r\n?|\n/,""));return ne.join(`
`)}#o(){const[se,ne]=this.parentDimensions;let ee;if(this.isAttachedToDOM)ee=this.div.getBoundingClientRect();else{const{currentLayer:ie,div:ae}=this,re=ae.style.display;ae.style.display="hidden",ie.div.append(this.div),ee=ae.getBoundingClientRect(),ae.remove(),ae.style.display=re}this.width=ee.width/se,this.height=ee.height/ne}commit(){this.isInEditMode()&&(super.commit(),this.#i||(this.#i=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#d=this.#u().trimEnd(),this.#o())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(se){this.enableEditMode(),this.editorDiv.focus()}keydown(se){se.target===this.div&&se.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(se){V._keyboardManager.exec(this,se)}editorDivFocus(se){this.isEditing=!0}editorDivBlur(se){this.isEditing=!1}editorDivInput(se){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let se,ne;this.width&&(se=this.x,ne=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#l),this.enableEditing(),V._l10nPromise.get("editor_free_text2_aria_label").then(ie=>this.editorDiv?.setAttribute("aria-label",ie)),V._l10nPromise.get("free_text2_default_content").then(ie=>this.editorDiv?.setAttribute("default-content",ie)),this.editorDiv.contentEditable=!0;const{style:ee}=this.editorDiv;if(ee.fontSize=`calc(${this.#a}px * var(--scale-factor))`,ee.color=this.#r,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,$.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ie,ae]=this.parentDimensions;this.setAt(se*ie,ne*ae,this.width*ie,this.height*ae);for(const re of this.#d.split(`
`)){const oe=document.createElement("div");oe.append(re?document.createTextNode(re):document.createElement("br")),this.editorDiv.append(oe)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(se,ne,ee){const ie=super.deserialize(se,ne,ee);return ie.#a=se.fontSize,ie.#r=F.Util.makeHexColor(...se.color),ie.#d=se.value,ie}serialize(){if(this.isEmpty())return null;const se=V._internalPadding*this.parentScale,ne=this.getRect(se,se),ee=Y.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#r);return{annotationType:F.AnnotationEditorType.FREETEXT,color:ee,fontSize:this.#a,value:this.#d,pageIndex:this.pageIndex,rect:ne,rotation:this.rotation}}}e.FreeTextEditor=V},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,Object.defineProperty(e,"fitCurve",{enumerable:!0,get:function(){return Y.fitCurve}});var F=C(1),$=C(4),Y=C(30),V=C(5);const te=16;class se extends $.AnnotationEditor{#e=0;#t=0;#s=0;#n=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#d=this.canvasPointerup.bind(this);#l=this.canvasPointerdown.bind(this);#i=!1;#a=!1;#h=null;#c=null;#u=0;#o=0;#m=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(ee){super({...ee,name:"inkEditor"}),this.color=ee.color||null,this.thickness=ee.thickness||null,this.opacity=ee.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(ee){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ie=>[ie,ee.get(ie)]))}static updateDefaultParams(ee,ie){switch(ee){case F.AnnotationEditorParamsType.INK_THICKNESS:se._defaultThickness=ie;break;case F.AnnotationEditorParamsType.INK_COLOR:se._defaultColor=ie;break;case F.AnnotationEditorParamsType.INK_OPACITY:se._defaultOpacity=ie/100;break}}updateParams(ee,ie){switch(ee){case F.AnnotationEditorParamsType.INK_THICKNESS:this.#S(ie);break;case F.AnnotationEditorParamsType.INK_COLOR:this.#E(ie);break;case F.AnnotationEditorParamsType.INK_OPACITY:this.#v(ie);break}}static get defaultPropertiesToUpdate(){return[[F.AnnotationEditorParamsType.INK_THICKNESS,se._defaultThickness],[F.AnnotationEditorParamsType.INK_COLOR,se._defaultColor||$.AnnotationEditor._defaultLineColor],[F.AnnotationEditorParamsType.INK_OPACITY,Math.round(se._defaultOpacity*100)]]}get propertiesToUpdate(){return[[F.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||se._defaultThickness],[F.AnnotationEditorParamsType.INK_COLOR,this.color||se._defaultColor||$.AnnotationEditor._defaultLineColor],[F.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??se._defaultOpacity))]]}#S(ee){const ie=this.thickness;this.addCommands({cmd:()=>{this.thickness=ee,this.#b()},undo:()=>{this.thickness=ie,this.#b()},mustExec:!0,type:F.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#E(ee){const ie=this.color;this.addCommands({cmd:()=>{this.color=ee,this.#p()},undo:()=>{this.color=ie,this.#p()},mustExec:!0,type:F.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#v(ee){ee/=100;const ie=this.opacity;this.addCommands({cmd:()=>{this.opacity=ee,this.#p()},undo:()=>{this.opacity=ie,this.#p()},mustExec:!0,type:F.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#y(),this.#w()),this.isAttachedToDOM||(this.parent.add(this),this.#A()),this.#b())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#c.disconnect(),this.#c=null,super.remove())}setParent(ee){!this.parent&&ee?this._uiManager.removeShouldRescale(this):this.parent&&ee===null&&this._uiManager.addShouldRescale(this),super.setParent(ee)}onScaleChanging(){const[ee,ie]=this.parentDimensions,ae=this.width*ee,re=this.height*ie;this.setDimensions(ae,re)}enableEditMode(){this.#i||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#l),this.canvas.addEventListener("pointerup",this.#d))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#l),this.canvas.removeEventListener("pointerup",this.#d))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#T(){const{parentRotation:ee,parentDimensions:[ie,ae]}=this;switch(ee){case 90:return[0,ae,ae,ie];case 180:return[ie,ae,ie,ae];case 270:return[ie,0,ae,ie];default:return[0,0,ie,ae]}}#C(){const{ctx:ee,color:ie,opacity:ae,thickness:re,parentScale:oe,scaleFactor:ce}=this;ee.lineWidth=re*oe/ce,ee.lineCap="round",ee.lineJoin="round",ee.miterLimit=10,ee.strokeStyle=`${ie}${(0,V.opacityToHex)(ae)}`}#R(ee,ie){this.isEditing=!0,this.#a||(this.#a=!0,this.#A(),this.thickness||=se._defaultThickness,this.color||=se._defaultColor||$.AnnotationEditor._defaultLineColor,this.opacity??=se._defaultOpacity),this.currentPath.push([ee,ie]),this.#h=null,this.#C(),this.ctx.beginPath(),this.ctx.moveTo(ee,ie),this.#m=()=>{this.#m&&(this.#h&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#p(),this.ctx.lineTo(...this.#h),this.#h=null,this.ctx.stroke()),window.requestAnimationFrame(this.#m))},window.requestAnimationFrame(this.#m)}#P(ee,ie){const[ae,re]=this.currentPath.at(-1);ee===ae&&ie===re||(this.currentPath.push([ee,ie]),this.#h=[ee,ie])}#k(ee,ie){this.ctx.closePath(),this.#m=null,ee=Math.min(Math.max(ee,0),this.canvas.width),ie=Math.min(Math.max(ie,0),this.canvas.height);const[ae,re]=this.currentPath.at(-1);(ee!==ae||ie!==re)&&this.currentPath.push([ee,ie]);let oe;if(this.currentPath.length!==1)oe=(0,Y.fitCurve)(this.currentPath,30,null);else{const pe=[ee,ie];oe=[[pe,pe.slice(),pe.slice(),pe]]}const ce=se.#I(oe);this.currentPath.length=0;const he=()=>{this.paths.push(oe),this.bezierPath2D.push(ce),this.rebuild()},de=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#y(),this.#w()),this.#b())};this.addCommands({cmd:he,undo:de,mustExec:!0})}#p(){if(this.isEmpty()){this.#g();return}this.#C();const{canvas:ee,ctx:ie}=this;ie.setTransform(1,0,0,1,0,0),ie.clearRect(0,0,ee.width,ee.height),this.#g();for(const ae of this.bezierPath2D)ie.stroke(ae)}commit(){this.#i||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#i=!0,this.div.classList.add("disabled"),this.#b(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(ee){super.focusin(ee),this.enableEditMode()}canvasPointerdown(ee){ee.button!==0||!this.isInEditMode()||this.#i||(this.setInForeground(),ee.type!=="mouse"&&this.div.focus(),ee.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#n),this.#R(ee.offsetX,ee.offsetY))}canvasPointermove(ee){ee.stopPropagation(),this.#P(ee.offsetX,ee.offsetY)}canvasPointerup(ee){ee.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(ee.stopPropagation(),this.#D(ee),this.setInBackground())}canvasPointerleave(ee){this.#D(ee),this.setInBackground()}#D(ee){this.#k(ee.offsetX,ee.offsetY),this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#n),this.addToAnnotationStorage()}#y(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",se._l10nPromise.get("editor_ink_canvas_aria_label").then(ee=>this.canvas?.setAttribute("aria-label",ee)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#w(){this.#c=new ResizeObserver(ee=>{const ie=ee[0].contentRect;ie.width&&ie.height&&this.setDimensions(ie.width,ie.height)}),this.#c.observe(this.div)}render(){if(this.div)return this.div;let ee,ie;this.width&&(ee=this.x,ie=this.y),super.render(),se._l10nPromise.get("editor_ink2_aria_label").then(he=>this.div?.setAttribute("aria-label",he));const[ae,re,oe,ce]=this.#T();if(this.setAt(ae,re,0,0),this.setDims(oe,ce),this.#y(),this.width){const[he,de]=this.parentDimensions;this.setAt(ee*he,ie*de,this.width*he,this.height*de),this.#a=!0,this.#A(),this.setDims(this.width*he,this.height*de),this.#p(),this.#O(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#w(),this.div}#A(){if(!this.#a)return;const[ee,ie]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*ee),this.canvas.height=Math.ceil(this.height*ie),this.#g()}setDimensions(ee,ie){const ae=Math.round(ee),re=Math.round(ie);if(this.#u===ae&&this.#o===re)return;this.#u=ae,this.#o=re,this.canvas.style.visibility="hidden",this.#e&&Math.abs(this.#e-ee/ie)>.01&&(ie=Math.ceil(ee/this.#e),this.setDims(ee,ie));const[oe,ce]=this.parentDimensions;this.width=ee/oe,this.height=ie/ce,this.#i&&this.#f(ee,ie),this.#A(),this.#p(),this.canvas.style.visibility="visible",this.fixDims()}#f(ee,ie){const ae=this.#L(),re=(ee-ae)/this.#s,oe=(ie-ae)/this.#t;this.scaleFactor=Math.min(re,oe)}#g(){const ee=this.#L()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+ee,this.translationY*this.scaleFactor+ee)}static#I(ee){const ie=new Path2D;for(let ae=0,re=ee.length;ae<re;ae++){const[oe,ce,he,de]=ee[ae];ae===0&&ie.moveTo(...oe),ie.bezierCurveTo(ce[0],ce[1],he[0],he[1],de[0],de[1])}return ie}#B(ee,ie,ae,re){const ce=[],he=this.thickness/2;let de,pe;for(const fe of this.paths){de=[],pe=[];for(let ye=0,_e=fe.length;ye<_e;ye++){const[Ee,be,Ae,we]=fe[ye],Te=ee*(Ee[0]+ie)+he,Me=re-ee*(Ee[1]+ae)-he,Be=ee*(be[0]+ie)+he,$e=re-ee*(be[1]+ae)-he,Fe=ee*(Ae[0]+ie)+he,Xe=re-ee*(Ae[1]+ae)-he,We=ee*(we[0]+ie)+he,Ie=re-ee*(we[1]+ae)-he;ye===0&&(de.push(Te,Me),pe.push(Te,Me)),de.push(Be,$e,Fe,Xe,We,Ie),this.#M(Te,Me,Be,$e,Fe,Xe,We,Ie,4,pe)}ce.push({bezier:de,points:pe})}return ce}#M(ee,ie,ae,re,oe,ce,he,de,pe,fe){if(this.#_(ee,ie,ae,re,oe,ce,he,de)){fe.push(he,de);return}for(let ye=1;ye<pe-1;ye++){const _e=ye/pe,Ee=1-_e;let be=_e*ee+Ee*ae,Ae=_e*ie+Ee*re,we=_e*ae+Ee*oe,Te=_e*re+Ee*ce;const Me=_e*oe+Ee*he,Be=_e*ce+Ee*de;be=_e*be+Ee*we,Ae=_e*Ae+Ee*Te,we=_e*we+Ee*Me,Te=_e*Te+Ee*Be,be=_e*be+Ee*we,Ae=_e*Ae+Ee*Te,fe.push(be,Ae)}fe.push(he,de)}#_(ee,ie,ae,re,oe,ce,he,de){const fe=(3*ae-2*ee-he)**2,ye=(3*re-2*ie-de)**2,_e=(3*oe-ee-2*he)**2,Ee=(3*ce-ie-2*de)**2;return Math.max(fe,_e)+Math.max(ye,Ee)<=10}#x(){let ee=1/0,ie=-1/0,ae=1/0,re=-1/0;for(const oe of this.paths)for(const[ce,he,de,pe]of oe){const fe=F.Util.bezierBoundingBox(...ce,...he,...de,...pe);ee=Math.min(ee,fe[0]),ae=Math.min(ae,fe[1]),ie=Math.max(ie,fe[2]),re=Math.max(re,fe[3])}return[ee,ae,ie,re]}#L(){return this.#i?Math.ceil(this.thickness*this.parentScale):0}#b(ee=!1){if(this.isEmpty())return;if(!this.#i){this.#p();return}const ie=this.#x(),ae=this.#L();this.#s=Math.max(te,ie[2]-ie[0]),this.#t=Math.max(te,ie[3]-ie[1]);const re=Math.ceil(ae+this.#s*this.scaleFactor),oe=Math.ceil(ae+this.#t*this.scaleFactor),[ce,he]=this.parentDimensions;this.width=re/ce,this.height=oe/he,this.#e=re/oe,this.#O();const de=this.translationX,pe=this.translationY;this.translationX=-ie[0],this.translationY=-ie[1],this.#A(),this.#p(),this.#u=re,this.#o=oe,this.setDims(re,oe);const fe=ee?ae/this.scaleFactor/2:0;this.translate(de-this.translationX-fe,pe-this.translationY-fe)}#O(){const{style:ee}=this.div;this.#e>=1?(ee.minHeight=`${te}px`,ee.minWidth=`${Math.round(this.#e*te)}px`):(ee.minWidth=`${te}px`,ee.minHeight=`${Math.round(te/this.#e)}px`)}static deserialize(ee,ie,ae){const re=super.deserialize(ee,ie,ae);re.thickness=ee.thickness,re.color=F.Util.makeHexColor(...ee.color),re.opacity=ee.opacity;const[oe,ce]=re.pageDimensions,he=re.width*oe,de=re.height*ce,pe=re.parentScale,fe=ee.thickness/2;re.#e=he/de,re.#i=!0,re.#u=Math.round(he),re.#o=Math.round(de);for(const{bezier:_e}of ee.paths){const Ee=[];re.paths.push(Ee);let be=pe*(_e[0]-fe),Ae=pe*(de-_e[1]-fe);for(let Te=2,Me=_e.length;Te<Me;Te+=6){const Be=pe*(_e[Te]-fe),$e=pe*(de-_e[Te+1]-fe),Fe=pe*(_e[Te+2]-fe),Xe=pe*(de-_e[Te+3]-fe),We=pe*(_e[Te+4]-fe),Ie=pe*(de-_e[Te+5]-fe);Ee.push([[be,Ae],[Be,$e],[Fe,Xe],[We,Ie]]),be=We,Ae=Ie}const we=this.#I(Ee);re.bezierPath2D.push(we)}const ye=re.#x();return re.#s=Math.max(te,ye[2]-ye[0]),re.#t=Math.max(te,ye[3]-ye[1]),re.#f(he,de),re}serialize(){if(this.isEmpty())return null;const ee=this.getRect(0,0),ie=this.rotation%180===0?ee[3]-ee[1]:ee[2]-ee[0],ae=$.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:F.AnnotationEditorType.INK,color:ae,thickness:this.thickness,opacity:this.opacity,paths:this.#B(this.scaleFactor/this.parentScale,this.translationX,this.translationY,ie),pageIndex:this.pageIndex,rect:ee,rotation:this.rotation}}}e.InkEditor=se},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fitCurve=void 0;const F=C(31);e.fitCurve=F},J=>{function e(oe,ce,he){if(!Array.isArray(oe))throw new TypeError("First argument should be an array");if(oe.forEach(ye=>{if(!Array.isArray(ye)||ye.some(_e=>typeof _e!="number")||ye.length!==oe[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),oe=oe.filter((ye,_e)=>_e===0||!ye.every((Ee,be)=>Ee===oe[_e-1][be])),oe.length<2)return[];const de=oe.length,pe=ie(oe[1],oe[0]),fe=ie(oe[de-2],oe[de-1]);return C(oe,pe,fe,ce,he)}function C(oe,ce,he,de,pe){var ye,_e,Ee,be,Ae,we,Te,Me,Be,$e,Fe,Xe,We;if(oe.length===2)return Xe=ae.vectorLen(ae.subtract(oe[0],oe[1]))/3,ye=[oe[0],ae.addArrays(oe[0],ae.mulItems(ce,Xe)),ae.addArrays(oe[1],ae.mulItems(he,Xe)),oe[1]],[ye];if(_e=te(oe),[ye,be,we]=F(oe,_e,_e,ce,he,pe),be===0||be<de)return[ye];if(be<de*de)for(Ee=_e,Ae=be,Te=we,We=0;We<20;We++){if(Ee=Y(ye,oe,Ee),[ye,be,we]=F(oe,_e,Ee,ce,he,pe),be<de)return[ye];if(we===Te){let Ie=be/Ae;if(Ie>.9999&&Ie<1.0001)break}Ae=be,Te=we}return Fe=[],Me=ae.subtract(oe[we-1],oe[we+1]),Me.every(Ie=>Ie===0)&&(Me=ae.subtract(oe[we-1],oe[we]),[Me[0],Me[1]]=[-Me[1],Me[0]]),Be=ae.normalize(Me),$e=ae.mulItems(Be,-1),Fe=Fe.concat(C(oe.slice(0,we+1),ce,Be,de,pe)),Fe=Fe.concat(C(oe.slice(we),$e,he,de,pe)),Fe}function F(oe,ce,he,de,pe,fe){var ye,_e,Ee;return ye=$(oe,he,de,pe),[_e,Ee]=se(oe,ye,ce),fe&&fe({bez:ye,points:oe,params:ce,maxErr:_e,maxPoint:Ee}),[ye,_e,Ee]}function $(oe,ce,he,de){var pe,fe,ye,_e,Ee,be,Ae,we,Te,Me,Be,$e,Fe,Xe,We,Ie,Oe,Pe=oe[0],ge=oe[oe.length-1];for(pe=[Pe,null,null,ge],fe=ae.zeros_Xx2x2(ce.length),Fe=0,Xe=ce.length;Fe<Xe;Fe++)Ie=ce[Fe],Oe=1-Ie,ye=fe[Fe],ye[0]=ae.mulItems(he,3*Ie*(Oe*Oe)),ye[1]=ae.mulItems(de,3*Oe*(Ie*Ie));for(_e=[[0,0],[0,0]],Ee=[0,0],Fe=0,Xe=oe.length;Fe<Xe;Fe++)Ie=ce[Fe],ye=fe[Fe],_e[0][0]+=ae.dot(ye[0],ye[0]),_e[0][1]+=ae.dot(ye[0],ye[1]),_e[1][0]+=ae.dot(ye[0],ye[1]),_e[1][1]+=ae.dot(ye[1],ye[1]),We=ae.subtract(oe[Fe],re.q([Pe,Pe,ge,ge],Ie)),Ee[0]+=ae.dot(ye[0],We),Ee[1]+=ae.dot(ye[1],We);return be=_e[0][0]*_e[1][1]-_e[1][0]*_e[0][1],Ae=_e[0][0]*Ee[1]-_e[1][0]*Ee[0],we=Ee[0]*_e[1][1]-Ee[1]*_e[0][1],Te=be===0?0:we/be,Me=be===0?0:Ae/be,$e=ae.vectorLen(ae.subtract(Pe,ge)),Be=1e-6*$e,Te<Be||Me<Be?(pe[1]=ae.addArrays(Pe,ae.mulItems(he,$e/3)),pe[2]=ae.addArrays(ge,ae.mulItems(de,$e/3))):(pe[1]=ae.addArrays(Pe,ae.mulItems(he,Te)),pe[2]=ae.addArrays(ge,ae.mulItems(de,Me))),pe}function Y(oe,ce,he){return he.map((de,pe)=>V(oe,ce[pe],de))}function V(oe,ce,he){var de=ae.subtract(re.q(oe,he),ce),pe=re.qprime(oe,he),fe=ae.mulMatrix(de,pe),ye=ae.sum(ae.squareItems(pe))+2*ae.mulMatrix(de,re.qprimeprime(oe,he));return ye===0?he:he-fe/ye}function te(oe){var ce=[],he,de,pe;return oe.forEach((fe,ye)=>{he=ye?de+ae.vectorLen(ae.subtract(fe,pe)):0,ce.push(he),de=he,pe=fe}),ce=ce.map(fe=>fe/de),ce}function se(oe,ce,he){var de,pe,fe,ye,_e,Ee,be,Ae;pe=0,fe=Math.floor(oe.length/2);const we=ne(ce,10);for(_e=0,Ee=oe.length;_e<Ee;_e++)be=oe[_e],Ae=ee(ce,he[_e],we,10),ye=ae.subtract(re.q(ce,Ae),be),de=ye[0]*ye[0]+ye[1]*ye[1],de>pe&&(pe=de,fe=_e);return[pe,fe]}var ne=function(oe,ce){for(var he,de=[0],pe=oe[0],fe=0,ye=1;ye<=ce;ye++)he=re.q(oe,ye/ce),fe+=ae.vectorLen(ae.subtract(he,pe)),de.push(fe),pe=he;return de=de.map(_e=>_e/fe),de};function ee(oe,ce,he,de){if(ce<0)return 0;if(ce>1)return 1;for(var pe,fe,ye,_e,Ee,be=1;be<=de;be++)if(ce<=he[be]){_e=(be-1)/de,ye=be/de,fe=he[be-1],pe=he[be],Ee=(ce-fe)/(pe-fe)*(ye-_e)+_e;break}return Ee}function ie(oe,ce){return ae.normalize(ae.subtract(oe,ce))}class ae{static zeros_Xx2x2(ce){for(var he=[];ce--;)he.push([0,0]);return he}static mulItems(ce,he){return ce.map(de=>de*he)}static mulMatrix(ce,he){return ce.reduce((de,pe,fe)=>de+pe*he[fe],0)}static subtract(ce,he){return ce.map((de,pe)=>de-he[pe])}static addArrays(ce,he){return ce.map((de,pe)=>de+he[pe])}static addItems(ce,he){return ce.map(de=>de+he)}static sum(ce){return ce.reduce((he,de)=>he+de)}static dot(ce,he){return ae.mulMatrix(ce,he)}static vectorLen(ce){return Math.hypot(...ce)}static divItems(ce,he){return ce.map(de=>de/he)}static squareItems(ce){return ce.map(he=>he*he)}static normalize(ce){return this.divItems(ce,this.vectorLen(ce))}}class re{static q(ce,he){var de=1-he,pe=ae.mulItems(ce[0],de*de*de),fe=ae.mulItems(ce[1],3*de*de*he),ye=ae.mulItems(ce[2],3*de*he*he),_e=ae.mulItems(ce[3],he*he*he);return ae.addArrays(ae.addArrays(pe,fe),ae.addArrays(ye,_e))}static qprime(ce,he){var de=1-he,pe=ae.mulItems(ae.subtract(ce[1],ce[0]),3*de*de),fe=ae.mulItems(ae.subtract(ce[2],ce[1]),6*de*he),ye=ae.mulItems(ae.subtract(ce[3],ce[2]),3*he*he);return ae.addArrays(ae.addArrays(pe,fe),ye)}static qprimeprime(ce,he){return ae.addArrays(ae.mulItems(ae.addArrays(ae.subtract(ce[2],ae.mulItems(ce[1],2)),ce[0]),6*(1-he)),ae.mulItems(ae.addArrays(ae.subtract(ce[3],ae.mulItems(ce[2],2)),ce[1]),6*he))}}J.exports=e,J.exports.fitCubic=C,J.exports.createTangent=ie},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationLayer=void 0;var F=C(1),$=C(6),Y=C(3),V=C(33),te=C(34);const se=1e3,ne=9,ee=new WeakSet;function ie(ve){return{width:ve[2]-ve[0],height:ve[3]-ve[1]}}class ae{static create(le){switch(le.data.annotationType){case F.AnnotationType.LINK:return new oe(le);case F.AnnotationType.TEXT:return new ce(le);case F.AnnotationType.WIDGET:switch(le.data.fieldType){case"Tx":return new de(le);case"Btn":return le.data.radioButton?new fe(le):le.data.checkBox?new pe(le):new ye(le);case"Ch":return new _e(le)}return new he(le);case F.AnnotationType.POPUP:return new Ee(le);case F.AnnotationType.FREETEXT:return new Ae(le);case F.AnnotationType.LINE:return new we(le);case F.AnnotationType.SQUARE:return new Te(le);case F.AnnotationType.CIRCLE:return new Me(le);case F.AnnotationType.POLYLINE:return new Be(le);case F.AnnotationType.CARET:return new Fe(le);case F.AnnotationType.INK:return new Xe(le);case F.AnnotationType.POLYGON:return new $e(le);case F.AnnotationType.HIGHLIGHT:return new We(le);case F.AnnotationType.UNDERLINE:return new Ie(le);case F.AnnotationType.SQUIGGLY:return new Oe(le);case F.AnnotationType.STRIKEOUT:return new Pe(le);case F.AnnotationType.STAMP:return new ge(le);case F.AnnotationType.FILEATTACHMENT:return new ue(le);default:return new re(le)}}}class re{constructor(le,{isRenderable:me=!1,ignoreBorder:Ce=!1,createQuadrilaterals:Se=!1}={}){this.isRenderable=me,this.data=le.data,this.layer=le.layer,this.page=le.page,this.viewport=le.viewport,this.linkService=le.linkService,this.downloadManager=le.downloadManager,this.imageResourcesPath=le.imageResourcesPath,this.renderForms=le.renderForms,this.svgFactory=le.svgFactory,this.annotationStorage=le.annotationStorage,this.enableScripting=le.enableScripting,this.hasJSActions=le.hasJSActions,this._fieldObjects=le.fieldObjects,me&&(this.container=this._createContainer(Ce)),Se&&(this.quadrilaterals=this._createQuadrilaterals(Ce))}_createContainer(le=!1){const{data:me,page:Ce,viewport:Se}=this,Re=document.createElement("section");Re.setAttribute("data-annotation-id",me.id),me.noRotate&&Re.classList.add("norotate");const{pageWidth:ke,pageHeight:De,pageX:Ne,pageY:Ge}=Se.rawDims,{width:Le,height:ze}=ie(me.rect),Ve=F.Util.normalizeRect([me.rect[0],Ce.view[3]-me.rect[1]+Ce.view[1],me.rect[2],Ce.view[3]-me.rect[3]+Ce.view[1]]);if(!le&&me.borderStyle.width>0){Re.style.borderWidth=`${me.borderStyle.width}px`;const Ke=me.borderStyle.horizontalCornerRadius,Ye=me.borderStyle.verticalCornerRadius;if(Ke>0||Ye>0){const Je=`calc(${Ke}px * var(--scale-factor)) / calc(${Ye}px * var(--scale-factor))`;Re.style.borderRadius=Je}else if(this instanceof fe){const Je=`calc(${Le}px * var(--scale-factor)) / calc(${ze}px * var(--scale-factor))`;Re.style.borderRadius=Je}switch(me.borderStyle.style){case F.AnnotationBorderStyleType.SOLID:Re.style.borderStyle="solid";break;case F.AnnotationBorderStyleType.DASHED:Re.style.borderStyle="dashed";break;case F.AnnotationBorderStyleType.BEVELED:(0,F.warn)("Unimplemented border style: beveled");break;case F.AnnotationBorderStyleType.INSET:(0,F.warn)("Unimplemented border style: inset");break;case F.AnnotationBorderStyleType.UNDERLINE:Re.style.borderBottomStyle="solid";break}const Ze=me.borderColor||null;Ze?Re.style.borderColor=F.Util.makeHexColor(Ze[0]|0,Ze[1]|0,Ze[2]|0):Re.style.borderWidth=0}Re.style.left=`${100*(Ve[0]-Ne)/ke}%`,Re.style.top=`${100*(Ve[1]-Ge)/De}%`;const{rotation:je}=me;return me.hasOwnCanvas||je===0?(Re.style.width=`${100*Le/ke}%`,Re.style.height=`${100*ze/De}%`):this.setRotation(je,Re),Re}setRotation(le,me=this.container){const{pageWidth:Ce,pageHeight:Se}=this.viewport.rawDims,{width:Re,height:ke}=ie(this.data.rect);let De,Ne;le%180===0?(De=100*Re/Ce,Ne=100*ke/Se):(De=100*ke/Ce,Ne=100*Re/Se),me.style.width=`${De}%`,me.style.height=`${Ne}%`,me.setAttribute("data-main-rotation",(360-le)%360)}get _commonActions(){const le=(me,Ce,Se)=>{const Re=Se.detail[me];Se.target.style[Ce]=V.ColorConverters[`${Re[0]}_HTML`](Re.slice(1))};return(0,F.shadow)(this,"_commonActions",{display:me=>{const Ce=me.detail.display%2===1;this.container.style.visibility=Ce?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:Ce,print:me.detail.display===0||me.detail.display===3})},print:me=>{this.annotationStorage.setValue(this.data.id,{print:me.detail.print})},hidden:me=>{this.container.style.visibility=me.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:me.detail.hidden})},focus:me=>{setTimeout(()=>me.target.focus({preventScroll:!1}),0)},userName:me=>{me.target.title=me.detail.userName},readonly:me=>{me.detail.readonly?me.target.setAttribute("readonly",""):me.target.removeAttribute("readonly")},required:me=>{this._setRequired(me.target,me.detail.required)},bgColor:me=>{le("bgColor","backgroundColor",me)},fillColor:me=>{le("fillColor","backgroundColor",me)},fgColor:me=>{le("fgColor","color",me)},textColor:me=>{le("textColor","color",me)},borderColor:me=>{le("borderColor","borderColor",me)},strokeColor:me=>{le("strokeColor","borderColor",me)},rotation:me=>{const Ce=me.detail.rotation;this.setRotation(Ce),this.annotationStorage.setValue(this.data.id,{rotation:Ce})}})}_dispatchEventFromSandbox(le,me){const Ce=this._commonActions;for(const Se of Object.keys(me.detail))(le[Se]||Ce[Se])?.(me)}_setDefaultPropertiesFromJS(le){if(!this.enableScripting)return;const me=this.annotationStorage.getRawValue(this.data.id);if(!me)return;const Ce=this._commonActions;for(const[Se,Re]of Object.entries(me)){const ke=Ce[Se];if(ke){const De={detail:{[Se]:Re},target:le};ke(De),delete me[Se]}}}_createQuadrilaterals(le=!1){if(!this.data.quadPoints)return null;const me=[],Ce=this.data.rect;for(const Se of this.data.quadPoints)this.data.rect=[Se[2].x,Se[2].y,Se[1].x,Se[1].y],me.push(this._createContainer(le));return this.data.rect=Ce,me}_createPopup(le,me){let Ce=this.container;this.quadrilaterals&&(le||=this.quadrilaterals,Ce=this.quadrilaterals[0]),le||(le=document.createElement("div"),le.classList.add("popupTriggerArea"),Ce.append(le));const Re=new be({container:Ce,trigger:le,color:me.color,titleObj:me.titleObj,modificationDate:me.modificationDate,contentsObj:me.contentsObj,richText:me.richText,hideWrapper:!0}).render();Re.style.left="100%",Ce.append(Re)}_renderQuadrilaterals(le){for(const me of this.quadrilaterals)me.classList.add(le);return this.quadrilaterals}render(){(0,F.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(le,me=null){const Ce=[];if(this._fieldObjects){const Se=this._fieldObjects[le];if(Se)for(const{page:Re,id:ke,exportValues:De}of Se){if(Re===-1||ke===me)continue;const Ne=typeof De=="string"?De:null,Ge=document.querySelector(`[data-element-id="${ke}"]`);if(Ge&&!ee.has(Ge)){(0,F.warn)(`_getElementsByName - element not allowed: ${ke}`);continue}Ce.push({id:ke,exportValue:Ne,domElement:Ge})}return Ce}for(const Se of document.getElementsByName(le)){const{exportValue:Re}=Se,ke=Se.getAttribute("data-element-id");ke!==me&&ee.has(Se)&&Ce.push({id:ke,exportValue:Re,domElement:Se})}return Ce}}class oe extends re{constructor(le,me=null){super(le,{isRenderable:!0,ignoreBorder:!!me?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=le.data.isTooltipOnly}render(){const{data:le,linkService:me}=this,Ce=document.createElement("a");Ce.setAttribute("data-element-id",le.id);let Se=!1;return le.url?(me.addLinkAttributes(Ce,le.url,le.newWindow),Se=!0):le.action?(this._bindNamedAction(Ce,le.action),Se=!0):le.attachment?(this._bindAttachment(Ce,le.attachment),Se=!0):le.setOCGState?(this.#t(Ce,le.setOCGState),Se=!0):le.dest?(this._bindLink(Ce,le.dest),Se=!0):(le.actions&&(le.actions.Action||le.actions["Mouse Up"]||le.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Ce,le),Se=!0),le.resetForm?(this._bindResetFormAction(Ce,le.resetForm),Se=!0):this.isTooltipOnly&&!Se&&(this._bindLink(Ce,""),Se=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((Re,ke)=>{const De=ke===0?Ce:Ce.cloneNode();return Re.append(De),Re}):(this.container.classList.add("linkAnnotation"),Se&&this.container.append(Ce),this.container)}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(le,me){le.href=this.linkService.getDestinationHash(me),le.onclick=()=>(me&&this.linkService.goToDestination(me),!1),(me||me==="")&&this.#e()}_bindNamedAction(le,me){le.href=this.linkService.getAnchorUrl(""),le.onclick=()=>(this.linkService.executeNamedAction(me),!1),this.#e()}_bindAttachment(le,me){le.href=this.linkService.getAnchorUrl(""),le.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,me.content,me.filename),!1),this.#e()}#t(le,me){le.href=this.linkService.getAnchorUrl(""),le.onclick=()=>(this.linkService.executeSetOCGState(me),!1),this.#e()}_bindJSAction(le,me){le.href=this.linkService.getAnchorUrl("");const Ce=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Se of Object.keys(me.actions)){const Re=Ce.get(Se);Re&&(le[Re]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:me.id,name:Se}}),!1))}le.onclick||(le.onclick=()=>!1),this.#e()}_bindResetFormAction(le,me){const Ce=le.onclick;if(Ce||(le.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,F.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Ce||(le.onclick=()=>!1);return}le.onclick=()=>{Ce?.();const{fields:Se,refs:Re,include:ke}=me,De=[];if(Se.length!==0||Re.length!==0){const Le=new Set(Re);for(const ze of Se){const Ve=this._fieldObjects[ze]||[];for(const{id:je}of Ve)Le.add(je)}for(const ze of Object.values(this._fieldObjects))for(const Ve of ze)Le.has(Ve.id)===ke&&De.push(Ve)}else for(const Le of Object.values(this._fieldObjects))De.push(...Le);const Ne=this.annotationStorage,Ge=[];for(const Le of De){const{id:ze}=Le;switch(Ge.push(ze),Le.type){case"text":{const je=Le.defaultValue||"";Ne.setValue(ze,{value:je});break}case"checkbox":case"radiobutton":{const je=Le.defaultValue===Le.exportValues;Ne.setValue(ze,{value:je});break}case"combobox":case"listbox":{const je=Le.defaultValue||"";Ne.setValue(ze,{value:je});break}default:continue}const Ve=document.querySelector(`[data-element-id="${ze}"]`);if(Ve){if(!ee.has(Ve)){(0,F.warn)(`_bindResetFormAction - element not allowed: ${ze}`);continue}}else continue;Ve.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Ge,name:"ResetForm"}}),!1}}}class ce extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me})}render(){this.container.classList.add("textAnnotation");const le=document.createElement("img");return le.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",le.alt="[{{type}} Annotation]",le.dataset.l10nId="text_annotation_type",le.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(le,this.data),this.container.append(le),this.container}}class he extends re{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(le){this.data.hasOwnCanvas&&(le.previousSibling?.nodeName==="CANVAS"&&(le.previousSibling.hidden=!0),le.hidden=!1)}_getKeyModifier(le){const{isWin:me,isMac:Ce}=F.FeatureTest.platform;return me&&le.ctrlKey||Ce&&le.metaKey}_setEventListener(le,me,Ce,Se){me.includes("mouse")?le.addEventListener(me,Re=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ce,value:Se(Re),shift:Re.shiftKey,modifier:this._getKeyModifier(Re)}})}):le.addEventListener(me,Re=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ce,value:Se(Re)}})})}_setEventListeners(le,me,Ce){for(const[Se,Re]of me)(Re==="Action"||this.data.actions?.[Re])&&this._setEventListener(le,Se,Re,Ce)}_setBackgroundColor(le){const me=this.data.backgroundColor||null;le.style.backgroundColor=me===null?"transparent":F.Util.makeHexColor(me[0],me[1],me[2])}_setTextStyle(le){const me=["left","center","right"],{fontColor:Ce}=this.data.defaultAppearanceData,Se=this.data.defaultAppearanceData.fontSize||ne,Re=le.style;let ke;const De=2,Ne=Ge=>Math.round(10*Ge)/10;if(this.data.multiLine){const Ge=Math.abs(this.data.rect[3]-this.data.rect[1]-De),Le=Math.round(Ge/(F.LINE_FACTOR*Se))||1,ze=Ge/Le;ke=Math.min(Se,Ne(ze/F.LINE_FACTOR))}else{const Ge=Math.abs(this.data.rect[3]-this.data.rect[1]-De);ke=Math.min(Se,Ne(Ge/F.LINE_FACTOR))}Re.fontSize=`calc(${ke}px * var(--scale-factor))`,Re.color=F.Util.makeHexColor(Ce[0],Ce[1],Ce[2]),this.data.textAlignment!==null&&(Re.textAlign=me[this.data.textAlignment])}_setRequired(le,me){me?le.setAttribute("required",!0):le.removeAttribute("required"),le.setAttribute("aria-required",me)}}class de extends he{constructor(le){const me=le.renderForms||!le.data.hasAppearance&&!!le.data.fieldValue;super(le,{isRenderable:me})}setPropertyOnSiblings(le,me,Ce,Se){const Re=this.annotationStorage;for(const ke of this._getElementsByName(le.name,le.id))ke.domElement&&(ke.domElement[me]=Ce),Re.setValue(ke.id,{[Se]:Ce})}render(){const le=this.annotationStorage,me=this.data.id;this.container.classList.add("textWidgetAnnotation");let Ce=null;if(this.renderForms){const Se=le.getValue(me,{value:this.data.fieldValue});let Re=Se.formattedValue||Se.value||"";const ke=le.getValue(me,{charLimit:this.data.maxLen}).charLimit;ke&&Re.length>ke&&(Re=Re.slice(0,ke));const De={userValue:Re,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(Ce=document.createElement("textarea"),Ce.textContent=Re,this.data.doNotScroll&&(Ce.style.overflowY="hidden")):(Ce=document.createElement("input"),Ce.type="text",Ce.setAttribute("value",Re),this.data.doNotScroll&&(Ce.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Ce.hidden=!0),ee.add(Ce),Ce.setAttribute("data-element-id",me),Ce.disabled=this.data.readOnly,Ce.name=this.data.fieldName,Ce.tabIndex=se,this._setRequired(Ce,this.data.required),ke&&(Ce.maxLength=ke),Ce.addEventListener("input",Ge=>{le.setValue(me,{value:Ge.target.value}),this.setPropertyOnSiblings(Ce,"value",Ge.target.value,"value")}),Ce.addEventListener("resetform",Ge=>{const Le=this.data.defaultFieldValue??"";Ce.value=De.userValue=Le,De.formattedValue=null});let Ne=Ge=>{const{formattedValue:Le}=De;Le!=null&&(Ge.target.value=Le),Ge.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Ce.addEventListener("focus",Le=>{const{target:ze}=Le;De.userValue&&(ze.value=De.userValue),De.lastCommittedValue=ze.value,De.commitKey=1}),Ce.addEventListener("updatefromsandbox",Le=>{this.showElementAndHideCanvas(Le.target);const ze={value(Ve){De.userValue=Ve.detail.value??"",le.setValue(me,{value:De.userValue.toString()}),Ve.target.value=De.userValue},formattedValue(Ve){const{formattedValue:je}=Ve.detail;De.formattedValue=je,je!=null&&Ve.target!==document.activeElement&&(Ve.target.value=je),le.setValue(me,{formattedValue:je})},selRange(Ve){Ve.target.setSelectionRange(...Ve.detail.selRange)},charLimit:Ve=>{const{charLimit:je}=Ve.detail,{target:Ke}=Ve;if(je===0){Ke.removeAttribute("maxLength");return}Ke.setAttribute("maxLength",je);let Ye=De.userValue;!Ye||Ye.length<=je||(Ye=Ye.slice(0,je),Ke.value=De.userValue=Ye,le.setValue(me,{value:Ye}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:me,name:"Keystroke",value:Ye,willCommit:!0,commitKey:1,selStart:Ke.selectionStart,selEnd:Ke.selectionEnd}}))}};this._dispatchEventFromSandbox(ze,Le)}),Ce.addEventListener("keydown",Le=>{De.commitKey=1;let ze=-1;if(Le.key==="Escape"?ze=0:Le.key==="Enter"&&!this.data.multiLine?ze=2:Le.key==="Tab"&&(De.commitKey=3),ze===-1)return;const{value:Ve}=Le.target;De.lastCommittedValue!==Ve&&(De.lastCommittedValue=Ve,De.userValue=Ve,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:me,name:"Keystroke",value:Ve,willCommit:!0,commitKey:ze,selStart:Le.target.selectionStart,selEnd:Le.target.selectionEnd}}))});const Ge=Ne;Ne=null,Ce.addEventListener("blur",Le=>{if(!Le.relatedTarget)return;const{value:ze}=Le.target;De.userValue=ze,De.lastCommittedValue!==ze&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:me,name:"Keystroke",value:ze,willCommit:!0,commitKey:De.commitKey,selStart:Le.target.selectionStart,selEnd:Le.target.selectionEnd}}),Ge(Le)}),this.data.actions?.Keystroke&&Ce.addEventListener("beforeinput",Le=>{De.lastCommittedValue=null;const{data:ze,target:Ve}=Le,{value:je,selectionStart:Ke,selectionEnd:Ye}=Ve;let Ze=Ke,Je=Ye;switch(Le.inputType){case"deleteWordBackward":{const tt=je.substring(0,Ke).match(/\w*[^\w]*$/);tt&&(Ze-=tt[0].length);break}case"deleteWordForward":{const tt=je.substring(Ke).match(/^[^\w]*\w*/);tt&&(Je+=tt[0].length);break}case"deleteContentBackward":Ke===Ye&&(Ze-=1);break;case"deleteContentForward":Ke===Ye&&(Je+=1);break}Le.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:me,name:"Keystroke",value:je,change:ze||"",willCommit:!1,selStart:Ze,selEnd:Je}})}),this._setEventListeners(Ce,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Le=>Le.target.value)}if(Ne&&Ce.addEventListener("blur",Ne),this.data.comb){const Le=(this.data.rect[2]-this.data.rect[0])/ke;Ce.classList.add("comb"),Ce.style.letterSpacing=`calc(${Le}px * var(--scale-factor) - 1ch)`}}else Ce=document.createElement("div"),Ce.textContent=this.data.fieldValue,Ce.style.verticalAlign="middle",Ce.style.display="table-cell";return this._setTextStyle(Ce),this._setBackgroundColor(Ce),this._setDefaultPropertiesFromJS(Ce),this.container.append(Ce),this.container}}class pe extends he{constructor(le){super(le,{isRenderable:le.renderForms})}render(){const le=this.annotationStorage,me=this.data,Ce=me.id;let Se=le.getValue(Ce,{value:me.exportValue===me.fieldValue}).value;typeof Se=="string"&&(Se=Se!=="Off",le.setValue(Ce,{value:Se})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Re=document.createElement("input");return ee.add(Re),Re.setAttribute("data-element-id",Ce),Re.disabled=me.readOnly,this._setRequired(Re,this.data.required),Re.type="checkbox",Re.name=me.fieldName,Se&&Re.setAttribute("checked",!0),Re.setAttribute("exportValue",me.exportValue),Re.tabIndex=se,Re.addEventListener("change",ke=>{const{name:De,checked:Ne}=ke.target;for(const Ge of this._getElementsByName(De,Ce)){const Le=Ne&&Ge.exportValue===me.exportValue;Ge.domElement&&(Ge.domElement.checked=Le),le.setValue(Ge.id,{value:Le})}le.setValue(Ce,{value:Ne})}),Re.addEventListener("resetform",ke=>{const De=me.defaultFieldValue||"Off";ke.target.checked=De===me.exportValue}),this.enableScripting&&this.hasJSActions&&(Re.addEventListener("updatefromsandbox",ke=>{const De={value(Ne){Ne.target.checked=Ne.detail.value!=="Off",le.setValue(Ce,{value:Ne.target.checked})}};this._dispatchEventFromSandbox(De,ke)}),this._setEventListeners(Re,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ke=>ke.target.checked)),this._setBackgroundColor(Re),this._setDefaultPropertiesFromJS(Re),this.container.append(Re),this.container}}class fe extends he{constructor(le){super(le,{isRenderable:le.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const le=this.annotationStorage,me=this.data,Ce=me.id;let Se=le.getValue(Ce,{value:me.fieldValue===me.buttonValue}).value;typeof Se=="string"&&(Se=Se!==me.buttonValue,le.setValue(Ce,{value:Se}));const Re=document.createElement("input");if(ee.add(Re),Re.setAttribute("data-element-id",Ce),Re.disabled=me.readOnly,this._setRequired(Re,this.data.required),Re.type="radio",Re.name=me.fieldName,Se&&Re.setAttribute("checked",!0),Re.tabIndex=se,Re.addEventListener("change",ke=>{const{name:De,checked:Ne}=ke.target;for(const Ge of this._getElementsByName(De,Ce))le.setValue(Ge.id,{value:!1});le.setValue(Ce,{value:Ne})}),Re.addEventListener("resetform",ke=>{const De=me.defaultFieldValue;ke.target.checked=De!=null&&De===me.buttonValue}),this.enableScripting&&this.hasJSActions){const ke=me.buttonValue;Re.addEventListener("updatefromsandbox",De=>{const Ne={value:Ge=>{const Le=ke===Ge.detail.value;for(const ze of this._getElementsByName(Ge.target.name)){const Ve=Le&&ze.id===Ce;ze.domElement&&(ze.domElement.checked=Ve),le.setValue(ze.id,{value:Ve})}}};this._dispatchEventFromSandbox(Ne,De)}),this._setEventListeners(Re,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],De=>De.target.checked)}return this._setBackgroundColor(Re),this._setDefaultPropertiesFromJS(Re),this.container.append(Re),this.container}}class ye extends oe{constructor(le){super(le,{ignoreBorder:le.data.hasAppearance})}render(){const le=super.render();le.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(le.title=this.data.alternativeText);const me=le.lastChild;return this.enableScripting&&this.hasJSActions&&me&&(this._setDefaultPropertiesFromJS(me),me.addEventListener("updatefromsandbox",Ce=>{this._dispatchEventFromSandbox({},Ce)})),le}}class _e extends he{constructor(le){super(le,{isRenderable:le.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const le=this.annotationStorage,me=this.data.id,Ce=le.getValue(me,{value:this.data.fieldValue}),Se=document.createElement("select");ee.add(Se),Se.setAttribute("data-element-id",me),Se.disabled=this.data.readOnly,this._setRequired(Se,this.data.required),Se.name=this.data.fieldName,Se.tabIndex=se;let Re=this.data.combo&&this.data.options.length>0;this.data.combo||(Se.size=this.data.options.length,this.data.multiSelect&&(Se.multiple=!0)),Se.addEventListener("resetform",Le=>{const ze=this.data.defaultFieldValue;for(const Ve of Se.options)Ve.selected=Ve.value===ze});for(const Le of this.data.options){const ze=document.createElement("option");ze.textContent=Le.displayValue,ze.value=Le.exportValue,Ce.value.includes(Le.exportValue)&&(ze.setAttribute("selected",!0),Re=!1),Se.append(ze)}let ke=null;if(Re){const Le=document.createElement("option");Le.value=" ",Le.setAttribute("hidden",!0),Le.setAttribute("selected",!0),Se.prepend(Le),ke=()=>{Le.remove(),Se.removeEventListener("input",ke),ke=null},Se.addEventListener("input",ke)}const De=Le=>{const ze=Le?"value":"textContent",{options:Ve,multiple:je}=Se;return je?Array.prototype.filter.call(Ve,Ke=>Ke.selected).map(Ke=>Ke[ze]):Ve.selectedIndex===-1?null:Ve[Ve.selectedIndex][ze]};let Ne=De(!1);const Ge=Le=>{const ze=Le.target.options;return Array.prototype.map.call(ze,Ve=>({displayValue:Ve.textContent,exportValue:Ve.value}))};return this.enableScripting&&this.hasJSActions?(Se.addEventListener("updatefromsandbox",Le=>{const ze={value(Ve){ke?.();const je=Ve.detail.value,Ke=new Set(Array.isArray(je)?je:[je]);for(const Ye of Se.options)Ye.selected=Ke.has(Ye.value);le.setValue(me,{value:De(!0)}),Ne=De(!1)},multipleSelection(Ve){Se.multiple=!0},remove(Ve){const je=Se.options,Ke=Ve.detail.remove;je[Ke].selected=!1,Se.remove(Ke),je.length>0&&Array.prototype.findIndex.call(je,Ze=>Ze.selected)===-1&&(je[0].selected=!0),le.setValue(me,{value:De(!0),items:Ge(Ve)}),Ne=De(!1)},clear(Ve){for(;Se.length!==0;)Se.remove(0);le.setValue(me,{value:null,items:[]}),Ne=De(!1)},insert(Ve){const{index:je,displayValue:Ke,exportValue:Ye}=Ve.detail.insert,Ze=Se.children[je],Je=document.createElement("option");Je.textContent=Ke,Je.value=Ye,Ze?Ze.before(Je):Se.append(Je),le.setValue(me,{value:De(!0),items:Ge(Ve)}),Ne=De(!1)},items(Ve){const{items:je}=Ve.detail;for(;Se.length!==0;)Se.remove(0);for(const Ke of je){const{displayValue:Ye,exportValue:Ze}=Ke,Je=document.createElement("option");Je.textContent=Ye,Je.value=Ze,Se.append(Je)}Se.options.length>0&&(Se.options[0].selected=!0),le.setValue(me,{value:De(!0),items:Ge(Ve)}),Ne=De(!1)},indices(Ve){const je=new Set(Ve.detail.indices);for(const Ke of Ve.target.options)Ke.selected=je.has(Ke.index);le.setValue(me,{value:De(!0)}),Ne=De(!1)},editable(Ve){Ve.target.disabled=!Ve.detail.editable}};this._dispatchEventFromSandbox(ze,Le)}),Se.addEventListener("input",Le=>{const ze=De(!0);le.setValue(me,{value:ze}),Le.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:me,name:"Keystroke",value:Ne,changeEx:ze,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Se,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Le=>Le.target.value)):Se.addEventListener("input",function(Le){le.setValue(me,{value:De(!0)})}),this.data.combo&&this._setTextStyle(Se),this._setBackgroundColor(Se),this._setDefaultPropertiesFromJS(Se),this.container.append(Se),this.container}}class Ee extends re{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(le){const{data:me}=le,Ce=!Ee.IGNORE_TYPES.has(me.parentType)&&!!(me.titleObj?.str||me.contentsObj?.str||me.richText?.str);super(le,{isRenderable:Ce})}render(){this.container.classList.add("popupAnnotation");const le=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(le.length===0)return this.container;const me=new be({container:this.container,trigger:Array.from(le),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Ce=this.page,Se=F.Util.normalizeRect([this.data.parentRect[0],Ce.view[3]-this.data.parentRect[1]+Ce.view[1],this.data.parentRect[2],Ce.view[3]-this.data.parentRect[3]+Ce.view[1]]),Re=Se[0]+this.data.parentRect[2]-this.data.parentRect[0],ke=Se[1],{pageWidth:De,pageHeight:Ne,pageX:Ge,pageY:Le}=this.viewport.rawDims;return this.container.style.left=`${100*(Re-Ge)/De}%`,this.container.style.top=`${100*(ke-Le)/Ne}%`,this.container.append(me.render()),this.container}}class be{constructor(le){this.container=le.container,this.trigger=le.trigger,this.color=le.color,this.titleObj=le.titleObj,this.modificationDate=le.modificationDate,this.contentsObj=le.contentsObj,this.richText=le.richText,this.hideWrapper=le.hideWrapper||!1,this.pinned=!1}render(){const me=document.createElement("div");me.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?me:this.container,this.hideElement.hidden=!0;const Ce=document.createElement("div");Ce.classList.add("popup");const Se=this.color;if(Se){const De=.7*(255-Se[0])+Se[0],Ne=.7*(255-Se[1])+Se[1],Ge=.7*(255-Se[2])+Se[2];Ce.style.backgroundColor=F.Util.makeHexColor(De|0,Ne|0,Ge|0)}const Re=document.createElement("h1");Re.dir=this.titleObj.dir,Re.textContent=this.titleObj.str,Ce.append(Re);const ke=$.PDFDateString.toDateObject(this.modificationDate);if(ke){const De=document.createElement("span");De.classList.add("popupDate"),De.textContent="{{date}}, {{time}}",De.dataset.l10nId="annotation_date_string",De.dataset.l10nArgs=JSON.stringify({date:ke.toLocaleDateString(),time:ke.toLocaleTimeString()}),Ce.append(De)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))te.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:Ce}),Ce.lastChild.classList.add("richText","popupContent");else{const De=this._formatContents(this.contentsObj);Ce.append(De)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const De of this.trigger)De.addEventListener("click",this._toggle.bind(this)),De.addEventListener("mouseover",this._show.bind(this,!1)),De.addEventListener("mouseout",this._hide.bind(this,!1));return Ce.addEventListener("click",this._hide.bind(this,!0)),me.append(Ce),me}_formatContents({str:le,dir:me}){const Ce=document.createElement("p");Ce.classList.add("popupContent"),Ce.dir=me;const Se=le.split(/(?:\r\n?|\n)/);for(let Re=0,ke=Se.length;Re<ke;++Re){const De=Se[Re];Ce.append(document.createTextNode(De)),Re<ke-1&&Ce.append(document.createElement("br"))}return Ce}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(le=!1){le&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(le=!0){le&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class Ae extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0}),this.textContent=le.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const le=document.createElement("div");le.classList.add("annotationTextContent"),le.setAttribute("role","comment");for(const me of this.textContent){const Ce=document.createElement("span");Ce.textContent=me,le.append(Ce)}this.container.append(le)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class we extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const le=this.data,{width:me,height:Ce}=ie(le.rect),Se=this.svgFactory.create(me,Ce,!0),Re=this.svgFactory.createElement("svg:line");return Re.setAttribute("x1",le.rect[2]-le.lineCoordinates[0]),Re.setAttribute("y1",le.rect[3]-le.lineCoordinates[1]),Re.setAttribute("x2",le.rect[2]-le.lineCoordinates[2]),Re.setAttribute("y2",le.rect[3]-le.lineCoordinates[3]),Re.setAttribute("stroke-width",le.borderStyle.width||1),Re.setAttribute("stroke","transparent"),Re.setAttribute("fill","transparent"),Se.append(Re),this.container.append(Se),this._createPopup(Re,le),this.container}}class Te extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const le=this.data,{width:me,height:Ce}=ie(le.rect),Se=this.svgFactory.create(me,Ce,!0),Re=le.borderStyle.width,ke=this.svgFactory.createElement("svg:rect");return ke.setAttribute("x",Re/2),ke.setAttribute("y",Re/2),ke.setAttribute("width",me-Re),ke.setAttribute("height",Ce-Re),ke.setAttribute("stroke-width",Re||1),ke.setAttribute("stroke","transparent"),ke.setAttribute("fill","transparent"),Se.append(ke),this.container.append(Se),this._createPopup(ke,le),this.container}}class Me extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const le=this.data,{width:me,height:Ce}=ie(le.rect),Se=this.svgFactory.create(me,Ce,!0),Re=le.borderStyle.width,ke=this.svgFactory.createElement("svg:ellipse");return ke.setAttribute("cx",me/2),ke.setAttribute("cy",Ce/2),ke.setAttribute("rx",me/2-Re/2),ke.setAttribute("ry",Ce/2-Re/2),ke.setAttribute("stroke-width",Re||1),ke.setAttribute("stroke","transparent"),ke.setAttribute("fill","transparent"),Se.append(ke),this.container.append(Se),this._createPopup(ke,le),this.container}}class Be extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const le=this.data,{width:me,height:Ce}=ie(le.rect),Se=this.svgFactory.create(me,Ce,!0);let Re=[];for(const De of le.vertices){const Ne=De.x-le.rect[0],Ge=le.rect[3]-De.y;Re.push(Ne+","+Ge)}Re=Re.join(" ");const ke=this.svgFactory.createElement(this.svgElementName);return ke.setAttribute("points",Re),ke.setAttribute("stroke-width",le.borderStyle.width||1),ke.setAttribute("stroke","transparent"),ke.setAttribute("fill","transparent"),Se.append(ke),this.container.append(Se),this._createPopup(ke,le),this.container}}class $e extends Be{constructor(le){super(le),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Fe extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Xe extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const le=this.data,{width:me,height:Ce}=ie(le.rect),Se=this.svgFactory.create(me,Ce,!0);for(const Re of le.inkLists){let ke=[];for(const Ne of Re){const Ge=Ne.x-le.rect[0],Le=le.rect[3]-Ne.y;ke.push(`${Ge},${Le}`)}ke=ke.join(" ");const De=this.svgFactory.createElement(this.svgElementName);De.setAttribute("points",ke),De.setAttribute("stroke-width",le.borderStyle.width||1),De.setAttribute("stroke","transparent"),De.setAttribute("fill","transparent"),this._createPopup(De,le),Se.append(De)}return this.container.append(Se),this.container}}class We extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class Ie extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class Oe extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class Pe extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class ge extends re{constructor(le){const me=!!(le.data.hasPopup||le.data.titleObj?.str||le.data.contentsObj?.str||le.data.richText?.str);super(le,{isRenderable:me,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ue extends re{constructor(le){super(le,{isRenderable:!0});const{filename:me,content:Ce}=this.data.file;this.filename=(0,$.getFilenameFromUrl)(me,!0),this.content=Ce,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:me,content:Ce})}render(){this.container.classList.add("fileAttachmentAnnotation");let le;return this.data.hasAppearance?le=document.createElement("div"):(le=document.createElement("img"),le.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),le.classList.add("popupTriggerArea"),le.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(le,this.data),this.container.append(le),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class xe{static#e(le,me,Ce,Se){const Re=le.firstChild||le;Re.id=`${$.AnnotationPrefix}${me}`,Ce.append(le),Se?.moveElementInDOM(Ce,le,Re,!1)}static render(le){const{annotations:me,div:Ce,viewport:Se,accessibilityManager:Re}=le;(0,$.setLayerDimensions)(Ce,Se);const ke={data:null,layer:Ce,page:le.page,viewport:Se,linkService:le.linkService,downloadManager:le.downloadManager,imageResourcesPath:le.imageResourcesPath||"",renderForms:le.renderForms!==!1,svgFactory:new $.DOMSVGFactory,annotationStorage:le.annotationStorage||new Y.AnnotationStorage,enableScripting:le.enableScripting===!0,hasJSActions:le.hasJSActions,fieldObjects:le.fieldObjects};let De=0;for(const Ne of me){if(Ne.noHTML)continue;if(Ne.annotationType!==F.AnnotationType.POPUP){const{width:ze,height:Ve}=ie(Ne.rect);if(ze<=0||Ve<=0)continue}ke.data=Ne;const Ge=ae.create(ke);if(!Ge.isRenderable)continue;const Le=Ge.render();if(Ne.hidden&&(Le.style.visibility="hidden"),Array.isArray(Le))for(const ze of Le)ze.style.zIndex=De++,xe.#e(ze,Ne.id,Ce,Re);else Le.style.zIndex=De++,Ge instanceof Ee?Ce.prepend(Le):xe.#e(Le,Ne.id,Ce,Re)}this.#t(Ce,le.annotationCanvasMap)}static update(le){const{annotationCanvasMap:me,div:Ce,viewport:Se}=le;(0,$.setLayerDimensions)(Ce,{rotation:Se.rotation}),this.#t(Ce,me),Ce.hidden=!1}static#t(le,me){if(me){for(const[Ce,Se]of me){const Re=le.querySelector(`[data-annotation-id="${Ce}"]`);if(!Re)continue;const{firstChild:ke}=Re;ke?ke.nodeName==="CANVAS"?ke.replaceWith(Se):ke.before(Se):Re.append(Se)}me.clear()}}}e.AnnotationLayer=xe},(J,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function C($){return Math.floor(Math.max(0,Math.min(1,$))*255).toString(16).padStart(2,"0")}class F{static CMYK_G([Y,V,te,se]){return["G",1-Math.min(1,.3*Y+.59*te+.11*V+se)]}static G_CMYK([Y]){return["CMYK",0,0,0,1-Y]}static G_RGB([Y]){return["RGB",Y,Y,Y]}static G_HTML([Y]){const V=C(Y);return`#${V}${V}${V}`}static RGB_G([Y,V,te]){return["G",.3*Y+.59*V+.11*te]}static RGB_HTML([Y,V,te]){const se=C(Y),ne=C(V),ee=C(te);return`#${se}${ne}${ee}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Y,V,te,se]){return["RGB",1-Math.min(1,Y+se),1-Math.min(1,te+se),1-Math.min(1,V+se)]}static CMYK_HTML(Y){const V=this.CMYK_RGB(Y).slice(1);return this.RGB_HTML(V)}static RGB_CMYK([Y,V,te]){const se=1-Y,ne=1-V,ee=1-te,ie=Math.min(se,ne,ee);return["CMYK",se,ne,ee,ie]}}e.ColorConverters=F},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var F=C(19);class ${static setupStorage(V,te,se,ne,ee){const ie=ne.getValue(te,{value:null});switch(se.name){case"textarea":if(ie.value!==null&&(V.textContent=ie.value),ee==="print")break;V.addEventListener("input",ae=>{ne.setValue(te,{value:ae.target.value})});break;case"input":if(se.attributes.type==="radio"||se.attributes.type==="checkbox"){if(ie.value===se.attributes.xfaOn?V.setAttribute("checked",!0):ie.value===se.attributes.xfaOff&&V.removeAttribute("checked"),ee==="print")break;V.addEventListener("change",ae=>{ne.setValue(te,{value:ae.target.checked?ae.target.getAttribute("xfaOn"):ae.target.getAttribute("xfaOff")})})}else{if(ie.value!==null&&V.setAttribute("value",ie.value),ee==="print")break;V.addEventListener("input",ae=>{ne.setValue(te,{value:ae.target.value})})}break;case"select":if(ie.value!==null)for(const ae of se.children)ae.attributes.value===ie.value&&(ae.attributes.selected=!0);V.addEventListener("input",ae=>{const re=ae.target.options,oe=re.selectedIndex===-1?"":re[re.selectedIndex].value;ne.setValue(te,{value:oe})});break}}static setAttributes({html:V,element:te,storage:se=null,intent:ne,linkService:ee}){const{attributes:ie}=te,ae=V instanceof HTMLAnchorElement;ie.type==="radio"&&(ie.name=`${ie.name}-${ne}`);for(const[re,oe]of Object.entries(ie))if(oe!=null)switch(re){case"class":oe.length&&V.setAttribute(re,oe.join(" "));break;case"dataId":break;case"id":V.setAttribute("data-element-id",oe);break;case"style":Object.assign(V.style,oe);break;case"textContent":V.textContent=oe;break;default:(!ae||re!=="href"&&re!=="newWindow")&&V.setAttribute(re,oe)}ae&&ee.addLinkAttributes(V,ie.href,ie.newWindow),se&&ie.dataId&&this.setupStorage(V,ie.dataId,te,se)}static render(V){const te=V.annotationStorage,se=V.linkService,ne=V.xfaHtml,ee=V.intent||"display",ie=document.createElement(ne.name);ne.attributes&&this.setAttributes({html:ie,element:ne,intent:ee,linkService:se});const ae=[[ne,-1,ie]],re=V.div;if(re.append(ie),V.viewport){const ce=`matrix(${V.viewport.transform.join(",")})`;re.style.transform=ce}ee!=="richText"&&re.setAttribute("class","xfaLayer xfaFont");const oe=[];for(;ae.length>0;){const[ce,he,de]=ae.at(-1);if(he+1===ce.children.length){ae.pop();continue}const pe=ce.children[++ae.at(-1)[1]];if(pe===null)continue;const{name:fe}=pe;if(fe==="#text"){const _e=document.createTextNode(pe.value);oe.push(_e),de.append(_e);continue}let ye;if(pe?.attributes?.xmlns?ye=document.createElementNS(pe.attributes.xmlns,fe):ye=document.createElement(fe),de.append(ye),pe.attributes&&this.setAttributes({html:ye,element:pe,storage:te,intent:ee,linkService:se}),pe.children&&pe.children.length>0)ae.push([pe,-1,ye]);else if(pe.value){const _e=document.createTextNode(pe.value);F.XfaText.shouldBuildText(fe)&&oe.push(_e),ye.append(_e)}}for(const ce of re.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))ce.setAttribute("readOnly",!0);return{textDivs:oe}}static update(V){const te=`matrix(${V.viewport.transform.join(",")})`;V.div.style.transform=te,V.div.hidden=!1}}e.XfaLayer=$},(J,e,C)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var F=C(6),$=C(1),Y=C(10);let V=class{constructor(){(0,$.unreachable)("Not implemented: SVGGraphics")}};e.SVGGraphics=V;{let pe=function(Ae){let we=[];const Te=[];for(const Me of Ae){if(Me.fn==="save"){we.push({fnId:92,fn:"group",items:[]}),Te.push(we),we=we.at(-1).items;continue}Me.fn==="restore"?we=Te.pop():we.push(Me)}return we},fe=function(Ae){if(Number.isInteger(Ae))return Ae.toString();const we=Ae.toFixed(10);let Te=we.length-1;if(we[Te]!=="0")return we;do Te--;while(we[Te]==="0");return we.substring(0,we[Te]==="."?Te:Te+1)},ye=function(Ae){if(Ae[4]===0&&Ae[5]===0){if(Ae[1]===0&&Ae[2]===0)return Ae[0]===1&&Ae[3]===1?"":`scale(${fe(Ae[0])} ${fe(Ae[3])})`;if(Ae[0]===Ae[3]&&Ae[1]===-Ae[2]){const we=Math.acos(Ae[0])*180/Math.PI;return`rotate(${fe(we)})`}}else if(Ae[0]===1&&Ae[1]===0&&Ae[2]===0&&Ae[3]===1)return`translate(${fe(Ae[4])} ${fe(Ae[5])})`;return`matrix(${fe(Ae[0])} ${fe(Ae[1])} ${fe(Ae[2])} ${fe(Ae[3])} ${fe(Ae[4])} ${fe(Ae[5])})`};var te=pe,se=fe,ne=ye;const ee={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},ie="http://www.w3.org/XML/1998/namespace",ae="http://www.w3.org/1999/xlink",re=["butt","round","square"],oe=["miter","round","bevel"],ce=function(Ae,we="",Te=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Te)return URL.createObjectURL(new Blob([Ae],{type:we}));const Me="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Be=`data:${we};base64,`;for(let $e=0,Fe=Ae.length;$e<Fe;$e+=3){const Xe=Ae[$e]&255,We=Ae[$e+1]&255,Ie=Ae[$e+2]&255,Oe=Xe>>2,Pe=(Xe&3)<<4|We>>4,ge=$e+1<Fe?(We&15)<<2|Ie>>6:64,ue=$e+2<Fe?Ie&63:64;Be+=Me[Oe]+Me[Pe]+Me[ge]+Me[ue]}return Be},he=function(){const Ae=new Uint8Array([137,80,78,71,13,10,26,10]),we=12,Te=new Int32Array(256);for(let Ie=0;Ie<256;Ie++){let Oe=Ie;for(let Pe=0;Pe<8;Pe++)Oe&1?Oe=3988292384^Oe>>1&2147483647:Oe=Oe>>1&2147483647;Te[Ie]=Oe}function Me(Ie,Oe,Pe){let ge=-1;for(let ue=Oe;ue<Pe;ue++){const xe=(ge^Ie[ue])&255,ve=Te[xe];ge=ge>>>8^ve}return ge^-1}function Be(Ie,Oe,Pe,ge){let ue=ge;const xe=Oe.length;Pe[ue]=xe>>24&255,Pe[ue+1]=xe>>16&255,Pe[ue+2]=xe>>8&255,Pe[ue+3]=xe&255,ue+=4,Pe[ue]=Ie.charCodeAt(0)&255,Pe[ue+1]=Ie.charCodeAt(1)&255,Pe[ue+2]=Ie.charCodeAt(2)&255,Pe[ue+3]=Ie.charCodeAt(3)&255,ue+=4,Pe.set(Oe,ue),ue+=Oe.length;const ve=Me(Pe,ge+4,ue);Pe[ue]=ve>>24&255,Pe[ue+1]=ve>>16&255,Pe[ue+2]=ve>>8&255,Pe[ue+3]=ve&255}function $e(Ie,Oe,Pe){let ge=1,ue=0;for(let xe=Oe;xe<Pe;++xe)ge=(ge+(Ie[xe]&255))%65521,ue=(ue+ge)%65521;return ue<<16|ge}function Fe(Ie){if(!Y.isNodeJS)return Xe(Ie);try{let Oe;parseInt(process.versions.node)>=8?Oe=Ie:Oe=Buffer.from(Ie);const Pe=require$$5.deflateSync(Oe,{level:9});return Pe instanceof Uint8Array?Pe:new Uint8Array(Pe)}catch(Oe){(0,$.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Oe)}return Xe(Ie)}function Xe(Ie){let Oe=Ie.length;const Pe=65535,ge=Math.ceil(Oe/Pe),ue=new Uint8Array(2+Oe+ge*5+4);let xe=0;ue[xe++]=120,ue[xe++]=156;let ve=0;for(;Oe>Pe;)ue[xe++]=0,ue[xe++]=255,ue[xe++]=255,ue[xe++]=0,ue[xe++]=0,ue.set(Ie.subarray(ve,ve+Pe),xe),xe+=Pe,ve+=Pe,Oe-=Pe;ue[xe++]=1,ue[xe++]=Oe&255,ue[xe++]=Oe>>8&255,ue[xe++]=~Oe&65535&255,ue[xe++]=(~Oe&65535)>>8&255,ue.set(Ie.subarray(ve),xe),xe+=Ie.length-ve;const le=$e(Ie,0,Ie.length);return ue[xe++]=le>>24&255,ue[xe++]=le>>16&255,ue[xe++]=le>>8&255,ue[xe++]=le&255,ue}function We(Ie,Oe,Pe,ge){const ue=Ie.width,xe=Ie.height;let ve,le,me;const Ce=Ie.data;switch(Oe){case $.ImageKind.GRAYSCALE_1BPP:le=0,ve=1,me=ue+7>>3;break;case $.ImageKind.RGB_24BPP:le=2,ve=8,me=ue*3;break;case $.ImageKind.RGBA_32BPP:le=6,ve=8,me=ue*4;break;default:throw new Error("invalid format")}const Se=new Uint8Array((1+me)*xe);let Re=0,ke=0;for(let Ve=0;Ve<xe;++Ve)Se[Re++]=0,Se.set(Ce.subarray(ke,ke+me),Re),ke+=me,Re+=me;if(Oe===$.ImageKind.GRAYSCALE_1BPP&&ge){Re=0;for(let Ve=0;Ve<xe;Ve++){Re++;for(let je=0;je<me;je++)Se[Re++]^=255}}const De=new Uint8Array([ue>>24&255,ue>>16&255,ue>>8&255,ue&255,xe>>24&255,xe>>16&255,xe>>8&255,xe&255,ve,le,0,0,0]),Ne=Fe(Se),Ge=Ae.length+we*3+De.length+Ne.length,Le=new Uint8Array(Ge);let ze=0;return Le.set(Ae,ze),ze+=Ae.length,Be("IHDR",De,Le,ze),ze+=we+De.length,Be("IDATA",Ne,Le,ze),ze+=we+Ne.length,Be("IEND",new Uint8Array(0),Le,ze),ce(Le,"image/png",Pe)}return function(Oe,Pe,ge){const ue=Oe.kind===void 0?$.ImageKind.GRAYSCALE_1BPP:Oe.kind;return We(Oe,ue,Pe,ge)}}();class de{constructor(){this.fontSizeScale=1,this.fontWeight=ee.fontWeight,this.fontSize=0,this.textMatrix=$.IDENTITY_MATRIX,this.fontMatrix=$.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=$.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=ee.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(we,Te){this.x=we,this.y=Te}}let _e=0,Ee=0,be=0;e.SVGGraphics=V=class{constructor(Ae,we,Te=!1){(0,F.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new F.DOMSVGFactory,this.current=new de,this.transformMatrix=$.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=Ae,this.objs=we,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!Te,this._operatorIdMapping=[];for(const Me in $.OPS)this._operatorIdMapping[$.OPS[Me]]=Me}getObject(Ae,we=null){return typeof Ae=="string"?Ae.startsWith("g_")?this.commonObjs.get(Ae):this.objs.get(Ae):we}save(){this.transformStack.push(this.transformMatrix);const Ae=this.current;this.extraStack.push(Ae),this.current=Ae.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(Ae){this.save(),this.executeOpTree(Ae),this.restore()}loadDependencies(Ae){const we=Ae.fnArray,Te=Ae.argsArray;for(let Me=0,Be=we.length;Me<Be;Me++)if(we[Me]===$.OPS.dependency)for(const $e of Te[Me]){const Fe=$e.startsWith("g_")?this.commonObjs:this.objs,Xe=new Promise(We=>{Fe.get($e,We)});this.current.dependencies.push(Xe)}return Promise.all(this.current.dependencies)}transform(Ae,we,Te,Me,Be,$e){const Fe=[Ae,we,Te,Me,Be,$e];this.transformMatrix=$.Util.transform(this.transformMatrix,Fe),this.tgrp=null}getSVG(Ae,we){this.viewport=we;const Te=this._initialize(we);return this.loadDependencies(Ae).then(()=>(this.transformMatrix=$.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(Ae)),Te))}convertOpList(Ae){const we=this._operatorIdMapping,Te=Ae.argsArray,Me=Ae.fnArray,Be=[];for(let $e=0,Fe=Me.length;$e<Fe;$e++){const Xe=Me[$e];Be.push({fnId:Xe,fn:we[Xe],args:Te[$e]})}return pe(Be)}executeOpTree(Ae){for(const we of Ae){const Te=we.fn,Me=we.fnId,Be=we.args;switch(Me|0){case $.OPS.beginText:this.beginText();break;case $.OPS.dependency:break;case $.OPS.setLeading:this.setLeading(Be);break;case $.OPS.setLeadingMoveText:this.setLeadingMoveText(Be[0],Be[1]);break;case $.OPS.setFont:this.setFont(Be);break;case $.OPS.showText:this.showText(Be[0]);break;case $.OPS.showSpacedText:this.showText(Be[0]);break;case $.OPS.endText:this.endText();break;case $.OPS.moveText:this.moveText(Be[0],Be[1]);break;case $.OPS.setCharSpacing:this.setCharSpacing(Be[0]);break;case $.OPS.setWordSpacing:this.setWordSpacing(Be[0]);break;case $.OPS.setHScale:this.setHScale(Be[0]);break;case $.OPS.setTextMatrix:this.setTextMatrix(Be[0],Be[1],Be[2],Be[3],Be[4],Be[5]);break;case $.OPS.setTextRise:this.setTextRise(Be[0]);break;case $.OPS.setTextRenderingMode:this.setTextRenderingMode(Be[0]);break;case $.OPS.setLineWidth:this.setLineWidth(Be[0]);break;case $.OPS.setLineJoin:this.setLineJoin(Be[0]);break;case $.OPS.setLineCap:this.setLineCap(Be[0]);break;case $.OPS.setMiterLimit:this.setMiterLimit(Be[0]);break;case $.OPS.setFillRGBColor:this.setFillRGBColor(Be[0],Be[1],Be[2]);break;case $.OPS.setStrokeRGBColor:this.setStrokeRGBColor(Be[0],Be[1],Be[2]);break;case $.OPS.setStrokeColorN:this.setStrokeColorN(Be);break;case $.OPS.setFillColorN:this.setFillColorN(Be);break;case $.OPS.shadingFill:this.shadingFill(Be[0]);break;case $.OPS.setDash:this.setDash(Be[0],Be[1]);break;case $.OPS.setRenderingIntent:this.setRenderingIntent(Be[0]);break;case $.OPS.setFlatness:this.setFlatness(Be[0]);break;case $.OPS.setGState:this.setGState(Be[0]);break;case $.OPS.fill:this.fill();break;case $.OPS.eoFill:this.eoFill();break;case $.OPS.stroke:this.stroke();break;case $.OPS.fillStroke:this.fillStroke();break;case $.OPS.eoFillStroke:this.eoFillStroke();break;case $.OPS.clip:this.clip("nonzero");break;case $.OPS.eoClip:this.clip("evenodd");break;case $.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case $.OPS.paintImageXObject:this.paintImageXObject(Be[0]);break;case $.OPS.paintInlineImageXObject:this.paintInlineImageXObject(Be[0]);break;case $.OPS.paintImageMaskXObject:this.paintImageMaskXObject(Be[0]);break;case $.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(Be[0],Be[1]);break;case $.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case $.OPS.closePath:this.closePath();break;case $.OPS.closeStroke:this.closeStroke();break;case $.OPS.closeFillStroke:this.closeFillStroke();break;case $.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case $.OPS.nextLine:this.nextLine();break;case $.OPS.transform:this.transform(Be[0],Be[1],Be[2],Be[3],Be[4],Be[5]);break;case $.OPS.constructPath:this.constructPath(Be[0],Be[1]);break;case $.OPS.endPath:this.endPath();break;case 92:this.group(we.items);break;default:(0,$.warn)(`Unimplemented operator ${Te}`);break}}}setWordSpacing(Ae){this.current.wordSpacing=Ae}setCharSpacing(Ae){this.current.charSpacing=Ae}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(Ae,we,Te,Me,Be,$e){const Fe=this.current;Fe.textMatrix=Fe.lineMatrix=[Ae,we,Te,Me,Be,$e],Fe.textMatrixScale=Math.hypot(Ae,we),Fe.x=Fe.lineX=0,Fe.y=Fe.lineY=0,Fe.xcoords=[],Fe.ycoords=[],Fe.tspan=this.svgFactory.createElement("svg:tspan"),Fe.tspan.setAttributeNS(null,"font-family",Fe.fontFamily),Fe.tspan.setAttributeNS(null,"font-size",`${fe(Fe.fontSize)}px`),Fe.tspan.setAttributeNS(null,"y",fe(-Fe.y)),Fe.txtElement=this.svgFactory.createElement("svg:text"),Fe.txtElement.append(Fe.tspan)}beginText(){const Ae=this.current;Ae.x=Ae.lineX=0,Ae.y=Ae.lineY=0,Ae.textMatrix=$.IDENTITY_MATRIX,Ae.lineMatrix=$.IDENTITY_MATRIX,Ae.textMatrixScale=1,Ae.tspan=this.svgFactory.createElement("svg:tspan"),Ae.txtElement=this.svgFactory.createElement("svg:text"),Ae.txtgrp=this.svgFactory.createElement("svg:g"),Ae.xcoords=[],Ae.ycoords=[]}moveText(Ae,we){const Te=this.current;Te.x=Te.lineX+=Ae,Te.y=Te.lineY+=we,Te.xcoords=[],Te.ycoords=[],Te.tspan=this.svgFactory.createElement("svg:tspan"),Te.tspan.setAttributeNS(null,"font-family",Te.fontFamily),Te.tspan.setAttributeNS(null,"font-size",`${fe(Te.fontSize)}px`),Te.tspan.setAttributeNS(null,"y",fe(-Te.y))}showText(Ae){const we=this.current,Te=we.font,Me=we.fontSize;if(Me===0)return;const Be=we.fontSizeScale,$e=we.charSpacing,Fe=we.wordSpacing,Xe=we.fontDirection,We=we.textHScale*Xe,Ie=Te.vertical,Oe=Ie?1:-1,Pe=Te.defaultVMetrics,ge=Me*we.fontMatrix[0];let ue=0;for(const le of Ae){if(le===null){ue+=Xe*Fe;continue}else if(typeof le=="number"){ue+=Oe*le*Me/1e3;continue}const me=(le.isSpace?Fe:0)+$e,Ce=le.fontChar;let Se,Re,ke=le.width;if(Ie){let Ne;const Ge=le.vmetric||Pe;Ne=le.vmetric?Ge[1]:ke*.5,Ne=-Ne*ge;const Le=Ge[2]*ge;ke=Ge?-Ge[0]:ke,Se=Ne/Be,Re=(ue+Le)/Be}else Se=ue/Be,Re=0;(le.isInFont||Te.missingFile)&&(we.xcoords.push(we.x+Se),Ie&&we.ycoords.push(-we.y+Re),we.tspan.textContent+=Ce);let De;Ie?De=ke*ge-me*Xe:De=ke*ge+me*Xe,ue+=De}we.tspan.setAttributeNS(null,"x",we.xcoords.map(fe).join(" ")),Ie?we.tspan.setAttributeNS(null,"y",we.ycoords.map(fe).join(" ")):we.tspan.setAttributeNS(null,"y",fe(-we.y)),Ie?we.y-=ue:we.x+=ue*We,we.tspan.setAttributeNS(null,"font-family",we.fontFamily),we.tspan.setAttributeNS(null,"font-size",`${fe(we.fontSize)}px`),we.fontStyle!==ee.fontStyle&&we.tspan.setAttributeNS(null,"font-style",we.fontStyle),we.fontWeight!==ee.fontWeight&&we.tspan.setAttributeNS(null,"font-weight",we.fontWeight);const xe=we.textRenderingMode&$.TextRenderingMode.FILL_STROKE_MASK;if(xe===$.TextRenderingMode.FILL||xe===$.TextRenderingMode.FILL_STROKE?(we.fillColor!==ee.fillColor&&we.tspan.setAttributeNS(null,"fill",we.fillColor),we.fillAlpha<1&&we.tspan.setAttributeNS(null,"fill-opacity",we.fillAlpha)):we.textRenderingMode===$.TextRenderingMode.ADD_TO_PATH?we.tspan.setAttributeNS(null,"fill","transparent"):we.tspan.setAttributeNS(null,"fill","none"),xe===$.TextRenderingMode.STROKE||xe===$.TextRenderingMode.FILL_STROKE){const le=1/(we.textMatrixScale||1);this._setStrokeAttributes(we.tspan,le)}let ve=we.textMatrix;we.textRise!==0&&(ve=ve.slice(),ve[5]+=we.textRise),we.txtElement.setAttributeNS(null,"transform",`${ye(ve)} scale(${fe(We)}, -1)`),we.txtElement.setAttributeNS(ie,"xml:space","preserve"),we.txtElement.append(we.tspan),we.txtgrp.append(we.txtElement),this._ensureTransformGroup().append(we.txtElement)}setLeadingMoveText(Ae,we){this.setLeading(-we),this.moveText(Ae,we)}addFontStyle(Ae){if(!Ae.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const we=ce(Ae.data,Ae.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${Ae.loadedName}"; src: url(${we}); }
`}setFont(Ae){const we=this.current,Te=this.commonObjs.get(Ae[0]);let Me=Ae[1];we.font=Te,this.embedFonts&&!Te.missingFile&&!this.embeddedFonts[Te.loadedName]&&(this.addFontStyle(Te),this.embeddedFonts[Te.loadedName]=Te),we.fontMatrix=Te.fontMatrix||$.FONT_IDENTITY_MATRIX;let Be="normal";Te.black?Be="900":Te.bold&&(Be="bold");const $e=Te.italic?"italic":"normal";Me<0?(Me=-Me,we.fontDirection=-1):we.fontDirection=1,we.fontSize=Me,we.fontFamily=Te.loadedName,we.fontWeight=Be,we.fontStyle=$e,we.tspan=this.svgFactory.createElement("svg:tspan"),we.tspan.setAttributeNS(null,"y",fe(-we.y)),we.xcoords=[],we.ycoords=[]}endText(){const Ae=this.current;Ae.textRenderingMode&$.TextRenderingMode.ADD_TO_PATH_FLAG&&Ae.txtElement?.hasChildNodes()&&(Ae.element=Ae.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(Ae){Ae>0&&(this.current.lineWidth=Ae)}setLineCap(Ae){this.current.lineCap=re[Ae]}setLineJoin(Ae){this.current.lineJoin=oe[Ae]}setMiterLimit(Ae){this.current.miterLimit=Ae}setStrokeAlpha(Ae){this.current.strokeAlpha=Ae}setStrokeRGBColor(Ae,we,Te){this.current.strokeColor=$.Util.makeHexColor(Ae,we,Te)}setFillAlpha(Ae){this.current.fillAlpha=Ae}setFillRGBColor(Ae,we,Te){this.current.fillColor=$.Util.makeHexColor(Ae,we,Te),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(Ae){this.current.strokeColor=this._makeColorN_Pattern(Ae)}setFillColorN(Ae){this.current.fillColor=this._makeColorN_Pattern(Ae)}shadingFill(Ae){const we=this.viewport.width,Te=this.viewport.height,Me=$.Util.inverseTransform(this.transformMatrix),Be=$.Util.applyTransform([0,0],Me),$e=$.Util.applyTransform([0,Te],Me),Fe=$.Util.applyTransform([we,0],Me),Xe=$.Util.applyTransform([we,Te],Me),We=Math.min(Be[0],$e[0],Fe[0],Xe[0]),Ie=Math.min(Be[1],$e[1],Fe[1],Xe[1]),Oe=Math.max(Be[0],$e[0],Fe[0],Xe[0]),Pe=Math.max(Be[1],$e[1],Fe[1],Xe[1]),ge=this.svgFactory.createElement("svg:rect");ge.setAttributeNS(null,"x",We),ge.setAttributeNS(null,"y",Ie),ge.setAttributeNS(null,"width",Oe-We),ge.setAttributeNS(null,"height",Pe-Ie),ge.setAttributeNS(null,"fill",this._makeShadingPattern(Ae)),this.current.fillAlpha<1&&ge.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ge)}_makeColorN_Pattern(Ae){return Ae[0]==="TilingPattern"?this._makeTilingPattern(Ae):this._makeShadingPattern(Ae)}_makeTilingPattern(Ae){const we=Ae[1],Te=Ae[2],Me=Ae[3]||$.IDENTITY_MATRIX,[Be,$e,Fe,Xe]=Ae[4],We=Ae[5],Ie=Ae[6],Oe=Ae[7],Pe=`shading${be++}`,[ge,ue,xe,ve]=$.Util.normalizeRect([...$.Util.applyTransform([Be,$e],Me),...$.Util.applyTransform([Fe,Xe],Me)]),[le,me]=$.Util.singularValueDecompose2dScale(Me),Ce=We*le,Se=Ie*me,Re=this.svgFactory.createElement("svg:pattern");Re.setAttributeNS(null,"id",Pe),Re.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Re.setAttributeNS(null,"width",Ce),Re.setAttributeNS(null,"height",Se),Re.setAttributeNS(null,"x",`${ge}`),Re.setAttributeNS(null,"y",`${ue}`);const ke=this.svg,De=this.transformMatrix,Ne=this.current.fillColor,Ge=this.current.strokeColor,Le=this.svgFactory.create(xe-ge,ve-ue);if(this.svg=Le,this.transformMatrix=Me,Oe===2){const ze=$.Util.makeHexColor(...we);this.current.fillColor=ze,this.current.strokeColor=ze}return this.executeOpTree(this.convertOpList(Te)),this.svg=ke,this.transformMatrix=De,this.current.fillColor=Ne,this.current.strokeColor=Ge,Re.append(Le.childNodes[0]),this.defs.append(Re),`url(#${Pe})`}_makeShadingPattern(Ae){switch(typeof Ae=="string"&&(Ae=this.objs.get(Ae)),Ae[0]){case"RadialAxial":const we=`shading${be++}`,Te=Ae[3];let Me;switch(Ae[1]){case"axial":const Be=Ae[4],$e=Ae[5];Me=this.svgFactory.createElement("svg:linearGradient"),Me.setAttributeNS(null,"id",we),Me.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Me.setAttributeNS(null,"x1",Be[0]),Me.setAttributeNS(null,"y1",Be[1]),Me.setAttributeNS(null,"x2",$e[0]),Me.setAttributeNS(null,"y2",$e[1]);break;case"radial":const Fe=Ae[4],Xe=Ae[5],We=Ae[6],Ie=Ae[7];Me=this.svgFactory.createElement("svg:radialGradient"),Me.setAttributeNS(null,"id",we),Me.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Me.setAttributeNS(null,"cx",Xe[0]),Me.setAttributeNS(null,"cy",Xe[1]),Me.setAttributeNS(null,"r",Ie),Me.setAttributeNS(null,"fx",Fe[0]),Me.setAttributeNS(null,"fy",Fe[1]),Me.setAttributeNS(null,"fr",We);break;default:throw new Error(`Unknown RadialAxial type: ${Ae[1]}`)}for(const Be of Te){const $e=this.svgFactory.createElement("svg:stop");$e.setAttributeNS(null,"offset",Be[0]),$e.setAttributeNS(null,"stop-color",Be[1]),Me.append($e)}return this.defs.append(Me),`url(#${we})`;case"Mesh":return(0,$.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${Ae[0]}`)}}setDash(Ae,we){this.current.dashArray=Ae,this.current.dashPhase=we}constructPath(Ae,we){const Te=this.current;let Me=Te.x,Be=Te.y,$e=[],Fe=0;for(const Xe of Ae)switch(Xe|0){case $.OPS.rectangle:Me=we[Fe++],Be=we[Fe++];const We=we[Fe++],Ie=we[Fe++],Oe=Me+We,Pe=Be+Ie;$e.push("M",fe(Me),fe(Be),"L",fe(Oe),fe(Be),"L",fe(Oe),fe(Pe),"L",fe(Me),fe(Pe),"Z");break;case $.OPS.moveTo:Me=we[Fe++],Be=we[Fe++],$e.push("M",fe(Me),fe(Be));break;case $.OPS.lineTo:Me=we[Fe++],Be=we[Fe++],$e.push("L",fe(Me),fe(Be));break;case $.OPS.curveTo:Me=we[Fe+4],Be=we[Fe+5],$e.push("C",fe(we[Fe]),fe(we[Fe+1]),fe(we[Fe+2]),fe(we[Fe+3]),fe(Me),fe(Be)),Fe+=6;break;case $.OPS.curveTo2:$e.push("C",fe(Me),fe(Be),fe(we[Fe]),fe(we[Fe+1]),fe(we[Fe+2]),fe(we[Fe+3])),Me=we[Fe+2],Be=we[Fe+3],Fe+=4;break;case $.OPS.curveTo3:Me=we[Fe+2],Be=we[Fe+3],$e.push("C",fe(we[Fe]),fe(we[Fe+1]),fe(Me),fe(Be),fe(Me),fe(Be)),Fe+=4;break;case $.OPS.closePath:$e.push("Z");break}$e=$e.join(" "),Te.path&&Ae.length>0&&Ae[0]!==$.OPS.rectangle&&Ae[0]!==$.OPS.moveTo?$e=Te.path.getAttributeNS(null,"d")+$e:(Te.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(Te.path)),Te.path.setAttributeNS(null,"d",$e),Te.path.setAttributeNS(null,"fill","none"),Te.element=Te.path,Te.setCurrentPoint(Me,Be)}endPath(){const Ae=this.current;if(Ae.path=null,!this.pendingClip)return;if(!Ae.element){this.pendingClip=null;return}const we=`clippath${_e++}`,Te=this.svgFactory.createElement("svg:clipPath");Te.setAttributeNS(null,"id",we),Te.setAttributeNS(null,"transform",ye(this.transformMatrix));const Me=Ae.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Me.setAttributeNS(null,"clip-rule","evenodd"):Me.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,Te.append(Me),this.defs.append(Te),Ae.activeClipUrl){Ae.clipGroup=null;for(const Be of this.extraStack)Be.clipGroup=null;Te.setAttributeNS(null,"clip-path",Ae.activeClipUrl)}Ae.activeClipUrl=`url(#${we})`,this.tgrp=null}clip(Ae){this.pendingClip=Ae}closePath(){const Ae=this.current;if(Ae.path){const we=`${Ae.path.getAttributeNS(null,"d")}Z`;Ae.path.setAttributeNS(null,"d",we)}}setLeading(Ae){this.current.leading=-Ae}setTextRise(Ae){this.current.textRise=Ae}setTextRenderingMode(Ae){this.current.textRenderingMode=Ae}setHScale(Ae){this.current.textHScale=Ae/100}setRenderingIntent(Ae){}setFlatness(Ae){}setGState(Ae){for(const[we,Te]of Ae)switch(we){case"LW":this.setLineWidth(Te);break;case"LC":this.setLineCap(Te);break;case"LJ":this.setLineJoin(Te);break;case"ML":this.setMiterLimit(Te);break;case"D":this.setDash(Te[0],Te[1]);break;case"RI":this.setRenderingIntent(Te);break;case"FL":this.setFlatness(Te);break;case"Font":this.setFont(Te);break;case"CA":this.setStrokeAlpha(Te);break;case"ca":this.setFillAlpha(Te);break;default:(0,$.warn)(`Unimplemented graphic state operator ${we}`);break}}fill(){const Ae=this.current;Ae.element&&(Ae.element.setAttributeNS(null,"fill",Ae.fillColor),Ae.element.setAttributeNS(null,"fill-opacity",Ae.fillAlpha),this.endPath())}stroke(){const Ae=this.current;Ae.element&&(this._setStrokeAttributes(Ae.element),Ae.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(Ae,we=1){const Te=this.current;let Me=Te.dashArray;we!==1&&Me.length>0&&(Me=Me.map(function(Be){return we*Be})),Ae.setAttributeNS(null,"stroke",Te.strokeColor),Ae.setAttributeNS(null,"stroke-opacity",Te.strokeAlpha),Ae.setAttributeNS(null,"stroke-miterlimit",fe(Te.miterLimit)),Ae.setAttributeNS(null,"stroke-linecap",Te.lineCap),Ae.setAttributeNS(null,"stroke-linejoin",Te.lineJoin),Ae.setAttributeNS(null,"stroke-width",fe(we*Te.lineWidth)+"px"),Ae.setAttributeNS(null,"stroke-dasharray",Me.map(fe).join(" ")),Ae.setAttributeNS(null,"stroke-dashoffset",fe(we*Te.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const Ae=this.svgFactory.createElement("svg:rect");Ae.setAttributeNS(null,"x","0"),Ae.setAttributeNS(null,"y","0"),Ae.setAttributeNS(null,"width","1px"),Ae.setAttributeNS(null,"height","1px"),Ae.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(Ae)}paintImageXObject(Ae){const we=this.getObject(Ae);if(!we){(0,$.warn)(`Dependent image with object ID ${Ae} is not ready yet`);return}this.paintInlineImageXObject(we)}paintInlineImageXObject(Ae,we){const Te=Ae.width,Me=Ae.height,Be=he(Ae,this.forceDataSchema,!!we),$e=this.svgFactory.createElement("svg:rect");$e.setAttributeNS(null,"x","0"),$e.setAttributeNS(null,"y","0"),$e.setAttributeNS(null,"width",fe(Te)),$e.setAttributeNS(null,"height",fe(Me)),this.current.element=$e,this.clip("nonzero");const Fe=this.svgFactory.createElement("svg:image");Fe.setAttributeNS(ae,"xlink:href",Be),Fe.setAttributeNS(null,"x","0"),Fe.setAttributeNS(null,"y",fe(-Me)),Fe.setAttributeNS(null,"width",fe(Te)+"px"),Fe.setAttributeNS(null,"height",fe(Me)+"px"),Fe.setAttributeNS(null,"transform",`scale(${fe(1/Te)} ${fe(-1/Me)})`),we?we.append(Fe):this._ensureTransformGroup().append(Fe)}paintImageMaskXObject(Ae){const we=this.getObject(Ae.data,Ae);if(we.bitmap){(0,$.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const Te=this.current,Me=we.width,Be=we.height,$e=Te.fillColor;Te.maskId=`mask${Ee++}`;const Fe=this.svgFactory.createElement("svg:mask");Fe.setAttributeNS(null,"id",Te.maskId);const Xe=this.svgFactory.createElement("svg:rect");Xe.setAttributeNS(null,"x","0"),Xe.setAttributeNS(null,"y","0"),Xe.setAttributeNS(null,"width",fe(Me)),Xe.setAttributeNS(null,"height",fe(Be)),Xe.setAttributeNS(null,"fill",$e),Xe.setAttributeNS(null,"mask",`url(#${Te.maskId})`),this.defs.append(Fe),this._ensureTransformGroup().append(Xe),this.paintInlineImageXObject(we,Fe)}paintFormXObjectBegin(Ae,we){if(Array.isArray(Ae)&&Ae.length===6&&this.transform(Ae[0],Ae[1],Ae[2],Ae[3],Ae[4],Ae[5]),we){const Te=we[2]-we[0],Me=we[3]-we[1],Be=this.svgFactory.createElement("svg:rect");Be.setAttributeNS(null,"x",we[0]),Be.setAttributeNS(null,"y",we[1]),Be.setAttributeNS(null,"width",fe(Te)),Be.setAttributeNS(null,"height",fe(Me)),this.current.element=Be,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(Ae){const we=this.svgFactory.create(Ae.width,Ae.height),Te=this.svgFactory.createElement("svg:defs");we.append(Te),this.defs=Te;const Me=this.svgFactory.createElement("svg:g");return Me.setAttributeNS(null,"transform",ye(Ae.transform)),we.append(Me),this.svg=Me,we}_ensureClipGroup(){if(!this.current.clipGroup){const Ae=this.svgFactory.createElement("svg:g");Ae.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(Ae),this.current.clipGroup=Ae}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",ye(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(J){var e=__webpack_module_cache__[J];if(e!==void 0)return e.exports;var C=__webpack_module_cache__[J]={exports:{}};return __webpack_modules__[J](C,C.exports,__w_pdfjs_require__),C.exports}var __webpack_exports__={};return(()=>{var J=__webpack_exports__;Object.defineProperty(J,"__esModule",{value:!0}),Object.defineProperty(J,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(J,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Y.AnnotationEditorLayer}}),Object.defineProperty(J,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(J,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(J,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return V.AnnotationEditorUIManager}}),Object.defineProperty(J,"AnnotationLayer",{enumerable:!0,get:function(){return te.AnnotationLayer}}),Object.defineProperty(J,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(J,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(J,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(J,"GlobalWorkerOptions",{enumerable:!0,get:function(){return se.GlobalWorkerOptions}}),Object.defineProperty(J,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(J,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(J,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(J,"PDFDataRangeTransport",{enumerable:!0,get:function(){return C.PDFDataRangeTransport}}),Object.defineProperty(J,"PDFDateString",{enumerable:!0,get:function(){return F.PDFDateString}}),Object.defineProperty(J,"PDFWorker",{enumerable:!0,get:function(){return C.PDFWorker}}),Object.defineProperty(J,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(J,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(J,"PixelsPerInch",{enumerable:!0,get:function(){return F.PixelsPerInch}}),Object.defineProperty(J,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(J,"RenderingCancelledException",{enumerable:!0,get:function(){return F.RenderingCancelledException}}),Object.defineProperty(J,"SVGGraphics",{enumerable:!0,get:function(){return ne.SVGGraphics}}),Object.defineProperty(J,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(J,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(J,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(J,"XfaLayer",{enumerable:!0,get:function(){return ee.XfaLayer}}),Object.defineProperty(J,"build",{enumerable:!0,get:function(){return C.build}}),Object.defineProperty(J,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(J,"getDocument",{enumerable:!0,get:function(){return C.getDocument}}),Object.defineProperty(J,"getFilenameFromUrl",{enumerable:!0,get:function(){return F.getFilenameFromUrl}}),Object.defineProperty(J,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return F.getPdfFilenameFromUrl}}),Object.defineProperty(J,"getXfaPageViewport",{enumerable:!0,get:function(){return F.getXfaPageViewport}}),Object.defineProperty(J,"isDataScheme",{enumerable:!0,get:function(){return F.isDataScheme}}),Object.defineProperty(J,"isPdfFile",{enumerable:!0,get:function(){return F.isPdfFile}}),Object.defineProperty(J,"loadScript",{enumerable:!0,get:function(){return F.loadScript}}),Object.defineProperty(J,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(J,"renderTextLayer",{enumerable:!0,get:function(){return $.renderTextLayer}}),Object.defineProperty(J,"setLayerDimensions",{enumerable:!0,get:function(){return F.setLayerDimensions}}),Object.defineProperty(J,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(J,"updateTextLayer",{enumerable:!0,get:function(){return $.updateTextLayer}}),Object.defineProperty(J,"version",{enumerable:!0,get:function(){return C.version}});var e=__w_pdfjs_require__(1),C=__w_pdfjs_require__(2),F=__w_pdfjs_require__(6),$=__w_pdfjs_require__(26),Y=__w_pdfjs_require__(27),V=__w_pdfjs_require__(5),te=__w_pdfjs_require__(32),se=__w_pdfjs_require__(14),ne=__w_pdfjs_require__(35),ee=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;function h(J,e,C,F){const $=C-J,Y=F-e;return Math.sqrt($*$+Y*Y)}function n$1(J,e,C){return Math.max(e,Math.min(J,C))}class u{constructor(e=0,C=0){this.length=2,this.x=e,this.y=C}static multiplyByScalar(e,C){return new u(e.x*C,e.y*C)}static addScalar(e,C){return new u(e.x+C,e.y+C)}static normalize(e){return new u().setFromVec2(e).normalize()}static add(e,C){return new u(e.x+C.x,e.y+C.y)}static subtract(e,C){return new u(e.x-C.x,e.y-C.y)}static dotProduct(e,C){return e.x*C.x+e.y*C.y}static applyMat3(e,C){return e.clone().applyMat3(C)}static lerp(e,C,F){return e.clone().lerp(C,F)}static rotate(e,C,F){return e.clone().rotate(C,F)}static equals(e,C,F=6){return!!e&&e.equals(C)}static getDistance(e,C){const F=C.x-e.x,$=C.y-e.y;return Math.sqrt(F*F+$*$)}static getAngle(e,C){return e.getAngle(C)}static minMax(...e){return(e=(e||[]).filter(C=>C)).length?{min:new u(Math.min(...e.map(C=>C.x)),Math.min(...e.map(C=>C.y))),max:new u(Math.max(...e.map(C=>C.x)),Math.max(...e.map(C=>C.y)))}:{min:new u,max:new u}}clone(){return new u(this.x,this.y)}set(e,C){return this.x=e,this.y=C,this}setFromVec2(e){return this.x=e.x,this.y=e.y,this}multiplyByScalar(e){return this.x*=e,this.y*=e,this}addScalar(e){return this.x+=e,this.y+=e,this}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}getAngle(e){const C=Math.atan2(this.x,this.y);let F=Math.atan2(e.x,e.y)-C;return F>Math.PI?F-=2*Math.PI:F<=-Math.PI&&(F+=2*Math.PI),F}normalize(){const e=this.getMagnitude();return e&&(this.x/=e,this.y/=e),this}add(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return this.x-=e.x,this.y-=e.y,this}dotProduct(e){return u.dotProduct(this,e)}applyMat3(e){if(e.length!==9)throw new Error("Matrix must contain 9 elements");const{x:C,y:F}=this,[$,Y,,V,te,,se,ne]=e;return this.x=C*$+F*V+se,this.y=C*Y+F*te+ne,this}lerp(e,C){return this.x+=C*(e.x-this.x),this.y+=C*(e.y-this.y),this}rotate(e,C){const F=Math.sin(C),$=Math.cos(C),Y=this.x-e.x,V=this.y-e.y;return this.x=Y*$-V*F+e.x,this.y=Y*F+V*$+e.y,this}truncate(e=5){return this.x=+this.x.toFixed(e),this.y=+this.y.toFixed(e),this}equals(e,C=6){return!!e&&+this.x.toFixed(C)==+e.x.toFixed(C)&&+this.y.toFixed(C)==+e.y.toFixed(C)}toArray(){return[this.x,this.y]}toIntArray(){return new Int32Array(this)}toFloatArray(){return new Float32Array(this)}*[Symbol.iterator](){yield this.x,yield this.y}}class l{constructor(){this.length=9,this._matrix=new Array(this.length),this._matrix[0]=1,this._matrix[1]=0,this._matrix[2]=0,this._matrix[3]=0,this._matrix[4]=1,this._matrix[5]=0,this._matrix[6]=0,this._matrix[7]=0,this._matrix[8]=1}get x_x(){return this._matrix[0]}get x_y(){return this._matrix[1]}get x_z(){return this._matrix[2]}get y_x(){return this._matrix[3]}get y_y(){return this._matrix[4]}get y_z(){return this._matrix[5]}get z_x(){return this._matrix[6]}get z_y(){return this._matrix[7]}get z_z(){return this._matrix[8]}static fromMat3(e){return new l().setFromMat3(e)}static fromMat4(e){return new l().setFromMat4(e)}static from4Vec2(e,C,F,$,Y=!1){const V=new l;V.applyTranslation(-e.x,-e.y);const te=u.subtract(C,e).getMagnitude(),se=u.subtract($,F).getMagnitude()/te;if(V.applyScaling(se),!Y){const ne=Math.atan2(C.y-e.y,C.x-e.x)-Math.atan2($.y-F.y,$.x-F.x);V.applyRotation(ne)}return V.applyTranslation(F.x,F.y),V}static multiply(e,C){const[F,$,Y,V,te,se,ne,ee,ie]=e._matrix,[ae,re,oe,ce,he,de,pe,fe,ye]=C._matrix,_e=new l;return _e.set(F*ae+$*ce+Y*pe,F*re+$*he+Y*fe,F*oe+$*de+Y*ye,V*ae+te*ce+se*pe,V*re+te*he+se*fe,V*oe+te*de+se*ye,ne*ae+ee*ce+ie*pe,ne*re+ee*he+ie*fe,ne*oe+ee*de+ie*ye),_e}static multiplyScalar(e,C){const F=new l;for(let $=0;$<this.length;$++)F._matrix[$]=e._matrix[$]*C;return F}static transpose(e){const C=new l;return C.set(e.x_x,e.y_x,e.z_x,e.x_y,e.y_y,e.z_y,e.x_z,e.y_z,e.z_z),C}static invert(e){const C=new l;C.set(e.y_y*e.z_z-e.z_y*e.y_z,e.y_x*e.z_z-e.z_x*e.y_z,e.y_x*e.z_y-e.z_x*e.y_y,e.x_y*e.z_z-e.z_y*e.x_z,e.x_x*e.z_z-e.z_x*e.x_z,e.x_x*e.z_y-e.z_x*e.x_y,e.x_y*e.y_z-e.y_y*e.x_z,e.x_x*e.y_z-e.y_x*e.x_z,e.x_x*e.y_y-e.y_x*e.x_y),C.set(C.x_x,-C.x_y,C.x_z,-C.y_x,C.y_y,-C.y_z,C.z_x,-C.z_y,C.z_z);const F=e.x_x*C.x_x+e.x_y*C.x_y+e.x_z*C.x_z,$=new l;if(F){const Y=1/F;$.set(Y*C.x_x,Y*C.y_x,Y*C.z_x,Y*C.x_y,Y*C.y_y,Y*C.z_y,Y*C.x_z,Y*C.y_z,Y*C.z_z)}else $.set(0,0,0,0,0,0,0,0,0);return $}static buildScale(e,C){return C!=null||(C=e),new l().set(e,0,0,0,C,0,0,0,1)}static buildRotation(e){const C=Math.cos(e),F=Math.sin(e);return new l().set(C,-F,0,F,C,0,0,0,1)}static buildTranslate(e,C){return new l().set(1,0,0,0,1,0,e,C,1)}static equals(e,C,F=6){return e.equals(C,F)}clone(){return new l().set(this.x_x,this.x_y,this.x_z,this.y_x,this.y_y,this.y_z,this.z_x,this.z_y,this.z_z)}set(e,C,F,$,Y,V,te,se,ne){return this._matrix[0]=e,this._matrix[1]=C,this._matrix[2]=F,this._matrix[3]=$,this._matrix[4]=Y,this._matrix[5]=V,this._matrix[6]=te,this._matrix[7]=se,this._matrix[8]=ne,this}reset(){return this._matrix[0]=1,this._matrix[1]=0,this._matrix[2]=0,this._matrix[3]=0,this._matrix[4]=1,this._matrix[5]=0,this._matrix[6]=0,this._matrix[7]=0,this._matrix[8]=1,this}setFromMat3(e){for(let C=0;C<this.length;C++)this._matrix[C]=e._matrix[C];return this}setFromMat4(e){const C=e.toArray();if(C.length!==16)throw new Error("Matrix must contain 16 elements");const[F,$,Y,,V,te,se,,ne,ee,ie]=C;for(let ae=0;ae<this.length;ae++)this._matrix[0]=F,this._matrix[1]=$,this._matrix[2]=Y,this._matrix[3]=V,this._matrix[4]=te,this._matrix[5]=se,this._matrix[6]=ne,this._matrix[7]=ee,this._matrix[8]=ie;return this}multiply(e){const[C,F,$,Y,V,te,se,ne,ee]=this._matrix,[ie,ae,re,oe,ce,he,de,pe,fe]=e._matrix;return this._matrix[0]=C*ie+F*oe+$*de,this._matrix[1]=C*ae+F*ce+$*pe,this._matrix[2]=C*re+F*he+$*fe,this._matrix[3]=Y*ie+V*oe+te*de,this._matrix[4]=Y*ae+V*ce+te*pe,this._matrix[5]=Y*re+V*he+te*fe,this._matrix[6]=se*ie+ne*oe+ee*de,this._matrix[7]=se*ae+ne*ce+ee*pe,this._matrix[8]=se*re+ne*he+ee*fe,this}multiplyScalar(e){for(let C=0;C<this.length;C++)this._matrix[C]*=e;return this}transpose(){const e=new l().setFromMat3(this);return this.set(e.x_x,e.y_x,e.z_x,e.x_y,e.y_y,e.z_y,e.x_z,e.y_z,e.z_z),this}invert(){const e=new l;e.set(this.y_y*this.z_z-this.z_y*this.y_z,this.y_x*this.z_z-this.z_x*this.y_z,this.y_x*this.z_y-this.z_x*this.y_y,this.x_y*this.z_z-this.z_y*this.x_z,this.x_x*this.z_z-this.z_x*this.x_z,this.x_x*this.z_y-this.z_x*this.x_y,this.x_y*this.y_z-this.y_y*this.x_z,this.x_x*this.y_z-this.y_x*this.x_z,this.x_x*this.y_y-this.y_x*this.x_y),e.set(e.x_x,-e.x_y,e.x_z,-e.y_x,e.y_y,-e.y_z,e.z_x,-e.z_y,e.z_z);const C=this.x_x*e.x_x+this.x_y*e.x_y+this.x_z*e.x_z;if(C){const F=1/C;this.set(F*e.x_x,F*e.y_x,F*e.z_x,F*e.x_y,F*e.y_y,F*e.z_y,F*e.x_z,F*e.y_z,F*e.z_z)}else this.set(0,0,0,0,0,0,0,0,0);return this}getDeterminant(){const[e,C,F,$,Y,V,te,se,ne]=this._matrix;return e*Y*ne-e*V*se+C*V*te-C*$*ne+F*$*se-F*Y*te}getTRS(){const e=new u(this.z_x,this.z_y),C=Math.sqrt(this.x_x*this.x_x+this.x_y*this.x_y),F=Math.sqrt(this.y_x*this.y_x+this.y_y*this.y_y),$=new u(C,F),Y=Math.atan(-this.x_y/this.x_x),V=Math.acos(this.x_x/C);let te;return te=V>Math.PI/2&&Y>0||V<Math.PI/2&&Y<0?2*Math.PI-V:V,{t:e,r:te,s:$}}truncate(e=5){for(let C=0;C<this.length;C++)this._matrix[C]=+this._matrix[C].toFixed(e);return this}equals(e,C=6){for(let F=0;F<this.length;F++)if(+this._matrix[F].toFixed(C)!=+e._matrix[F].toFixed(C))return!1;return!0}applyScaling(e,C){const F=l.buildScale(e,C);return this.multiply(F)}applyTranslation(e,C){const F=l.buildTranslate(e,C);return this.multiply(F)}applyRotation(e){const C=l.buildRotation(e);return this.multiply(C)}toArray(){return this._matrix.slice()}toIntArray(){return new Int32Array(this)}toFloatArray(){return new Float32Array(this)}toIntShortArray(){return new Int32Array([this._matrix[0],this._matrix[1],this._matrix[3],this._matrix[4],this._matrix[6],this._matrix[7]])}toFloatShortArray(){return new Float32Array([+this._matrix[0].toFixed(5),+this._matrix[1].toFixed(5),+this._matrix[3].toFixed(5),+this._matrix[4].toFixed(5),+this._matrix[6].toFixed(5),+this._matrix[7].toFixed(5)])}*[Symbol.iterator](){for(let e=0;e<9;e++)yield this._matrix[e]}}class z{constructor(e=0,C=0,F=0){this.length=3,this.x=e,this.y=C,this.z=F}static multiplyByScalar(e,C){return new z(e.x*C,e.y*C,e.z*C)}static addScalar(e,C){return new z(e.x+C,e.y+C,e.z+C)}static normalize(e){return new z().setFromVec3(e).normalize()}static add(e,C){return new z(e.x+C.x,e.y+C.y,e.z+C.z)}static subtract(e,C){return new z(e.x-C.x,e.y-C.y,e.z-C.z)}static dotProduct(e,C){return e.x*C.x+e.y*C.y+e.z*C.z}static crossProduct(e,C){return new z(e.y*C.z-e.z*C.y,e.z*C.x-e.x*C.z,e.x*C.y-e.y*C.x)}static onVector(e,C){return e.clone().onVector(C)}static onPlane(e,C){return e.clone().onPlane(C)}static applyMat3(e,C){return e.clone().applyMat3(C)}static applyMat4(e,C){return e.clone().applyMat4(C)}static lerp(e,C,F){return e.clone().lerp(C,F)}static equals(e,C,F=6){return!!e&&e.equals(C,F)}static getDistance(e,C){const F=C.x-e.x,$=C.y-e.y,Y=C.z-e.z;return Math.sqrt(F*F+$*$+Y*Y)}static getAngle(e,C){return e.getAngle(C)}clone(){return new z(this.x,this.y,this.z)}set(e,C,F){return this.x=e,this.y=C,this.z=F,this}setFromVec3(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}multiplyByScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}getAngle(e){const C=this.getMagnitude()*e.getMagnitude();if(!C)return Math.PI/2;const F=this.dotProduct(e)/C;return Math.acos(n$1(F,-1,1))}normalize(){const e=this.getMagnitude();return e&&(this.x/=e,this.y/=e,this.z/=e),this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}subtract(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}dotProduct(e){return z.dotProduct(this,e)}crossProduct(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this.z=this.x*e.y-this.y*e.x,this}onVector(e){const C=this.getMagnitude();return C?e.clone().multiplyByScalar(e.clone().dotProduct(this)/(C*C)):this.set(0,0,0)}onPlane(e){return this.subtract(this.clone().onVector(e))}applyMat3(e){if(e.length!==9)throw new Error("Matrix must contain 9 elements");const{x:C,y:F,z:$}=this,[Y,V,te,se,ne,ee,ie,ae,re]=e;return this.x=C*Y+F*se+$*ie,this.y=C*V+F*ne+$*ae,this.z=C*te+F*ee+$*re,this}applyMat4(e){if(e.length!==16)throw new Error("Matrix must contain 16 elements");const{x:C,y:F,z:$}=this,[Y,V,te,se,ne,ee,ie,ae,re,oe,ce,he,de,pe,fe,ye]=e,_e=1/(C*se+F*ae+$*he+ye);return this.x=(C*Y+F*ne+$*re+de)*_e,this.y=(C*V+F*ee+$*oe+pe)*_e,this.z=(C*te+F*ie+$*ce+fe)*_e,this}lerp(e,C){return this.x+=C*(e.x-this.x),this.y+=C*(e.y-this.y),this.z+=C*(e.z-this.z),this}truncate(e=5){return this.x=+this.x.toFixed(e),this.y=+this.y.toFixed(e),this.z=+this.z.toFixed(e),this}equals(e,C=6){return!!e&&+this.x.toFixed(C)==+e.x.toFixed(C)&&+this.y.toFixed(C)==+e.y.toFixed(C)&&+this.z.toFixed(C)==+e.z.toFixed(C)}toArray(){return[this.x,this.y,this.z]}toIntArray(){return new Int32Array(this)}toFloatArray(){return new Float32Array(this)}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(J){return typeof J=="string"&&REGEX.test(J)}var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).substr(1));function stringify(J){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=(byteToHex[J[e+0]]+byteToHex[J[e+1]]+byteToHex[J[e+2]]+byteToHex[J[e+3]]+"-"+byteToHex[J[e+4]]+byteToHex[J[e+5]]+"-"+byteToHex[J[e+6]]+byteToHex[J[e+7]]+"-"+byteToHex[J[e+8]]+byteToHex[J[e+9]]+"-"+byteToHex[J[e+10]]+byteToHex[J[e+11]]+byteToHex[J[e+12]]+byteToHex[J[e+13]]+byteToHex[J[e+14]]+byteToHex[J[e+15]]).toLowerCase();if(!validate(C))throw TypeError("Stringified UUID is invalid");return C}function v4(J,e,C){J=J||{};var F=J.random||(J.rng||rng)();if(F[6]=F[6]&15|64,F[8]=F[8]&63|128,e){C=C||0;for(var $=0;$<16;++$)e[C+$]=F[$];return e}return stringify(F)}var img$J="data:image/png;base64,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",img$I="data:image/png;base64,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",img$H="data:image/png;base64,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",img$G="data:image/png;base64,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",img$F="data:image/png;base64,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",img$E="data:image/png;base64,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",img$D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIU/N4piFBEtRCxSRLFQCApiKRFMoxYxgq8mu24SIRuX3Q0itoKNRcBCtPFV+A+0FWwVBEERRGz8A74akfVOVohIMsvs/Tgz5zJzBrTJvGG59TGwCp6TTMQjc/MLkcYXQmiE6aQ9bbj21MxEiprj8446VW8HVa/a+6qO8LLpGlDXJDxi2I4nPCY8uebZireFO41celn4UHjAkQMKXyldD/hZcTbgd8VOKjkOmuoZyf5h/Q8bOccS7heOWvmi8XsedZMWszA7I7VbZg8uSRLEiaBTZIU8HoNSC5JZdV+s7JtmVTyG/G3WccSRJSfeAVGL0tWUmhHdlC/Pusr9f55uZngo6N4Sh4Yn33/rhcYd+C75/teR738fQ+gRLgoV/6rkNPoheqmiRQ+gbRPOLiuavgvnW9D1YKeddFkKydQyGXg9hdZ56LiB5sUgq991Tu4htSFPdA17+9An+9uWfgCZXmfbLPy9EwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAtBJREFUeNrlWwtuwjAMra2cALj/CWFHWLYiQKGLEzu282GRqiFo3bznT23PhY1Yl8vl/vd6vW6VFTf5AitZp/P5JQsByPMoHEABr12oAE/d21IWG0+gTuywYrLx2OumR8sOSnmg3LwaONcFiqZT0j4jBngAhoZYVDX/HLbQCfgRWJT6MkVGycefn0tEQO5HS7YJWWwCanI5+y8REKxUu99UEEhzsQO0hFOKK5GFrdrfhT2PQU+RJiVVCdA8WkYA0O4DPTdrHUg5AKUk4AhNzURy0DIqDH4uJB/3sH+mAt+fVPg7Ri+Nx5bonpFtIscrFeZkfFGxeSs5pLLQGfww2Vy3xIXAu9wDO2xMY7bgTQJODF5EQi4Q59zg+B1ODt7FElIS4HQ+v/34dbv1Ah8NrqleW+t14OSad7cEXAi8Cwm4GHgVCRbl8Azgm0igiqagBf/rR+BZCVaKGaor/ZY2l/aEC2reNCaE9LGXtrgy1diM4KuW8Lt/YPcDMqayAniVO+CiZm/mDvhB4JtIwA8DLyYBt3++Qmsw6bUa8wq2FeOoRoTjErkw9io6ZgR/dwGLVHMl8Mf+BzIaCCtYQvOTC5m9tJlJUD22JdVg1h0etQKsCP7lAtyO6mSWYJKwoaQWn4gEs2wVGxOOkSSYpuqaVHgECeZ1ingqy3BTUXl+E/gU3z4aYFEM9bAEc/B38wdonxLrSIJreW5ZDnuQYAaecm3UChjQNDG7B/m/QcoNJiDBXDZ22CiMluM6K1wQDoqgaqb12mMdS/6hcINlFqZDz9z3hVYnIcUVtg9dZmNyveZ+e4En3xpLL+aAfp43G0Fdp8UVsSCOKKWzEyKcbtAKbpAL4hwMotfmDF6vE78252mJr1RYo+G9KfpojHIOiYuwjlalNI3LCwYopFle1ChAky2GI7iOSc4xz+/SVK0+BrlEPH6HwgyR1MebSOBOqVHf/wB4polu0KoYHQAAAABJRU5ErkJggg==",img$C="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAZdJREFUeNrtW1GywiAMZDOeQHv/E9Z3hBenf05ttZAACSQz/lQHdjcJCRVSCgsLm9nQcC62iA3GSDfHCcOkm2CGI+JVsKMDeTQcq/oA7H0OVASmvb5UmQ8VwPSsLGghABvoKdRwwCl5NTxwTF4FF5yTF+MjJ/uIrmWQjZMXYSXnnhdjo8Lc8mRcqhg7834RdkqTGw2S+8VYaeDcv8SJBvR+tRTwZphdgEtpQJPkvygCMHIaRB8QAoQAIUAIEAKEAOUvFDxugCICfgiAgfmiNAKG3R/cpAPcH4/093wePte0szmOnuc4jTQ2QHuy2uSV5oA0AvibMDVIC+a4nLLTV4GS8zrWq0QW5tsMTl6W5fCLdV1/pgCclcQsbJswqBFWxsjjnfDHIvj+8CxUHETCpQMSW8hLvDjEEZm9kzX+G2Qv5LUaGD759CAvwrFxj4OSFUuOi6OyJOjhkRGiGqGuTl6SApKFcKjj8j2rgakLEy2FMHtlpqYYri5NaYlh59rcvn38Z7sbQgK+9v4fv0+TG+V635N5xt7MXlrTY+62KCOPAAAAAElFTkSuQmCC",img$B="data:image/png;base64,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",img$A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZG9S0JRGMZ/aqGVIVRDVIODRYGBFERjGORSDWaQ1aI3PwI/LvcqIa1BS4PQELX0NfQf1Bq0FgRBEUS09A/0tUTc3qOCEnku574/nnOel3OeA/bZjJY1WwKQzRWMcCjoXYoue52vtNGPiy5GYpqpzy3MRGg6vu6xqXo3qno13/fv6FhLmBrYXMITmm4UhKeEZzcKuuId4R4tHVsTPhL2G3JA4Wulx6v8ojhV5Q/FRiQ8DXbV05tq4HgDa2kjKzws7MtmilrtPOom7kRucUFqn8wBTMKECOIlTpF1MhQYlZqTzP73BSq+efLi0eSvU8IQR4q0eP2iFqVrQmpS9IR8GUoq9795msnxsWp3dxBany3rfRCcu/BTtqzvY8v6OQHHE1zm6v685DT5KXq5rvkOwbMF51d1Lb4HF9vQ+6jHjFhFcsi0J5PwdgadUei+hfaVala1dU4fILIpT3QD+wcwJPs9q78GJWgN6zGReAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAlxJREFUeNrtW1uOgzAMxCgn2HL/E9IeYb30AymkYbETv6BEQuoDiD2xJ+MQYNhp0zRh7fdfxEGrjQCb7/M8w6DcgOq4BwAWQADVcU8ANIEYhy9vcDT6FnnISUNpe1Ikx8u+qWnZFQG1Tjydp0SDpH1fzwFj5NHP7CmPexZQJ8FK4xASXA0A7HG8V1aX5/08HmKyOmmiazGNcW0pgUjEUQBCFEBEx4+ASFfMay0SdJOxZc6/ns9ue96/v+1JFihHltWj9uhHEVY1O9723lLYKfSRKazU7JHmAEq4Y/HZNUVSgCg8BKHC+ig1IB4cAJ11hui5aUWXoq+V89YkHUrlOzLEBVJunh+NIEgqUmBxAEdhOTeXJTE4k2NaswAI5nuIYstjFgjjvBcAocrs5OQwdjp/aiG0GqbtPOncUSCfwy5/aXMAGilEOyHUG1pMWR2GOLE4uOdXrzEAoaktdm1sry13g1MxZDUlYisHoLVxJiSYh2rgsNUVQsQOwCsFNFeEWoohby3PFUL/2paOtqYRQXBf3LQWQp7OhhBCR0UNSgI1TdPmu+TTpqQwGnjqFOh8ti/ufDn6V1wQ8Y2AvaemEYyrjf5ir7wQ2ukcpQknSthXSYwz6vlDj0WlQV5p5SVx/p8QV3DvB7VqMFeW4muCBFndS7LAuB/ugPAJgOUObVfSK5RvqpBMMxBEWQ3CKQCcFCCToDL5QZT73TrgBkB3Pg9FqDV77rfGLFCOsFlyz65k2Xm0V/BUIqBHVpetZcvOqvKob6GG5YDW/Urc61RSILKs/nhjxKKzCEDs8c8fwBklUiRq2yMAAAAASUVORK5CYII=",img$z="data:image/png;base64,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",img$y="data:image/png;base64,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",img$x="data:image/png;base64,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",img$w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIU/YyTBBykUEbHYwoiFAVEQS4mgjVrECEZtkk02EbKbZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9YwIJorPM3o8zcy4zZ8A3k9dN1z8MplV0YtNRbTGxpAVe8NNNB0HCSd21Z+en4vw7Pu9oUvU2onr9v+/P0ZbOuDo0BYXHdNspCk8Iz6wVbcVbwl16LpkWPhQecuSAwldKT1X5WXG2yu+KnXhsEnyqp5Zt4FQD6znHFB4U7jfzJb12HnWT9oy1MC+1V2YfLjGmiaKRosQqeYpEpFqS2d++4R/fHAXx6PK3KeOII0tOvEOilqRrRqoheka+PGWV++88XWN0pNq9PQotT573FobADlS2Pe/ryPMqx9D8CBdW3V+QnMY/RN+ua/0HENqAs8u6ltqF803oebCTTvJHapbpMwx4PYWOBHTeQOtyNavaOif3EF+XJ7qGvX0YkP2hlW/cxWf6XLNyeQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAJpJREFUeNrt1TESxCAIBdCw97+z2+1slQmgNHmv9guS0VwXAAAAAADAS8TDdauYq2Qna6WbyeSz2claWza92yObnaz1aACrcZXW4LVd3SsfGw7/v9fpw++oFZUBRGNIcfhtyGajFUg2ls1O1fqt/TRe3mhkd/+uy31+DjeWycVwD1sGMPH1T+55O4AoNlbJTdYCAAAAAAAAXugLTOAcJH5aTj8AAAAASUVORK5CYII=",img$v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABbmlDQ1BpY2MAACiRdZE7SwNBFIW/JEp8IqiFiEWKKAoKoiCWEkEbtYgRfDW76yYRsuuyu0GCrWBjIViINr4K/4G2gq2CICiCiI1/wFcjYb1jhATRWWbvx5k5l5kzEJ7IGZZX1Q+W7bvJ8URsdm4+Fn0mQjO19BDVDM+ZnB5L8e/4uCWk6k2f6vX/vj9H/ZLpGRCqER4yHNcXHhGeWPUdxZvCrUZWWxI+EO515YDCl0rXS/ykOFPiN8VuKjkKYdUzlqlgvYKNrGsJdwvHrVze+DmPukmDac9MS22X2YFHknESxNDJs0wOnz6ptmT2t6//2zfFingM+TsUcMWRISveXlHz0tWUmhbdlC9HQeX+O08vPThQ6t6QgOrHIHjthOg2FLeC4PMwCIpHEHmAc7vsX5Gcht9F3ypr8X1oWofTi7Km78DZBrTdO5qrfUsRmeF0Gl5OoHEOWq6hbqGU1c86x3eQWpMnuoLdPeiS/U2LX8/hZ/QGsUVrAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDklEQVR42u2aQRKDIAxFSacnqNz/hNgjNF221qkIKAJ5f+eMjPwHiZmAc8i2pPL3tLV5SYPmq87tRgiUr1TXnsWY+ZVvQsB6CCCESILUAdQBhmUewP2gokEzxtUasxnahAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYUqwt7rz3i+eXLjvMz3m+1MBjmj6rKesueQiBHQAAAPxX7HR41KMxTocBAAAAAOBIAJKRmWuNKSuFC36pLY3J3gEj3BrTFAAWLhJLag7QUVd/a8X17Ni7yLyUJEHtBIRmx8OACTDqVQaO/10+5Yxt1YPx3MSmoxhPejHWGG2qtv9qjMYaorvqgF/zPannuVfTG32vK+uRIdIIAAAAAElFTkSuQmCC",img$u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABbmlDQ1BpY2MAACiRdZG9S0JRGMZ/amGY4VBDRIODhYRCFERjGORiDWqQ1aLXr8CPy71KSGvQ0iA0RC19Df0HtQatBUFQBBEt/QN9LSG392RghJ7Lue+P55zn5ZzngD1S0Ipm1zgUSxUjGg55lxLLXucLDly4GcOf1Ex9PjYXp+P4vMOm6m1Q9eq8r+3oTWdMDWw9wlOablSEZ4Qj6xVd8bbwgJZPpoUPhQOGHFD4SumpJj8rzjX5XbERj86CXfX05v5w6g9reaMo7Bf2FQtV7fc86ibuTGkxJnVI5jAmUcKE8JKiyhoFKgSlliSz9r7xH98CZfFo8tepYYgjR168AVGr0jUjNSt6Rr4CNZX7/zzN7OREs7s7BN1PlvU2As4daNQt6+vIshrH4HiEi1LLX5acpj9Er7c03wF4NuHssqWlduF8CwYf9KSR/JEcMu3ZLLyeQl8C+m/AtdLM6nedk3uIb8gTXcPePozKfs/qNw5zaBHJcPVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAADIUlEQVR42u1bPY7UMBS2PZYQotmdTMMhqFhKGsR23IN6F1pEg7bj5xZUnICSluEAXIBmnEkFQsomPId45bGcxEnsTJ4nT7I0cX7s73u/diaUNMhms7H2F2VJ+kgqhK3b9hBqu3CdJM5jMUobz+12O2s/dwWOXRQukwgeO/AuIhg5caFd2m/ynZHiHAN8aLsNG58Y+KSiMLQRwWwnYwDvaiEnEQOkQp3T4Ny0PyY75be3JNvvD7CZz+MhJ+CDUFvhVRQFYYw1Fj7qHnlNl3DMpt23KrUGQUyAlcZdNOsqR7EAWd/rawTz2GEtMWitYLMa7sOMhpIwh2egcQEzGPsAj4oAPZv4Ao9yMdQGXsULmSajJMAFfN8swWIDH6ULhAKPgoCQ4FEGQZ/gnSrBOe4N+AKP0gJ8gkdHgG/wzouhMXsCvlwoBHg0FhAKPAoCQoJHnQYXAhwspnRYFPEYtdrHbRYXWAhYCFgIWAhYCDhhGV0H5Hn+iDF2Qyh9UedgGmqy6yT5/xanLL+lafpMDu/DAkqjmYNWr5NUU+/aVaOUfqnBi4NJhgIvhdKnSZK8HPioA7zjXYCxz/WvxDpZ3+DvOKBfZxED9kK8BZN87zJpX+DlsGB9PychQNbV8rW0anJzRG/VNWn6OgQJlvv3MIfHMKf17LKAbxJs9wH456D5H7NNgxUJhHwYS0KD5i98gw9SB4B5vhpDgpbq/mqavwTwWzSFUE0C6UuCOl8UxR8I8/e0gBcEfNBKUBZEBSEfXUnQ+6Gwul9r/sJnwAtSCXZsmV/nUDwBy1e1Zn8BuIct12fQztTvkJqfbC2QCXGtLKEDPKnBZ7Xmz6NZDOkk2ERahpHqtmQimWw1KEkAJ/9kr6Yry8hgFfUkNHi9qKua2RFSoGy+aiIBRr4UQnyPfj9AkmA3kOnBH21DRKZIsIR34Pu/pwx4gwg4O/c/N5k6V5S+4avVAzjcHvODLdtncyUEortgoP/fHrtIbLNwgTkJ07XdxlSM2pfYedcNNoKwAzfSb3+tH+sv9q6FjosoxS5fjg7xf8wWYLo0HeI7GAloimX/ANBjieJDfrkhAAAAAElFTkSuQmCC",img$t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZG9S8NQFMVPW8Wi1Q46SHHIUMWhhaIgjlLBLtWhrWDVJXlN2kKShpcUKa6Ci0PBQXTxa/A/0FVwVRAERRBx8R/wa5ES72sKLdLe8PJ+nHfP5eUE8Kd1Zth9CcAwHZ5JJaW1/Lo08A4fRhBEHBGZ2dZydimHnvXzSN1UD3Exq3df1xoqqDYDfEHiOWZxh3iBOL3lWIL3iMdYSS4QnxDHOF2Q+Fboisdvgosefwnmucwi4BczpWIHKx3MStwgniaOGnqVte4jviSkmqtZ2iO0JmAjgxSSkKCgijJ0OJRLGSZl1t2XaPpWUCEPo7eFGjg5iiiRN0ZqlaaqtGukq/ToqInc/+dpa7Mz3vRQEuh/dd3PSWBgH2jUXff31HUbZ0DgBbg22/4K5TT/TXq9rUWPgfAOcHnT1pQD4GoXGH+2ZC43pQAtv6YBHxfAcB4YvQcGN7ysWuc4fwJy2/SL7oDDI2CK+sObf/JNaAQfxWcoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVR42u2bzXKDIBCAw+ql6cnqpQ/Q93+f9gF60aan9GKwmkqHsXZA5Wd3YWcyySFO+D4WCLKKU+R4qush5u/DKfHIAlIXIFIDXs45eQhkAYlHiaUhTdMMcvgZniDcTE397Xb9vFweKQgoFfwU+ue1kFJ+AcDDf6J+RQKcqWRAv+cikyhqc4Ax71WPT73Pbg746Lpd/0uO7iVIrwIuNlJkBIyrhJddJBkBbdt62UIDp7Qf5xExL5PvLAXYwM+rxDM7AbbwLIeAL3gSAnzCoxfgGx61gBDwaAWEgkcpICQ8OgGh4VEJiAGPRkAseBQCPMF3JAQo+LV7e3vh9esGKd9M3xeppT2Kk6GYY/5PBiwb47sBmOCDZwA2eCsBVVW9Tg0fX63TsadNfLHgrQQIgBebHtza8+pQIyb81iFQc0n7YHMAdnivAijAexNABd6LAErwzgVQg3cqgCK8MwFU4Z0IoAx/WAB1+EMCOMBvEqAfOXOB3yRAHTlzgne6DOrwy3IW9gKWPa+Xs7AXQDHt9ThcJ7h2p8eiglPMdYF85oCpfvf+ble+OpDMAFNx8o7f7tELGHv2WhbF2SQGisJYv7soh+9JZICp3p565EdmsoDEQ8R+dpfSwUgeAlkAw/gGgdL3j4c6UpkAAAAASUVORK5CYII=",img$s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZG9S8NQFMVPW8Wi1Q46SHHIUMWhhaIgjlLBLtWhrWDVJXlN2kKShpcUKa6Ci0PBQXTxa/A/0FVwVRAERRBx8R/wa5ES72sKLdLe8PJ+nHfP5eUE8Kd1Zth9CcAwHZ5JJaW1/Lo08A4fRhBEHBGZ2dZydimHnvXzSN1UD3Exq3df1xoqqDYDfEHiOWZxh3iBOL3lWIL3iMdYSS4QnxDHOF2Q+Fboisdvgosefwnmucwi4BczpWIHKx3MStwgniaOGnqVte4jviSkmqtZ2iO0JmAjgxSSkKCgijJ0OJRLGSZl1t2XaPpWUCEPo7eFGjg5iiiRN0ZqlaaqtGukq/ToqInc/+dpa7Mz3vRQEuh/dd3PSWBgH2jUXff31HUbZ0DgBbg22/4K5TT/TXq9rUWPgfAOcHnT1pQD4GoXGH+2ZC43pQAtv6YBHxfAcB4YvQcGN7ysWuc4fwJy2/SL7oDDI2CK+sObf/JNaAQfxWcoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR42u2bMW/EIAyFA7qla5Ol///HdUm6dguFKlQuBwnh7ADKs5TlTsrxPp6NAZ16H0czCMTXsijO90mNUw83DwC4OwAV5hZ37rYWoV6kAAAAAAAAAAAAAAAAAAAAAADcMh6CO63F7iwnkR2cUmqe57YcEIq3zyg4cWaapnYARM7rRjtLYupXY9ggaAHxzqKDtSgbAXdIkwBqqgK4QryP8J3OBe6xLjBVAFwpnjoh9rmDUJoOuhfxqXTwTiitCbon8WE6ROrCaQi6N/GxdFjX9XtzwWkIukS8/cHPmuKfnKD1W6kTdMnM2x/8qC0+VhNIPciGoEts7+nb75ro53cm4nCJ3L0ZkrqRvWSXRwokBZR9M9SzeJoOR82SziHYe5C6kA/A2cZB8E/PsXfh+zgqLt4+DgIl2cotsivEdizJlD0aZ84ymOy/G5nd5FhyJukQwHby8td60jW3hULpxP8Wu605O+vQrEaIQqDtZ20nePG+OStJz+xW+MkJpP2s4QQqvmTmizZDUSdsg7jSCVzii7bDHkK4PF5VEzjFFx+IOAip/lsSArf4YgCxZkl6iZQQ/zKAVJ/AnQ5S4lkA0Jog3Msv3OK5HBBdHZjj300TZxvOdjcoCYHrjlHMAT0HAAAAAAAAAAAAAAAAAAAAANwzFP47jBQAgFvHDyRnPtj60cBDAAAAAElFTkSuQmCC",img$r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAeNJREFUeNrlm2uOwjAMhDsWJ4De/4bsEfD+WGm3QqTNw54460hIBbWNP2ec2G3Alq/p4RhIDP/jgczwmRyghd9NQ0AbzkUEeAtD1MBAzIIf6VwdjAUbvqdTJUgWLPjWztQAQAlO0JZ7wgAeTnMIvOFrOlFSzFr0oz3Xw/qGrNi1shWB4Hv7HrJVAiYvICjm9EQNkjJf2WGiUgSFv7LHLERlW6+Zzk8IPPotyVO3nRKkYhuBG7JTiDl+yLpBssV8rQMQHN5UQp6TX/TQgqw8ehY2SmD5U5psydst0JJVM9urgVo1ogKmld+SGT6CA6bCz3bAdPiSAzQL/CwFWD/4HHYAFpU9VlPACLyyQ4CVx09Pu+XEEA0MD28FRBp5ZSiAqYJReDDmgH+zzrc6wEIFVvCUx/S1D0SUHK+0dxRiMLIMeHoq3PoqWo3A6XPHaP6NzX/vkOvuMa809JNj0OFc9xXq1jByq+wSc00pV9knWM0g+77/fjkeTzAOMxKlCApgQzfPAbUZngaGLucB98fDKr3F26ck8VD1AIzga64L+cpdnOCXaZIZ/swBKeBLDkgD/8kBqeDfHZAO/uiAlPBX9TxKNcJL/y75ej5nFk5uq0CajVKXD0UrKsTlQ+AoV9afF8PwfwNGBXNgWGrhCQAAAABJRU5ErkJggg==",img$q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcWlDQ1BpY2MAACiRdZE9S8NQFIbfpkpFqx3qIMUhQxWHFoqCOEoFu1SHtoJVl+Q2aYQkDUmKFFfBxaHgILr4NfgPdBVcFQRBEURc/AN+LVLiuU2hRdoTbs7De897uPdcQMjqzHD6UoBhunYukxZXi2ti6B0BxDACAVGJOdZSfrGAnvHzSNUUD0neq3dd1xgqKQ4DAgPEs8yyXeJ54uyWa3HeIx5lmlQiPiFO2HRA4luuyz6/cS77/MXZLuQWAIH3FMsdLHcw02yDeIo4buhV1joPv0lYMVfylGO0xuEghwzSECGjik3ocJGkbNLMuvtSTd8yKuRh9LdQg02OMjTyJkitUleFskq6Qp+OGp/7/3k66sy03z2cBvpfPe9zAgjtA4265/2eel7jDAi+ANdm21+hOc19k15va/FjILIDXN60NfkAuNoFxp4tyZaaUpCWoKrAxwUwXASi98Dguj+r1j7On4DCNj3RHXB4BExSfWTjD603Z+Sp2ztrAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGklEQVR42uVbC47jIAytESeY6f1P2NkjLCOqInmoP5g4BChSpLZJAT8/G9sQuDHtfr+Tv/9P6WZp/35+tP6lDsEyXgBg7z0eD3qAVsE9AWgU/s8cOQG+vr+bAOCAiK2Cn9CS4TnwGrTIWYAItw9voGmfo56DJlI1DnD38jx75qGxOvcZRwuuCV++V888zaCmLyUkvlc+S0BE6uZBtBMDKHjYbvnMzVG6Rz0bvbSaByWo+0frR0GQWCSZicSE0Kv93Fm5mAl10V/4PSkrSGpRkgrAUXoatWbq8yVA8ujfFQBOg56UbxXQCoIXACytvUHwBjkepffL+Q0PYGqQseaxw5WWyScDcmyPr6uEYOzdnT3YcTcxwMsBtsTlXv1aVoJwpv0bNH16tDl8FThTmwygXeYSBtn61YAmLn6YlgFW0Bg/UgueatMYWQ+AWRiFQZjSBOql6kwneWlF6MyaA8E+6EqHtUleEQUeMD2ofcJH1QRPS4cno7tp/NjoMGbSIljpL4EfPo3ybwzAOzd5aRC0DSOTllEgBEPykBSAlmzBkjkhILyWJLb2Vy7qP54heW89oGu/rgiEKskiRdGETyurBUr7L08L0sA9FdhpTYBaZopmpMKjBwjO+5KiuVD9xVYPSuzXTRdAtdQRc90TnyMIBxBetuHib+jQxjYgPNnQ68m3igOsjm0nEALl4Q2BzvIgRC3Qwaewciu5A9pzr4sM65nAQRYszYioxPzqQUXsDzJbOMZMDwAX6GQB6vM522WDStKzdYt1HlCzQNrBXZEROAxuDYS2YUGtrAwGmw1+SmsNhdMm2n87Wxha1/PdvH/xa8GQg69eEL3ufMBszg+zPBjD2jRwgmfavv7CxC7rvqbcgA89E4cKYQNfkCTlDt0XmGDZezNt1QmuGBgJwvNvjeE/t5Siy3ncq/f9LcJTrA1Wp7GAQ2SFJ0+ItGx5C0XQNJPmhYIuiG+Otm5P9QzQypwjpmSlPR4TNDoTr6iRA40+ak/l95QD1+RaemdIE96UDqMDCUuBYBW+lhM0O1VC4nQl/SkW1MJrcvwCJhH28gf87HUAAAAASUVORK5CYII=",img$p="data:image/png;base64,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",img$o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZG9S0JRGMZ/adGX4VBDRIODRYOCGERjGNRiDWrQ16LXezVQu9yrRLQGLQ1BQ9TS19B/UGvQWhAERRDR0j/Q1xJye48KSui5nPv+eM55Xs55DriiOS1vt4cgXyhasdmIb3Fp2df5jpsh+gnTndRscy4+k6Dl+HmkTdWHoOrVel/T0ZvWbQ3auoQnNNMqCk8JRzeKpuJd4QEtm0wLnwgHLDmg8K3SU1V+U5yp8pdiKxGbBpfq6cs0cKqBtayVFx4T9udzJa12HnUTj15YiEsdkjmMTYxZIvhIUWKNHEWCUguSWXNfqOKbZ108mvxNNrHEkSEr3oCoJemqSzVE1+XLsaly/5+nbYyHq909Eeh4dZzPEejch/Ke4/yeOk75DNwvcF2o+9clp8lv0ffqmv8YvNtweVPXUgdwtQODz2bSSlYkt0yXYcDHBfQtQf899KxUs6qtc/4EiS15ojs4PIJR2e9d/QMO/2gR3i+r3wAAAAlwSFlzAAALEwAACxMBAJqcGAAAAvVJREFUeNrtW01y0zAYtRQPadzpkEQ5AwcoXcCGHSdgxTFaTtA9tGy5BxumnemCbXoD9mwsJ6sYZlqLT0EeUiNZ/pHj2P40o3HGcWS99733SXJk4hnKYrHQnk+E2B4jzr1DKXPGtkdKiPGaMAy150c64EEQGBsS6hjHca1Ow31ePhuPf0yOjye/4viuTlsT1V+SQ4DEJOtms3lyntgi3oQCIGIrOEx3z0F7pEkFmBRB9y1XxthZFrwsM8au27APsUXf5J2q4EE/NzoClL0+rzg/d3U/m6oltlHqD92XWb/U9TwAXMLHoyRJfoJfTzTReDUOgueQE765uKfsv6ymnCa/G+lYchn1FDzkjlsJXiWrkxxJvnZJginA6fnGc4BMeAB+qWS/zk2woAyVmM6njF256oMMqCmoJKsAl9FXkV9W/X3ieddrzi+qev3h8dFbr1a519IijetqgchHKXiIbGwb7nTnpRKgHVGaOBiqZaXULvBGLCAjL0e2v6ld/IaOTIqM9abvgYRPRQCntUyhTYCHTtz8MxkZl5noGK67sJFQtVDH4E+V7Gd1ZnlGEubzj3X7mFULrSMfDfjborKuRAIhH1yQ4FwBKuHd1418GyRQB7J/kQXuAryNBFg7XB4EAUKIt02BN7TH1azpvea6dEK1PwI451+Ahe9Ngde0y+B+X4H4dzrwW1C0OCzfQd8eoih6s4+la84k6jCGwS4WJGDoBFhzgOtnA6gAJKBjFjA9cOiLNdACSAAS0K+yOy0WBRZFfh+jWmZtgBZAApAAJAAJQAKQgGGvBrN/Bz158Cg3IO3+Y3RI2+MqFoEKQAJKECAlL/ffpbXoBoku5YDWFyzpRsfBWCCbSNtMrJgDkAAkAAlAAoa+FhhWxDMvVfhl3rJACyABAyRgOpv1mgD5vsB/+2PDMOxlYtBh9VvqiKchvR0L6KKtY6qP0ZfYfdsPum4HWzBJlajX2Va/74mOqaSBHfwwWMn/XVZA1tKkine6SIApl/0BVV9uhgTVncEAAAAASUVORK5CYII=",img$n="data:image/png;base64,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",img$m="data:image/png;base64,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",img$l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAaNJREFUeNrlm0sOgzAMRHHEEbj/CbmDq7Ko2opWxBk79pBNuwCTN/4lCshSc+jbfxkxJMXhhzmEAH6IRUjgzTxCBG9iaoXhBSBW+gi4Aq8jbELiebMIQhL2ZhGEBN58rxDBm2wIGXy3LSGE77LZSOEv399I4S8viORm8GlqQDR8qjaYBn5GDZie8zMjIEXOzxIgJXyUAGnhIwRIDe8tQHp4TwFKwHsJUAbeQ4BS8GgBysEjBSgJf2pk27bjd993evjnWL/B7+J5xGaoPPxLAIP3KeCtEUADfxg+8/6fAkgF3xsBdPCnAvzwPiX8Rxsk8Tz8bDAzPOStkdUw8dnwipxf73l7NnjxqgG6+AwFpSKsQDYQQEl49EqwHPw/g8iXEhHwbmsCj91gGfgeAQSYDqneS2oArym4jWqkWM2hZmgV+F8PUcM1iLDXGWnSgMKhcj60RvTsBTwLni6ThjhOxgIf3iHWIFFTwp89VIPAU8BbIqDiV2bDAngfoU8VVYInqdkiKmpTolnTCXEuUBbeskTtTZ30RTRqpZa2eyA/R6FvmZTjAXQIhaMv+ge0AAAAAElFTkSuQmCC",img$k="data:image/png;base64,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",img$j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAA0dJREFUeNrlWwmO5CAMjBEv2On/v7BnnjDeZhUkixgfQELIIkXqzgG4XD64YKuU1+vF3v9F3Dzl5/vbVX9PewGg+uz9frP3wduxskMVAdHSlgeImgB/vr5MANTqid6OGAoK92GbXLKcGYgwuH7sfH55iZr2a9TrBAmkdjxsrPkYrZ70LLUZBwpes3vUQCjbSv+5zpf05YSkz/JvCYjAPRykdZCcX6vtWjTrqTOeZPtgZMIQQDTFSUwIrdpPlY2IHFqnRxauzrDNKzhKwz2hPFxA/22UL7AI6AVhJgOGULrXVOJoRK8UvhY2c4zXwuQ/BqTcnl53FHB09KCgTDeBGsPOYl5pNuHJmr7ECVobKqnXo+GRoIWRdmUNU/m9VhBGmkeYaecjtcy9Lw2oLgWgFq8/93BPpNjrrDR5ehRwJDBIQDqFlXGG8C3ffDqMwrfQCkLs7fBVmaLSD2wF4w5jAahcbpB306qaDAfi5SZAhfl0SJoqB6pdmt9bTWYTpt1cANxlQLSDAJY5hV1g1TSWHg5z5qL4iQNgkU4rJ9oI2gZrsjEJiEx70VSSj/i8BwcG5I8lBBWAblO0PlJHGYzCl0B0aarQWjVR2jUJLSGucKTDw2BTZrYLBVR4ia4EHI+tm/xEdpKB0z7pJAidw22tYosCOcxkzaT/QrzGM+21IW3WzAVcY4Fi4hFmaN0DAuMzDiXtJ6D7CMIIGq1W6ORvaNDGY0BIV2ik5CNAYBlgsfMngRA4D+9IdJYHIQqJDmSvSUseO5Clp+Fr/5ebQCcLlmZEVHJ+0NYLqT9IbKkx5vYA1BKdJMCoFZ0losCIQc+yJsCxgNuadsMJEbvGSRpsTYQew4LDstgHjOpo8H8p1lQYH6L9w4auYI3nT/P+2a8FxxgcFwcBe0zgUc6Psjw401q8sINn2r5+YOIpcV9TbqD7e5hNhfAAX4CScmNHpbCA3auHt1QnuGJiJAhfPzVGP7ZMRe9bVuCsjY5nCM+xNnidxgIOsSo8e2DCsuQtTILinTQvTOiCeHLUujzV0oCVOT2m5KU9bRM0OjNH1NiGZm21V84LgybX0itDmvCu4bB19+YKiyKS8KWcoNmpkhLjTPpzLCiF1+T4C+eX+V1keq0EAAAAAElFTkSuQmCC",img$i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAbhJREFUeNrtWgFqwzAM9Jm+YM3/X5juCdPooFA8Z7MdSZbkCEohtFi6O8lSUEqXXba0waBPpOkfDAev4uPNcOBLpADN9hOOWEcUAKjRJ5V6AEPBY0ZRhDHWW/8HTwDQSR9EQYAxyauDAKOsq4EAw6yrgAAngYuBAKNyV5sZ4IR1MSXAafBsIMBx8CwgZOaucsZscerMbMEJofNJCgBKNm0IhByA/VMg5CDsD4OQA7E/BEIOxr7qLYCVAAjJPncj5LE4NgFADuVPlwKYAPDIflfBjqgA4lJAFPaXrwHgAgAR0ckr5/8KKYCrBvxjt055/UL0435Pn49Hqj3ntKMz3p5X5b9t28/3vu/dCmguemWw3MEPnoESiBcYowroclDCOM4oFRGlBgyP673LCXACAErGa/ZUQfhb4Kj4RboG6Uw9GNnPcbteW0uH/P6w8oNQs38tHTCAMDyyf0Ty8q1wS3NBDZ+ZChj24xk7BmUmMplx3v/cTmmxDMn8r/YBjf01Jkm6J90glQJW1CFCkoVl6fAAaIBkYlV2Fkgh31bbKhxl+/hFdtcFMtA8Cl+tcAsAf71RsW6efVezb/4DdiZjsxv1AAAAAElFTkSuQmCC",img$h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAa1JREFUeNrtmoFqAyEMhv2lT7De+z/hdY+wjA4GxXkjphqTaKAUpOWSL380eqa0bdvSBoM+kaZ/MBy8io83w4EvUQI02084yjqiACCmTyrzAQwFjxmTIoxlnfs/eAJAb/owFAKMSV4dAoxmXQ0CDGddBQKcBD4MAozKXW3PACdZH6YEOA2+G4TsvL2GsCyHAMCkvcXUZZCMbKvFE6PFIzFVCNEANEOICKAJQlQAbAg5LW4bwAawjmElALQVsAHwlvu8svw5AChNfHE5uwRIStWL/PckGBAArQ6gebO3fAncGuX1h+jH/Z4+H49UG+9pV894Ga/K/ziOn+/zPJsVwD4rKIPtHbzwGShB/MKQKqDJwRHW4xmlIqLMAeI+pfVyApwAQJnxmj1VEH4VuJr8Ii2D9M58ILmf4/Z6ba0c8utg5Qcej83RUg4QEIbH7F8leflWmNNcEOMzUwFiP56xQyizITuznut/b6e0soyR9V/tA5j9NSZJuqXcMKoErKhjSJIsXJYOD0ADkomrsrMgRb7kYaRuyvbxi+y+J8kAeyu8W2EOgP9OVKybZ9/V7BsoanMeq391+AAAAABJRU5ErkJggg==",img$g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAhtJREFUeNrtW21uwyAMjREnWHv/E6brDrDGC1MzZQiCCWAMwVL+NCH2e/iLQGHyyP1+R9fvC+IkVRSA9948z86bQAXeOgE+IoAKvBcCbCLUdHGB0Oz7YidFVn22jiLg3noOsWlO4NzyJhaOiFCu2e8BPDXhXyIHGE/whZmWPvt2voiR79dr+no+/2GzPV6XNCBHgnOV3WVZJqWUt+xtY8wzIdEtu3aOnkSnzmCqh8Q2OgY0ZWazEVBbPh+Pw/sft1uS18D6ArQUUpKg1H44aLuN94wvoWCHibbt8msBVcLNJIdAdBL0ZHmyIlcVObsYOkp4W7K0nwkl0WZCgAKeKwS6Ad8EASXBN10FcoAfjZDxAMNkJJtdNULboN/LZif0vNCL4gF/FzgGdR0Ctu26oKJuW+HLrwUGAYOAjuRsEuSqAiDRAzhLII4QEEgAZw8AUnPAaIQGAb0QsP/iErvL0qLYGPVVgPtI0JdzeWtLXcccLRtJcBAwCOifAOqR2RbFhW0clfUx09thSR9GHRrQOhGhkIYzsX90PG23T5+VuPW9SOlaqX1NkePy+y22zeCc4G0dWb8HbIzkrALG8FRPyEmkK6S9Z4VzEZFCQk7w5P8MZRAM5Rvm94TLoEASkMvekiXuLAjktLV0jY8Fg9x2cjQ5VFBYw0auLi8EDmvZx9nmokTbuPt8lGZXjYUOSrKp5koPBdlSlYSqX6B+AGDuGPLVCsLeAAAAAElFTkSuQmCC",img$f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAhRJREFUeNrtW1tywyAMtBhO0OT+J3SaHqAxMZ2446qINwQBmvFPbAy7rB4YAgth1+tVmX7flFpaNQFA3lvX1XgTfIFzJ4AiAnyB90IAJkIsgxu4Zp/ynRTb+8N9FAH36seKTdYEXttexIKNCGGa/R7A+wb8IWKAVgLlZrL12cfxIsS+H4/l637/gw0rXpYcQI4AZ0q727YtQggy7R1t9DMuk5ylnaMmkakzmKqQ0EJHg/aZ2WwEvNs+bzfr/Y/LJUk1sL9AoQ59gmCr9bBz7BhvjJZUw4IJHtvwawFRQmYtu0BwECSivHdHpiwSuxiyBbwjWOJnXEGUjQv4gK/lAt2AZ0FASfCss0AO8LMQ0grQTAay2VUhdDT6uTA7rucbvXwU8HuBoVHXLoDHLgt21G0pPPxaYBIwCejIYoNgrSwALSqgZgpU0wUaJKBmDQCtxoBZCE0CeiHg/MUldJeFo2GMchTgFAlyOMmjLXUZcrRsBsFJwCSgfwJ8j8xyNBO2eVSWYqa3w5IURulqwJ0Il0tDjO+fDhr9Iwfv0xt2nZJijKtq9a1rko7Ln7bTlAk8ATwZvOW9+T44uJSAT3PsMwKeg8uWXWwqcCkAuzR5VpgIGjHjbSKtev9nKAIMJIB/e4CFDDMKHIGXLITYgM/9PYAV8JwuUKofdgpgBbzGYohFCS1HBV5KAewWTnJU4KkDVz2A1/YE9TAKPpdsqQcAAAAASUVORK5CYII=",img$e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABcmlDQ1BpY2MAACiRdZE9S8NQFIbftkpFWwrqIOKQoYpCC0VBHKWCXapDW8GqS3KbtEKShpsUKa6Ci0PBQXTxa/Af6Cq4KgiCIoi4+Af8WqTEc5tCi7Qn3JyH9573cO+5gD+tM8PuSQCG6fBMKimt5tek4Dt8GEQYQ5iSmW0tZRdz6Bo/j1RN8RAXvbrXdYyBgmozwNdHPMss7hDPE6e3HEvwHvEwK8kF4hPiGKcDEt8KXfH4TXDR4y/BPJdZAPyip1RsY6WNWYkbxJPEUUOvsOZ5xE1CqrmSpTxKaww2MkghCQkKKtiEDgdxyibNrLMv0fAto0weRn8LVXByFFEib4zUCnVVKWukq/TpqIq5/5+nrc1Me91DSaD31XU/x4HgPlCvue7vqevWz4DAC3BttvxlmtPcN+m1lhY9BiI7wOVNS1MOgKtdYOTZkrnckAK0/JoGfFwA4TwwdA/0r3uzau7j/AnIbdMT3QGHR8AE1Uc2/gDt82gCvNGYhAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAcpJREFUeNrtWwFuwyAMjBEPWNf8/4XpugesoWMKUppBYidQ5cAnVZWaRtGdDxscoC6Bvu9d7PfRue6sMETJa8MwRC8Slzi6ACkhiEu8FgGWQpiucdBW9FNj5wiWzyvxjOk5/muVm30n8Xfjl8NfkNeEMLHo10Cem/CbyAHeCZMb/sGePfqTfXfh5/Hovu/3F25Lx9ujiURad6WIld1xHDtjTLLshXv8f7Zgka2dY04ClQNCxDmR5eL0Dvi63Vavf16vh1xjzzy13YKUPPQQWFaDHOShBJjX8VzkIRdDa+RDvvBlskoBOOSlVcLURr7KIVCKPIQAJclDJsGc5FkzwdBUqJE8pANykocTIDd59mKI2zIv0Q8oSR7GAaXIQwhQkjx0GVQBGI5xjEWRrTGqkmGjQ0AFUAFUABVABVAB2sXmRMi3pEbnSDLJyNm3h3MAEvnsAqCRZw0Bb/l5Q2THjg1qaghoFVABVAAVQAVQAVQAFUCCI9thxYSJXj5WcspCHaACNNgP+LhcTr+gySqAX/nNX2nP99ujI/aaX3NAbAPDkQ0RSNFfPTUWbkA/QLUVTNoT9RpOj+rJ0aUDJE5AdkDy8LRECEQBUrnsCeUexwK5uUFRAAAAAElFTkSuQmCC",img$d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAMtJREFUeNrt2kEKgzAQBVAjnqDm/ifUHqHpsigKgkYa5/2dWRjnOQkE0nUiEjlpZ7xEqTcFKn6z5j76EggPMJzYJ1pJ0QEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACB4hrMveI1j957nzfErszfH1vjtHbAu9uria84x1PrAGqkxR/g94Mg1uafdEXJNDgAAAAAAAAAAAACAY6fBogMAxDoOP7nt01GARXLOi+dP+V+fPv1KmqbJEjgNsP77LaXlb78tX1rgGEFVOtioAAAAAElFTkSuQmCC",img$c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JIpioim0ELHYIgaLCKIglhJBG7WIEYzabDabRNjEZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9Y4SImFlm78eZOZeZM+CfsoyC2zQIhWLJSUzGtfnUgtbyTIAQHQSJ6oZrT89OJGk4Pm7xqXozoHo13vfvCGZM1wBfq/CIYTsl4THhqdWSrXhTuMvI6xnhA+GYIwcUvlR6usZPinM1flPsJBPj4Fc9tdwvTv9iI+8UhPuFIwWrbPycR90kZBbnZqX2yOzFJcEkcTTSlFnGosSA1KJk9r9v8Ns3w4p4DPnbVHDEkSMv3pioZelqSs2KbspnUVG5/83TzQ4P1bqH4tD86HmvfdCyDdUtz/s89LzqEQQe4LxY969ITqPvom/Vtcg+hNfh9KKupXfgbAO6723d0b+lgEx/NgsvJ9Cegs5raFusZfWzzvEdJNfkia5gdw+isj+89AXPlWf0rTeiAwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAZBJREFUeNrtmlGOwyAMRDOoJ9jm/idM9wjrzVZaKWpDoBI2YzBSf6oqeB5jjGmWZfKBDnMKU0wgEd0tPpAKN4sTDsSrxgqyPDffH2AoHp2eYwqgddDqEEAs3gQCyMWrPz85KbHUZVA6VxewOsDFSOTWV392UrAkW3Nl6gCL5grMKSDsK94aAAhSIKpAACADIF7yvxUAeM3/SAFFAOIltRKLFXvNqZkCwr76sQc0BgBv9rdwgDDbP1Ig2uFwQAAIAI46QZU5wgEOdmzEHuAEgOV/BMJk0VxAFu8eQA3Auq6nlH/k/evvx+Ptu6/7van6mjkS8jy2bUMVgJzwKwCvAbYWXzvHFYAcCNQKLwGg2NBQnxH/IKavAiitfi53vIySttuowo86dgjZ0okzQqOIP7ggW0qn2AP2BX1+sifB4w9GW/2Ss3FiC4zshteUjzK4n6jk7Jg5w/g7TWLheNNr2AsRfgBajYunFOh1qdG9BYgUCAABIADcPuymnsPLrVCuAQoHXABAafWd3gNM0+x9PH4BvDJ3ZJJMpIIAAAAASUVORK5CYII=",img$b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIU/YyTBBykUEbHYwoiFAVEQS4mgjVrECEZtkk02EbKbZTdBgq1gYyFYiDa+Cv+BtoKtgiAogoiNf8BXI2G9YwIJorPM3o8zcy4zZ8A3k9dN1z8MplV0YtNRbTGxpAVe8NNNB0HCSd21Z+en4vw7Pu9oUvU2onr9v+/P0ZbOuDo0BYXHdNspCk8Iz6wVbcVbwl16LpkWPhQecuSAwldKT1X5WXG2yu+KnXhsEnyqp5Zt4FQD6znHFB4U7jfzJb12HnWT9oy1MC+1V2YfLjGmiaKRosQqeYpEpFqS2d++4R/fHAXx6PK3KeOII0tOvEOilqRrRqoheka+PGWV++88XWN0pNq9PQotT573FobADlS2Pe/ryPMqx9D8CBdW3V+QnMY/RN+ua/0HENqAs8u6ltqF803oebCTTvJHapbpMwx4PYWOBHTeQOtyNavaOif3EF+XJ7qGvX0YkP2hlW/cxWf6XLNyeQAAAAlwSFlzAAALEwAACxMBAJqcGAAAADdJREFUeNrt1LERAAAEA0DsvzO9EfjvUsrlRAAAAAAAAABwX67c3+6u7wtQgC8AAAAAAAAAwH0DNkcBCEXoxRkAAAAASUVORK5CYII=",img$a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/xmiESWEhLO5iyAKJkqVGscFiZpTBZu51Z0bNx+3eO2myVTYWykJsfC38B2yVLaUUKcnGP+BrI13vMVMzyZzbue+v55zn7ZzngG8mY2Qd/zBkc64dmQ5rC/FFLfCCn27aGCKYMBxrNjoVo+b4vKNO1dtB1av2vn9H84rpGFDXKDxmWLYrPCE8s+ZaireEO4x0YkX4UHjAlgMKXyldL/Gz4lSJ3xXbscgk+FRPLVXFehUbaTsr3C8cymYKRvk86iYtZm4+KrVLZg8OEaYJo6FTYJUMLoNSc5LZ/77hX98cefEY8rcoYosjRVq8A6IWpKspNSm6KV+Gosr9b55OcnSk1L0lDA1PnvfWC4Ed+N72vK8jz/s+hvpHuMhV/HnJafxD9O2KFjqA1g04u6xo+i6cb0Lng5WwE79SvUxfMgmvpxCMQ/sNNC2Vsiqvc3IPsXV5omvY24c+2d+6/AMRKmgSy8M37AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAV1JREFUeNrtmgEKgzAMRRvJCab3P6HuCOtU5nBdY61iqcn/UJBN0f9qkxTjHARBkGGR9EfXdT72+8v7as00JNpxfd/TLgCS8bsDkEDQXuNaAIQgGsSAxOxLa+cuSnljrcbXPkYI02EUBMUIaTG/eguWwz+vJmLAOKHziAZO7bOf8mY+CwCAdQBszXBYyfLB0rbWephKLAFf8QR7xIACAGquE7KfjUvdCGkQAAAAADRVgnoKoecwuGlYLYSWi+bxaFufc36lY1Mfj99BkYtI+RLwKISQBQAAAADgZBAslQmo1jegVBr0WAKVAihVB1DNMYAsvwFIg2oAjLuj9U5JveHQI1sxLkEw920w7CTjnNYyBEEAAAD9APa2zN5RMW9olZXIKGyWjHrk1AWae4V/dnQ5a3+rryjzK9PpUjZV6Ei6pF3+avNX3INDIpqzQGxJs3SCNhCae6AhCIKgo3oDRfKqQh1Aqh4AAAAASUVORK5CYII=",img$9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABbmlDQ1BpY2MAACiRdZE7SwNBFIW/JEpEE1JoIZIihYqFgiiIpUTQRi1iBF/N7uYlZDfLboKIrWBjIViINr4K/4G2gq2CICiCiI1/wFcjst5JAgmSzDJ7P87MucycAf9M3jDdlmEwraKTmI7HFpeWY8E3WogSIoxPM1x7dn4qSdPx/YBP1fsh1av5voajI5V2DfC1CY8ZtlMUnhCeWS/aineEu4yclhI+Fh505IDCN0rXK/yqOFvhT8VOMjEJftUzlq1jvY6NnGMKDwj3mvmSUT2PukkobS3MS+2RGcUlwTRxYuiUWCNPkSGplmTW2Ddc9s1REI8hf5sNHHFkyYl3UNSSdE1LzYieli/Phsr9f55uZnSk0j0Uh9YXz/vog+Ae/O563s+J5/2eQuAZrqyavyA5jX+JvlvTeo8gsgUX1zVN34fLbeh+sjVHK0sBmf5MBt7PIbwEnXfQvlLJqrrO2SMkN+WJbuHgEPplf2T1D6TFZ+Dpj8jzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJUlEQVR42u2b6wrCMAyFF9kTuL3/q0YUlDIQrGnatPkOFPZDluY0l7NQty05pHjWCfbo9nKd6KCa4pY9BSAgOwF7w7zTRrmrRIAjzvN8rSsB0rP1VFZ86RUBUqwIbc91L+8ooAtkdv4ZBUQABEAAn8Ot8KsS1Ei+946ASJ/dSgoMIECipf8+ed2pxv04hhdB2iAEQEAcjCiCLbWAGGwsIYTUYAMhtIIQEoMN8Qjv6woHhBBtEAIgYCUhZO4gTISoAXMLIfNe0k2E6AIQAAFT6ADLoGMJHaDOzqMDousAy6Cjai/p5gHlFTlSAAJsbVD/+E24lBBH52ts6ijfI6SAjrTLJanOJyeBokBSnvi36/IAUATD/3fQxXdJ6vyHBHRA9hQA2fEADxYsjjbR70EAAAAASUVORK5CYII=",img$8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAZ1JREFUeNrtmw1uwyAMhTHiBGvuf8K03QHWMDE1UkehgEMSDO+TKlX5IXnG2E4gpCJM0xTcvlirWkUTRffN8xzcTrnCpRsgZgjKFd6LAVIeAQAYCzrjon7APTMgmdZ7KDc7hfh5PNT3/f7W3mpw99/seQM1ejeUdpdlUVrraNpbz3HHpDQZyeO3Rk1ifJfweyzVg1s9pLTQcaJjPcuOAUeKKOV2vX7c/3W5bPIa8htIXfBJq/VwMqv5ejm+ZBsOC8X3ptXg6D3cTFJhx60Dsi8UyiLcSvBTwFtjV2lMEzMEcsQfNQS6ES/CAHuKF50FaohHIeQ8wAkutGZXhRCnrraN/4o00imWbqgQAgCAoRk+C1BH4lmaNIYACiEAhub16ah0lkW6XocZRXjMCNzZ4aOyQPWo/jalzpgYbeoFxxacdgmVILXYuO1BPHcIdMPfEAgZoNdlpCGteBiKWaY3L4hpNKkTpBsiFeOKl8s7Xhca1Zqjq1Xa5i6ZXzuWFQMY02lyXoi0tI53Dw/w9ZjYAb3VB/hCBAAAAAAAgH/8Ah3f3c5J52vwAAAAAElFTkSuQmCC",img$7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAgVJREFUeNrtWwtuwyAMxREnWLn/Cdt1B1hDSzemyoNiKFADthSpSiDhPX/5FFREjDHB+7u1iqtsANFnx+MxeB+owEcnIEYEUIHPQgAmwvfgi6qt3ClbFfyP1ajFZXkCNCUz1BYccGMpqpHYFAGshJqdQvJ9uaiv8/nf+zzh7rduOYAa2g2l3X3f1bZt0bTn+7g2KUx6ZP+tUZNobBJYYykNvmohuYWOAx3TbHEQ7AkiVz5Pp6fPPw6Hl6wGbi+w6IOULMC1eEqOHeMtsSXOlWP22KQSbGFmnF2AUglSojz5Q6EsUloJPgt4PljiNqkgOowLUMBPOxlqBX4IAlqCHzoL1AAvhZCzAMdkJptTFUK+0/3C7KTaM70oFvB3hRZFp3YBVWlFiHM1KHMBIUAIEALqzQbfnAmAqwX0SoNWXIApAb3qAOAcA2BlC5A0OA0BjysuubssIwrGqFcBHiNBL2fyaEsdjDG28wkNNuL2J+SU2PJZ4GYGsCp4hx1Ce38MY0LJumXQ58UFMAGU3dtMTVmm5h60dJ3qkOEOFv0GrsCDvpSj9ceDRr+7SrbxbDEaA3AVSz0y7xVbFAPQdlpr8H0XHDJPb/QCX80CMB4da0BwiaE0T/7PUKFG3m65PUvhqeYOyxdCI7oAcHnZ0Omv1oCHJ6HGYOcqhFYjYWNG5PDCdjosEpEraP7o1MFLlvgAAAAASUVORK5CYII=",img$6="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAALNJREFUeNrt2zEOgCAMAEAw/v/L1Qc4FSWNvSaORLjS6gBjiN4x7yc6Axzdd0B7gDMzKCJmyXqeMz7fAVUXn52bHgBAE9zffJ5qNdPA3uhHSiCZ7VjJ3FefvcxczuSLR5Vf6NUEKAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPDj2HJlJnOkddcBzKPi4lfGKQEAxQCytbyrB7g3qAQACNE5LgqdKICszpBUAAAAAElFTkSuQmCC",img$5="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZE7SwNBFIW/JMaIRlJoISKaQsVCQRTEUiKYRi1iBF9Ndt0kwiYuuwkitoKNhWAh2vgq/AfaCrYKgqAIIjb+AV+NhPVOVkiQOMvs/Tgz5zJzBvyTpp5z6gYhly/YiXgsOje/EA29EqSeEJ10pXTHmpqZSPLv+LrHp+rdgOr1/76ao2nZcHTwNQiP6JZdEB4TnlwrWIq3hVv1bGpZ+Ei435YDCl8rXfP4RXHG4w/FdjIxDn7VM5qpYq2K9aydE+4T7s6ZRf33POomYSM/OyO1XWYHDgnixIiiUWQFkwIDUvOSWW3fYNk3zap4dPlbrGOLI0NWvP2iFqWrITUtuiGfybrK/W+eTnp4yOsejkHw2XXfeyC0C6Ud1/0+dt3SCQSe4DJf8a9KTqOfou9UtO5DiGzC+VVF0/bgYgvaHq2UnSpLAZn+dBrezqB5HlpuoXHRy+p3ndMHSG7IE93A/gH0yv7I0g/RtGf1H+H7WwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAPxJREFUeNrtmm0OgyAQRB3TE1Tvf1WaNmlCE4NCW77mkfDHRbP7nF1AXBbzpsL7wizxaKLgi2Ja3VMAAO4Abo2KT+ilHtkpYN/3V/8GgH40lf5DeaqlAEW9h2kv25e3CpgFnIN/qgAFAAAAbIdbtNCLL6QAANgNerX7tlEESQEAAAAAAAAAADwBsBAiBQAAAAAAAAAAAAAAAAAAAAAAAACwOxmKf5FDAQColwKhYEyVT2TqJPhm/lED3AGooxrQyje/dUC8FtDFt6YJ7UnD2cnN6PbL5I7Gj25PXggGZUA5spkeggyD/4h9zZHLhPYkAJ08ZHR7sgbMOO8f2h90sy2pSZTVdgAAAABJRU5ErkJggg==",img$4="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAMpJREFUeNrtmksKgDAMBY30BNr7n7B3iCgo4kbwl+CbAZdCM77E+uk6AABh7OJ5/pd67EfFX6qpV4t8rXU5ZAXIJ2CfhJkSNHw8yzySboE5Bf0DV9sCa7i9lvJR5DPuZWgBBARG2bOshRZAgDhFreBhHBmCtAACEIAABABocrYRciEXdhTggoEwboPqAuRnAAAzIAReiHAbRAACEIAABMQj92Vo/4scCUAAAngWoAVogbjIp1ibJS3+tfWt+4DWGi0gmQBmAAAAwMYEsvUT/L18rywAAAAASUVORK5CYII=",img$3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABb2lDQ1BpY2MAACiRdZHNK0RRGMZ/M4gYUSwk6S6GKFOiZKlRZoPFGGWwuffOnRk1M273zqTJVtlYTFmIja+F/4CtsqWUIiXZ+Ad8bTRd7zFqJHNu576/nnOet3OeA/7pjJl164chm8s70UhYW4gvao3P1NNDO4P06qZrz8xNxag5Pm7xqXoTUr1q7/t3tCQs1wRfk/CYaTt54Qnh6bW8rXhLuNNM6wnhA+EhRw4ofKl0o8JPilMVflPsxKKT4Fc9tdQvNn6xmXaywgPCwWymYP6cR90kYOXm56R2y+zBJUqEMBoGBVbIkCckNSeZ/e8b/vbNsioeU/42RRxxpEiLd0jUgnS1pCZFt+TLUFS5/83TTY6OVLoHwtDw6HmvfdC4DeWS530eel75COoe4DxX9a9KTuPvopeqWnAf2jbg9KKqGTtwtgld97bu6N9SnUx/MgkvJ9Aah45raF6qZPWzzvEdxNblia5gdw/6ZX/b8hco4WgdZKtgqgAAAAlwSFlzAAALEwAACxMBAJqcGAAAANNJREFUeNrt2tEKwyAMhWEz9gSr7/+qjg0GvZ3dVMwX8K6F5OfkRFtLSR7R+V7bpZ7YqPiumm7ZWwCA7ADuk8ynreJH6RRQa32vKwDiR6P0H8qLUQqI01ph7H2dy0cFpkDm4l8qoAAAAHAcnhFtlVy0AABOg7nicRxMUAsAAAAAAAAAQE4ANkJaAAAAAAAAAAAAAAAAAAAAAAAA0v0ZOl+RowAAxrVA63hmyCeyWKT4afnxgOwAYiEPmJVbvn3A1evyQmxogi1r/ZG4eCYIAA+w2SpPUykQkfN9GyAAAAAASUVORK5CYII=";class Icons{}Icons.icon_arrow=img$J;Icons.icon_arrow_up=img$I;Icons.icon_arrow_down=img$H;Icons.icon_arrow_left=img$G;Icons.icon_arrow_right=img$F;Icons.icon_back=img$E;Icons.icon_caret=img$D;Icons.icon_circle=img$C;Icons.icon_clockwise=img$B;Icons.icon_counter_clockwise=img$z;Icons.icon_compare=img$A;Icons.icon_close=img$y;Icons.icon_close2=img$x;Icons.icon_cloudy=img$w;Icons.icon_delete=img$v;Icons.icon_download=img$u;Icons.icon_fit_page=img$t;Icons.icon_fit_viewer=img$s;Icons.icon_geometric=img$r;Icons.icon_hand=img$q;Icons.icon_line=img$p;Icons.icon_load=img$o;Icons.icon_minus=img$n;Icons.icon_ok=img$m;Icons.icon_pen=img$l;Icons.icon_plus=img$k;Icons.icon_pointer=img$j;Icons.icon_polygon=img$i;Icons.icon_polyline=img$h;Icons.icon_popup=img$g;Icons.icon_popup2=img$f;Icons.icon_sidebar=img$e;Icons.icon_square=img$d;Icons.icon_stamp=img$c;Icons.icon_straight=img$b;Icons.icon_text=img$a;Icons.icon_text2=img$9;Icons.icon_text_free=img$8;Icons.icon_text_callout=img$7;Icons.icon_text_highlight=img$6;Icons.icon_text_squiggly=img$5;Icons.icon_text_strikeout=img$4;Icons.icon_text_underline=img$3;Icons.geometricIcons={square:`<img src="${Icons.icon_square}"/>`,circle:`<img src="${Icons.icon_circle}"/>`,line:`<img src="${Icons.icon_line}"/>`,arrow:`<img src="${Icons.icon_arrow}"/>`,polyline:`<img src="${Icons.icon_polyline}"/>`,polygon:`<img src="${Icons.icon_polygon}"/>`};Icons.textIcons={note:`<img src="${Icons.icon_popup2}"/>`,freeText:`<img src="${Icons.icon_text_free}"/>`,freeTextCallout:`<img src="${Icons.icon_text_callout}"/>`,strikeout:`<img src="${Icons.icon_text_strikeout}"/>`,squiggly:`<img src="${Icons.icon_text_squiggly}"/>`,underline:`<img src="${Icons.icon_text_underline}"/>`,highlight:`<img src="${Icons.icon_text_highlight}"/>`};Icons.lineTypeIcons={straight:`<img src="${Icons.icon_straight}"/>`,cloudy:`<img src="${Icons.icon_cloudy}"/>`};Icons.editIcons={close:`<img src="${Icons.icon_close}"/>`,ok:`<img src="${Icons.icon_ok}"/>`,back:`<img src="${Icons.icon_back}"/>`,delete:`<img src="${Icons.icon_delete}"/>`};function getCommonStyles(J){return`
    :host {
      --${J}-color-primary-final: var(--${J}-color-primary, rgba(40,40,40,1));
      --${J}-color-primary-tr-final: var(--${J}-color-primary-tr, rgba(40,40,40,0.9));
      --${J}-color-secondary-final: var(--${J}-color-secondary, rgba(60,60,60,1));
      --${J}-color-secondary-tr-final: var(--${J}-color-secondary-tr, rgba(60,60,60,0.9));
      --${J}-color-accent-final: var(--${J}-color-accent, rgba(96,96,96,1));
      --${J}-color-shadow-final: var(--${J}-color-shadow, rgba(0,0,0,0.75));
      --${J}-color-bg-final: var(--${J}-color-bg, rgba(128,128,128,1));
      --${J}-color-fg-primary-final: var(--${J}-color-fg-primary, rgba(255,255,255,1));
      --${J}-color-fg-secondary-final: var(--${J}-color-fg-secondary, rgba(187,187,187,1));
      --${J}-color-fg-accent-final: var(--${J}-color-fg-accent, rgba(255,204,0,1));
      --${J}-color-text-selection-final: var(--${J}-color-text-selection, rgba(104,104,128,0.3));
    }
  
    .disabled {
      pointer-events: none !important;
    }
  
    .relative {
      position: relative;
    }
    .absolute {
      position: absolute;
    }
    .abs-hidden {
      position: absolute;
      opacity: 0;
      z-index: -10;
    }
    .abs-stretch {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
    }
    .abs-topleft {
      position: absolute;
      left: 0;
      top: 0;
    }
    .stretch {
      width: 100%;
      height: 100%;
    }
    
    .no-margin {
      margin: 0;
    }
    .no-padding {
      padding: 0;
    }
    .margin-s-5 {
      margin: 0 5px;
    }
  
    .line-clamp {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical; 
      overflow: hidden; 
    }
  
    #main-container {
      box-sizing: border-box;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: stretch;
      align-items: stretch;
      width: 100%;
      height: 100%;
      background: var(--${J}-color-bg-final);
    }
  
    #top-panel {
      position: relative;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
      width: 100%;
      height: 50px;
      background: var(--${J}-color-primary-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      z-index: 4;
      transition: height 0.25s ease-out 0.1s;
    }
    .hide-panels #top-panel {
      height: 0;
      transition: height 0.25s ease-in 0.2s;
    }
  
    #bottom-panel {
      position: absolute;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      flex-grow: 0;
      flex-shrink: 0;
      bottom: 20px;
      height: 50px;  
      background: var(--${J}-color-primary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      z-index: 4;
      transition: height 0.25s ease-out, bottom 0.1s linear 0.25s;
    }
    .hide-panels #bottom-panel {
      bottom: 0;
      height: 0;
      transition: bottom 0.1s linear 0.1s, height 0.25s ease-in 0.2s;
    }
    .compact #zoom-fit-viewer,
    .compact #zoom-fit-page {  
      width: 0;  
      transform: scale(0);
    }
  
    #focused-annotation-panel {
      box-sizing: border-box;
      position: absolute;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: stretch;
      flex-grow: 0;
      flex-shrink: 0;
      left: calc(50% - 120px);
      top: 80px;
      width: 240px;
      height: 84px; 
      padding: 18px;
      border-radius: 18px;
      background: var(--${J}-color-secondary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      opacity: 0;
      transform: scale(0);
      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;
      z-index: 4;
      pointer-events: none;
    }
    .mobile #focused-annotation-panel {
      left: 20px;
      width: 150px;
    }
    .annotation-focused #focused-annotation-panel {
      opacity: 100;
      transform: scale(1);    
      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;
    }
    #focused-annotation-panel p {
      margin: 0;
      padding: 0;
      line-height: 16px;
      font-size: 12px;
      font-family: sans-serif;
      color: var(--${J}-color-fg-primary-final);
    }
    
    #annotation-panel,
    #command-panel {
      position: absolute;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-end;
      flex-grow: 1;
      flex-shrink: 1;
      right: 20px;
      pointer-events: none;
    }
    #annotation-panel {
      top: 125px;
      z-index: -5;
      transition: z-index 0s linear 0.25s;
    }
    #command-panel {
      top: 80px;
      z-index: 5;
    }
    .mode-annotation #annotation-panel {
      z-index: 5;
    }
    
    .annotation-panel-row,
    .command-panel-row {      
        display: flex;
        flex-direction: row;
        justify-content: flex-end;
        align-items: center;
        flex-grow: 1;
        flex-shrink: 1;
      }
  
    .annotation-panel-item {
      margin: 3px;
      cursor: default;      
      opacity: 0;
      background: var(--${J}-color-primary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      transform: scale(0);
      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;
      pointer-events: all;
    }    
    .mode-annotation .annotation-panel-item { 
      cursor: pointer;
      opacity: 100;
      transform: scale(1);    
      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;
    }
  
    .annotation-panel-subitem,
    .command-panel-subitem {
      margin: 3px;    
      background: var(--${J}-color-secondary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      pointer-events: all;
    }    
    .command-panel-subitem.accent:hover,
    .command-panel-subitem.accent.on {
      box-shadow: 0 0 10px var(--${J}-color-fg-accent-final);
    }
    :not(.mode-annotation):not(.undoable-commands) #button-command-undo,
    :not(.annotation-selected) #button-annotation-edit-text,
    :not(.annotation-selected) #button-annotation-delete,
    :not(.stamp-annotator-data-undoable) #button-annotation-stamp-undo,
    :not(.stamp-annotator-data-clearable) #button-annotation-stamp-clear,
    :not(.stamp-annotator-data-saveable) #button-annotation-stamp-save,
    :not(.pen-annotator-data-undoable) #button-annotation-pen-undo,
    :not(.pen-annotator-data-clearable) #button-annotation-pen-clear,
    :not(.pen-annotator-data-saveable) #button-annotation-pen-save,
    :not(.text-annotator-data-undoable) #button-annotation-text-undo,
    :not(.text-annotator-data-clearable) #button-annotation-text-clear,
    :not(.text-annotator-data-saveable) #button-annotation-text-save,
    :not(.geom-annotator-data-undoable) #button-annotation-geometric-undo,
    :not(.geom-annotator-data-clearable) #button-annotation-geometric-clear,
    :not(.geom-annotator-data-saveable) #button-annotation-geometric-save {
      cursor: default;      
      opacity: 0;
      transform: scale(0);
      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;
    }
    .mode-annotation.undoable-commands #button-command-undo,
    .annotation-selected #button-annotation-edit-text,
    .annotation-selected #button-annotation-delete,
    .stamp-annotator-data-undoable #button-annotation-stamp-undo,
    .stamp-annotator-data-clearable #button-annotation-stamp-clear,
    .stamp-annotator-data-saveable #button-annotation-stamp-save,
    .pen-annotator-data-undoable #button-annotation-pen-undo,
    .pen-annotator-data-clearable #button-annotation-pen-clear,
    .pen-annotator-data-saveable #button-annotation-pen-save,
    .text-annotator-data-undoable #button-annotation-text-undo,
    .text-annotator-data-clearable #button-annotation-text-clear,
    .text-annotator-data-saveable #button-annotation-text-save,
    .geom-annotator-data-undoable #button-annotation-geometric-undo,
    .geom-annotator-data-clearable #button-annotation-geometric-clear,
    .geom-annotator-data-saveable #button-annotation-geometric-save { 
      cursor: pointer;
      opacity: 100;
      transform: scale(1);    
      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;
    }
  
    .panel-v-separator {
      width: 1px;
      height: 30px;
      background-color: var(--${J}-color-fg-secondary-final);
    }
  
    .panel-button {
      cursor: pointer;
      user-select: none;
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      flex-grow: 0;
      justify-content: center;
      align-items: center;
      width: 36px;
      height: 36px;
      border-radius: 50%;
    }
    .panel-button:hover,
    .panel-button.on {
      background-color: var(--${J}-color-accent-final);
    }
    .panel-button.accent,
    .panel-button.accent:hover,
    .panel-button.accent.on {
      background-color: var(--${J}-color-fg-accent-final);
    }
    .panel-button img {
      width: 20px;
      height: 20px;
      filter: invert() opacity(0.7) drop-shadow(0 0 0 var(--${J}-color-fg-primary-final)) saturate(1000%);
    }  
    .panel-button:hover img,
    .panel-button.on img {
      filter: invert() opacity(0.7) drop-shadow(0 0 0 var(--${J}-color-fg-accent-final)) saturate(1000%);
    }  
    .panel-button.accent img,  
    .panel-button.accent:hover img,
    .panel-button.accent.on img {
      filter: opacity(0.7) drop-shadow(0 0 0 var(--${J}-color-primary-final)) saturate(1000%);
    }
    .disabled .panel-button img,
    .panel-button.disabled img {
      filter: invert() opacity(0.2) drop-shadow(0 0 0 var(--${J}-color-fg-primary-final)) saturate(1000%);
    }  
    .context-menu-content .panel-button {
      margin: 1px;
    }
    
    .subpanel {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      margin: 0 4px;
    }    
    
    .panel-item {
      transform: scale(1);
      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;
    }
    .hide-panels .panel-item {
      cursor: default;      
      opacity: 0;
      transform: scale(0);
      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;
    }
  
    #paginator {  
      user-select: none;
      font-family: sans-serif;
      font-size: 16px;
      color: var(--${J}-color-fg-primary-final);
    }
  
    #toggle-previewer {
      margin: 4px;
    }
      
    #previewer {
      box-sizing: border-box;
      position: absolute;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      overflow-x: hidden;
      overflow-y: auto;
      left: 0;
      top: 50px;
      bottom: 0;
      width: 160px; 
      padding-top: 0px;
      background: var(--${J}-color-secondary-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      z-index: 3;
      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, width 0.25s ease-out;
    } 
    .hide-panels #previewer {
      top: 0;
      padding-top: 50px;
      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s;
    }   
    .mobile #previewer {
      background: var(--${J}-color-secondary-tr-final);
    } 
    .hide-previewer #previewer {
      width: 0;
      transition: width 0.25s ease-in 0.1s;
    }
    #previewer .page-preview {      
      transform: scaleX(1);
      transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;
    }
    .hide-previewer #previewer .page-preview {
      opacity: 0;
      transform: scaleX(0);
      transition: opacity 0.1s ease-in, transform 0s linear 0.1s;
    }
  
    #viewer {
      box-sizing: border-box;
      position: absolute;
      display: flex;
      flex-direction: column;
      overflow: auto;
      left: 160px;
      right: 0;
      top: 50px;
      bottom: 0;
      padding-top: 0;
      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, left 0.25s ease-out;
    }
    #viewer.dialog-shown {
      overflow: hidden;
    }
    .mode-hand #viewer {
      cursor: grab !important;
      user-select: none !important;
    }
    .hide-panels #viewer {
      top: 0;
      padding-top: 50px;
      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s;
    }      
    .hide-panels.mobile #viewer,
    .hide-panels.hide-previewer #viewer {
      top: 0;
      padding-top: 50px;
      left: 0;
      transition: padding-top 0.25s ease-in 0.2s, top 0.25s ease-in 0.2s, left 0.25s ease-in;
    }   
    .mobile #viewer,
    .hide-previewer #viewer {
      top: 50px;
      padding-top: 0px;
      left: 0;
      transition: padding-top 0.25s ease-out 0.1s, top 0.25s ease-out 0.1s, left 0.25s ease-in;
    }
    
    #annotation-overlay-container {
      position: absolute;
      top: 0; 
      right: 0;
      bottom: 0;
      left: 0; 
      margin-top: 0;
      transition: margin-top 0.25s ease-out 0.1s;
      z-index: 3;
    }
    .hide-panels #annotation-overlay-container {
      margin-top: 50px;
      transition: margin-top 0.25s ease-in 0.2s;
    }
    .mode-text-markup #annotation-overlay-container {
      pointer-events: none;
    }
    
    #annotation-overlay {
      position: absolute;
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      touch-action: none;
    }
  
    .page-container {    
      position: relative;
      display: flex;
      flex-grow: 0;
      flex-shrink: 0;
      background-color: white;
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
    }
    .page {    
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;    
      transform-origin: left top;
    }
    .page-preview {   
      cursor: pointer; 
      position: relative;
      display: flex;
      flex-grow: 0;
      flex-shrink: 0;
      margin: 0 auto;
      background-color: white;
      background-clip: content-box;
      border-style: solid;
      border-width: 10px 10px 20px 10px;
      border-color: transparent;
    }
    .page-preview:hover,
    .page-preview.current {
      border-color: var(--${J}-color-accent-final);
    }
    .page-preview::after {
      display: inline-block;
      position: absolute;
      top: calc(100% + 3px);
      width: 100%;
      text-align: center;
      font-family: sans-serif;
      font-size: 14px;
      line-height: 1;
      color: var(--${J}-color-fg-primary-final);
      content: attr(data-page-number) " ";
    }
  
    .page-canvas {
      background-color: white;
    } 
  
    .page-annotations {
      width: 0;
      height: 0;
    }
    .mode-text-markup .page-annotations,
    .mode-text .page-annotations,
    .mode-hand .page-annotations {
      pointer-events: none;
    }
    .page-annotations-controls,
    .annotation-content,
    .annotation-content-element {    
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
    }
    .page-annotations-controls {
      z-index: 2;
    }
    .annotation-content {
      pointer-events: none;
    }
  
    .abs-full-size-overlay {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: var(--${J}-color-secondary-tr-final);
      touch-action: none;
    }
    
    .fixed-full-size-overlay {
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: var(--${J}-color-secondary-tr-final);
    }
    
    .text-dialog {
      z-index: 9;
    }
    .text-dialog .form {
      box-sizing: border-box;
      position: absolute;
      display: flex;
      flex-direction: column;
      justify-content: stretch;
      align-items: stretch;
      flex-grow: 0;
      flex-shrink: 0;
      left: calc(50% - 160px);
      top: calc(50% - 120px);
      width: 320px;
      height: 240px;
      padding: 5px;
      background: var(--${J}-color-primary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
    }
    .text-dialog textarea {
      height: 100%;
      margin: 0 0 5px 0;
      padding: 5px;
      font-size: 14px;
      resize: none;
      outline: none;
      border: none;
      color: var(--${J}-color-fg-primary-final);
      background-color: var(--${J}-color-primary-final);
    }
    .text-dialog textarea::placeholder {
      font-size: 14px;
      font-style: italic;
      color: var(--${J}-color-fg-primary-final);
    }
    .text-dialog .buttons {
      display: flex;
      flex-direction: row;
      justify-content: flex-end;
      align-items: center;
      flex-grow: 1;
      flex-shrink: 1;
    } 
    
    .stamp-dialog {
      z-index: 9;
    }
    .stamp-dialog .form {
      position: absolute;
      display: flex;
      flex-direction: column;
      justify-content: stretch;
      align-items: stretch;
      flex-grow: 0;
      flex-shrink: 0;
      left: 50%;
      top: 50%;
      width: 100%;
      height: 100%;
      max-width: 720px;
      max-height: 720px;
      background: var(--${J}-color-primary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      transform-origin: center;
      transform: translate(-50%, -50%)
    }
    .stamp-dialog .buttons {
      display: flex;
      flex-direction: row;
      justify-content: flex-end;
      align-items: center;
      height: 40px;
    } 
    .stamp-dialog .form-canvas-wrapper {
      position: relative;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      margin: 20px;
      flex-grow: 1;
      flex-shrink: 1;
    } 
    .stamp-dialog input {
      width: 100%;
      margin: 10px;
      padding: 5px;
      font-size: 16px;
      outline: none;
      border: none;
      color: var(--${J}-color-fg-primary-final);
      background-color: var(--${J}-color-primary-final);
    }
    .stamp-dialog input::placeholder {
      font-size: 14px;
      font-style: italic;
      color: var(--${J}-color-fg-primary-final);
    }
    .stamp-input-row {    
      display: flex;
      flex-direction: row;
      justify-content: stretch;
      align-items: center;
      height: 30px;
      margin: 10px;
    }
    .stamp-input-row p {
      user-select: none;
      margin: 0;   
      padding: 0 10px;
      font-family: sans-serif; 
      font-size: 16px;
      white-space: nowrap;
      color: var(--${J}-color-fg-secondary-final);
    }
    
    .abs-ratio-canvas {
      outline: 0;
      position: absolute;
      width: 100%;
      height: auto;
      max-height: 100%;
      border: 2px solid var(--${J}-color-fg-secondary-final);
    }
  
    .annotation-temp-copy {
      opacity: 0.2;
    }  
    .annotation-controls {
      cursor: pointer;
    }     
    .annotation-out-of-page {
      cursor: not-allowed;
    }
    .annotation-rect,
    .annotation-bbox {
      fill: none;
    }
    .mode-annotation .annotation-controls.selected {
      cursor: grab;
    } 
    .mode-annotation .annotation-controls.selected .annotation-rect {
      vector-effect: non-scaling-stroke;
      stroke: rgba(80, 80, 80, 0.5);
      stroke-dasharray: 3 3;
    }
    .mode-annotation .annotation-controls.selected .annotation-bbox {
      vector-effect: non-scaling-stroke;
      stroke: rgba(80, 80, 80, 1);
      stroke-dasharray: 3 3;
    }   
    .mode-annotation .annotation-controls.focused .annotation-bbox {
      vector-effect: non-scaling-stroke;
      stroke: rgba(255, 165, 0, 1);
      stroke-dasharray: 3 0;
    } 
    .mode-annotation .annotation-controls.selected .annotation-handle {
      stroke-width: 16;
      stroke-linecap: round;
      vector-effect: non-scaling-stroke;
      cursor: pointer;
    }
    .mode-annotation .annotation-controls.selected .annotation-handle.helper {
      stroke-width: 12;
      stroke: rgba(200, 200, 50, 0.75);
    }
    .mode-annotation .annotation-controls.selected .annotation-handle.scale {
      stroke: rgba(0, 0, 0, 0.75);
    }
    .mode-annotation .annotation-controls.selected .annotation-handle.rotation {
      stroke: rgba(50, 100, 50, 0.75);
    }
    .mode-annotation .annotation-controls.selected .annotation-handle.translation {
      stroke: rgba(100, 100, 200, 0.75);
    }
    .mode-annotation .annotation-controls.selected .annotation-rotator {
      fill: none;
      cursor: pointer;
      vector-effect: non-scaling-stroke;
    }
    .mode-annotation .annotation-controls.selected .annotation-rotator .circle {
      r: 25;
    }
    .mode-annotation .annotation-controls.selected .annotation-rotator .dashed {
      stroke: rgba(80, 80, 80, 1);
      stroke-dasharray: 3 3;
    }
  
    #context-menu {
      box-sizing: border-box;
      position: absolute;
      z-index: 5;
      min-width: 50px;
      min-height: 50px;
      max-height: 300px;
      padding: 5px;
      background: var(--${J}-color-secondary-tr-final);
      box-shadow: 0 0 10px var(--${J}-color-shadow-final);
      display: flex;
      flex-direction: column;
      justify-content: stretch;
      align-items: stretch;
      overflow-y: auto;
    }
    .context-menu-content {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-grow: 1;
      flex-shrink: 0;
    }
    .context-menu-content.row {
      flex-direction: row;
    }
    .context-menu-content.column {
      flex-direction: column;
    }
    .context-menu-color-icon {
      width: 20px;
      height: 20px;
      border-radius: 12px;
      border-width: 2px;
      border-style: solid;
      border-color: var(--${J}-color-fg-secondary-final);
    }
    .context-menu-stamp-select-button {
      box-sizing: border-box;
      cursor: pointer;
      user-select: none;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
      width: 100%;
      height: 36px;
      padding: 0 5px;
      border-radius: 5px;
      font-family: sans-serif;
      font-size: 16px;
      color: var(--${J}-color-fg-primary-final); 
    }
    .context-menu-stamp-select-button:hover,
    .context-menu-stamp-select-button.on {
      background-color: var(--${J}-color-accent-final);
    }
    .context-menu-slider {
      -webkit-appearance: none;
      appearance: none;
      outline: none;
      margin: 10px;
      height: 5px;
      border-radius: 5px;
      cursor: pointer;
      background-color: var(--${J}-color-fg-secondary-final);
    }
    .context-menu-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      outline: none;
      width: 20px;
      height: 20px;
      border-radius: 10px;
      cursor: pointer;
      background-color: var(--${J}-color-accent-final);
    }
    .context-menu-slider::-moz-range-thumb {
      outline: none; 
      width: 20px;
      height: 20px;
      border-radius: 10px;
      cursor: pointer;
      background-color: var(--${J}-color-accent-final);
    }
  
    #button-open-file {
      pointer-events: auto !important;
    }
    .disabled #button-open-file img {
      filter: invert() opacity(0.7) drop-shadow(0 0 0 var(--${J}-color-fg-primary-final)) saturate(1000%);
    }
  
    .spinner {
      position: absolute;
      left: calc(50% - 30px);
      top: calc(50% - 30px);
      width: 60px;
      height: 60px;
    }
    .spinner div {   
      position: absolute; 
      width: 20px;
      height: 20px;
      margin: 5px;
      border-radius: 5px;
      animation-duration: 3s;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }
    .spinner div:nth-child(1) {
      animation-name: spinnerone;
      background-color: var(--${J}-color-accent-final);
    }
    .spinner div:nth-child(2) {
      animation-name: spinnertwo;
      background-color: var(--${J}-color-fg-primary-final);  
    }
    .spinner div:nth-child(3) {  
      animation-name: spinnerthree;
      background-color: var(--${J}-color-fg-secondary-final);  
    }
  
    @keyframes spinnerone {
      from {
        left: 0;
        top: 0;
      }
      8.3% {
        left: 0;
        top: 0;
      }
      16.7% {
        left: 0;
        top: 0;
      }
      25% { 
        left: 30px;
        top: 0px; 
      }
      33.3% {
        left: 30px;
        top: 0px;        
      }
      41.7% {
        left: 30px;
        top: 0px;        
      }
      50% {
        left: 30px;
        top: 30px;         
      }
      58.3% {
        left: 30px;
        top: 30px;       
      }
      66.7% {      
        left: 30px;
        top: 30px;   
      }
      75% {
        left: 0;
        top: 30px;
      }
      83.3% {
        left: 0;
        top: 30px;
      }
      91.7% {
        left: 0;
        top: 30px;
      }
      to {   
        left: 0;
        top: 0;   
      }
    }
    @keyframes spinnertwo {
      from {
        left: 30px;
        top: 0px;
      }
      8.3% {
        left: 30px;
        top: 0px;
      }
      16.7% {
        left: 30px;
        top: 30px;
      }
      25% { 
        left: 30px;
        top: 30px;
      }
      33.3% {
        left: 30px;
        top: 30px;
      }
      41.7% {
        left: 0;
        top: 30px;
      }
      50% {
        left: 0;
        top: 30px;
      }
      58.3% {
        left: 0;
        top: 30px;
      }
      66.7% {
        left: 0;
        top: 0;
      }
      75% {
        left: 0;
        top: 0;
      }
      83.3% {
        left: 0;
        top: 0;
      }
      91.7% {
        left: 30px;
        top: 0px;
      }
      to {
        left: 30px;
        top: 0px;
      }
    }
    @keyframes spinnerthree {
      from {
        left: 30px;
        top: 30px;
      }
      8.3% {
        left: 0;
        top: 30px;
      }
      16.7% {
        left: 0;
        top: 30px;
      }
      25% { 
        left: 0;
        top: 30px;
      }
      33.3% {
        left: 0;
        top: 0;
      }
      41.7% {
        left: 0;
        top: 0;
      }
      50% {
        left: 0;
        top: 0;
      }
      58.3% {
        left: 30px;
        top: 0; 
      }
      66.7% {
        left: 30px;
        top: 0;
      }
      75% {
        left: 30px;
        top: 0;
      }
      83.3% {
        left: 30px;
        top: 30px;
      }
      91.7% {
        left: 30px;
        top: 30px;
      }
      to {
        left: 30px;
        top: 30px; 
      }
    }
  `}class ByteUtils{static parseIntFromBytes(e){if(!e?.length)return 0;if(e.length===1)return e[0];const C=Array.from(e,F=>("0"+(F&255).toString(16)).slice(-2)).join("");return parseInt(C,16)}static int8ToBytes(e){const C=new ArrayBuffer(1);return new DataView(C).setInt8(0,e),new Uint8Array(C)}static int16ToBytes(e,C=!1){const F=new ArrayBuffer(2);return new DataView(F).setInt16(0,e,C),new Uint8Array(F)}static int32ToBytes(e,C=!1){const F=new ArrayBuffer(4);return new DataView(F).setInt32(0,e,C),new Uint8Array(F)}static int32ArrayToBytes(e,C=!1){const F=new ArrayBuffer(e.length*4),$=new DataView(F);for(let Y=0;Y<e.length;Y++)$.setInt32(Y*4,e[Y],C);return new Uint8Array(F)}static bytesToInt32Array(e,C=!1){if(!e?.length)return null;const F=new ArrayBuffer(Math.ceil(e.length/4)*4),$=new DataView(F);for(let V=0;V<e.length;V++)$.setUint8(V,e[V]);const Y=new Int32Array(F.byteLength/4);for(let V=0;V<Y.length;V++)Y[V]=$.getInt32(V*4,C);return Y}static xorBytes(e,C){const F=new Uint8Array(e.length);for(let $=0;$<e.length;$++)F[$]=e[$]^C;return F}static arraysEqual(e,C){if(e.length!==C.length)return!1;for(let F=0;F<e.length;F++)if(e[F]!==C[F])return!1;return!0}static findSubarrayIndex(e,C){if(e?.length&&C?.length){let F;e:for(let $=0;$<=e.length;$++){let Y=!1;for(F=0;F<C.length;F++)if($+F<e.length){if(e[$+F]!==C[F])continue e;Y=!0}else{if(Y)return $;break e}}}return-1}static hexStringToBytes(e){const C=new Uint8Array(e.length/2);for(let F=0,$=0;F<e.length;F+=2,$++)C[$]=parseInt(e.substr(F,2),16);return C}static getBit(e,C){return e&1<<C?1:0}static setBit(e,C){return e|1<<C}static clearBit(e,C){const F=~(1<<C);return e&F}static updateBit(e,C,F){const $=F?1:0,Y=~(1<<C);return e&Y|$<<C}}class ContextMenu{constructor(){this.onPointerDownOutside=e=>{if(!this._shown)return;e.composedPath()[0].closest("#context-menu")||this.hide()},this._container=document.createElement("div"),this._container.id="context-menu",this.hide(),document.addEventListener("pointerdown",this.onPointerDownOutside)}set content(e){var C;(C=this._content)===null||C===void 0||C.forEach(F=>F.remove()),e?.length?(e.forEach(F=>this._container.append(F)),this._content=e):this._content=null}get enabled(){return this._enabled}set enabled(e){this._enabled=!!e}destroy(){this.clear(),document.removeEventListener("pointerdown",this.onPointerDownOutside)}show(e,C){C.append(this._container),this._shown=!0,setTimeout(()=>{this.setContextMenuPosition(e,C),this._container.style.opacity="1"},0)}hide(){this._container.style.opacity="0",this._container.remove(),this._shown=!1}clear(){this.hide(),this.content=null}setContextMenuPosition(e,C){const F=new u(this._container.offsetWidth,this._container.offsetHeight),$=new u,Y=C.getBoundingClientRect(),V=new u(e.x-Y.x,e.y-Y.y);V.x+F.x>Y.width+Y.x?$.x=V.x-F.x:$.x=V.x,V.y+F.y>Y.height+Y.y?$.y=V.y-F.y:$.y=V.y,this._container.style.left=$.x+C.scrollLeft+"px",this._container.style.top=$.y+C.scrollTop+"px"}}class SmoothPath{constructor(e){this._paths=[],this._positionBuffer=[],this._bufferSize=e?.bufferSize||SmoothPath._defaultBufferSize,this._id=e?.id,this._uuid=e?.uuid}get id(){return this._id}get uuid(){return this._uuid}get bufferSize(){return this._bufferSize}get paths(){return this._paths.slice()}get pathCount(){return this._paths.length}endPath(){this._currentPath&&this._currentPath.positions.length>1&&this._paths.push(this._currentPath),this._positionBuffer=null,this._currentPath=null,this._currentPathString=null}addPosition(e){this.appendPositionToBuffer(e),this.updateCurrentPath()}appendPositionToBuffer(e){const C=this._positionBuffer;C.push(e),this._positionBuffer=C.slice(Math.max(0,C.length-this._bufferSize),C.length)}getAverageBufferPosition(e){const C=this._positionBuffer.length;if(C>=this._bufferSize){let F=0,$=0,Y,V,te=0;for(V=e;V<C;V++)te++,Y=this._positionBuffer[V],F+=Y.x,$+=Y.y;return new u(F/te,$/te)}return null}updateCurrentPath(){let e=this.getAverageBufferPosition(0);if(!e)return null;this._currentPathString+=" L"+e.x+" "+e.y,this._currentPath.positions.push(e);let C="";for(let F=2;F<this._positionBuffer.length;F+=2)e=this.getAverageBufferPosition(F),C+=" L"+e.x+" "+e.y;return C}}SmoothPath._defaultBufferSize=8;class CanvasSmoothPathEditor extends SmoothPath{constructor(e,C){if(super(C),this._strokeWidth=CanvasSmoothPathEditor._defaultStrokeWidth,this._color=CanvasSmoothPathEditor._colors[0],this._paths=[],this.onContextMenu=F=>{this._contextMenu.enabled&&(F.preventDefault(),this._contextMenu.show(new u(F.clientX,F.clientY),this._container))},this.onPointerDown=F=>{if(!F.isPrimary||F.button===2)return;const{clientX:$,clientY:Y}=F,[V,te]=this.convertClientCoordsToCanvas($,Y);this.newPath(new u(V,te));const se=F.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(F.pointerId)},this.onPointerMove=F=>{if(!F.isPrimary)return;const{clientX:$,clientY:Y}=F,[V,te]=this.convertClientCoordsToCanvas($,Y);this.addPosition(new u(V,te)),this.refreshEditor()},this.onPointerUp=F=>{if(!F.isPrimary)return;const $=F.target;$.removeEventListener("pointermove",this.onPointerMove),$.removeEventListener("pointerup",this.onPointerUp),$.removeEventListener("pointerout",this.onPointerUp),$.releasePointerCapture(F.pointerId),this.endPath(),this.refreshEditor()},!e)throw new Error("Container is not defined");if(!C?.canvasWidth||!C.canvasHeight)throw new Error("Canvas dimensions is not defined");this._container=e,this._canvas=document.createElement("canvas"),this._canvas.classList.add("abs-ratio-canvas"),this._canvas.width=C.canvasWidth,this._canvas.height=C.canvasHeight,this._canvas.addEventListener("pointerdown",this.onPointerDown),this._contextMenu=new ContextMenu,this.fillContextMenu(),this._container.append(this._canvas),this._container.addEventListener("contextmenu",this.onContextMenu)}get canvas(){return this._canvas}get ctx(){return this._canvas.getContext("2d")}get canvasSize(){return[this._canvas.width,this._canvas.height]}set canvasSize(e){if(!e)return;const[C,F]=e;!C||!F||C===this._canvas.width&&F===this._canvas.height||(this._canvas.width=C,this._canvas.height=F,this.refreshEditor())}get paths(){return this._paths.slice()}destroy(){this._canvas.remove(),this._container.removeEventListener("contextmenu",this.onContextMenu),this._contextMenu.destroy()}getImageData(){return this.refreshEditor(),this.ctx.getImageData(0,0,this._canvas.width,this._canvas.height).data}newPath(e){const C="M"+e.x+" "+e.y,F=new Path2D(C);this._positionBuffer=[e],this._currentPath={strokeWidth:this._strokeWidth,color:this._color,path:F,positions:[new u(e.x,e.y)]},this._currentPathString=C}removePath(e){e&&(this._paths=this._paths.filter(C=>C.path!==e),this.refreshEditor())}removeLastPath(){this._paths.pop(),this.refreshEditor()}removeAllPaths(){this._paths.length=0,this.refreshEditor()}updateCurrentPath(){const e=super.updateCurrentPath();return e&&(this._currentPath.path=new Path2D(this._currentPathString+e)),e}refreshEditor(){this.drawPaths(),this.fillContextMenu()}drawPaths(){this.ctx.clearRect(0,0,this._canvas.width,this._canvas.height),(this._currentPath?[...this._paths,this._currentPath]:this._paths).forEach(e=>{const[C,F,$,Y]=e.color;this.ctx.strokeStyle=`rgba(${C*255},${F*255},${$*255},${Y})`,this.ctx.lineWidth=e.strokeWidth,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.stroke(e.path)})}convertClientCoordsToCanvas(e,C){const{top:F,left:$,width:Y,height:V}=this._canvas.getBoundingClientRect(),te=Y/this._canvas.width,se=V/this._canvas.height,ne=(e-$)/te,ee=(C-F)/se;return[ne,ee]}fillContextMenu(){const e=[this.buildColorPicker(),this.buildWidthSliderWithButtons()];this._contextMenu.content=e,this._contextMenu.enabled=!0}buildColorPicker(){const e=document.createElement("div");return e.classList.add("context-menu-content","row"),CanvasSmoothPathEditor._colors.forEach(C=>{const F=document.createElement("div");F.classList.add("panel-button"),C===this._color&&F.classList.add("on"),F.addEventListener("click",()=>{this._color=C,this.fillContextMenu()});const $=document.createElement("div");$.classList.add("context-menu-color-icon"),$.style.backgroundColor=`rgb(${C[0]*255},${C[1]*255},${C[2]*255})`,F.append($),e.append(F)}),e}buildWidthSliderWithButtons(){const e=document.createElement("div");e.classList.add("context-menu-content","row");const C=document.createElement("div");C.classList.add("panel-button"),this.pathCount?C.addEventListener("click",()=>{this.removeLastPath()}):C.classList.add("disabled"),C.innerHTML=`<img src="${Icons.icon_back}"/>`,e.append(C);const F=document.createElement("div");F.classList.add("panel-button"),this.pathCount?F.addEventListener("click",()=>{this.removeAllPaths()}):F.classList.add("disabled"),F.innerHTML=`<img src="${Icons.icon_close}"/>`,e.append(F);const $=document.createElement("input");return $.setAttribute("type","range"),$.setAttribute("min","1"),$.setAttribute("max","32"),$.setAttribute("step","1"),$.setAttribute("value",this._strokeWidth+""),$.classList.add("context-menu-slider"),$.addEventListener("change",()=>{this._strokeWidth=$.valueAsNumber}),e.append($),e}}CanvasSmoothPathEditor._defaultStrokeWidth=3;CanvasSmoothPathEditor._colors=[[0,0,0,1],[.804,0,0,1],[0,.804,0,1],[0,0,.804,1],[1,.5,0,1],[1,.2,1,1]];var __awaiter$1=function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};class DomUtils{static htmlToElements(e){const C=document.createElement("template");C.innerHTML=e;const F=[];return C.content.childNodes.forEach($=>{$ instanceof HTMLElement&&F.push($)}),F}static promisify(e){return __awaiter$1(this,void 0,void 0,function*(){return new Promise(C=>{setTimeout(()=>{const F=e();C(F)},0)})})}static runEmptyTimeout(){return __awaiter$1(this,void 0,void 0,function*(){yield this.promisify(()=>{})})}static downloadFile(e,C){const F=URL.createObjectURL(e),$=document.createElement("a");$.setAttribute("download",C),$.href=F,document.body.appendChild($),$.click(),$.remove(),setTimeout(()=>URL.revokeObjectURL(F),1e4)}static loadImageAsync(e,C=!1){return __awaiter$1(this,void 0,void 0,function*(){return yield new Promise(($,Y)=>{const V=new Image;V.onerror=(te,se)=>{C&&URL.revokeObjectURL(e),console.log(`Error while loading image: ${se?.message||te.toString()}`),$(null)},V.onload=()=>{C&&URL.revokeObjectURL(e),$(V)},V.src=e})})}static loadFileDataAsync(e){return __awaiter$1(this,void 0,void 0,function*(){let C;if(e instanceof Uint8Array)C=e;else{let F;if(typeof e=="string"){const Y=yield fetch(e);if(!Y.ok)throw new Error(`${Y.status}: ${Y.statusText}`);F=yield Y.blob()}else F=e;const $=yield F.arrayBuffer();C=new Uint8Array($)}return C})}}class Spinner{constructor(){this._spinnerElement=DomUtils.htmlToElements(Spinner.spinnerHtml)[0]}show(e,C=8){this._isShown||!e||(this._spinnerElement.style.zIndex=C+"",this._spinnerElement.style.top=e.scrollTop+"px",this._spinnerElement.style.left=e.scrollLeft+"px",e.append(this._spinnerElement),this._isShown=!0)}hide(){this._spinnerElement.remove(),this._isShown=!1}}Spinner.spinnerHtml=`
  <div class="abs-full-size-overlay">
    <div class="spinner">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
  `;class CloudCurveData{static buildFromPolyline(e,C){if(!e||e.length<2)return null;if(isNaN(C)||C<=0)throw new Error(`Invalid maximal arc size ${C}`);const F=e[0].clone().truncate(2),$=[],Y=new u,V=new u;let te,se,ne,ee,ie,ae,re,oe,ce,he;for(te=0;te<e.length-1;te++){if(ne=e[te],ee=e[te+1],ie=u.subtract(ee,ne).getMagnitude(),!ie)continue;V.set(ie,0);const de=l.from4Vec2(Y,V,ne,ee);for(ae=Math.ceil(ie/C),re=ie/ae,oe=re/2,se=0;se<ae;se++){ce=se*re,he=(se+1)*re;const pe=[new u(ce,-oe).applyMat3(de).truncate(2),new u(he,-oe).applyMat3(de).truncate(2),new u(he,0).applyMat3(de).truncate(2)];$.push(pe)}}return{start:F,curves:$}}static buildFromEllipse(e,C,F,$){$||($=new l);const Y=new u,V=Math.PI*(3*(e+C)-Math.sqrt((3*e+C)*(e+3*C))),te=Math.ceil(V/F/4)*4,se=Math.ceil(V/te),ne=[],ee=new u(Y.x+e,Y.y),ie=new u;let ae=0,re;ne.push(ee.clone().applyMat3($).truncate(2));for(let ce=0;ce<te;ce++){for(re=0;re<se;)ae+=.25/180*Math.PI,ie.set(e*Math.cos(ae)+Y.x,C*Math.sin(ae)+Y.y),re+=h(ee.x,ee.y,ie.x,ie.y),ee.setFromVec2(ie);ne.push(ee.clone().applyMat3($).truncate(2))}return this.buildFromPolyline(ne,F)}}class SvgSmoothPath extends SmoothPath{constructor(e){super(e),this._paths=[],this._strokeWidth=e?.strokeWidth||SvgSmoothPath._defaultStrokeWidth,this._color=e?.color||SvgSmoothPath._defaultColor,this._group=document.createElementNS("http://www.w3.org/2000/svg","g")}get strokeWidth(){return this._strokeWidth}get color(){return this._color}get group(){return this._group}get paths(){return this._paths.slice()}newPath(e){const[C,F,$,Y]=this._color||[0,0,0,1],V=document.createElementNS("http://www.w3.org/2000/svg","path");V.setAttribute("fill","none"),V.setAttribute("stroke",`rgba(${C*255},${F*255},${$*255},${Y})`),V.setAttribute("stroke-width",this._strokeWidth+""),V.setAttribute("stroke-linecap","round"),V.setAttribute("stroke-linejoin","round");const te="M"+e.x+" "+e.y;V.setAttribute("d",te),this._positionBuffer=[e],this._currentPath={path:V,positions:[new u(e.x,e.y)]},this._currentPathString=te,this._group.append(V)}removePath(e){e&&(e.remove(),this._paths=this._paths.filter(C=>C.path!==e))}removeLastPath(){const e=this._paths.pop();e?.path.remove()}updateCurrentPath(){const e=super.updateCurrentPath();return e&&this._currentPath.path.setAttribute("d",this._currentPathString+e),e}}SvgSmoothPath._defaultStrokeWidth=3;SvgSmoothPath._defaultColor=[0,0,0,.8];class SvgTempPath{constructor(){this._path=document.createElementNS("http://www.w3.org/2000/svg","path")}get path(){return this._path}set(e,C,F,$,Y=!1){let V="";if($?.length>1){V+=`M${$[0].x},${$[0].y} `;for(let te=1;te<$.length;te++)V+=`L${$[te].x},${$[te].y} `;Y&&(V+="Z")}this._path.classList.add("annotation-temp-copy"),this._path.setAttribute("d",V),this._path.style.fill=e,this._path.style.stroke=C,this._path.style.strokeWidth=F+""}insertAfter(e){e.after(this._path)}remove(){this._path.setAttribute("d",""),this._path.remove()}}class EventService{constructor(e){if(this._eventMap=new Map,!e)throw new Error("Container is not defined");const C=document.createElement("div");C.style.position="absolute",C.style.width="0",C.style.height="0",C.style.zIndex="-1000",e.append(C),this._element=C}get element(){return this._element}destroy(){this.removeAllListeners(),this._element.remove(),this._element=null}addListener(e,C,F){this._element&&(this._element.addEventListener(e,C,F),this._eventMap.has(e)?this._eventMap.get(e).add(C):this._eventMap.set(e,new Set().add(C)))}removeListener(e,C){this._element&&(this._element.removeEventListener(e,C),this._eventMap.has(e)&&this._eventMap.get(e).delete(C))}removeAllListenersForKey(e){this._element&&this._eventMap.has(e)&&(this._eventMap.get(e).forEach(F=>this._element.removeEventListener(e,F)),this._eventMap.delete(e))}removeAllListeners(){this._element&&(this._eventMap.forEach((e,C)=>{e.forEach(F=>this._element.removeEventListener(C,F))}),this._eventMap.clear())}getListenersByKey(e){const C=this._eventMap.get(e);return C?[...C]:[]}hasListenersForKey(e){const C=this._eventMap.get(e);return!!C?.size}dispatchEvent(e){this._element&&this.hasListenersForKey(e.type)&&this._element.dispatchEvent(e)}}class LinkedListNode{constructor(e){this.data=e}}class LinkedList{constructor(e){this._length=0,e&&this.push(e)}get head(){return this._head.data}get length(){return this._length}get tail(){return this.get(this._length-1)}push(e){const C=new LinkedListNode(e);let F;if(!this._head)this._head=C;else{for(F=this._head;F.next;)F=F.next;F.next=C}this._length++}insert(e,C){if(C<0||C>this._length-1)return null;const F=new LinkedListNode(e);let $,Y=this._head,V=0;if(!C)this._head=F;else{for(;V++<C;)$=Y,Y=Y.next;$.next=F}return F.next=Y,this._length++,F.data}replace(e,C){if(C<0||C>this._length-1)return null;const F=new LinkedListNode(e);let $,Y=this._head,V=0;if(!C)this._head=F;else{for(;V++<C;)$=Y,Y=Y.next;$.next=F}return F.next=Y.next,Y.data}remove(e){if(e<0||e>this._length-1)return null;let C,F=this._head,$=0;if(!e)this._head=F.next;else{for(;$++<e;)C=F,F=F.next;C.next=F.next}return this._length--,F.data}clear(){this._head=null,this._length=0}get(e){if(e<0||e>this._length-1)return null;let C=this._head,F=0;for(;F++<e;)C=C.next;return C.data}pop(){return this.remove(this._length-1)}has(e,C){if(!this._length)return!1;C||(C=(Y,V)=>Y===V);let F=this._head,$=0;for(;$<this._length;){if(C(e,F.data))return!0;F=F.next,$++}return!1}findIndex(e,C){if(!this._length)return-1;C||(C=(Y,V)=>Y===V);let F=this._head,$=0;for(;$<this._length;){if(C(e,F.data))return $;F=F.next,$++}return-1}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.data,e=e.next}}class UUID{static getRandomUuid(){return v4()}}var __awaiter=function(J,e,C,F){function $(Y){return Y instanceof C?Y:new C(function(V){V(Y)})}return new(C||(C=Promise))(function(Y,V){function te(ee){try{ne(F.next(ee))}catch(ie){V(ie)}}function se(ee){try{ne(F.throw(ee))}catch(ie){V(ie)}}function ne(ee){ee.done?Y(ee.value):$(ee.value).then(te,se)}ne((F=F.apply(J,e||[])).next())})};const stampImageLoaderHtml=`
  <div class="abs-full-size-overlay stamp-dialog">
    <div class="form">
      <div class="form-canvas-wrapper">
        <canvas class="abs-ratio-canvas"></canvas>
      </div>
      <div class="stamp-input-row">
        <p>Stamp name:</p>
        <input class="stamp-name-input" type="text" maxlength="128"/>
      </div>
      <div class="stamp-input-row">
        <p>Stamp description:</p>
        <input class="stamp-subject-input" type="text" maxlength="256"/>
      </div>
      <div class="stamp-input-row">
        <p>Width:</p>
        <input class="stamp-width-input" type="text" maxlength="4"/>
        <p>Height:</p>
        <input class="stamp-height-input" type="text" maxlength="4"/>
      </div>
      <div class="buttons">
        <div class="panel-button stamp-ok">
          <img src="${Icons.icon_ok}"/>
        </div>
        <div class="panel-button stamp-cancel">
          <img src="${Icons.icon_close}"/>
        </div>
      </div>
    </div>
  </div>
`,stampDesignerHtml=`
  <div class="abs-full-size-overlay stamp-dialog">
    <div class="form">
      <div class="form-canvas-wrapper">
      </div>
      <div class="stamp-input-row">
        <p>Stamp name:</p>
        <input class="stamp-name-input" type="text" maxlength="128"/>
      </div>
      <div class="stamp-input-row">
        <p>Stamp description:</p>
        <input class="stamp-subject-input" type="text" maxlength="256"/>
      </div>
      <div class="stamp-input-row">
        <p>Width:</p>
        <input class="stamp-width-input" type="text" maxlength="4"/>
        <p>Height:</p>
        <input class="stamp-height-input" type="text" maxlength="4"/>
      </div>
      <div class="buttons">
        <div class="panel-button stamp-ok">
          <img src="${Icons.icon_ok}"/>
        </div>
        <div class="panel-button stamp-cancel">
          <img src="${Icons.icon_close}"/>
        </div>
      </div>
    </div>
  </div>
`,customStampEvent="tsviewer-customstampchange";class CustomStampEvent extends CustomEvent{constructor(e){super(customStampEvent,{detail:e})}}class CustomStampService{constructor(e,C){if(this._customStampsByType=new Map,this._spinner=new Spinner,this.onFileInput=()=>{const $=this._fileInput.files;$.length!==0&&(this.openImageLoaderOverlayAsync($[0]),this._fileInput.value=null)},!e)throw new Error("Container is not defined");if(!C)throw new Error("Event service is not defined");this._container=e,this._eventService=C;const F=document.createElement("input");F.type="file",F.accept="image/*",F.classList.add("abs-hidden"),this._fileInput=F,this._fileInput.addEventListener("change",this.onFileInput),this._container.append(this._fileInput)}destroy(){var e;this._fileInput.remove(),this._spinner.hide(),(e=this._overlay)===null||e===void 0||e.remove()}importCustomStamps(e){e?.length&&e.forEach(C=>{this._customStampsByType.set(C.type,C)})}getCustomStamps(){return[...this._customStampsByType.values()]}addCustomStamp(e){this._customStampsByType.set(e.type,e),this._eventService.dispatchEvent(new CustomStampEvent({type:"add",stamp:e}))}removeCustomStamp(e){const C=this._customStampsByType.get(e);C&&(this._customStampsByType.delete(e),this._eventService.dispatchEvent(new CustomStampEvent({type:"delete",stamp:C})))}startLoadingImage(){this._fileInput.click()}startDrawing(){this.openDesignerOverlayAsync()}openImageLoaderOverlayAsync(e){return __awaiter(this,void 0,void 0,function*(){this._spinner.show(this._container,10);const C=new Promise((be,Ae)=>{const we=URL.createObjectURL(e),Te=new Image;Te.onload=()=>{URL.revokeObjectURL(we),be(Te)},Te.onerror=Me=>{console.log(Me),Ae()},Te.src=we});let F;try{F=yield C}catch{this._spinner.hide();return}const $=F.width,Y=F.height,V=F.width/F.height,te=DomUtils.htmlToElements(stampImageLoaderHtml)[0],se=te.querySelector("canvas"),ne=te.querySelector(".stamp-cancel"),ee=te.querySelector(".stamp-ok"),ie=te.querySelector(".stamp-name-input"),ae=te.querySelector(".stamp-subject-input"),re=te.querySelector(".stamp-width-input"),oe=te.querySelector(".stamp-height-input");let ce="Custom stamp",he="image stamp",de=64,pe=+(64/V).toFixed();ie.value=ce,re.value=de+"",oe.value=pe+"",this._overlay=te,this._container.append(te),se.width=$,se.height=Y;const fe=se.getContext("2d");fe.drawImage(F,0,0);const ye=fe.getImageData(0,0,F.width,F.height).data,_e=()=>{!ce||!pe||isNaN(pe)||!de||isNaN(de)?ee.classList.add("disabled"):ee.classList.remove("disabled")};ie.addEventListener("input",()=>{ce=ie.value,_e()}),ae.addEventListener("input",()=>{he=ae.value,_e()}),re.addEventListener("input",()=>{var be;de=+((be=+re.value)===null||be===void 0?void 0:be.toFixed()),_e()}),oe.addEventListener("input",()=>{var be;pe=+((be=+oe.value)===null||be===void 0?void 0:be.toFixed()),_e()});const Ee=()=>{te.remove(),this._overlay=null};ne.addEventListener("click",Ee),ee.addEventListener("click",()=>{const be=new Array(ye.length);for(let we=0;we<ye.length;we++)be[we]=ye[we];const Ae={type:"/"+UUID.getRandomUuid(),name:ce,subject:he,rect:[0,0,de,pe],bbox:[0,0,$,Y],imageData:be};this.addCustomStamp(Ae),Ee()}),this._spinner.hide()})}openDesignerOverlayAsync(){return __awaiter(this,void 0,void 0,function*(){this._spinner.show(this._container,10);const e=DomUtils.htmlToElements(stampDesignerHtml)[0],C=e.querySelector(".form-canvas-wrapper"),F=e.querySelector(".stamp-cancel"),$=e.querySelector(".stamp-ok"),Y=e.querySelector(".stamp-name-input"),V=e.querySelector(".stamp-subject-input"),te=e.querySelector(".stamp-width-input"),se=e.querySelector(".stamp-height-input");let ne="Custom stamp",ee="drawing stamp",ie=64,ae=64;Y.value=ne,te.value=ie+"",se.value=ae+"";const re=new CanvasSmoothPathEditor(C,{canvasWidth:ie,canvasHeight:ae});this._overlay=e,this._container.append(e);const oe=()=>{re.canvasSize=[ie,ae]},ce=()=>{!ne||!ae||isNaN(ae)||!ie||isNaN(ie)?$.classList.add("disabled"):(oe(),$.classList.remove("disabled"))};Y.addEventListener("input",()=>{ne=Y.value,ce()}),V.addEventListener("input",()=>{ee=V.value,ce()}),te.addEventListener("input",()=>{var de;ie=+((de=+te.value)===null||de===void 0?void 0:de.toFixed()),ce()}),se.addEventListener("input",()=>{var de;ae=+((de=+se.value)===null||de===void 0?void 0:de.toFixed()),ce()});const he=()=>{e.remove(),this._overlay=null};F.addEventListener("click",he),$.addEventListener("click",()=>{const de=re.getImageData(),pe=new Array(de.length);for(let ye=0;ye<de.length;ye++)pe[ye]=de[ye];const fe={type:"/"+UUID.getRandomUuid(),name:ne,subject:ee,rect:[0,0,ie,ae],bbox:[0,0,ie,ae],imageData:pe};this.addCustomStamp(fe),he()}),this._spinner.hide()})}}class HtmlTemplates{}HtmlTemplates.textDialogHtml=`
    <div class="abs-full-size-overlay text-dialog">
      <div class="form">
        <textarea class="text-input" maxlength="1024"></textarea>
        <div class="buttons">
          <div class="panel-button text-ok">
            <img src="${Icons.icon_ok}"/>
          </div>
          <div class="panel-button text-cancel">
            <img src="${Icons.icon_close}"/>
          </div>
        </div>
      </div>
    </div>
  `;HtmlTemplates.stampContextButtonsHtml=`
    <div class="context-menu-content row">
      <div class="panel-button stamp-load-image">
        <img src="${Icons.icon_load}"/>
      </div>
      <div class="panel-button stamp-draw-image">
        <img src="${Icons.icon_pen}"/>
      </div>
      <div class="panel-button stamp-delete disabled">
        <img src="${Icons.icon_delete}"/>
      </div>
    </div>
  `;const mainHtml=`
  <div id="main-container" tabindex="0" class="hide-previewer disabled" 
    ondragstart="return false;" ondrop="return false;">
    <div id="viewer"></div>
    <div id="previewer"></div>
    <div id="top-panel"> 
      <div class="subpanel panel-item">
        <div id="toggle-previewer" class="panel-button panel-item">
          <img src="${Icons.icon_sidebar}"/>
        </div>
        <div id="toggle-expand" class="panel-sizers panel-button panel-item" type="button" title="Expand Window"><embed class="svg" src="/expand.svg" /></div>
        <div id="toggle-shrink" class="panel-sizers panel-button panel-item" type="button" title="Shrink Window"><embed class="svg" src="/shrink.svg" /></div> 
      </div>
      <div id="modes" class="subpanel panel-item">
        <div id="button-mode-text" class="panel-button panel-item" title="Text Selection Tool">
          <img src="${Icons.icon_caret}"/>
        </div> 
        <div id="button-mode-hand" class="panel-button panel-item" title="Grab Tool">
          <img src="${Icons.icon_hand}"/>
        </div> 
        <div id="button-mode-annotation" class="panel-button panel-item" title="Annotation Tool">
          <img src="${Icons.icon_popup}"/>
        </div> 
        <div id="button-mode-comparison"></div> 
        <div class="panel-v-separator margin-s-5 panel-item"></div>
        <div id="button-open-file" class="panel-button panel-item" title="Open PDF">
          <img src="${Icons.icon_load}"/>
        </div> 
        <div id="button-save-file" class="panel-button panel-item" title="Save PDF...">
          <img src="${Icons.icon_download}"/>
        </div> 
        <div id="button-close-file" class="panel-button panel-item">
          <img src="${Icons.icon_close2}"/>
        </div> 
      </div>
    </div>
    <div id="bottom-panel">
      <div id="paginator" class="subpanel panel-item">
        <div id="paginator-prev" class="panel-button" title="Previous Page">
          <img src="${Icons.icon_arrow_up}"/>
        </div>
        <div id="paginator-next" class="panel-button" title="Next Page">
          <img src="${Icons.icon_arrow_down}"/>
        </div>
        <input id="paginator-input" type="text">
        <span>&nbsp/&nbsp</span>
        <span id="paginator-total">0</span>
      </div>
      <div class="panel-v-separator panel-item"></div>
      <div id="rotator" class="subpanel panel-item">
        <div id="rotate-counter-clockwise" class="panel-button" title="Rotate Counter-Clockwise">
          <img src="${Icons.icon_counter_clockwise}"/>
        </div>
        <div id="rotate-clockwise" class="panel-button" title="Rotate Clockwise">
          <img src="${Icons.icon_clockwise}"/>
        </div>
      </div>
      <div class="panel-v-separator panel-item"></div>
      <div id="zoomer" class="subpanel panel-item">
        <div id="zoom-out" class="panel-button" title="Zoom Out">
          <img src="${Icons.icon_minus}"/>
        </div>
        <div id="zoom-in" class="panel-button" title="Zoom In">
          <img src="${Icons.icon_plus}"/>
        </div>
        <div id="zoom-fit-viewer" class="panel-button" title="Fit to View">
          <img src="${Icons.icon_fit_viewer}"/>
        </div>
        <div id="zoom-fit-page" class="panel-button" title="Fit to Page">
          <img src="${Icons.icon_fit_page}"/>
        </div>
      </div>
    </div>
    <div id="command-panel">
      <div class="command-panel-row">
        <div id="button-command-comparison-close" 
          class="panel-button command-panel-subitem accent">
          <img src="${Icons.icon_close2}"/>
        </div>
        <div id="button-command-comparison-open" 
          class="panel-button command-panel-subitem accent">
          <img src="${Icons.icon_load}"/>
        </div>
        <div id="button-command-undo" 
          class="panel-button command-panel-subitem accent">
          <img src="${Icons.icon_back}"/>
        </div>
      </div>      
    </div>
    <div id="annotation-panel">
      <div class="annotation-panel-row">
        <div id="button-annotation-edit-text" 
          class="panel-button annotation-panel-subitem" title="Edit Annotation">
          <img src="${Icons.icon_text}"/>
        </div> 
        <div id="button-annotation-delete" 
          class="panel-button annotation-panel-subitem" title="Delete Annotation">
          <img src="${Icons.icon_close}"/>
        </div> 
        <div id="button-annotation-mode-select" 
          class="panel-button annotation-panel-item" title="Select Annotation">
          <img src="${Icons.icon_pointer}"/>
        </div> 
      </div>
    <div id="button-annotation-mode-stamp"></div> 
      <div class="annotation-panel-row">
        <div id="button-annotation-pen-undo" 
          class="panel-button annotation-panel-subitem button-annotation-undo">
          <img src="${Icons.icon_back}"/>
        </div> 
        <div id="button-annotation-pen-clear" 
          class="panel-button annotation-panel-subitem button-annotation-clear">
          <img src="${Icons.icon_close}"/>
        </div> 
        <div id="button-annotation-pen-save" 
          class="panel-button annotation-panel-subitem button-annotation-save">
          <img src="${Icons.icon_ok}"/>
        </div> 
        <div id="button-annotation-mode-pen" 
          class="panel-button annotation-panel-item">
          <img src="${Icons.icon_pen}"/>
        </div> 
      </div>
      <div class="annotation-panel-row">
        <div id="button-annotation-geometric-undo" 
          class="panel-button annotation-panel-subitem button-annotation-undo" title="Undo Annotation">
          <img src="${Icons.icon_back}"/>
        </div> 
        <div id="button-annotation-geometric-clear" 
          class="panel-button annotation-panel-subitem button-annotation-clear" title="Clear Annotation">
          <img src="${Icons.icon_close}"/>
        </div> 
        <div id="button-annotation-geometric-save" 
          class="panel-button annotation-panel-subitem button-annotation-save" title="Save Annotation">
          <img src="${Icons.icon_ok}"/>
        </div> 
        <div id="button-annotation-mode-geometric" 
          class="panel-button annotation-panel-item">
          <img src="${Icons.icon_geometric}"/>
        </div>
      </div>
      <div class="annotation-panel-row">
        <div id="button-annotation-text-undo" 
          class="panel-button annotation-panel-subitem button-annotation-undo"  title="Undo Annotation">
          <img src="${Icons.icon_back}"/>
        </div> 
        <div id="button-annotation-text-clear" 
          class="panel-button annotation-panel-subitem button-annotation-clear" title="Clear Annotation">
          <img src="${Icons.icon_close}"/>
        </div> 
        <div id="button-annotation-text-save" 
          class="panel-button annotation-panel-subitem button-annotation-save"  title="Save Annotation">
          <img src="${Icons.icon_ok}"/>
        </div> 
        <div id="button-annotation-mode-text" 
          class="panel-button annotation-panel-item">
          <img src="${Icons.icon_text2}"/>
        </div>
      </div>
    </div>

    <div id="focused-annotation-panel">
      <p id="focused-annotation-author" class="line-clamp"></p>
      <p id="focused-annotation-date" class="line-clamp"></p>
      <p id="focused-annotation-text" class="line-clamp"></p>
    </div>

    <input id="open-file-input" class="abs-hidden" type="file" accept="application/pdf">
    <input id="open-comparable-file-input" class="abs-hidden" type="file" accept="application/pdf">
  </div>
`,passwordDialogHtml=`
  <div class="abs-full-size-overlay password-dialog">
    <div class="form">
      <input class="password-input" type="password" maxlength="127"/>
      <div class="buttons">
        <div class="panel-button password-ok">
          <img src="${Icons.icon_ok}"/>
        </div>
        <div class="panel-button password-cancel">
          <img src="${Icons.icon_close}"/>
        </div>
      </div>
    </div>
  </div>
`,appName="tspdf",styles=`
<style>
  ${getCommonStyles(appName)}
  
  #bottom-panel {
    left: calc(50% - 200px);
    width: 400px;
  }
  .compact #bottom-panel {  
    left: calc(50% - 160px);  
    width: 320px;
  }
  .svg {
    width: 25px;
    height: 25px;
    pointer-events: none;
  }
  .panel-button
  {
    filter: var(--invert);
  }
  #viewer {
    justify-content: flex-start;
  }

  #paginator-input {
    text-align: center; 
    font-size: 16px;
    width: 30px;
    height: 30px;
    margin: 2px;
    padding: 0;
    outline: none;
    border: none;
    color: var(--${appName}-color-fg-primary-final);
    background-color: var(--${appName}-color-primary-final);
  }
  #paginator-total {
    margin: 4px;
  }

  .page-container {
    margin: 10px auto;
  }  
  
  .page-text {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    margin: 0;
    padding: 0;
    overflow: hidden;
    line-height: 1;
  }
  .page-text span {
    cursor: text;
    position: absolute;
    white-space: pre;
    color: transparent;
    transform-origin: 0% 0%;
  }
  .page-text ::selection {
    background: var(--${appName}-color-text-selection-final);
  }
  .mode-hand .page-text span {
    cursor: grab;
  }
  .dummy-corner {    
    position: absolute;
    width: 0;
    height: 0;
  }
  .dummy-corner.bl {
    bottom: 0;
    left: 0;
  }
  .dummy-corner.br {
    bottom: 0;
    right: 0;
  }
  .dummy-corner.tr {
    top: 0;
    right: 0;
  }
  .dummy-corner.tl {
    top: 0;
    left: 0;
  }

  .password-dialog {
    z-index: 10;
    pointer-events: all !important;
  }
  .password-dialog .form {
    position: absolute;
    display: flex;
    flex-direction: row;
    justify-content: stretch;
    align-items: stretch;
    flex-grow: 0;
    flex-shrink: 0;
    left: calc(50% - 160px);
    top: calc(50% - 25px);
    width: 320px;
    height: 50px;
    background: var(--${appName}-color-primary-tr-final);
    box-shadow: 0 0 10px var(--${appName}-color-shadow-final);
  }
  .password-dialog input {
    width: 220px;
    margin: 10px 0 10px 10px;
    padding: 5px;
    font-size: 16px;
    outline: none;
    border: none;
    color: var(--${appName}-color-fg-primary-final);
    background-color: var(--${appName}-color-primary-final);
  }
  .password-dialog input::placeholder {
    font-size: 14px;
    font-style: italic;
    color: var(--${appName}-color-fg-primary-final);
  }
  .password-dialog .buttons {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
    flex-shrink: 1;
    width: 100px;
  }

  <!-- .mode-hand .page-text {
    visibility: hidden;
  }
  .mode-comparison .page-annotations,
  .mode-comparison .page-text {
    visibility: hidden;
  }
  .mode-text .page-comparison,
  .mode-hand .page-comparison,
  .mode-annotation .page-comparison {
    visibility: hidden;
  } -->
  
  #button-command-comparison-open,
  #button-command-comparison-close {
    position: absolute;
    right: 0;
    top: 0;
  }
  :not(.mode-comparison) #button-command-comparison-open,
  .comparison-loaded #button-command-comparison-open,
  :not(.comparison-loaded) #button-command-comparison-close {
    cursor: default;
    opacity: 0;
    transform: scale(0);
    transition: opacity 0.1s ease-in, transform 0s linear 0.1s;
  }
  .mode-comparison:not(.comparison-loaded) #button-command-comparison-open,
  .mode-comparison.comparison-loaded #button-command-comparison-close { 
    cursor: pointer;
    opacity: 100;
    transform: scale(1);
    transition: opacity 0.1s ease-out 0.35s, transform 0s linear 0.35s;
  }

  .page-comparison {
    width: 0;
    height: 0;
  }
  .page-comparison-areas {
    z-index: 2;
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
  }
  .comparison-area-rect {
    stroke: red;
    stroke-width: 3px;
    fill: none;
  }
  .comparison-area-image {
    opacity: 0;
  }
  .transparent .comparison-area-image {
    opacity: 0.5;
  }
  .opaque .comparison-area-image {
    opacity: 1;
  }

</style>
`;function getNextNode(J){if(J.hasChildNodes())return J.firstChild;for(;J&&!J.nextSibling;)J=J.parentNode;return J?J.nextSibling:null}function getRangeNodes(J){let e=J.startContainer;const C=J.endContainer;if(e===C)return[e];const F=[];for(;e&&e!==C;)F.push(e=getNextNode(e));for(e=J.startContainer;e&&e!==J.commonAncestorContainer;)F.unshift(e),e=e.parentNode;return F}function getSelectionInfosFromRangeSpans(J){const e=getRangeNodes(J).filter(F=>F?.nodeType===3),C=[];for(let F=0;F<e.length;F++){const $=e[F],Y=$.textContent;if(!Y)continue;const V=$.textContent?.length||0;let te=0,se=V;F===0&&(te=J.startOffset),F===e.length-1&&(se=J.endOffset);const ne=Y.slice(te,se);if(!ne)continue;const ee=$.parentElement;if(!ee||ee.tagName.toLowerCase()!=="span")continue;const ie=ee.querySelectorAll(".dummy-corner");if(ie.length!==4)continue;const ae=new u,re=new u,oe=new u,ce=new u;ie.forEach(Ae=>{const{x:we,y:Te}=Ae.getBoundingClientRect();Ae.classList.contains("bl")?ae.set(we,Te):Ae.classList.contains("br")?re.set(we,Te):Ae.classList.contains("tr")?oe.set(we,Te):Ae.classList.contains("tl")&&ce.set(we,Te)});const he=te/V,de=se/V,pe=u.subtract(re,ae),fe=u.subtract(oe,ce),ye=u.add(ae,u.multiplyByScalar(pe,he)),_e=u.add(ae,u.multiplyByScalar(pe,de)),Ee=u.add(ce,u.multiplyByScalar(fe,de)),be=u.add(ce,u.multiplyByScalar(fe,he));C.push({text:ne,bottomLeft:ye,bottomRight:_e,topRight:Ee,topLeft:be})}return C}function getSelectionInfosFromSelection(J){const e=J.getRangeAt(0);return getSelectionInfosFromRangeSpans(e)}class PageTextView{_container;_pageProxy;_renderTask;_divModeTimer;_destroyed;constructor(e){if(!e)throw new Error("Page proxy is not defined");this._pageProxy=e,this._container=document.createElement("div"),this._container.classList.add("page-text"),this._container.addEventListener("pointerdown",this.onPointerDown),this._container.addEventListener("pointerup",this.onPointerUp)}static async appendPageTextAsync(e,C,F){const $=new PageTextView(e);try{if(!await $.renderTextLayerAsync(F)||$._destroyed)return null}catch(Y){return console.error(Y),null}return C.append($._container),$}destroy(){this.remove(),this._container=null,this._destroyed=!0}remove(){this.destroyRenderTask(),this._container&&this._container.remove()}async renderTextLayerAsync(e){this.destroyRenderTask(),this.clear();const C=this._pageProxy.getViewport({scale:e}),F=this._pageProxy.streamTextContent();this._renderTask=pdfExports.renderTextLayer({container:this._container,textContentSource:F,viewport:C,enhanceTextSelection:!1});try{await this._renderTask.promise}catch(Y){if(Y.message==="TextLayer task cancelled.")return!1;throw Y}return this._container.querySelectorAll("span").forEach(Y=>{const V=document.createElement("span");V.classList.add("dummy-corner","bl");const te=document.createElement("span");te.classList.add("dummy-corner","br");const se=document.createElement("span");se.classList.add("dummy-corner","tr");const ne=document.createElement("span");ne.classList.add("dummy-corner","tl"),Y.append(V,te,se,ne)}),!0}clear(){this._container.innerHTML=""}destroyRenderTask(){this._renderTask&&(this._renderTask.cancel(),this._renderTask=null)}onPointerDown=e=>{this._divModeTimer&&(clearTimeout(this._divModeTimer),this._divModeTimer=null),typeof this._renderTask.expandTextDivs=="function"&&this._renderTask.expandTextDivs(!0)};onPointerUp=e=>{this._divModeTimer=setTimeout(()=>{typeof this._renderTask.expandTextDivs=="function"&&this._renderTask.expandTextDivs(!1),this._divModeTimer=null},300)}}const maxGeneration=65535,objectTypes={UNKNOWN:0,NULL:1,BOOLEAN:2,NUMBER:3,STRING_LITERAL:4,STRING_HEX:5,NAME:6,ARRAY:7,DICTIONARY:8,STREAM:9},valueTypes={UNKNOWN:0,NULL:1,BOOLEAN:2,NUMBER:3,STRING_LITERAL:4,STRING_HEX:5,NAME:6,ARRAY:7,DICTIONARY:8,STREAM:9,REF:10,COMMENT:11},dictTypes={XREF:"/XRef",XOBJECT:"/XObject",CATALOG:"/Catalog",PAGE_TREE:"/Pages",PAGE:"/Page",ANNOTATION:"/Annot",BORDER_STYLE:"/Border",OPTIONAL_CONTENT_GROUP:"/OCG",OPTIONAL_CONTENT_MD:"/OCMD",EXTERNAL_DATA:"/ExDATA",ACTION:"/Action",MEASURE:"/Measure",DEV_EXTENSIONS:"/DeveloperExtensions",GRAPHICS_STATE:"/ExtGState",CRYPT_FILTER:"/CryptFilter",SOFT_MASK:"/Mask",GROUP:"/Group",FONT:"/Font",FONT_DESCRIPTOR:"/FontDescriptor",ENCODING:"/Encoding",EMPTY:""},xRefTypes={TABLE:0,STREAM:1,HYBRID:2},xRefEntryTypes={FREE:0,NORMAL:1,COMPRESSED:2},streamFilters={ASCII85:"/ASCII85Decode",ASCIIHEX:"/ASCIIHexDecode",CCF:"/CCITTFaxDecode",CRYPT:"/Crypt",DCT:"/DCTDecode",FLATE:"/FlateDecode",JBIG2:"/JBIG2Decode",JPX:"/JPXDecode",LZW:"/LZWDecode",RLX:"/RunLengthDecode"},flatePredictors={NONE:1,TIFF:2,PNG_NONE:10,PNG_SUB:11,PNG_UP:12,PNG_AVERAGE:13,PNG_PAETH:14,PNG_OPTIMUM:15},streamTypes={XREF:"/XRef",OBJECT_STREAM:"/ObjStm",FORM_XOBJECT:"/XObject",METADATA_STREAM:"/Metadata"},supportedFilters=new Set([streamFilters.FLATE,streamFilters.DCT,streamFilters.JBIG2,streamFilters.JPX]),cryptVersions={RC4_40:1,RC4_128:2,AES_128:4,AES_256:5},cryptRevisions={RC4_40:2,RC4_128:3,AES_128:4,AES_256:5,AES_256_V2:6},cryptMethods={NONE:"/None",RC4:"/V2",AES_128:"/AESV2",AES_256:"/AESV3"},authEvents={DOC_OPEN:"/DocOpen",EMBEDDED_OPEN:"/EFOpen"},annotationTypes={TEXT:"/Text",LINK:"/Link",FREE_TEXT:"/FreeText",LINE:"/Line",SQUARE:"/Square",CIRCLE:"/Circle",POLYGON:"/Polygon",POLYLINE:"/PolyLine",HIGHLIGHT:"/Highlight",UNDERLINE:"/Underline",SQUIGGLY:"/Squiggly",STRIKEOUT:"/StrikeOut",STAMP:"/Stamp",CARET:"/Caret",INK:"/Ink",POPUP:"/Popup",FILE_ATTACHMENT:"/FileAttachment",SOUND:"/Sound",MOVIE:"/Movie",WIDGET:"/Widget",SCREEN:"/Screen",PRINTER_MARK:"/PrinterMark",TRAPNET:"/TrapNet",WATERMARK:"/Watermark",THREED:"/3D",REDACT:"/Redact",PROJECTION:"/Projection",RICH_MEDIA:"/RichMedia"},annotationStateModelTypes={MARKED:"/Marked",REVIEW:"/Review"},annotationMarkedStates={MARKED:"/Marked",UNMARKED:"/Unmarked"},annotationReviewStates={ACCEPTED:"/Accepted",REJECTED:"/Rejected",CANCELLED:"/Cancelled",COMPLETED:"/Completed",NONE:"/None"},annotationIconTypes={COMMENT:"/Comment",KEY:"/Key",NOTE:"/Note",HELP:"/Help",NEW_PARAGRAPH:"/NewParagraph",PARAGRAPH:"/Paragraph",INSERT:"/Insert"},freeTextIntents={PLAIN_TEXT:"/FreeText",WITH_CALLOUT:"/FreeTextCallout",CLICK_TO_TYPE:"/FreeTextTypeWriter"},markupAnnotationReplyTypes={REPLY:"/R",GROUP:"/Group"},stampTypes={DRAFT:"/Draft",NOT_APPROVED:"/NotApproved",APPROVED:"/Approved",AS_IS:"/AsIs",FOR_COMMENT:"/ForComment",EXPERIMENTAL:"/Experimental",FINAL:"/Final",SOLD:"/Sold",EXPIRED:"/Expired",PUBLIC:"/ForPublicRelease",NOT_PUBLIC:"/NotForPublicRelease",DEPARTMENTAL:"/Departmental",CONFIDENTIAL:"/Confidential",SECRET:"/TopSecret"},polyIntents={CLOUD:"/PolygonCloud",POLYGON_DIMENSION:"/PolygonDimension",POLYLINE_DIMENSION:"/PolyLineDimension"},lineIntents={ARROW:"/LineArrow",DIMENSION:"/LineDimension"},lineCaptionPositions={INLINE:"/Inline",TOP:"/Top"},lineEndingTypes={SQUARE:"/Square",CIRCLE:"/Circle",DIAMOND:"/Diamond",ARROW_OPEN:"/OpenArrow",ARROW_CLOSED:"/ClosedArrow",NONE:"/None",BUTT:"/Butt",ARROW_OPEN_R:"/ROpenArrow",ARROW_CLOSED_R:"/RClosedArrow",SLASH:"/Slash"},lineCapStyles={BUTT:0,ROUND:1,SQUARE:2},lineJoinStyles={MITER:0,ROUND:1,BEVEL:2},justificationTypes={LEFT:0,CENTER:1,RIGHT:2},renderingIntents={ABSOLUTE:"/AbsoluteColorimetric",RELATIVE:"/RelativeColorimetric",SATURATION:"/Saturation",PERCEPTUAL:"/Perceptual"},blendModes={NORMAL:"/Normal",COMPATIBLE:"/Compatible",MULTIPLY:"/Multiply",SCREEN:"/Screen",OVERLAY:"/Overlay",DARKEN:"/Darken",LIGHTEN:"/Lighten",COLOR_DODGE:"/ColorDodge",COLOR_BURN:"/ColorBurn",HARD_LIGHT:"/HardLight",SOFT_LIGHT:"/SoftLight",DIFFERENCE:"/Difference",EXCLUSION:"/Exclusion"},textRenderModes={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_USE_AS_CLIP:4,STROKE_USE_AS_CLIP:5,FILL_STROKE_USE_AS_CLIP:6,USE_AS_CLIP:7},colorSpaces={GRAYSCALE:"/DeviceGray",RGB:"/DeviceRGB",CMYK:"/DeviceCMYK",SPECIAL:"/DeviceN",SPECIAL_INDEXED:"/Indexed",SPECIAL_PATTERN:"/Pattern",SPECIAL_SEPARATION:"/Separation"},softMaskTypes={ALPHA:"/Alpha",LUMINOSITY:"/Luminosity"},borderEffects={NONE:"/S",CLOUDY:"/C"},borderStyles={SOLID:"/S",DASHED:"/D",BEVELED:"/B",INSET:"/I",UNDERLINE:"/U",NONE:"/N"},groupDictTypes={TRANSPARENCY:"/Transparency"},workerSrc=`
/**the most used char codes from the ASCII set */
const codes = {
  NULL: 0,
  BACKSPACE: 8,
  HORIZONTAL_TAB: 9,
  LINE_FEED: 10,
  VERTICAL_TAB: 11,
  FORM_FEED: 12,
  CARRIAGE_RETURN: 13,
  WHITESPACE: 32,
  EXCLAMATION_MARK: 33,
  DOUBLE_QUOTE: 34,
  HASH: 35,
  DOLLAR: 36,
  PERCENT: 37,
  AMPERSAND: 38,
  QUOTE: 39,
  L_PARENTHESE: 40,
  R_PARENTHESE: 41,
  ASTERISK: 42,
  PLUS: 43,
  COMMA: 44,
  MINUS: 45,
  DOT: 46,
  SLASH: 47,
  D_0: 48,
  D_1: 49,
  D_2: 50,
  D_3: 51,
  D_4: 52,
  D_5: 53,
  D_6: 54,
  D_7: 55,
  D_8: 56,
  D_9: 57,
  COLON: 58,
  SEMICOLON: 59,
  LESS: 60,
  EQUAL: 61,
  GREATER: 62,
  QUESTION_MARK: 63,
  AT: 64,
  A: 65,
  B: 66,
  C: 67,
  D: 68,
  E: 69,
  F: 70,
  G: 71,
  H: 72,
  I: 73,
  J: 74,
  K: 75,
  L: 76,
  M: 77,
  N: 78,
  O: 79,
  P: 80,
  Q: 81,
  R: 82,
  S: 83,
  T: 84,
  U: 85,
  V: 86,
  W: 87,
  X: 88,
  Y: 89,
  Z: 90,
  L_BRACKET: 91,
  BACKSLASH: 92,
  R_BRACKET: 93,
  CARET: 94,
  UNDERSCORE: 95,
  BACKTICK: 96,
  a: 97,
  b: 98,
  c: 99,
  d: 100,
  e: 101,
  f: 102,
  g: 103,
  h: 104,
  i: 105,
  j: 106,
  k: 107,
  l: 108,
  m: 109,
  n: 110,
  o: 111,
  p: 112,
  q: 113,
  r: 114,
  s: 115,
  t: 116,
  u: 117,
  v: 118,
  w: 119,
  x: 120,
  y: 121,
  z: 122,
  L_BRACE: 123,
  VERTICAL_LINE: 124,
  R_BRACE: 125,
  TILDE: 126,
};

/**char code sequences commonly used in PDF data */
const keywordCodes = {
  NULL: [codes.n, codes.u, codes.l, codes.l],

  OBJ: [codes.o, codes.b, codes.j],
  OBJ_END: [codes.e, codes.n, codes.d, codes.o, codes.b, codes.j],

  STREAM_START: [codes.s, codes.t, codes.r, codes.e, codes.a, codes.m],
  STREAM_END: [codes.e, codes.n, codes.d,
    codes.s, codes.t, codes.r, codes.e, codes.a, codes.m],

  DICT_START: [codes.LESS, codes.LESS],
  DICT_END: [codes.GREATER, codes.GREATER],

  ARRAY_START: [codes.L_BRACKET],
  ARRAY_END: [codes.R_BRACKET],
  
  STR_LITERAL_START: [codes.L_PARENTHESE],
  STR_LITERAL_END: [codes.R_PARENTHESE],

  STR_HEX_START: [codes.LESS],
  STR_HEX_END: [codes.GREATER],

  VERSION: [codes.PERCENT, codes.P, codes.D, codes.F, codes.MINUS],

  PREV: [codes.SLASH, codes.P, codes.r, codes.e, codes.v],
  TYPE: [codes.SLASH, codes.T, codes.y, codes.p, codes.e],
  SUBTYPE: [codes.SLASH, codes.S, codes.u, codes.b, codes.t, codes.y, codes.p, codes.e],
  FORM: [codes.SLASH, codes.F, codes.o, codes.r, codes.m],
  
  XREF_TABLE: [codes.x, codes.r, codes.e, codes.f],
  XREF_STREAM: [codes.SLASH, codes.X, codes.R, codes.e, codes.f],
  XREF_HYBRID: [codes.X, codes.R, codes.e, codes.f, codes.S, codes.t, codes.m],
    
  XREF_START: [codes.s, codes.t, codes.a, codes.r, codes.t, 
    codes.x, codes.r, codes.e, codes.f],
  TRAILER: [codes.t, codes.r, codes.a, codes.i, codes.l, codes.e, codes.r],
  END_OF_FILE: [codes.PERCENT, codes.PERCENT, codes.E, codes.O, codes.F],

  END_OF_LINE: [codes.CARRIAGE_RETURN, codes.LINE_FEED],

  TRUE: [codes.t, codes.r, codes.u, codes.e],
  FALSE: [codes.f, codes.a, codes.l, codes.s, codes.e],

  CMAP_BEGIN: [codes.b, codes.e, codes.g, codes.i, codes.n,
    codes.c, codes.m, codes.a, codes.p],
  CMAP_END: [codes.e, codes.n, codes.d,
    codes.c, codes.m, codes.a, codes.p],
  CMAP_BEGIN_CODE_RANGE: [codes.b, codes.e, codes.g, codes.i, codes.n,
    codes.c, codes.o, codes.d, codes.e, codes.s, codes.p, codes.a, codes.c, codes.e,
    codes.r, codes.a, codes.n, codes.g, codes.e],
  CMAP_END_CODE_RANGE: [codes.e, codes.n, codes.d,
    codes.c, codes.o, codes.d, codes.e, codes.s, codes.p, codes.a, codes.c, codes.e,
    codes.r, codes.a, codes.n, codes.g, codes.e],
  CMAP_BEGIN_CHAR: [codes.b, codes.e, codes.g, codes.i, codes.n,
    codes.b, codes.f, codes.c, codes.h, codes.a, codes.r],
  CMAP_END_CHAR: [codes.e, codes.n, codes.d,
    codes.b, codes.f, codes.c, codes.h, codes.a, codes.r],
  CMAP_BEGIN_RANGE: [codes.b, codes.e, codes.g, codes.i, codes.n,
    codes.b, codes.f, codes.r, codes.a, codes.n, codes.g, codes.e],
  CMAP_END_RANGE: [codes.e, codes.n, codes.d,
    codes.b, codes.f, codes.r, codes.a, codes.n, codes.g, codes.e],

  AP_STREAM_TEXT_END: [codes.E, codes.T],
};

/**value types that can be found in PDF file data */
const valueTypes = {
  UNKNOWN: 0,
  NULL: 1,
  BOOLEAN: 2,
  NUMBER: 3,
  STRING_LITERAL: 4,
  STRING_HEX: 5,
  NAME: 6,
  ARRAY: 7,
  DICTIONARY: 8,
  STREAM: 9,
  REF: 10,
  COMMENT: 11,
};

//#region static collections
/**
 * Each line is terminated by an end-of-line (EOL) marker
 */
// const EOL = [
//   codes.CARRIAGE_RETURN, 
//   codes.LINE_FEED,
// ];
  
/**
 * The delimiter  characters (, ), <, >, [, ], {, }, /,  and  %  are  special.  
 * They delimit syntactic entities such as strings, arrays, names, and comments.  
 * Any of these characters terminates the entity preceding it and is not included in the entity. 
 */
const delimiterChars = new Set([
  codes.PERCENT,
  codes.L_PARENTHESE,
  codes.R_PARENTHESE,
  codes.SLASH,
  codes.LESS,
  codes.GREATER,
  codes.L_BRACKET,
  codes.R_BRACKET,
  codes.L_BRACE,
  codes.R_BRACE,
]);
  
/**
 * White-space characters separate syntactic constructs such as names and numbers from each other.  
 * All white-space characters are  equivalent, except in comments, strings, and streams. 
 * In all other contexts, PDF treats any sequence of consecutive white-space characters as one character.
 */
const spaceChars = new Set([
  codes.NULL,
  codes.HORIZONTAL_TAB,
  codes.LINE_FEED,
  codes.FORM_FEED,
  codes.CARRIAGE_RETURN,
  codes.WHITESPACE,
]);
  
const digitChars = new Set([
  codes.D_0,
  codes.D_1,
  codes.D_2,
  codes.D_3,
  codes.D_4,
  codes.D_5,
  codes.D_6,
  codes.D_7,
  codes.D_8,
  codes.D_9,
]);

const newLineChars = new Set([
  codes.CARRIAGE_RETURN,
  codes.LINE_FEED,
]);
//#endregion

//#region static check functions
/**
 * check if the char is not a space char or a delimiter char
 * @param code char code
 * @returns 
 */
function isRegularChar(code) {
  if (isNaN(code)) {
    return false;
  }
  return !delimiterChars.has(code) && !spaceChars.has(code);
}

/**
 * check if the char is a space char or a delimiter char
 * @param code char code
 * @returns 
 */
function isNotRegularChar(code) {
  if (isNaN(code)) {
    return true;
  }
  return delimiterChars.has(code) || spaceChars.has(code);
}

function isDigit(code) {
  return digitChars.has(code);
}

function isNewLineChar(code) {
  return newLineChars.has(code);
}

function isSpaceChar(code) {
  return spaceChars.has(code);
}

function isNotSpaceChar(code) {
  return !spaceChars.has(code);
}

function isDelimiterChar(code) {
  return delimiterChars.has(code);
}

function isNotDelimiterChar(code) {
  return !delimiterChars.has(code);
}
//#endregion

let _data = new Uint8Array();
let _maxIndex = 0;

const _messageQueue = [];
let _busy = false;

self.onmessage = (event) => {
  if (_busy) {
    _messageQueue.push(event);
  } else {
    _busy = true;
    processData(event.data);
  }
};

function sendResponse(response) {
  self.postMessage(response);
  if (_messageQueue.length) {
    processData(_messageQueue.shift().data);
  } else {
    _busy = false;
  }
}

function processData(data) {
  const id = data.id;
  const name = data.name;

  if (name === "data-set") {
    if (data.bytes) {      
      const dataBytesArray = new Uint8Array(data.bytes);
      if (dataBytesArray?.length) {
        _data = dataBytesArray;
        _maxIndex = dataBytesArray.length - 1;
        sendResponse({id, name, type: "success"});
        return;
      }
    }
    sendResponse({id, name, type: "error", 
      message: "data-set: byte array is null or empty"});
    return; 
  }
  
  if (name === "data-reset") {
    const buffer = _data.buffer;
    _data = new Uint8Array();
    _maxIndex = 0;
    sendResponse({id, name, type: "success", bytes: buffer}, [buffer]);
    return; 
  }

  // console.log(JSON.stringify(data));
  try {
    let result;
    switch (name) { 
    // common cases
    case "is-outside":
      result = isOutside(...data.args);
      break;
    case "is-code-at":
      result = isCodeAt(...data.args);
      break;
    case "get-value-type-at":
      result = getValueTypeAt(...data.args);
      break;
    // search cases
    case "find-subarray-index":
      result = findSubarrayIndex(...data.args);
      break;
    case "find-char-index":
      result = findCharIndex(...data.args);
      break;
    case "find-new-line-index":
      result = findNewLineIndex(...data.args);
      break;
    case "find-space-index":result = findSpaceIndex(...data.args);
      break;
    case "find-non-space-index":
      result = findNonSpaceIndex(...data.args);
      break;
    case "find-delimiter-index":
      result = findDelimiterIndex(...data.args);
      break;
    case "find-non-delimiter-index":
      result = findNonDelimiterIndex(...data.args);
      break;
    case "find-regular-index":
      result = findRegularIndex(...data.args);
      break;
    case "find-irregular-index":
      result = findIrregularIndex(...data.args);
      break;
    // getting bounds cases  
    case "get-indirect-object-bounds":
      result = getIndirectObjectBoundsAt(...data.args);
      break;
    case "get-xref-table-bounds":
      result = getXrefTableBoundsAt(...data.args);
      break;
    case "get-dict-bounds":
      result = getDictBoundsAt(...data.args);
      break;
    case "get-array-bounds":
      result = getArrayBoundsAt(...data.args);
      break;
    case "get-hex-bounds":
      result = getHexBoundsAt(...data.args);
      break;
    case "get-literal-bounds":
      result = getLiteralBoundsAt(...data.args);
      break;
    // parsing cases
    case "parse-number":
      result = parseNumberAt(...data.args);
      break;
    case "parse-name":
      result = parseNameAt(...data.args);
      break;
    case "parse-string":
      result = parseStringAt(...data.args);
      break;
    case "parse-bool":
      result = parseBoolAt(...data.args);
      break;
    case "parse-number-array":
      result = parseNumberArrayAt(...data.args);
      break;
    case "parse-name-array":
      result = parseNameArrayAt(...data.args);
      break;
    case "parse-dict-type":
      result = parseDictType(...data.args);
      break;
    case "parse-dict-subtype":
      result = parseDictSubtype(...data.args);
      break;
    case "parse-dict-property-by-name":
      result = parseDictPropertyByName(...data.args);
      break;
    // skip cases
    case "skip-empty":
      result = skipEmptyChars(...data.args);
      break;
    case "skip-to-next-name":
      result = skipToNextName(...data.args);
      break;
    // getting char/codes cases
    case "slice-char-codes":
      result = sliceCharCodes(...data.args);
      break;
    case "slice-chars":
      result = sliceChars(...data.args);
      break;
    case "get-char-code":
      result = getCharCode(...data.args);
      break;
    default:
      throw new Error("Unknown command name: " + name);
    }    
    // console.log(JSON.stringify(result));
    sendResponse({id, name, type: "success", result});
  } catch (e) {
    // console.log(JSON.stringify(e));
    sendResponse({id, name, type: "error", message: e.message});
  }
}

//#region common functions  
function isOutside(index) {
  return (index < 0 || index > _maxIndex);
}

function isCodeAt(index, code) {
  return getCharCode(index) === code;
}

function getValueTypeAt(start, skipEmpty = true)  {
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start)) {
    return null;
  }

  const arr = _data;
  const i = start;
  const charCode = arr[i];

  let tempIndex;
  switch (charCode) {
  case codes.SLASH:
    if (isRegularChar(arr[i + 1])) {
      return valueTypes.NAME;
    } 
    return valueTypes.UNKNOWN;
  case codes.L_BRACKET:
    return valueTypes.ARRAY;
  case codes.L_PARENTHESE:
    return valueTypes.STRING_LITERAL;
  case codes.LESS:
    if (codes.LESS === arr[i + 1]) {          
      return valueTypes.DICTIONARY;
    }
    return valueTypes.STRING_HEX;
  case codes.PERCENT:
    return valueTypes.COMMENT;
  case codes.D_0:
  case codes.D_1:
  case codes.D_2:
  case codes.D_3:
  case codes.D_4:
  case codes.D_5:
  case codes.D_6:
  case codes.D_7:
  case codes.D_8:
  case codes.D_9:
    tempIndex = findDelimiterIndex(true, i + 1);
    if (tempIndex !== -1) {
      const refEndIndex = findCharIndex(codes.R, false, tempIndex - 1);
      if (refEndIndex !== -1 && refEndIndex > i && !isRegularChar(arr[refEndIndex + 1])) {
        return valueTypes.REF;
      }
    }
    return valueTypes.NUMBER;
  case codes.DOT:
  case codes.MINUS:
    if (isDigit(arr[i + 1])) {          
      return valueTypes.NUMBER;
    }
    return valueTypes.UNKNOWN;
  case codes.s:
    if (arr[i + 1] === codes.t
        && arr[i + 2] === codes.r
        && arr[i + 3] === codes.e
        && arr[i + 4] === codes.a
        && arr[i + 5] === codes.m) {
      return valueTypes.STREAM;
    }
    return valueTypes.UNKNOWN;
  case codes.t:
    if (arr[i + 1] === codes.r
        && arr[i + 2] === codes.u
        && arr[i + 3] === codes.e) {
      return valueTypes.BOOLEAN;
    }
    return valueTypes.UNKNOWN;
  case codes.f:
    if (arr[i + 1] === codes.a
        && arr[i + 2] === codes.l
        && arr[i + 3] === codes.s
        && arr[i + 4] === codes.e) {
      return valueTypes.BOOLEAN;
    }
    return valueTypes.UNKNOWN;
  default:
    return valueTypes.UNKNOWN;
  }
} 
//#endregion

//#region search functions
function findSubarrayIndex(sub, options) {
  const arr = _data;
  if (!sub?.length) {
    return null;
  }

  const direction = options?.direction ?? true;
  const minIndex = Math.max(Math.min(options?.minIndex ?? 0, _maxIndex), 0);
  const maxIndex = Math.max(Math.min(options?.maxIndex ?? _maxIndex, _maxIndex), 0);
  const allowOpened = !options?.closedOnly;

  let i = direction
    ? minIndex
    : maxIndex; 

  let j; 
  if (direction) { 
    outer_loop:
    for (i; i <= maxIndex; i++) {
      for (j = 0; j < sub.length; j++) {
        if (arr[i + j] !== sub[j]) {
          continue outer_loop;
        }
      }
      if (allowOpened || !isRegularChar(arr[i + j])) {
        return {start: i, end: i + j - 1};
      }
    }
  } else {
    const subMaxIndex = sub.length - 1;
    outer_loop:
    for (i; i >= minIndex; i--) {
      for (j = 0; j < sub.length; j++) {
        if (arr[i - j] !== sub[subMaxIndex - j]) {
          continue outer_loop;
        }
      }
      if (allowOpened || !isRegularChar(arr[i - j])) {
        return {start: i - j + 1, end: i};
      }
    }
  }

  return null;
}

function findCharIndex(charCode, direction = true, start = undefined) {    

  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 

  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (arr[i] === charCode) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (arr[i] === charCode) {
        return i;
      }
    }
  }

  return -1; 
}

function findNewLineIndex(direction = true, start = undefined) {
  let lineBreakIndex;     

  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isNewLineChar(arr[i])) {
        lineBreakIndex = i;
        break;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isNewLineChar(arr[i])) {
        lineBreakIndex = i;
        break;
      }
    }
  }

  if (lineBreakIndex === undefined) {
    return -1;
  }

  if (direction) {  
    if (_data[lineBreakIndex] === codes.CARRIAGE_RETURN 
      && _data[lineBreakIndex + 1] === codes.LINE_FEED) {
      lineBreakIndex++;
    }  
    return Math.min(lineBreakIndex + 1, _maxIndex);
  } else {        
    if (_data[lineBreakIndex] === codes.LINE_FEED 
      && _data[lineBreakIndex - 1] === codes.CARRIAGE_RETURN) {
      lineBreakIndex--;
    }  
    return Math.max(lineBreakIndex - 1, 0);
  }
}

function findSpaceIndex(direction = true, start = undefined) {
  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isSpaceChar(arr[i])) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isSpaceChar(arr[i])) {
        return i;
      }
    }
  }
  
  return -1;
}

function findNonSpaceIndex(direction = true, start = undefined) {
  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isNotSpaceChar(arr[i])) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isNotSpaceChar(arr[i])) {
        return i;
      }
    }
  }
  
  return -1;
}

function findDelimiterIndex(direction = true, start = undefined) {
  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isDelimiterChar(arr[i])) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isDelimiterChar(arr[i])) {
        return i;
      }
    }
  }
  
  return -1; 
}

function findNonDelimiterIndex(direction = true, start = undefined) {    
  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isNotDelimiterChar(arr[i])) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isNotDelimiterChar(arr[i])) {
        return i;
      }
    }
  }
  
  return -1;
}

function findRegularIndex(direction = true, start = undefined) {
  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isRegularChar(arr[i])) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isRegularChar(arr[i])) {
        return i;
      }
    }
  }
  
  return -1;
}

function findIrregularIndex(direction = true, start = undefined) {  
  const arr = _data;
  let i = isNaN(start)
    ? direction
      ? 0
      : _maxIndex
    : start; 
    
  if (direction) {        
    for (i; i <= _maxIndex; i++) {
      if (isNotRegularChar(arr[i])) {
        return i;
      }
    }    
  } else {        
    for (i; i >= 0; i--) {
      if (isNotRegularChar(arr[i])) {
        return i;
      }
    }
  }
  
  return -1;
}
//#endregion

//#region get bounds functions  
function getIndirectObjectBoundsAt(start, skipEmpty = true) {   
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start)) {
    return null;
  }    

  const objStartIndex = findSubarrayIndex(keywordCodes.OBJ, 
    {minIndex: start, closedOnly: true});
  if (!objStartIndex) {
    return null;
  }      

  let contentStart = findNonSpaceIndex(true, objStartIndex.end + 1);
  if (contentStart === -1){
    return null;
  }    
  const objEndIndex = findSubarrayIndex(keywordCodes.OBJ_END, 
    {minIndex: contentStart, closedOnly: true});
  if (!objEndIndex) {
    return null;
  }
  let contentEnd = findNonSpaceIndex(false, objEndIndex.start - 1);

  if (getCharCode(contentStart) === codes.LESS
      && getCharCode(contentStart + 1) === codes.LESS
      && getCharCode(contentEnd - 1) === codes.GREATER
      && getCharCode(contentEnd) === codes.GREATER) {
    // object is dict. exclude bounds from content
    contentStart += 2;
    contentEnd -=2;
  }

  return {
    start: objStartIndex.start, 
    end: objEndIndex.end,
    contentStart,
    contentEnd,
  };
} 
  
function getXrefTableBoundsAt(start, skipEmpty = true) {   
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) || _data[start] !== codes.x) {
    return null;
  }

  const xrefStart = findSubarrayIndex(keywordCodes.XREF_TABLE, 
    {minIndex: start});
  if (!xrefStart) {
    return null;
  }     
  const contentStart = findNonSpaceIndex(true, xrefStart.end + 1);
  if (contentStart === -1){
    return null;
  }   
  const xrefEnd = findSubarrayIndex(keywordCodes.TRAILER, 
    {minIndex: xrefStart.end + 1});
  if (!xrefEnd) {
    return null;
  } 
  const contentEnd = findNonSpaceIndex(false, xrefEnd.start - 1);

  if (contentEnd < contentStart) {
    // should be only possible in an empty xref, which is not allowed
    return null;
  }

  return {
    start: xrefStart.start, 
    end: xrefEnd.end,
    contentStart,
    contentEnd,
  };
}

function getDictBoundsAt(start, skipEmpty = true) {   
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) 
      || _data[start] !== codes.LESS
      || _data[start + 1] !== codes.LESS) {
    return null;
  }
     
  const contentStart = findNonSpaceIndex(true, start + 2);
  if (contentStart === -1){
    return null;
  }  
    
  let dictOpened = 1;
  let dictBound = true;
  let literalOpened = 0;
  let i = contentStart;    
  let code;
  let prevCode;
  while (dictOpened) {
    prevCode = code;
    code = _data[i++];

    if (code === codes.L_PARENTHESE
        && (!literalOpened || prevCode !== codes.BACKSLASH)) {
      // increase string literal nesting
      literalOpened++;
    }

    if (code === codes.R_PARENTHESE
        && (literalOpened && prevCode !== codes.BACKSLASH)) {
      // decrease string literal nesting
      literalOpened--;
    }

    if (literalOpened) {
      // ignore 'less' and 'greater' signs while being inside a literal
      continue;
    }

    if (!dictBound) {
      if (code === codes.LESS && code === prevCode) {
        dictOpened++;
        dictBound = true;
      } else if (code === codes.GREATER && code === prevCode) {
        dictOpened--;
        dictBound = true;
      }
    } else {        
      dictBound = false;
    }
  }
  const end = i - 1;
 
  const contentEnd = findNonSpaceIndex(false, end - 2);
  if (contentEnd < contentStart) {
    // should be possible only in an empty dict
    return {
      start, 
      end,
    };
  }

  return {
    start, 
    end,
    contentStart,
    contentEnd,
  };
}
  
function getArrayBoundsAt(start, skipEmpty = true) {
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) || _data[start] !== codes.L_BRACKET) {
    return null;
  }

  let arraysOpened = 1;
  let i = start + 1;    
  let code;
  while (arraysOpened) {
    code = _data[i++];
    if (code === codes.L_BRACKET) {
      arraysOpened++;
    } else if (code === codes.R_BRACKET) {
      arraysOpened--;
    }
  }
  const arrayEnd = i - 1;
  if (arrayEnd - start < 1) {
    return null;
  }

  return {start, end: arrayEnd};
}
      
function getHexBoundsAt(start, skipEmpty = true) {   
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) || getCharCode(start) !== codes.LESS) {
    return null;
  }

  const end = findCharIndex(codes.GREATER, true, start + 1);
  if (end === -1) {
    return null;
  }

  return {start, end};
}  

function getLiteralBoundsAt(start, skipEmpty = true) {       
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) || getCharCode(start) !== codes.L_PARENTHESE) {
    return null;
  }

  let i = start;
  let code;
  let escaped = false;
  let opened = 0;

  while (opened || code !== codes.R_PARENTHESE || escaped) {
    if (i > _maxIndex) {
      return null;
    }

    code = getCharCode(i++);

    if (!escaped) {
      if (code === codes.L_PARENTHESE) {
        opened += 1;
      } else if (opened && code === codes.R_PARENTHESE) {
        opened -= 1;
      }
    }
      
    if (!escaped && code === codes.BACKSLASH) {
      escaped = true;
    } else {
      escaped = false;
    }
  }

  return {start, end: i - 1};
}
//#endregion

//#region parse functions 
function parseNumberAt(start, float = false, skipEmpty = true) {
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) || !isRegularChar(_data[start])) {
    return null;
  }

  let i = start;
  let numberStr = "";
  let value = _data[i];
  if (value === codes.MINUS) {
    numberStr += "-";
    value = _data[++i];
  } else if (value === codes.DOT) {
    numberStr += "0.";
    value = _data[++i];
  }
  while (isDigit(value)
      || (float && value === codes.DOT)) {
    numberStr += String.fromCharCode(value);
    value = _data[++i];
  }

  return numberStr 
    ? {value: +numberStr, start, end: i - 1}
    : null;
}
  
function parseNameAt(start, includeSlash = true, skipEmpty = true) {
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start) || _data[start] !== codes.SLASH) {
    return null;
  }

  let i = start + 1;
  let result = includeSlash
    ? "/"
    : "";
  let value = _data[i];
  while (isRegularChar(value)) {
    result += String.fromCharCode(value);
    value = _data[++i];
  }

  return result.length > 1 
    ? {value: result, start, end: i - 1}
    : null;
} 
  
function parseStringAt(start, skipEmpty = true) {
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }
  if (isOutside(start)) {
    return null;
  }

  let i = start;
  let result = "";
  let value = _data[i];
  while (isRegularChar(value)) {
    result += String.fromCharCode(value);
    value = _data[++i];
  }

  return result.length !== 0 
    ? {value: result, start, end: i - 1}
    : null;
} 
  
function parseBoolAt(start, skipEmpty = true)  {
  if (skipEmpty) {
    start = skipEmptyChars(start);
  }    

  if (isOutside(start)) {
    return null;
  }

  const nearestDelimiter = findDelimiterIndex(true, start);

  const isTrue = findSubarrayIndex(keywordCodes.TRUE, {
    minIndex: start, 
    maxIndex: nearestDelimiter === -1 ? _maxIndex : nearestDelimiter,
  });
  if (isTrue) {
    return {value: true, start, end: isTrue.end};
  }    
    
  const isFalse = findSubarrayIndex(keywordCodes.FALSE, {
    minIndex: start,      
    maxIndex: nearestDelimiter === -1 ? _maxIndex : nearestDelimiter,
  });
  if (isFalse) {
    return {value: false, start, end: isFalse.end};
  }

  return null;
} 
  
function parseNumberArrayAt(start, float = true, skipEmpty = true) {
  const arrayBounds = getArrayBoundsAt(start, skipEmpty);
  if (!arrayBounds) {
    return null;
  }

  const numbers = [];
  let current;
  let i = arrayBounds.start + 1;
  while(i < arrayBounds.end) {
    current = parseNumberAt(i, float, true);
    if (!current) {
      break;
    }
    numbers.push(current.value);
    i = current.end + 1;
  }

  return {value: numbers, start: arrayBounds.start, end: arrayBounds.end};
}  
  
function parseNameArrayAt(start, includeSlash = true, 
  skipEmpty = true) {
  const arrayBounds = getArrayBoundsAt(start, skipEmpty);
  if (!arrayBounds) {
    return null;
  }

  const names = [];
  let current;
  let i = arrayBounds.start + 1;
  while(i < arrayBounds.end) {
    current = parseNameAt(i, includeSlash, true);
    if (!current) {
      break;
    }
    names.push(current.value);
    i = current.end + 1;
  }

  return {value: names, start: arrayBounds.start, end: arrayBounds.end};
}  
  
function parseDictType(bounds) {
  return parseDictPropertyByName(keywordCodes.TYPE, bounds);   
} 
  
function parseDictSubtype(bounds) {
  return parseDictPropertyByName(keywordCodes.SUBTYPE, bounds);   
} 
  
function parseDictPropertyByName(propName, bounds) {
  const arr = _data;
  if (!propName?.length) {
    return null;
  }

  const minIndex = Math.max(Math.min(bounds.start ?? 0, _maxIndex), 0);
  const maxIndex = Math.max(Math.min(bounds.end ?? _maxIndex, _maxIndex), 0);

  let propNameBounds;
  let i = minIndex;
  let j;
  let code;
  let prevCode;
  let dictOpened = 0;
  let dictBound = true;
  let literalOpened = 0;
  outer_loop:
  for (i; i <= maxIndex; i++) {
    prevCode = code;
    code = arr[i];
      
    // check if literal opens
    if (code === codes.L_PARENTHESE
        && (!literalOpened || prevCode !== codes.BACKSLASH)) {
      // increase string literal nesting
      literalOpened++;
    }

    // check if literal closes
    if (code === codes.R_PARENTHESE
        && (literalOpened && prevCode !== codes.BACKSLASH)) {
      // decrease string literal nesting
      literalOpened--;
    }

    if (literalOpened) {
      // ignore all bytes while being inside a literal
      continue;
    }

    // check if dict opens or closes
    if (!dictBound) {
      if (code === codes.LESS && code === prevCode) {
        dictOpened++;
        dictBound = true;
      } else if (code === codes.GREATER && code === prevCode) {
        dictOpened--;
        dictBound = true;
      }
    } else {        
      dictBound = false;
    }

    // compare next j values to the corresponding values of the sought name
    for (j = 0; j < propName.length; j++) {
      if (arr[i + j] !== propName[j]) {
        continue outer_loop;
      }
    }

    if (dictOpened !== 1) {
      // the found property name is not inside the topmost dict
      continue;
    }

    // check if name is closed
    if (!isRegularChar(arr[i + j])) {
      propNameBounds = {start: i, end: i + j - 1};
      break;
    }
  }
    
  if (!propNameBounds) {
    // the property name is not found
    return null;
  }

  // parse the property value
  const type = parseNameAt(propNameBounds.end + 1);
  if (!type) {
    return null;
  }

  return type.value;     
} 
//#endregion 

//#region skip functions
function skipEmptyChars(start) {
  let index = findNonSpaceIndex(true, start);
  if (index === -1) {
    return -1;
  }
  if (_data[index] === codes.PERCENT) {
    // it's a comment. skip it
    const afterComment = findNewLineIndex(true, index + 1);
    if (afterComment === -1) {
      return -1;
    }
    index = findNonSpaceIndex(true, afterComment);
  }
  return index;
}

function skipToNextName(start, max) {
  start ||= 0;
  max = max 
    ? Math.min(max, _maxIndex)
    : 0;
  if (max < start) {
    return -1;
  }

  let i = start;
  while (i <= max) {      
    const value = getValueTypeAt(i, true);
    if (value) {
      let skipValueBounds;
      let parseResult;
      switch (value) {
      case valueTypes.DICTIONARY:
        skipValueBounds = getDictBoundsAt(i, false);
        break;
      case valueTypes.ARRAY:
        skipValueBounds = getArrayBoundsAt(i, false);
        break;
      case valueTypes.STRING_LITERAL:            
        skipValueBounds = getLiteralBoundsAt(i, false);
        break; 
      case valueTypes.STRING_HEX: 
        skipValueBounds = getHexBoundsAt(i, false);
        break; 
      case valueTypes.NUMBER:
        parseResult = parseNumberAt(i, true, false);
        if (parseResult) {
          skipValueBounds = parseResult;
        }
        break; 
      case valueTypes.BOOLEAN:
        parseResult = parseBoolAt(i, false);
        if (parseResult) {
          skipValueBounds = parseResult;
        }
        break;
      case valueTypes.COMMENT:
        // TODO: Add skip comment
        break;
      case valueTypes.NAME:
        return i;
      default:
        i++;
        continue;
      }   
      if (skipValueBounds) {
        i = skipValueBounds.end + 1;
        skipValueBounds = null;     
        continue;
      }
    }
    i++;
  }
  return -1;
}
//#endregion

//#region get chars/codes functions
function sliceCharCodes(start, end = undefined) {
  return _data.slice(start, (end || start) + 1);
}

function sliceChars(start, end = undefined) {
  return String.fromCharCode(..._data.slice(start, (end || start) + 1));
}

function getCharCode(index) {    
  return _data[index];
}  
//#endregion
`;class BgDataParser{static _maxWorkersCount=navigator.hardwareConcurrency||4;static _workerTimeout=60*1e3;static _workerSrc=(()=>{const e=new Blob([workerSrc],{type:"text/plain;charset=utf-8;"});return URL.createObjectURL(e)})();static _workerPool=[];static _freeWorkers=new Set;_data;_maxIndex;get maxIndex(){return this._maxIndex}_workerPromise;_prevWorkerReleasePromise;_workerOnMessageHandlers=new Set;_commandsInProgress=0;constructor(e){if(!e?.length)throw new Error("Data is empty");if(!BgDataParser._workerSrc)throw new Error("Worker source is not initialized");this._data=e.buffer,this._maxIndex=e.length-1}static tryGetParser(e){try{return new BgDataParser(e)}catch(C){return console.error(C),null}}static destroy(){this._freeWorkers.clear(),this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0}static async getFreeWorkerFromPoolAsync(){if(this._freeWorkers.size){const C=this._freeWorkers.values().next().value;return this._freeWorkers.delete(C),C}if(this._workerPool.length<this._maxWorkersCount){const C=new Worker(this._workerSrc);return this._workerPool.push(C),C}return await new Promise((C,F)=>{const $=performance.now(),Y=setInterval(()=>{if(this._freeWorkers.size){const V=this._freeWorkers.values().next().value;this._freeWorkers.delete(V),clearInterval(Y),C(V)}performance.now()-$>this._workerTimeout&&(clearInterval(Y),F("Free worker waiting timeout exceeded"))},20)})}static returnWorkerToPool(e){this._freeWorkers.add(e)}static async transferDataToWorker(e,C){const F=new Promise(($,Y)=>{e.onmessage=V=>{V.data.type==="success"?$():(console.log(V),console.log(V.data),Y(V))},e.onerror=V=>{console.log(V),console.log(V.message),Y(V)},e.postMessage({name:"data-set",bytes:C},[C])});try{await F}catch($){throw console.error($),new Error("Error while transfering parser data to worker")}}static async transferDataFromWorker(e){const C=new Promise((F,$)=>{e.onmessage=Y=>{if(Y.data.type==="success"){const V=Y.data.bytes;F(V)}else $(Y)},e.onerror=Y=>$(Y),e.postMessage({name:"data-reset"})});try{return await C}catch{throw new Error("Error while transfering parser data from worker")}}destroy(){}async getSubParserAsync(e,C){const F=await this.execCommandAsync("slice-char-codes",[e,C]);return BgDataParser.tryGetParser(F)}isOutside(e){return e<0||e>this._maxIndex}async isCodeAtAsync(e,C){return await this.execCommandAsync("is-code-at",[e,C])}async getValueTypeAtAsync(e,C=!0){return await this.execCommandAsync("get-value-type-at",[e,C])}async findSubarrayIndexAsync(e,C){return await this.execCommandAsync("find-subarray-index",[e,C])}async findCharIndexAsync(e,C=!0,F){return await this.execCommandAsync("find-char-index",[e,C,F])}async findNewLineIndexAsync(e=!0,C){return await this.execCommandAsync("find-new-line-index",[e,C])}async findSpaceIndexAsync(e=!0,C){return await this.execCommandAsync("find-space-index",[e,C])}async findNonSpaceIndexAsync(e=!0,C){return await this.execCommandAsync("find-non-space-index",[e,C])}async findDelimiterIndexAsync(e=!0,C){return await this.execCommandAsync("find-delimiter-index",[e,C])}async findNonDelimiterIndexAsync(e=!0,C){return await this.execCommandAsync("find-non-delimiter-index",[e,C])}async findRegularIndexAsync(e=!0,C){return await this.execCommandAsync("find-regular-index",[e,C])}async findIrregularIndexAsync(e=!0,C){return await this.execCommandAsync("find-irregular-index",[e,C])}async getIndirectObjectBoundsAtAsync(e,C=!0){return await this.execCommandAsync("get-indirect-object-bounds",[e,C])}async getXrefTableBoundsAtAsync(e,C=!0){return await this.execCommandAsync("get-xref-table-bounds",[e,C])}async getDictBoundsAtAsync(e,C=!0){return await this.execCommandAsync("get-dict-bounds",[e,C])}async getArrayBoundsAtAsync(e,C=!0){return await this.execCommandAsync("get-array-bounds",[e,C])}async getHexBoundsAtAsync(e,C=!0){return await this.execCommandAsync("get-hex-bounds",[e,C])}async getLiteralBoundsAtAsync(e,C=!0){return await this.execCommandAsync("get-literal-bounds",[e,C])}async parseNumberAtAsync(e,C=!1,F=!0){return await this.execCommandAsync("parse-number",[e,C,F])}async parseNameAtAsync(e,C=!0,F=!0){return await this.execCommandAsync("parse-name",[e,C,F])}async parseStringAtAsync(e,C=!0){return await this.execCommandAsync("parse-string",[e,C])}async parseBoolAtAsync(e,C=!0){return await this.execCommandAsync("parse-bool",[e,C])}async parseNumberArrayAtAsync(e,C=!0,F=!0){return await this.execCommandAsync("parse-number-array",[e,C,F])}async parseNameArrayAtAsync(e,C=!0,F=!0){return await this.execCommandAsync("parse-name-array",[e,C,F])}async parseDictTypeAsync(e){return await this.execCommandAsync("parse-dict-type",[e])}async parseDictSubtypeAsync(e){return await this.execCommandAsync("parse-dict-subtype",[e])}async parseDictPropertyByNameAsync(e,C){return await this.execCommandAsync("parse-dict-property-by-name",[e,C])}async skipEmptyAsync(e){return await this.execCommandAsync("skip-empty",[e])}async skipToNextNameAsync(e,C){return await this.execCommandAsync("skip-to-next-name",[e,C])}async sliceCharCodesAsync(e,C){return await this.execCommandAsync("slice-char-codes",[e,C])}async sliceCharsAsync(e,C){return await this.execCommandAsync("slice-chars",[e,C])}onWorkerMessage=e=>{for(const C of this._workerOnMessageHandlers)C(e)};onWorkerError=e=>{throw new Error(`Background worker error: ${e.message}`)};async releaseWorkerAsync(e){this._workerPromise=null;const C=await BgDataParser.transferDataFromWorker(e);this._data=C,e.onmessage=null,e.onerror=null,BgDataParser.returnWorkerToPool(e),this._prevWorkerReleasePromise=null}async getWorkerAsync(){return this._prevWorkerReleasePromise&&await this._prevWorkerReleasePromise,this._workerPromise||(this._workerPromise=new Promise(async(C,F)=>{const $=this._data,Y=await BgDataParser.getFreeWorkerFromPoolAsync();await BgDataParser.transferDataToWorker(Y,$),Y.onmessage=this.onWorkerMessage,Y.onerror=this.onWorkerError;const V=setInterval(async()=>{this._commandsInProgress>0||this._workerOnMessageHandlers.size||(clearInterval(V),this._prevWorkerReleasePromise=this.releaseWorkerAsync(Y))},50);C(Y)})),await this._workerPromise}async execCommandAsync(e,C=[]){this._commandsInProgress++;const F=await this.getWorkerAsync(),$=UUID.getRandomUuid(),Y=new Promise((te,se)=>{const ne=ee=>{ee.data.id===$&&(this._workerOnMessageHandlers.delete(ne),ee.data.type==="error"?se(`Background worker error: ${ee.data.message}`):te(ee.data.result))};this._workerOnMessageHandlers.add(ne)});F.postMessage({id:$,name:e,args:C});const V=await Y;return this._commandsInProgress--,V}}const codes={NULL:0,BACKSPACE:8,HORIZONTAL_TAB:9,LINE_FEED:10,VERTICAL_TAB:11,FORM_FEED:12,CARRIAGE_RETURN:13,WHITESPACE:32,EXCLAMATION_MARK:33,DOUBLE_QUOTE:34,HASH:35,DOLLAR:36,PERCENT:37,AMPERSAND:38,QUOTE:39,L_PARENTHESE:40,R_PARENTHESE:41,ASTERISK:42,PLUS:43,COMMA:44,MINUS:45,DOT:46,SLASH:47,D_0:48,D_1:49,D_2:50,D_3:51,D_4:52,D_5:53,D_6:54,D_7:55,D_8:56,D_9:57,COLON:58,SEMICOLON:59,LESS:60,EQUAL:61,GREATER:62,QUESTION_MARK:63,AT:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,L_BRACKET:91,BACKSLASH:92,R_BRACKET:93,CARET:94,UNDERSCORE:95,BACKTICK:96,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,L_BRACE:123,VERTICAL_LINE:124,R_BRACE:125,TILDE:126},keywordCodes={NULL:[codes.n,codes.u,codes.l,codes.l],OBJ:[codes.o,codes.b,codes.j],OBJ_END:[codes.e,codes.n,codes.d,codes.o,codes.b,codes.j],STREAM_START:[codes.s,codes.t,codes.r,codes.e,codes.a,codes.m],STREAM_END:[codes.e,codes.n,codes.d,codes.s,codes.t,codes.r,codes.e,codes.a,codes.m],DICT_START:[codes.LESS,codes.LESS],DICT_END:[codes.GREATER,codes.GREATER],ARRAY_START:[codes.L_BRACKET],ARRAY_END:[codes.R_BRACKET],STR_LITERAL_START:[codes.L_PARENTHESE],STR_LITERAL_END:[codes.R_PARENTHESE],STR_HEX_START:[codes.LESS],STR_HEX_END:[codes.GREATER],VERSION:[codes.PERCENT,codes.P,codes.D,codes.F,codes.MINUS],PREV:[codes.SLASH,codes.P,codes.r,codes.e,codes.v],TYPE:[codes.SLASH,codes.T,codes.y,codes.p,codes.e],SUBTYPE:[codes.SLASH,codes.S,codes.u,codes.b,codes.t,codes.y,codes.p,codes.e],FORM:[codes.SLASH,codes.F,codes.o,codes.r,codes.m],XREF_TABLE:[codes.x,codes.r,codes.e,codes.f],XREF_STREAM:[codes.SLASH,codes.X,codes.R,codes.e,codes.f],XREF_HYBRID:[codes.X,codes.R,codes.e,codes.f,codes.S,codes.t,codes.m],XREF_START:[codes.s,codes.t,codes.a,codes.r,codes.t,codes.x,codes.r,codes.e,codes.f],TRAILER:[codes.t,codes.r,codes.a,codes.i,codes.l,codes.e,codes.r],END_OF_FILE:[codes.PERCENT,codes.PERCENT,codes.E,codes.O,codes.F],END_OF_LINE:[codes.CARRIAGE_RETURN,codes.LINE_FEED],TRUE:[codes.t,codes.r,codes.u,codes.e],FALSE:[codes.f,codes.a,codes.l,codes.s,codes.e],CMAP_BEGIN:[codes.b,codes.e,codes.g,codes.i,codes.n,codes.c,codes.m,codes.a,codes.p],CMAP_END:[codes.e,codes.n,codes.d,codes.c,codes.m,codes.a,codes.p],CMAP_BEGIN_CODE_RANGE:[codes.b,codes.e,codes.g,codes.i,codes.n,codes.c,codes.o,codes.d,codes.e,codes.s,codes.p,codes.a,codes.c,codes.e,codes.r,codes.a,codes.n,codes.g,codes.e],CMAP_END_CODE_RANGE:[codes.e,codes.n,codes.d,codes.c,codes.o,codes.d,codes.e,codes.s,codes.p,codes.a,codes.c,codes.e,codes.r,codes.a,codes.n,codes.g,codes.e],CMAP_BEGIN_CHAR:[codes.b,codes.e,codes.g,codes.i,codes.n,codes.b,codes.f,codes.c,codes.h,codes.a,codes.r],CMAP_END_CHAR:[codes.e,codes.n,codes.d,codes.b,codes.f,codes.c,codes.h,codes.a,codes.r],CMAP_BEGIN_RANGE:[codes.b,codes.e,codes.g,codes.i,codes.n,codes.b,codes.f,codes.r,codes.a,codes.n,codes.g,codes.e],CMAP_END_RANGE:[codes.e,codes.n,codes.d,codes.b,codes.f,codes.r,codes.a,codes.n,codes.g,codes.e],AP_STREAM_TEXT_END:[codes.E,codes.T]};class NaiveBytePatternSearch{_pattern;constructor(e){if(!e?.length)throw new Error("Pattern is empty");this._pattern=e}*run(e){const C=this._pattern;if(!e?.length||e.length<C.length)return-1;let F=!1,$=0,Y=0;e:for($;$<e.length;$++){for(Y=0;Y<C.length;Y++)if(e[$+Y]!==C[Y])continue e;F=!0,yield $}if(!F)return-1}*runBackwards(e){const C=this._pattern;if(!e?.length||e.length<C.length)return-1;let F=!1,$=e.length-1,Y=0;const V=C.length-1;e:for($;$>=0;$--){for(Y=0;Y<C.length;Y++)if(e[$-Y]!==C[V-Y])continue e;F=!0,yield $-Y+1}if(!F)return-1}}class SyncDataParser{static EOL=[codes.CARRIAGE_RETURN,codes.LINE_FEED];static delimiterChars=new Set([codes.PERCENT,codes.L_PARENTHESE,codes.R_PARENTHESE,codes.SLASH,codes.LESS,codes.GREATER,codes.L_BRACKET,codes.R_BRACKET,codes.L_BRACE,codes.R_BRACE]);static spaceChars=new Set([codes.NULL,codes.HORIZONTAL_TAB,codes.LINE_FEED,codes.FORM_FEED,codes.CARRIAGE_RETURN,codes.WHITESPACE]);static digitChars=new Set([codes.D_0,codes.D_1,codes.D_2,codes.D_3,codes.D_4,codes.D_5,codes.D_6,codes.D_7,codes.D_8,codes.D_9]);static newLineChars=new Set([codes.CARRIAGE_RETURN,codes.LINE_FEED]);_data;_maxIndex;get maxIndex(){return this._maxIndex}constructor(e){if(!e?.length)throw new Error("Data is empty");this._data=e,this._maxIndex=e.length-1}static tryGetParser(e){try{return new SyncDataParser(e)}catch(C){return console.error(C),null}}static isRegularChar(e){return isNaN(e)?!1:!this.delimiterChars.has(e)&&!this.spaceChars.has(e)}static isNotRegularChar(e){return isNaN(e)?!0:this.delimiterChars.has(e)||this.spaceChars.has(e)}static isDigit(e){return this.digitChars.has(e)}static isNewLineChar(e){return this.newLineChars.has(e)}static isSpaceChar(e){return this.spaceChars.has(e)}static isNotSpaceChar(e){return!this.spaceChars.has(e)}static isDelimiterChar(e){return this.delimiterChars.has(e)}static isNotDelimiterChar(e){return!this.delimiterChars.has(e)}destroy(){}async getSubParserAsync(e,C){return new SyncDataParser(await this.sliceCharCodesAsync(e,C))}isOutside(e){return e<0||e>this._maxIndex}async isCodeAtAsync(e,C){return this.getCharCode(e)===C}async getValueTypeAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e))return null;const F=this._data,$=e;switch(F[$]){case codes.SLASH:return SyncDataParser.isRegularChar(F[$+1])?valueTypes.NAME:valueTypes.UNKNOWN;case codes.L_BRACKET:return valueTypes.ARRAY;case codes.L_PARENTHESE:return valueTypes.STRING_LITERAL;case codes.LESS:return codes.LESS===F[$+1]?valueTypes.DICTIONARY:valueTypes.STRING_HEX;case codes.PERCENT:return valueTypes.COMMENT;case codes.D_0:case codes.D_1:case codes.D_2:case codes.D_3:case codes.D_4:case codes.D_5:case codes.D_6:case codes.D_7:case codes.D_8:case codes.D_9:const V=await this.findDelimiterIndexAsync(!0,$+1);if(V!==-1){const te=await this.findCharIndexAsync(codes.R,!1,V-1);if(te!==-1&&te>$&&!SyncDataParser.isRegularChar(F[te+1]))return valueTypes.REF}return valueTypes.NUMBER;case codes.DOT:case codes.MINUS:return SyncDataParser.isDigit(F[$+1])?valueTypes.NUMBER:valueTypes.UNKNOWN;case codes.s:return F[$+1]===codes.t&&F[$+2]===codes.r&&F[$+3]===codes.e&&F[$+4]===codes.a&&F[$+5]===codes.m?valueTypes.STREAM:valueTypes.UNKNOWN;case codes.t:return F[$+1]===codes.r&&F[$+2]===codes.u&&F[$+3]===codes.e?valueTypes.BOOLEAN:valueTypes.UNKNOWN;case codes.f:return F[$+1]===codes.a&&F[$+2]===codes.l&&F[$+3]===codes.s&&F[$+4]===codes.e?valueTypes.BOOLEAN:valueTypes.UNKNOWN;default:return valueTypes.UNKNOWN}}async findSubarrayIndexAsync(e,C){const F=this._data;if(!e?.length)return null;const $=C?.direction??!0,Y=Math.max(Math.min(C?.minIndex??0,this._maxIndex),0),V=Math.max(Math.min(C?.maxIndex??this._maxIndex,this._maxIndex),0),te=!C?.closedOnly,se=new NaiveBytePatternSearch(e);let ne,ee,ie;$?ie=se.run(F.subarray(Y,V+1)):ie=se.runBackwards(F.subarray(Y,V+1));for(const ae of ie){if(ae===-1)return null;if(ne=ae+Y,ee=ne+e.length-1,te||ee===V||!SyncDataParser.isRegularChar(F[ee+1]))return{start:ne,end:ee}}return null}async findCharIndexAsync(e,C=!0,F){const $=this._data;let Y=isNaN(F)?C?0:this._maxIndex:F;if(C){for(Y;Y<=this._maxIndex;Y++)if($[Y]===e)return Y}else for(Y;Y>=0;Y--)if($[Y]===e)return Y;return-1}async findNewLineIndexAsync(e=!0,C){let F;const $=this._data;let Y=isNaN(C)?e?0:this._maxIndex:C;if(e){for(Y;Y<=this._maxIndex;Y++)if(SyncDataParser.isNewLineChar($[Y])){F=Y;break}}else for(Y;Y>=0;Y--)if(SyncDataParser.isNewLineChar($[Y])){F=Y;break}return F===void 0?-1:e?(this._data[F]===codes.CARRIAGE_RETURN&&this._data[F+1]===codes.LINE_FEED&&F++,Math.min(F+1,this._maxIndex)):(this._data[F]===codes.LINE_FEED&&this._data[F-1]===codes.CARRIAGE_RETURN&&F--,Math.max(F-1,0))}async findSpaceIndexAsync(e=!0,C){const F=this._data;let $=isNaN(C)?e?0:this._maxIndex:C;if(e){for($;$<=this._maxIndex;$++)if(SyncDataParser.isSpaceChar(F[$]))return $}else for($;$>=0;$--)if(SyncDataParser.isSpaceChar(F[$]))return $;return-1}async findNonSpaceIndexAsync(e=!0,C){const F=this._data;let $=isNaN(C)?e?0:this._maxIndex:C;if(e){for($;$<=this._maxIndex;$++)if(SyncDataParser.isNotSpaceChar(F[$]))return $}else for($;$>=0;$--)if(SyncDataParser.isNotSpaceChar(F[$]))return $;return-1}async findDelimiterIndexAsync(e=!0,C){const F=this._data;let $=isNaN(C)?e?0:this._maxIndex:C;if(e){for($;$<=this._maxIndex;$++)if(SyncDataParser.isDelimiterChar(F[$]))return $}else for($;$>=0;$--)if(SyncDataParser.isDelimiterChar(F[$]))return $;return-1}async findNonDelimiterIndexAsync(e=!0,C){const F=this._data;let $=isNaN(C)?e?0:this._maxIndex:C;if(e){for($;$<=this._maxIndex;$++)if(SyncDataParser.isNotDelimiterChar(F[$]))return $}else for($;$>=0;$--)if(SyncDataParser.isNotDelimiterChar(F[$]))return $;return-1}async findRegularIndexAsync(e=!0,C){const F=this._data;let $=isNaN(C)?e?0:this._maxIndex:C;if(e){for($;$<=this._maxIndex;$++)if(SyncDataParser.isRegularChar(F[$]))return $}else for($;$>=0;$--)if(SyncDataParser.isRegularChar(F[$]))return $;return-1}async findIrregularIndexAsync(e=!0,C){const F=this._data;let $=isNaN(C)?e?0:this._maxIndex:C;if(e){for($;$<=this._maxIndex;$++)if(SyncDataParser.isNotRegularChar(F[$]))return $}else for($;$>=0;$--)if(SyncDataParser.isNotRegularChar(F[$]))return $;return-1}async getIndirectObjectBoundsAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e))return null;const F=await this.findSubarrayIndexAsync(keywordCodes.OBJ,{minIndex:e,closedOnly:!0});if(!F)return null;let $=await this.findNonSpaceIndexAsync(!0,F.end+1);if($===-1)return null;const Y=await this.findSubarrayIndexAsync(keywordCodes.OBJ_END,{minIndex:$,closedOnly:!0});if(!Y)return null;let V=await this.findNonSpaceIndexAsync(!1,Y.start-1);return this.getCharCode($)===codes.LESS&&this.getCharCode($+1)===codes.LESS&&this.getCharCode(V-1)===codes.GREATER&&this.getCharCode(V)===codes.GREATER&&($+=2,V-=2),{start:F.start,end:Y.end,contentStart:$,contentEnd:V}}async getXrefTableBoundsAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||this._data[e]!==codes.x)return null;const F=await this.findSubarrayIndexAsync(keywordCodes.XREF_TABLE,{minIndex:e});if(!F)return null;const $=await this.findNonSpaceIndexAsync(!0,F.end+1);if($===-1)return null;const Y=await this.findSubarrayIndexAsync(keywordCodes.TRAILER,{minIndex:F.end+1});if(!Y)return null;const V=await this.findNonSpaceIndexAsync(!1,Y.start-1);return V<$?null:{start:F.start,end:Y.end,contentStart:$,contentEnd:V}}async getDictBoundsAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||this._data[e]!==codes.LESS||this._data[e+1]!==codes.LESS)return null;const F=await this.findNonSpaceIndexAsync(!0,e+2);if(F===-1)return null;let $=1,Y=!0,V=0,te=F,se,ne;for(;$;)ne=se,se=this._data[te++],se===codes.L_PARENTHESE&&(!V||ne!==codes.BACKSLASH)&&V++,se===codes.R_PARENTHESE&&V&&ne!==codes.BACKSLASH&&V--,!V&&(Y?Y=!1:se===codes.LESS&&se===ne?($++,Y=!0):se===codes.GREATER&&se===ne&&($--,Y=!0));const ee=te-1,ie=await this.findNonSpaceIndexAsync(!1,ee-2);return ie<F?{start:e,end:ee}:{start:e,end:ee,contentStart:F,contentEnd:ie}}async getArrayBoundsAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||this._data[e]!==codes.L_BRACKET)return null;let F=1,$=e+1,Y;for(;F;)Y=this._data[$++],Y===codes.L_BRACKET?F++:Y===codes.R_BRACKET&&F--;const V=$-1;return V-e<1?null:{start:e,end:V}}async getHexBoundsAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||this.getCharCode(e)!==codes.LESS)return null;const F=await this.findCharIndexAsync(codes.GREATER,!0,e+1);return F===-1?null:{start:e,end:F}}async getLiteralBoundsAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||this.getCharCode(e)!==codes.L_PARENTHESE)return null;let F=e,$,Y=!1,V=0;for(;V||$!==codes.R_PARENTHESE||Y;){if(F>this._maxIndex)return null;$=this.getCharCode(F++),Y||($===codes.L_PARENTHESE?V+=1:V&&$===codes.R_PARENTHESE&&(V-=1)),!Y&&$===codes.BACKSLASH?Y=!0:Y=!1}return{start:e,end:F-1}}async parseNumberAtAsync(e,C=!1,F=!0){if(F&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||!SyncDataParser.isRegularChar(this._data[e]))return null;let $=e,Y="",V=this._data[$];for(V===codes.MINUS?(Y+="-",V=this._data[++$]):V===codes.DOT&&(Y+="0.",V=this._data[++$]);SyncDataParser.isDigit(V)||C&&V===codes.DOT;)Y+=String.fromCharCode(V),V=this._data[++$];return Y?{value:+Y,start:e,end:$-1}:null}async parseNameAtAsync(e,C=!0,F=!0){if(F&&(e=await this.skipEmptyAsync(e)),this.isOutside(e)||this._data[e]!==codes.SLASH)return null;let $=e+1,Y=C?"/":"",V=this._data[$];for(;SyncDataParser.isRegularChar(V);)Y+=String.fromCharCode(V),V=this._data[++$];return Y.length>1?{value:Y,start:e,end:$-1}:null}async parseStringAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e))return null;let F=e,$="",Y=this._data[F];for(;SyncDataParser.isRegularChar(Y);)$+=String.fromCharCode(Y),Y=this._data[++F];return $.length!==0?{value:$,start:e,end:F-1}:null}async parseBoolAtAsync(e,C=!0){if(C&&(e=await this.skipEmptyAsync(e)),this.isOutside(e))return null;const F=await this.findDelimiterIndexAsync(!0,e),$=await this.findSubarrayIndexAsync(keywordCodes.TRUE,{minIndex:e,maxIndex:F===-1?this._maxIndex:F});if($)return{value:!0,start:e,end:$.end};const Y=await this.findSubarrayIndexAsync(keywordCodes.FALSE,{minIndex:e,maxIndex:F===-1?this._maxIndex:F});return Y?{value:!1,start:e,end:Y.end}:null}async parseNumberArrayAtAsync(e,C=!0,F=!0){const $=await this.getArrayBoundsAtAsync(e,F);if(!$)return null;const Y=[];let V,te=$.start+1;for(;te<$.end&&(V=await this.parseNumberAtAsync(te,C,!0),!!V);)Y.push(V.value),te=V.end+1;return{value:Y,start:$.start,end:$.end}}async parseNameArrayAtAsync(e,C=!0,F=!0){const $=await this.getArrayBoundsAtAsync(e,F);if(!$)return null;const Y=[];let V,te=$.start+1;for(;te<$.end&&(V=await this.parseNameAtAsync(te,C,!0),!!V);)Y.push(V.value),te=V.end+1;return{value:Y,start:$.start,end:$.end}}async parseDictTypeAsync(e){return await this.parseDictPropertyByNameAsync(keywordCodes.TYPE,e)}async parseDictSubtypeAsync(e){return await this.parseDictPropertyByNameAsync(keywordCodes.SUBTYPE,e)}async parseDictPropertyByNameAsync(e,C){const F=this._data;if(!e?.length)return null;const $=Math.max(Math.min(C.start??0,this._maxIndex),0),Y=Math.max(Math.min(C.end??this._maxIndex,this._maxIndex),0);let V,te=$,se,ne,ee,ie=0,ae=!0,re=0;e:for(te;te<=Y;te++)if(ee=ne,ne=F[te],ne===codes.L_PARENTHESE&&(!re||ee!==codes.BACKSLASH)&&re++,ne===codes.R_PARENTHESE&&re&&ee!==codes.BACKSLASH&&re--,!re){for(ae?ae=!1:ne===codes.LESS&&ne===ee?(ie++,ae=!0):ne===codes.GREATER&&ne===ee&&(ie--,ae=!0),se=0;se<e.length;se++)if(F[te+se]!==e[se])continue e;if(ie===1&&!SyncDataParser.isRegularChar(F[te+se])){V={start:te,end:te+se-1};break}}if(!V)return null;const oe=await this.parseNameAtAsync(V.end+1);return oe?oe.value:null}async skipEmptyAsync(e){let C=await this.findNonSpaceIndexAsync(!0,e);if(C===-1)return-1;if(this._data[C]===codes.PERCENT){const F=await this.findNewLineIndexAsync(!0,C+1);if(F===-1)return-1;C=await this.findNonSpaceIndexAsync(!0,F)}return C}async skipToNextNameAsync(e,C){if(e||=0,C=C?Math.min(C,this._maxIndex):0,C<e)return-1;let F=e;for(;F<=C;){const $=await this.getValueTypeAtAsync(F,!0);if($){let Y;switch($){case valueTypes.DICTIONARY:Y=await this.getDictBoundsAtAsync(F,!1);break;case valueTypes.ARRAY:Y=await this.getArrayBoundsAtAsync(F,!1);break;case valueTypes.STRING_LITERAL:Y=await this.getLiteralBoundsAtAsync(F,!1);break;case valueTypes.STRING_HEX:Y=await this.getHexBoundsAtAsync(F,!1);break;case valueTypes.NUMBER:const V=await this.parseNumberAtAsync(F,!0,!1);V&&(Y=V);break;case valueTypes.BOOLEAN:const te=await this.parseBoolAtAsync(F,!1);te&&(Y=te);break;case valueTypes.COMMENT:break;case valueTypes.NAME:return F;default:F++;continue}if(Y){F=Y.end+1,Y=null;continue}}F++}return-1}async sliceCharCodesAsync(e,C){return this._data.slice(e,(C||e)+1)}async sliceCharsAsync(e,C){return String.fromCharCode(...this._data.slice(e,(C||e)+1))}getCharCode(e){return this._data[e]}}class DataWriter{_encoder;_sourceData;_dataToAppend=[];_pointer;get offset(){return this._pointer}constructor(e){if(!e?.length)throw new Error("Data is empty");this._encoder=new TextEncoder,this._sourceData=e.slice(0),this._pointer=e.length,this.fixEof()}getCurrentData(){const e=new Uint8Array(this._sourceData.length+this._dataToAppend.length);return e.set(this._sourceData,0),e.set(this._dataToAppend,this._sourceData.length),e}writeBytes(e){if(e?.length){for(let C=0;C<e.length;C++)this._dataToAppend.push(e[C]);this._pointer+=e.length}}writeIndirectObject(e,C){if(!e?.ref||!C)return;const F=[...this._encoder.encode(`${e.ref.id} ${e.ref.generation} `),...keywordCodes.OBJ,...keywordCodes.END_OF_LINE,...C.toArray(e),...keywordCodes.END_OF_LINE,...keywordCodes.OBJ_END,...keywordCodes.END_OF_LINE];this.writeBytes(F)}writeIndirectArray(e,C){if(!e?.ref||!C)return;const F=[...this._encoder.encode(`${e.ref.id} ${e.ref.generation} `),...keywordCodes.OBJ,...keywordCodes.END_OF_LINE,codes.L_BRACKET];for(const $ of C)F.push(codes.WHITESPACE,...$.toArray(e));F.push(codes.R_BRACKET,...keywordCodes.END_OF_LINE,...keywordCodes.OBJ_END,...keywordCodes.END_OF_LINE),this.writeBytes(F)}writeEof(e){const C=[...keywordCodes.XREF_START,...keywordCodes.END_OF_LINE,...this._encoder.encode(e+""),...keywordCodes.END_OF_LINE,...keywordCodes.END_OF_FILE,...keywordCodes.END_OF_LINE];this.writeBytes(C)}fixEof(){this._sourceData[this._pointer-1]!==codes.LINE_FEED&&(this._sourceData[this._pointer-2]!==codes.CARRIAGE_RETURN?(this._dataToAppend.push(codes.CARRIAGE_RETURN,codes.LINE_FEED),this._pointer+=2):(this._dataToAppend.push(codes.LINE_FEED),this._pointer+=1))}}class XRefEntry{constructor(e,C,F,$,Y,V,te){this.type=e,this.id=C,this.generation=F,this.byteOffset=$,this.nextFreeId=Y,this.streamId=V,this.streamIndex=te}static digitChars=new Set([codes.D_0,codes.D_1,codes.D_2,codes.D_3,codes.D_4,codes.D_5,codes.D_6,codes.D_7,codes.D_8,codes.D_9]);static isDigit(e){return this.digitChars.has(e)}static*fromTableBytes(e){let C=0,F=0;for(;C<e.length;){const $=[];let Y=e[C++];for(;XRefEntry.isDigit(Y);)$.push(Y),Y=e[C++];let V=parseInt($.map(ee=>String.fromCharCode(ee)).join(""),10);const te=[];let se=e[C++];for(;XRefEntry.isDigit(se);)te.push(se),se=e[C++];const ne=parseInt(te.map(ee=>String.fromCharCode(ee)).join(""),10);for(;!XRefEntry.isDigit(e[C]);)C++;for(F=0;F<ne;F++){const ee=parseInt(Array.from(e.subarray(C,C+10)).map(re=>String.fromCharCode(re)).join(""),10);C+=11;const ie=parseInt(Array.from(e.subarray(C,C+5)).map(re=>String.fromCharCode(re)).join(""),10);C+=6;const ae=e[C];ae===codes.f?yield new XRefEntry(xRefEntryTypes.FREE,V++,ie,null,ee):ae===codes.n&&(yield new XRefEntry(xRefEntryTypes.NORMAL,V++,ie,ee)),C+=3}}}static*fromStreamBytes(e,C,F){const[$,Y,V]=C,te=$+Y+V;if(e.length%te)throw new Error("Incorrect stream length");const se=e.length/te,ne=new Array(se);if(F?.length){let ce,he,de=0;for(let pe=0;pe<F.length;pe++)if(!(pe%2))ce=F[pe];else for(he=0;he<F[pe];he++)ne[de++]=ce+he}else{let ce=0;for(;ce<se;)ne[ce++]=ce}let ee=0,ie=0,ae,re,oe;for(;ee<e.length;)switch(ae=$?ByteUtils.parseIntFromBytes(e.slice(ee,ee+$)):1,ee+=$,re=ByteUtils.parseIntFromBytes(e.slice(ee,ee+Y)),ee+=Y,oe=V?ByteUtils.parseIntFromBytes(e.slice(ee,ee+V)):null,ee+=V,ae){case xRefEntryTypes.FREE:yield new XRefEntry(xRefEntryTypes.FREE,ne[ie++],oe??maxGeneration,null,re);break;case xRefEntryTypes.NORMAL:yield new XRefEntry(xRefEntryTypes.NORMAL,ne[ie++],oe??0,re);break;case xRefEntryTypes.COMPRESSED:yield new XRefEntry(xRefEntryTypes.COMPRESSED,ne[ie++],0,null,null,re,oe);break}}static toTableBytes(e){if(!e?.length)return null;const C=new TextEncoder,F=this.groupEntries(e);let $=new Uint8Array,Y,V;for(const te of F){V=`${te[0]} ${te[1].length}\r
`,Y=new Uint8Array($.length+V.length),Y.set($),Y.set(C.encode(V),$.length),$=Y;for(const se of te[1]){switch(se.type){case xRefEntryTypes.FREE:V=`${se.nextFreeId.toString().padStart(10,"0")} ${se.generation.toString().padStart(5,"0")} f\r
`;break;case xRefEntryTypes.NORMAL:V=`${se.byteOffset.toString().padStart(10,"0")} ${se.generation.toString().padStart(5,"0")} n\r
`;break;default:continue}Y=new Uint8Array($.length+V.length),Y.set($),Y.set(C.encode(V),$.length),$=Y}}return $}static toStreamBytes(e,C=[1,4,2]){if(!e?.length)return null;if(Math.min(...C)<0)throw new Error("Negative length values are not permitted");let[F,$,Y]=C;F??=0,$??=4,Y??=0;const V=F+$+Y;let te,se,ne;switch(F){case 0:te=()=>new Uint8Array;break;case 1:te=ByteUtils.int8ToBytes;break;case 2:te=ByteUtils.int16ToBytes;break;default:se=de=>new Uint8Array([...new Array(F-2).fill(0),...ByteUtils.int16ToBytes(de)]);break}switch($){case 1:se=ByteUtils.int8ToBytes;break;case 2:se=ByteUtils.int16ToBytes;break;case 3:se=de=>new Uint8Array([0,...ByteUtils.int16ToBytes(de)]);break;case 4:se=ByteUtils.int32ToBytes;break;default:se=de=>new Uint8Array([...new Array(F-4).fill(0),...ByteUtils.int32ToBytes(de)]);break}switch(Y){case 0:ne=()=>new Uint8Array;break;case 1:ne=ByteUtils.int8ToBytes;break;case 2:ne=ByteUtils.int16ToBytes;break;default:se=de=>new Uint8Array([...new Array(F-2).fill(0),...ByteUtils.int16ToBytes(de)]);break}new TextEncoder;const ee=this.groupEntries(e),ie=[];let ae=new Uint8Array,re,oe,ce,he;for(const de of ee){ie.push(de[0],de[1].length);for(const pe of de[1]){switch(pe.type){case xRefEntryTypes.FREE:oe=te(0),ce=se(pe.nextFreeId),he=ne(pe.generation);break;case xRefEntryTypes.NORMAL:oe=te(1),ce=se(pe.byteOffset),he=ne(pe.generation);break;case xRefEntryTypes.COMPRESSED:oe=te(2),ce=se(pe.streamId),he=ne(pe.streamIndex);break;default:continue}re=new Uint8Array(ae.length+V),re.set(ae),re.set(oe,ae.length),re.set(ce,ae.length+F),re.set(he,ae.length+F+$),ae=re}}return{bytes:ae,index:ie}}static groupEntries(e){e.sort((V,te)=>V.id-te.id);const C=[];let F,$,Y;for(const V of e)V.id!==Y+1?($?.length&&C.push([F,$]),F=V.id,$=[V]):$.push(V),Y=V.id;return $?.length&&C.push([F,$]),C}}class ReferenceDataChange{_refData;_freeLinkedList;_usedMap;_size;get size(){return this._size}constructor(e){this._refData=e,this._size=e.size;const C=new LinkedList;for(const F of e.freeLinkedList)C.push(Object.assign({},F));this._freeLinkedList=C,this._usedMap=new Map}getUsedRef(e){return this._usedMap.get(e)}takeFreeRef(e,C=!1){let F;if(!C&&this._freeLinkedList.length>1){const $=this._freeLinkedList.pop();this._freeLinkedList.tail.nextFreeId=0,F={id:$.id,generation:$.generation,byteOffset:e}}else F={id:this._size++,generation:0,byteOffset:e};return this._usedMap.set(F.id,F),F}setRefFree(e){if(this._usedMap.has(e)&&(this._usedMap.delete(e),this._size>this._refData.size&&this._size===e+1&&this._size--),this._refData.isUsed(e)){const C=this._refData.getGeneration(e),F={id:e,generation:C+1,nextFreeId:0};if(this._freeLinkedList.findIndex(F,(V,te)=>V.id===te.id&&V.generation<=te.generation)!==-1)return;const Y=this._freeLinkedList.tail;Y.nextFreeId=e,this._freeLinkedList.push(F)}}updateUsedRef(e){if(e.compressed&&e.generation)throw new Error(`Compressed ref generation can't be greater than zero: '${e.id} ${e.generation} R'`);if(this.isFreed(e))throw new Error(`The reference is freed: '${e.id} ${e.generation} R'`);const C=this._usedMap.get(e.id);if(C)throw new Error(`Same reference has been issued twice: '${C.id} ${C.generation} R'`);if(this._refData.isUsed(e.id)){const F=this._refData.getGeneration(e.id);if(e.generation>=F)return this._usedMap.set(e.id,e),!0;throw new Error(`The reference has an old generation: '${C.id} ${C.generation} R'`)}throw new Error(`The reference is not used: '${C.id} ${C.generation} R'`)}exportEntries(){const e=[];for(const C of this._freeLinkedList)e.push(new XRefEntry(xRefEntryTypes.FREE,C.id,C.generation,null,C.nextFreeId));return this._usedMap.forEach(C=>{C.compressed?e.push(new XRefEntry(xRefEntryTypes.COMPRESSED,C.id,0,null,null,C.streamId,C.streamIndex)):e.push(new XRefEntry(xRefEntryTypes.NORMAL,C.id,C.generation,C.byteOffset))}),e}isFreed(e){return this._freeLinkedList.has(e,(C,F)=>C.id===F.id&&C.generation<F.generation)}isUsedInSource(e){return this._refData.isUsed(e)}}class ObjectId{id;generation;constructor(e,C){this.id=e??0,this.generation=C??0}static async parseAsync(e,C,F=!0){if(F&&(C=await e.findRegularIndexAsync(!0,C)),C<0||C>e.maxIndex)return null;const $=await e.parseNumberAtAsync(C,!1,!1);if(!$||isNaN($.value))return null;const Y=await e.parseNumberAtAsync($.end+2,!1,!1);return!Y||isNaN(Y.value)?null:{value:new ObjectId($.value,Y.value),start:C,end:Y.end}}static async parseRefAsync(e,C,F=!0){const $=await ObjectId.parseAsync(e,C,F);if(!$)return null;const Y=$.end+2,V=await e.findSubarrayIndexAsync([codes.R],{minIndex:Y,closedOnly:!0});return!V||V.start!==Y?null:{value:$.value,start:$.start,end:V.end}}static async parseRefArrayAsync(e,C,F=!0){const $=await e.getArrayBoundsAtAsync(C,F);if(!$)return null;const Y=[];let V,te=$.start+1;for(;te<$.end&&(V=await ObjectId.parseRefAsync(e,te,!0),!!V);)Y.push(V.value),te=V.end+1;return{value:Y,start:$.start,end:$.end}}static fromRef(e){return new ObjectId(e.id,e.generation)}equals(e){return this.id===e.id&&this.generation===e.generation}toArray(e){return new TextEncoder().encode(`${this.id} ${this.generation} R`)}toString(){return this.id+"|"+this.generation}}class DateString{_source;get source(){return this._source}_date;get date(){return new Date(this._date)}constructor(e,C){this._source=e,this._date=new Date(C)}static async parseAsync(e,C,F=null,$=!0){if($&&(C=await e.skipEmptyAsync(C)),e.isOutside(C)||!await e.isCodeAtAsync(C,codes.L_PARENTHESE))return null;const Y=await e.findCharIndexAsync(codes.R_PARENTHESE,!0,C);if(Y===-1)return null;let V=await e.sliceCharCodesAsync(C+1,Y-1);F?.ref&&F.stringCryptor&&(V=F.stringCryptor.decrypt(V,F.ref));try{return{value:DateString.fromArray(V),start:C,end:Y}}catch{return null}}static fromDate(e){const C=e.getFullYear(),F=String(e.getMonth()+1).padStart(2,"0"),$=String(e.getDate()).padStart(2,"0"),Y=String(e.getHours()).padStart(2,"0"),V=String(e.getMinutes()).padStart(2,"0"),te=String(e.getSeconds()).padStart(2,"0"),se=`D:${C}${F}${$}${Y}${V}${te}`;return new DateString(se,e)}static fromString(e){const C=/D:(?<Y>\d{4})(?<M>\d{2})(?<D>\d{2})(?<h>\d{2})(?<m>\d{2})(?<s>\d{2})/.exec(e),F=new Date(+C.groups.Y,+C.groups.M-1,+C.groups.D,+C.groups.h,+C.groups.m,+C.groups.s);return new DateString(e,F)}static fromArray(e){const C=new TextDecoder().decode(e);return DateString.fromString(C)}toArray(e){let C=new TextEncoder().encode(this._source);return e?.ref&&e.stringCryptor&&(C=e.stringCryptor.encrypt(C,e.ref)),new Uint8Array([...keywordCodes.STR_LITERAL_START,...C,...keywordCodes.STR_LITERAL_END])}}class HexString{_literal;get literal(){return this._literal}_hex;get hex(){return this._hex.slice()}_bytes;get bytes(){return this._bytes.slice()}constructor(e,C,F){this._literal=e,this._hex=C,this._bytes=F}static async parseAsync(e,C,F=null,$=!0){const Y=await e.getHexBoundsAtAsync(C,$);if(!Y)return null;let V=await e.sliceCharCodesAsync(Y.start+1,Y.end-1);return F?.ref&&F.stringCryptor&&(V=F.stringCryptor.decrypt(V,F.ref)),{value:HexString.fromBytes(V),start:Y.start,end:Y.end}}static async parseArrayAsync(e,C,F=null,$=!0){const Y=await e.getArrayBoundsAtAsync(C,$);if(!Y)return null;const V=[];let te,se=Y.start+1;for(;se<Y.end&&(te=await HexString.parseAsync(e,se,F,$),!!te);)V.push(te.value),se=te.end+1;return{value:V,start:Y.start,end:Y.end}}static fromBytes(e){const C=new TextDecoder().decode(e),F=ByteUtils.hexStringToBytes(C);return new HexString(C,F,e)}static fromHexBytes(e){let C="";e.forEach($=>C+=$.toString(16).padStart(2,"0"));const F=new TextEncoder().encode(C);return new HexString(C,e,F)}static fromString(e){const C=ByteUtils.hexStringToBytes(e),F=new TextEncoder().encode(e);return new HexString(e,C,F)}toArray(e){return new Uint8Array([...keywordCodes.STR_HEX_START,...this._bytes,...keywordCodes.STR_HEX_END])}}class LiteralString{_literal;get literal(){return this._literal}_bytes;get bytes(){return this._bytes.slice()}constructor(e,C){this._literal=e,this._bytes=C}static async parseAsync(e,C,F=null,$=!0){const Y=await e.getLiteralBoundsAtAsync(C,$);if(!Y)return;let V=LiteralString.unescape(await e.sliceCharCodesAsync(Y.start+1,Y.end-1));return F?.ref&&F.stringCryptor&&(V=F.stringCryptor.decrypt(V,F.ref)),{value:LiteralString.fromBytes(V),start:Y.start,end:Y.end}}static async parseArrayAsync(e,C,F=null,$=!0){const Y=await e.getArrayBoundsAtAsync(C,$);if(!Y)return null;const V=[];let te,se=Y.start+1;for(;se<Y.end&&(te=await LiteralString.parseAsync(e,se,F,$),!!te);)V.push(te.value),se=te.end+1;return{value:V,start:Y.start,end:Y.end}}static fromBytes(e){const F=(e[0]===254&&e[1]===255?new TextDecoder("utf-16be"):new TextDecoder).decode(e);return new LiteralString(F,e)}static fromString(e){const C=[];C.push(254,255);for(let F=0;F<e.length;F++){const $=e.charCodeAt(F);C.push(($&65280)>>>8),C.push($&255)}return new LiteralString(e,new Uint8Array(C))}static escape(e){const C=[];for(let F=0;F<e.length;F++)switch(e[F]){case codes.LINE_FEED:C.push(codes.BACKSLASH),C.push(codes.n);break;case codes.CARRIAGE_RETURN:C.push(codes.BACKSLASH),C.push(codes.r);break;case codes.HORIZONTAL_TAB:C.push(codes.BACKSLASH),C.push(codes.t);break;case codes.BACKSPACE:C.push(codes.BACKSLASH),C.push(codes.b);break;case codes.FORM_FEED:C.push(codes.BACKSLASH),C.push(codes.f);break;case codes.L_PARENTHESE:C.push(codes.BACKSLASH),C.push(codes.L_PARENTHESE);break;case codes.R_PARENTHESE:C.push(codes.BACKSLASH),C.push(codes.R_PARENTHESE);break;case codes.BACKSLASH:C.push(codes.BACKSLASH),C.push(codes.BACKSLASH);break;default:C.push(e[F]);break}return new Uint8Array(C)}static unescape(e){const C=[];let F=!1;for(let $=0;$<e.length;$++){if(F){switch(e[$]){case codes.n:C.push(codes.LINE_FEED);break;case codes.r:C.push(codes.CARRIAGE_RETURN);break;case codes.t:C.push(codes.HORIZONTAL_TAB);break;case codes.b:C.push(codes.BACKSPACE);break;case codes.f:C.push(codes.FORM_FEED);break;case codes.L_PARENTHESE:C.push(codes.L_PARENTHESE);break;case codes.R_PARENTHESE:C.push(codes.R_PARENTHESE);break;case codes.BACKSLASH:C.push(codes.BACKSLASH);break;default:C.push(e[$]);break}F=!1;continue}if(e[$]===codes.BACKSLASH){F=!0;continue}C.push(e[$])}return new Uint8Array(C)}toArray(e){const C=e?.ref&&e.stringCryptor?e.stringCryptor.encrypt(this._bytes,e.ref):this._bytes;return new Uint8Array([...keywordCodes.STR_LITERAL_START,...LiteralString.escape(C),...keywordCodes.STR_LITERAL_END])}}class PdfObject{$onChangeAction;$onEditAction;_sourceBytes;get sourceBytes(){return this._sourceBytes?.slice()}get sourceChars(){return this._sourceBytes?String.fromCharCode(...this._sourceBytes.slice(0,this._sourceBytes.length)):""}_ref;get ref(){return this._ref}set ref(e){this._ref=e}get id(){return this._ref?.id}get generation(){return this._ref?.generation}_proxy;_added=!1;get added(){return this._added}_edited=!1;get edited(){return this._edited}_deleted=!1;get deleted(){return this._deleted}onChange={set:(e,C,F)=>(C[0]!=="_"&&C[0]!=="$"&&(this._edited||=!0,this.$onChangeAction&&this.$onChangeAction()),e[C]=F,!0)};constructor(){}static async getDataParserAsync(e){return BgDataParser.tryGetParser(e.slice())??SyncDataParser.tryGetParser(e)}markAsDeleted(e=!0){this._deleted=e}initProxy(){const e=new Proxy(this,this.onChange);return this._proxy=e,e}getProxy(){return this._proxy||this}encodePrimitiveArray(e,C){C||=new TextEncoder;const F=[codes.L_BRACKET];return e.forEach($=>F.push(...C.encode(" "+$))),F.push(codes.R_BRACKET),F}encodeNestedPrimitiveArray(e,C){C||=new TextEncoder;const F=[codes.L_BRACKET];return e.forEach($=>{F.push(codes.L_BRACKET),$.forEach(Y=>F.push(...C.encode(" "+Y))),F.push(codes.R_BRACKET)}),F.push(codes.R_BRACKET),F}encodeSerializableArray(e,C){const F=[codes.L_BRACKET];return e.forEach($=>F.push(codes.WHITESPACE,...$.toArray(C))),F.push(codes.R_BRACKET),F}async parseRefPropAsync(e,C,F){const $=await ObjectId.parseRefAsync(C,F);return this.setParsedProp(e,$)}async parseRefArrayPropAsync(e,C,F){const $=await ObjectId.parseRefArrayAsync(C,F);return this.setParsedProp(e,$)}async parseBoolPropAsync(e,C,F){const $=await C.parseBoolAtAsync(F);return this.setParsedProp(e,$)}async parseNamePropAsync(e,C,F,$=!0){const Y=await C.parseNameAtAsync(F,$);return this.setParsedProp(e,Y)}async parseNameArrayPropAsync(e,C,F,$=!0){const Y=await C.parseNameArrayAtAsync(F,$);return this.setParsedProp(e,Y)}async parseNumberPropAsync(e,C,F,$=!0){const Y=await C.parseNumberAtAsync(F,$);return this.setParsedProp(e,Y)}async parseNumberArrayPropAsync(e,C,F,$=!0){const Y=await C.parseNumberArrayAtAsync(F,$);return this.setParsedProp(e,Y)}async parseDatePropAsync(e,C,F,$){const Y=await DateString.parseAsync(C,F,$);return this.setParsedProp(e,Y)}async parseLiteralPropAsync(e,C,F,$){const Y=await LiteralString.parseAsync(C,F,$);return this.setParsedProp(e,Y)}async parseHexPropAsync(e,C,F,$){const Y=await HexString.parseAsync(C,F,$);return this.setParsedProp(e,Y)}setParsedProp(e,C){if(!C)throw new Error(`Can't parse ${e} property value`);return this[e.slice(1)]=C.value,C.end+1}}class PdfDict extends PdfObject{Type;_streamId;get streamId(){return this._streamId}constructor(e){super(),this.Type=e}toArray(e){const C=new TextEncoder,F=[...keywordCodes.DICT_START];return this.Type&&F.push(...keywordCodes.TYPE,...C.encode(this.Type)),F.push(...keywordCodes.DICT_END),new Uint8Array(F)}async parsePropsAsync(e){if(!e)throw new Error("Parse info is empty");const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;this._ref=e.cryptInfo?.ref,this._streamId=e.streamId,this._sourceBytes=await C.sliceCharCodesAsync($,Y);let V=await C.skipToNextNameAsync($,Y-1);if(V===-1)throw new Error("Dict is empty (has no properties)");let te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Type":const ne=await C.parseNameAtAsync(V);if(ne){if(this.Type&&this.Type!==ne.value)throw new Error(`Ivalid dict type: '${ne.value}' instead of '${this.Type}'`);return}throw new Error("Can't parse /Type property value");default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class DecodeParamsDict extends PdfDict{_intPropMap=new Map;_boolPropMap=new Map;_namePropMap=new Map;_refPropMap=new Map;constructor(){super(dictTypes.EMPTY)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new DecodeParamsDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}static async parseArrayAsync(e,C,F=null,$=!0){const Y=await e.getArrayBoundsAtAsync(C,$);if(!Y)return null;const V=[];let te,se=Y.start+1;for(;se<Y.end;){const ne=await e.getDictBoundsAtAsync(se);if(te=await DecodeParamsDict.parseAsync({parser:e,bounds:ne,cryptInfo:F}),!te)break;V.push(te.value),se=te.end+1}return{value:V,start:Y.start,end:Y.end}}getIntProp(e){return this._intPropMap.get(e)}getBoolProp(e){return this._boolPropMap.get(e)}getNameProp(e){return this._namePropMap.get(e)}getRefProp(e){return this._refPropMap.get(e)}setIntProp(e,C){return this._intPropMap.set(e,C)}setBoolProp(e,C){return this._boolPropMap.set(e,C)}setNameProp(e,C){return this._namePropMap.set(e,C)}setRefProp(e,C){return this._refPropMap.set(e,C)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this._intPropMap.forEach((V,te)=>$.push(...F.encode(te),...F.encode(" "+V))),this._boolPropMap.forEach((V,te)=>$.push(...F.encode(te),...F.encode(" "+V))),this._namePropMap.forEach((V,te)=>$.push(...F.encode(te),...F.encode(V))),this._refPropMap.forEach((V,te)=>$.push(...F.encode(te),...V.toArray(e)));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;){switch(V=se.end+1,te=se.value,await C.getValueTypeAtAsync(V)){case valueTypes.NUMBER:const ee=await C.parseNumberAtAsync(V,!1);if(ee){this._intPropMap.set(te,ee.value),V=ee.end+1;continue}break;case valueTypes.BOOLEAN:const ie=await C.parseBoolAtAsync(V);if(ie){this._boolPropMap.set(te,ie.value),V=ie.end+1;continue}break;case valueTypes.NAME:const ae=await C.parseNameAtAsync(V);if(ae){this._namePropMap.set(te,ae.value),V=ae.end+1;continue}break;case valueTypes.REF:const re=await ObjectId.parseRefAsync(C,V);if(re){this._refPropMap.set(te,re.value),V=re.end+1;continue}break}V=await C.skipToNextNameAsync(V,Y-1)}}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(J){let e=J.length;for(;--e>=0;)J[e]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(J,e,C,F,$){this.static_tree=J,this.extra_bits=e,this.extra_base=C,this.elems=F,this.max_length=$,this.has_stree=J&&J.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(J,e){this.dyn_tree=J,this.max_code=0,this.stat_desc=e}const d_code=J=>J<256?_dist_code[J]:_dist_code[256+(J>>>7)],put_short=(J,e)=>{J.pending_buf[J.pending++]=e&255,J.pending_buf[J.pending++]=e>>>8&255},send_bits=(J,e,C)=>{J.bi_valid>Buf_size-C?(J.bi_buf|=e<<J.bi_valid&65535,put_short(J,J.bi_buf),J.bi_buf=e>>Buf_size-J.bi_valid,J.bi_valid+=C-Buf_size):(J.bi_buf|=e<<J.bi_valid&65535,J.bi_valid+=C)},send_code=(J,e,C)=>{send_bits(J,C[e*2],C[e*2+1])},bi_reverse=(J,e)=>{let C=0;do C|=J&1,J>>>=1,C<<=1;while(--e>0);return C>>>1},bi_flush=J=>{J.bi_valid===16?(put_short(J,J.bi_buf),J.bi_buf=0,J.bi_valid=0):J.bi_valid>=8&&(J.pending_buf[J.pending++]=J.bi_buf&255,J.bi_buf>>=8,J.bi_valid-=8)},gen_bitlen=(J,e)=>{const C=e.dyn_tree,F=e.max_code,$=e.stat_desc.static_tree,Y=e.stat_desc.has_stree,V=e.stat_desc.extra_bits,te=e.stat_desc.extra_base,se=e.stat_desc.max_length;let ne,ee,ie,ae,re,oe,ce=0;for(ae=0;ae<=MAX_BITS$1;ae++)J.bl_count[ae]=0;for(C[J.heap[J.heap_max]*2+1]=0,ne=J.heap_max+1;ne<HEAP_SIZE$1;ne++)ee=J.heap[ne],ae=C[C[ee*2+1]*2+1]+1,ae>se&&(ae=se,ce++),C[ee*2+1]=ae,!(ee>F)&&(J.bl_count[ae]++,re=0,ee>=te&&(re=V[ee-te]),oe=C[ee*2],J.opt_len+=oe*(ae+re),Y&&(J.static_len+=oe*($[ee*2+1]+re)));if(ce!==0){do{for(ae=se-1;J.bl_count[ae]===0;)ae--;J.bl_count[ae]--,J.bl_count[ae+1]+=2,J.bl_count[se]--,ce-=2}while(ce>0);for(ae=se;ae!==0;ae--)for(ee=J.bl_count[ae];ee!==0;)ie=J.heap[--ne],!(ie>F)&&(C[ie*2+1]!==ae&&(J.opt_len+=(ae-C[ie*2+1])*C[ie*2],C[ie*2+1]=ae),ee--)}},gen_codes=(J,e,C)=>{const F=new Array(MAX_BITS$1+1);let $=0,Y,V;for(Y=1;Y<=MAX_BITS$1;Y++)$=$+C[Y-1]<<1,F[Y]=$;for(V=0;V<=e;V++){let te=J[V*2+1];te!==0&&(J[V*2]=bi_reverse(F[te]++,te))}},tr_static_init=()=>{let J,e,C,F,$;const Y=new Array(MAX_BITS$1+1);for(C=0,F=0;F<LENGTH_CODES$1-1;F++)for(base_length[F]=C,J=0;J<1<<extra_lbits[F];J++)_length_code[C++]=F;for(_length_code[C-1]=F,$=0,F=0;F<16;F++)for(base_dist[F]=$,J=0;J<1<<extra_dbits[F];J++)_dist_code[$++]=F;for($>>=7;F<D_CODES$1;F++)for(base_dist[F]=$<<7,J=0;J<1<<extra_dbits[F]-7;J++)_dist_code[256+$++]=F;for(e=0;e<=MAX_BITS$1;e++)Y[e]=0;for(J=0;J<=143;)static_ltree[J*2+1]=8,J++,Y[8]++;for(;J<=255;)static_ltree[J*2+1]=9,J++,Y[9]++;for(;J<=279;)static_ltree[J*2+1]=7,J++,Y[7]++;for(;J<=287;)static_ltree[J*2+1]=8,J++,Y[8]++;for(gen_codes(static_ltree,L_CODES$1+1,Y),J=0;J<D_CODES$1;J++)static_dtree[J*2+1]=5,static_dtree[J*2]=bi_reverse(J,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=J=>{let e;for(e=0;e<L_CODES$1;e++)J.dyn_ltree[e*2]=0;for(e=0;e<D_CODES$1;e++)J.dyn_dtree[e*2]=0;for(e=0;e<BL_CODES$1;e++)J.bl_tree[e*2]=0;J.dyn_ltree[END_BLOCK*2]=1,J.opt_len=J.static_len=0,J.sym_next=J.matches=0},bi_windup=J=>{J.bi_valid>8?put_short(J,J.bi_buf):J.bi_valid>0&&(J.pending_buf[J.pending++]=J.bi_buf),J.bi_buf=0,J.bi_valid=0},smaller=(J,e,C,F)=>{const $=e*2,Y=C*2;return J[$]<J[Y]||J[$]===J[Y]&&F[e]<=F[C]},pqdownheap=(J,e,C)=>{const F=J.heap[C];let $=C<<1;for(;$<=J.heap_len&&($<J.heap_len&&smaller(e,J.heap[$+1],J.heap[$],J.depth)&&$++,!smaller(e,F,J.heap[$],J.depth));)J.heap[C]=J.heap[$],C=$,$<<=1;J.heap[C]=F},compress_block=(J,e,C)=>{let F,$,Y=0,V,te;if(J.sym_next!==0)do F=J.pending_buf[J.sym_buf+Y++]&255,F+=(J.pending_buf[J.sym_buf+Y++]&255)<<8,$=J.pending_buf[J.sym_buf+Y++],F===0?send_code(J,$,e):(V=_length_code[$],send_code(J,V+LITERALS$1+1,e),te=extra_lbits[V],te!==0&&($-=base_length[V],send_bits(J,$,te)),F--,V=d_code(F),send_code(J,V,C),te=extra_dbits[V],te!==0&&(F-=base_dist[V],send_bits(J,F,te)));while(Y<J.sym_next);send_code(J,END_BLOCK,e)},build_tree=(J,e)=>{const C=e.dyn_tree,F=e.stat_desc.static_tree,$=e.stat_desc.has_stree,Y=e.stat_desc.elems;let V,te,se=-1,ne;for(J.heap_len=0,J.heap_max=HEAP_SIZE$1,V=0;V<Y;V++)C[V*2]!==0?(J.heap[++J.heap_len]=se=V,J.depth[V]=0):C[V*2+1]=0;for(;J.heap_len<2;)ne=J.heap[++J.heap_len]=se<2?++se:0,C[ne*2]=1,J.depth[ne]=0,J.opt_len--,$&&(J.static_len-=F[ne*2+1]);for(e.max_code=se,V=J.heap_len>>1;V>=1;V--)pqdownheap(J,C,V);ne=Y;do V=J.heap[1],J.heap[1]=J.heap[J.heap_len--],pqdownheap(J,C,1),te=J.heap[1],J.heap[--J.heap_max]=V,J.heap[--J.heap_max]=te,C[ne*2]=C[V*2]+C[te*2],J.depth[ne]=(J.depth[V]>=J.depth[te]?J.depth[V]:J.depth[te])+1,C[V*2+1]=C[te*2+1]=ne,J.heap[1]=ne++,pqdownheap(J,C,1);while(J.heap_len>=2);J.heap[--J.heap_max]=J.heap[1],gen_bitlen(J,e),gen_codes(C,se,J.bl_count)},scan_tree=(J,e,C)=>{let F,$=-1,Y,V=e[0*2+1],te=0,se=7,ne=4;for(V===0&&(se=138,ne=3),e[(C+1)*2+1]=65535,F=0;F<=C;F++)Y=V,V=e[(F+1)*2+1],!(++te<se&&Y===V)&&(te<ne?J.bl_tree[Y*2]+=te:Y!==0?(Y!==$&&J.bl_tree[Y*2]++,J.bl_tree[REP_3_6*2]++):te<=10?J.bl_tree[REPZ_3_10*2]++:J.bl_tree[REPZ_11_138*2]++,te=0,$=Y,V===0?(se=138,ne=3):Y===V?(se=6,ne=3):(se=7,ne=4))},send_tree=(J,e,C)=>{let F,$=-1,Y,V=e[0*2+1],te=0,se=7,ne=4;for(V===0&&(se=138,ne=3),F=0;F<=C;F++)if(Y=V,V=e[(F+1)*2+1],!(++te<se&&Y===V)){if(te<ne)do send_code(J,Y,J.bl_tree);while(--te!==0);else Y!==0?(Y!==$&&(send_code(J,Y,J.bl_tree),te--),send_code(J,REP_3_6,J.bl_tree),send_bits(J,te-3,2)):te<=10?(send_code(J,REPZ_3_10,J.bl_tree),send_bits(J,te-3,3)):(send_code(J,REPZ_11_138,J.bl_tree),send_bits(J,te-11,7));te=0,$=Y,V===0?(se=138,ne=3):Y===V?(se=6,ne=3):(se=7,ne=4)}},build_bl_tree=J=>{let e;for(scan_tree(J,J.dyn_ltree,J.l_desc.max_code),scan_tree(J,J.dyn_dtree,J.d_desc.max_code),build_tree(J,J.bl_desc),e=BL_CODES$1-1;e>=3&&J.bl_tree[bl_order[e]*2+1]===0;e--);return J.opt_len+=3*(e+1)+5+5+4,e},send_all_trees=(J,e,C,F)=>{let $;for(send_bits(J,e-257,5),send_bits(J,C-1,5),send_bits(J,F-4,4),$=0;$<F;$++)send_bits(J,J.bl_tree[bl_order[$]*2+1],3);send_tree(J,J.dyn_ltree,e-1),send_tree(J,J.dyn_dtree,C-1)},detect_data_type=J=>{let e=4093624447,C;for(C=0;C<=31;C++,e>>>=1)if(e&1&&J.dyn_ltree[C*2]!==0)return Z_BINARY;if(J.dyn_ltree[9*2]!==0||J.dyn_ltree[10*2]!==0||J.dyn_ltree[13*2]!==0)return Z_TEXT;for(C=32;C<LITERALS$1;C++)if(J.dyn_ltree[C*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=J=>{static_init_done||(tr_static_init(),static_init_done=!0),J.l_desc=new TreeDesc(J.dyn_ltree,static_l_desc),J.d_desc=new TreeDesc(J.dyn_dtree,static_d_desc),J.bl_desc=new TreeDesc(J.bl_tree,static_bl_desc),J.bi_buf=0,J.bi_valid=0,init_block(J)},_tr_stored_block$1=(J,e,C,F)=>{send_bits(J,(STORED_BLOCK<<1)+(F?1:0),3),bi_windup(J),put_short(J,C),put_short(J,~C),C&&J.pending_buf.set(J.window.subarray(e,e+C),J.pending),J.pending+=C},_tr_align$1=J=>{send_bits(J,STATIC_TREES<<1,3),send_code(J,END_BLOCK,static_ltree),bi_flush(J)},_tr_flush_block$1=(J,e,C,F)=>{let $,Y,V=0;J.level>0?(J.strm.data_type===Z_UNKNOWN$1&&(J.strm.data_type=detect_data_type(J)),build_tree(J,J.l_desc),build_tree(J,J.d_desc),V=build_bl_tree(J),$=J.opt_len+3+7>>>3,Y=J.static_len+3+7>>>3,Y<=$&&($=Y)):$=Y=C+5,C+4<=$&&e!==-1?_tr_stored_block$1(J,e,C,F):J.strategy===Z_FIXED$1||Y===$?(send_bits(J,(STATIC_TREES<<1)+(F?1:0),3),compress_block(J,static_ltree,static_dtree)):(send_bits(J,(DYN_TREES<<1)+(F?1:0),3),send_all_trees(J,J.l_desc.max_code+1,J.d_desc.max_code+1,V+1),compress_block(J,J.dyn_ltree,J.dyn_dtree)),init_block(J),F&&bi_windup(J)},_tr_tally$1=(J,e,C)=>(J.pending_buf[J.sym_buf+J.sym_next++]=e,J.pending_buf[J.sym_buf+J.sym_next++]=e>>8,J.pending_buf[J.sym_buf+J.sym_next++]=C,e===0?J.dyn_ltree[C*2]++:(J.matches++,e--,J.dyn_ltree[(_length_code[C]+LITERALS$1+1)*2]++,J.dyn_dtree[d_code(e)*2]++),J.sym_next===J.sym_end);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32=(J,e,C,F)=>{let $=J&65535|0,Y=J>>>16&65535|0,V=0;for(;C!==0;){V=C>2e3?2e3:C,C-=V;do $=$+e[F++]|0,Y=Y+$|0;while(--V);$%=65521,Y%=65521}return $|Y<<16|0};var adler32_1=adler32;const makeTable=()=>{let J,e=[];for(var C=0;C<256;C++){J=C;for(var F=0;F<8;F++)J=J&1?3988292384^J>>>1:J>>>1;e[C]=J}return e},crcTable=new Uint32Array(makeTable()),crc32=(J,e,C,F)=>{const $=crcTable,Y=F+C;J^=-1;for(let V=F;V<Y;V++)J=J>>>8^$[(J^e[V])&255];return J^-1};var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(J,e)=>(J.msg=messages[e],e),rank=J=>J*2-(J>4?9:0),zero=J=>{let e=J.length;for(;--e>=0;)J[e]=0},slide_hash=J=>{let e,C,F,$=J.w_size;e=J.hash_size,F=e;do C=J.head[--F],J.head[F]=C>=$?C-$:0;while(--e);e=$,F=e;do C=J.prev[--F],J.prev[F]=C>=$?C-$:0;while(--e)};let HASH_ZLIB=(J,e,C)=>(e<<J.hash_shift^C)&J.hash_mask,HASH=HASH_ZLIB;const flush_pending=J=>{const e=J.state;let C=e.pending;C>J.avail_out&&(C=J.avail_out),C!==0&&(J.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+C),J.next_out),J.next_out+=C,e.pending_out+=C,J.total_out+=C,J.avail_out-=C,e.pending-=C,e.pending===0&&(e.pending_out=0))},flush_block_only=(J,e)=>{_tr_flush_block(J,J.block_start>=0?J.block_start:-1,J.strstart-J.block_start,e),J.block_start=J.strstart,flush_pending(J.strm)},put_byte=(J,e)=>{J.pending_buf[J.pending++]=e},putShortMSB=(J,e)=>{J.pending_buf[J.pending++]=e>>>8&255,J.pending_buf[J.pending++]=e&255},read_buf=(J,e,C,F)=>{let $=J.avail_in;return $>F&&($=F),$===0?0:(J.avail_in-=$,e.set(J.input.subarray(J.next_in,J.next_in+$),C),J.state.wrap===1?J.adler=adler32_1(J.adler,e,$,C):J.state.wrap===2&&(J.adler=crc32_1(J.adler,e,$,C)),J.next_in+=$,J.total_in+=$,$)},longest_match=(J,e)=>{let C=J.max_chain_length,F=J.strstart,$,Y,V=J.prev_length,te=J.nice_match;const se=J.strstart>J.w_size-MIN_LOOKAHEAD?J.strstart-(J.w_size-MIN_LOOKAHEAD):0,ne=J.window,ee=J.w_mask,ie=J.prev,ae=J.strstart+MAX_MATCH;let re=ne[F+V-1],oe=ne[F+V];J.prev_length>=J.good_match&&(C>>=2),te>J.lookahead&&(te=J.lookahead);do if($=e,!(ne[$+V]!==oe||ne[$+V-1]!==re||ne[$]!==ne[F]||ne[++$]!==ne[F+1])){F+=2,$++;do;while(ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&ne[++F]===ne[++$]&&F<ae);if(Y=MAX_MATCH-(ae-F),F=ae-MAX_MATCH,Y>V){if(J.match_start=e,V=Y,Y>=te)break;re=ne[F+V-1],oe=ne[F+V]}}while((e=ie[e&ee])>se&&--C!==0);return V<=J.lookahead?V:J.lookahead},fill_window=J=>{const e=J.w_size;let C,F,$;do{if(F=J.window_size-J.lookahead-J.strstart,J.strstart>=e+(e-MIN_LOOKAHEAD)&&(J.window.set(J.window.subarray(e,e+e-F),0),J.match_start-=e,J.strstart-=e,J.block_start-=e,J.insert>J.strstart&&(J.insert=J.strstart),slide_hash(J),F+=e),J.strm.avail_in===0)break;if(C=read_buf(J.strm,J.window,J.strstart+J.lookahead,F),J.lookahead+=C,J.lookahead+J.insert>=MIN_MATCH)for($=J.strstart-J.insert,J.ins_h=J.window[$],J.ins_h=HASH(J,J.ins_h,J.window[$+1]);J.insert&&(J.ins_h=HASH(J,J.ins_h,J.window[$+MIN_MATCH-1]),J.prev[$&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=$,$++,J.insert--,!(J.lookahead+J.insert<MIN_MATCH)););}while(J.lookahead<MIN_LOOKAHEAD&&J.strm.avail_in!==0)},deflate_stored=(J,e)=>{let C=J.pending_buf_size-5>J.w_size?J.w_size:J.pending_buf_size-5,F,$,Y,V=0,te=J.strm.avail_in;do{if(F=65535,Y=J.bi_valid+42>>3,J.strm.avail_out<Y||(Y=J.strm.avail_out-Y,$=J.strstart-J.block_start,F>$+J.strm.avail_in&&(F=$+J.strm.avail_in),F>Y&&(F=Y),F<C&&(F===0&&e!==Z_FINISH$3||e===Z_NO_FLUSH$2||F!==$+J.strm.avail_in)))break;V=e===Z_FINISH$3&&F===$+J.strm.avail_in?1:0,_tr_stored_block(J,0,0,V),J.pending_buf[J.pending-4]=F,J.pending_buf[J.pending-3]=F>>8,J.pending_buf[J.pending-2]=~F,J.pending_buf[J.pending-1]=~F>>8,flush_pending(J.strm),$&&($>F&&($=F),J.strm.output.set(J.window.subarray(J.block_start,J.block_start+$),J.strm.next_out),J.strm.next_out+=$,J.strm.avail_out-=$,J.strm.total_out+=$,J.block_start+=$,F-=$),F&&(read_buf(J.strm,J.strm.output,J.strm.next_out,F),J.strm.next_out+=F,J.strm.avail_out-=F,J.strm.total_out+=F)}while(V===0);return te-=J.strm.avail_in,te&&(te>=J.w_size?(J.matches=2,J.window.set(J.strm.input.subarray(J.strm.next_in-J.w_size,J.strm.next_in),0),J.strstart=J.w_size,J.insert=J.strstart):(J.window_size-J.strstart<=te&&(J.strstart-=J.w_size,J.window.set(J.window.subarray(J.w_size,J.w_size+J.strstart),0),J.matches<2&&J.matches++,J.insert>J.strstart&&(J.insert=J.strstart)),J.window.set(J.strm.input.subarray(J.strm.next_in-te,J.strm.next_in),J.strstart),J.strstart+=te,J.insert+=te>J.w_size-J.insert?J.w_size-J.insert:te),J.block_start=J.strstart),J.high_water<J.strstart&&(J.high_water=J.strstart),V?BS_FINISH_DONE:e!==Z_NO_FLUSH$2&&e!==Z_FINISH$3&&J.strm.avail_in===0&&J.strstart===J.block_start?BS_BLOCK_DONE:(Y=J.window_size-J.strstart,J.strm.avail_in>Y&&J.block_start>=J.w_size&&(J.block_start-=J.w_size,J.strstart-=J.w_size,J.window.set(J.window.subarray(J.w_size,J.w_size+J.strstart),0),J.matches<2&&J.matches++,Y+=J.w_size,J.insert>J.strstart&&(J.insert=J.strstart)),Y>J.strm.avail_in&&(Y=J.strm.avail_in),Y&&(read_buf(J.strm,J.window,J.strstart,Y),J.strstart+=Y,J.insert+=Y>J.w_size-J.insert?J.w_size-J.insert:Y),J.high_water<J.strstart&&(J.high_water=J.strstart),Y=J.bi_valid+42>>3,Y=J.pending_buf_size-Y>65535?65535:J.pending_buf_size-Y,C=Y>J.w_size?J.w_size:Y,$=J.strstart-J.block_start,($>=C||($||e===Z_FINISH$3)&&e!==Z_NO_FLUSH$2&&J.strm.avail_in===0&&$<=Y)&&(F=$>Y?Y:$,V=e===Z_FINISH$3&&J.strm.avail_in===0&&F===$?1:0,_tr_stored_block(J,J.block_start,F,V),J.block_start+=F,flush_pending(J.strm)),V?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=(J,e)=>{let C,F;for(;;){if(J.lookahead<MIN_LOOKAHEAD){if(fill_window(J),J.lookahead<MIN_LOOKAHEAD&&e===Z_NO_FLUSH$2)return BS_NEED_MORE;if(J.lookahead===0)break}if(C=0,J.lookahead>=MIN_MATCH&&(J.ins_h=HASH(J,J.ins_h,J.window[J.strstart+MIN_MATCH-1]),C=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart),C!==0&&J.strstart-C<=J.w_size-MIN_LOOKAHEAD&&(J.match_length=longest_match(J,C)),J.match_length>=MIN_MATCH)if(F=_tr_tally(J,J.strstart-J.match_start,J.match_length-MIN_MATCH),J.lookahead-=J.match_length,J.match_length<=J.max_lazy_match&&J.lookahead>=MIN_MATCH){J.match_length--;do J.strstart++,J.ins_h=HASH(J,J.ins_h,J.window[J.strstart+MIN_MATCH-1]),C=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart;while(--J.match_length!==0);J.strstart++}else J.strstart+=J.match_length,J.match_length=0,J.ins_h=J.window[J.strstart],J.ins_h=HASH(J,J.ins_h,J.window[J.strstart+1]);else F=_tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++;if(F&&(flush_block_only(J,!1),J.strm.avail_out===0))return BS_NEED_MORE}return J.insert=J.strstart<MIN_MATCH-1?J.strstart:MIN_MATCH-1,e===Z_FINISH$3?(flush_block_only(J,!0),J.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):J.sym_next&&(flush_block_only(J,!1),J.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(J,e)=>{let C,F,$;for(;;){if(J.lookahead<MIN_LOOKAHEAD){if(fill_window(J),J.lookahead<MIN_LOOKAHEAD&&e===Z_NO_FLUSH$2)return BS_NEED_MORE;if(J.lookahead===0)break}if(C=0,J.lookahead>=MIN_MATCH&&(J.ins_h=HASH(J,J.ins_h,J.window[J.strstart+MIN_MATCH-1]),C=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart),J.prev_length=J.match_length,J.prev_match=J.match_start,J.match_length=MIN_MATCH-1,C!==0&&J.prev_length<J.max_lazy_match&&J.strstart-C<=J.w_size-MIN_LOOKAHEAD&&(J.match_length=longest_match(J,C),J.match_length<=5&&(J.strategy===Z_FILTERED||J.match_length===MIN_MATCH&&J.strstart-J.match_start>4096)&&(J.match_length=MIN_MATCH-1)),J.prev_length>=MIN_MATCH&&J.match_length<=J.prev_length){$=J.strstart+J.lookahead-MIN_MATCH,F=_tr_tally(J,J.strstart-1-J.prev_match,J.prev_length-MIN_MATCH),J.lookahead-=J.prev_length-1,J.prev_length-=2;do++J.strstart<=$&&(J.ins_h=HASH(J,J.ins_h,J.window[J.strstart+MIN_MATCH-1]),C=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart);while(--J.prev_length!==0);if(J.match_available=0,J.match_length=MIN_MATCH-1,J.strstart++,F&&(flush_block_only(J,!1),J.strm.avail_out===0))return BS_NEED_MORE}else if(J.match_available){if(F=_tr_tally(J,0,J.window[J.strstart-1]),F&&flush_block_only(J,!1),J.strstart++,J.lookahead--,J.strm.avail_out===0)return BS_NEED_MORE}else J.match_available=1,J.strstart++,J.lookahead--}return J.match_available&&(F=_tr_tally(J,0,J.window[J.strstart-1]),J.match_available=0),J.insert=J.strstart<MIN_MATCH-1?J.strstart:MIN_MATCH-1,e===Z_FINISH$3?(flush_block_only(J,!0),J.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):J.sym_next&&(flush_block_only(J,!1),J.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(J,e)=>{let C,F,$,Y;const V=J.window;for(;;){if(J.lookahead<=MAX_MATCH){if(fill_window(J),J.lookahead<=MAX_MATCH&&e===Z_NO_FLUSH$2)return BS_NEED_MORE;if(J.lookahead===0)break}if(J.match_length=0,J.lookahead>=MIN_MATCH&&J.strstart>0&&($=J.strstart-1,F=V[$],F===V[++$]&&F===V[++$]&&F===V[++$])){Y=J.strstart+MAX_MATCH;do;while(F===V[++$]&&F===V[++$]&&F===V[++$]&&F===V[++$]&&F===V[++$]&&F===V[++$]&&F===V[++$]&&F===V[++$]&&$<Y);J.match_length=MAX_MATCH-(Y-$),J.match_length>J.lookahead&&(J.match_length=J.lookahead)}if(J.match_length>=MIN_MATCH?(C=_tr_tally(J,1,J.match_length-MIN_MATCH),J.lookahead-=J.match_length,J.strstart+=J.match_length,J.match_length=0):(C=_tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++),C&&(flush_block_only(J,!1),J.strm.avail_out===0))return BS_NEED_MORE}return J.insert=0,e===Z_FINISH$3?(flush_block_only(J,!0),J.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):J.sym_next&&(flush_block_only(J,!1),J.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(J,e)=>{let C;for(;;){if(J.lookahead===0&&(fill_window(J),J.lookahead===0)){if(e===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(J.match_length=0,C=_tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++,C&&(flush_block_only(J,!1),J.strm.avail_out===0))return BS_NEED_MORE}return J.insert=0,e===Z_FINISH$3?(flush_block_only(J,!0),J.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):J.sym_next&&(flush_block_only(J,!1),J.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(J,e,C,F,$){this.good_length=J,this.max_lazy=e,this.nice_length=C,this.max_chain=F,this.func=$}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=J=>{J.window_size=2*J.w_size,zero(J.head),J.max_lazy_match=configuration_table[J.level].max_lazy,J.good_match=configuration_table[J.level].good_length,J.nice_match=configuration_table[J.level].nice_length,J.max_chain_length=configuration_table[J.level].max_chain,J.strstart=0,J.block_start=0,J.lookahead=0,J.insert=0,J.match_length=J.prev_length=MIN_MATCH-1,J.match_available=0,J.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=J=>{if(!J)return 1;const e=J.state;return!e||e.strm!==J||e.status!==INIT_STATE&&e.status!==GZIP_STATE&&e.status!==EXTRA_STATE&&e.status!==NAME_STATE&&e.status!==COMMENT_STATE&&e.status!==HCRC_STATE&&e.status!==BUSY_STATE&&e.status!==FINISH_STATE?1:0},deflateResetKeep=J=>{if(deflateStateCheck(J))return err(J,Z_STREAM_ERROR$2);J.total_in=J.total_out=0,J.data_type=Z_UNKNOWN;const e=J.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?GZIP_STATE:e.wrap?INIT_STATE:BUSY_STATE,J.adler=e.wrap===2?0:1,e.last_flush=-2,_tr_init(e),Z_OK$3},deflateReset=J=>{const e=deflateResetKeep(J);return e===Z_OK$3&&lm_init(J.state),e},deflateSetHeader=(J,e)=>deflateStateCheck(J)||J.state.wrap!==2?Z_STREAM_ERROR$2:(J.state.gzhead=e,Z_OK$3),deflateInit2=(J,e,C,F,$,Y)=>{if(!J)return Z_STREAM_ERROR$2;let V=1;if(e===Z_DEFAULT_COMPRESSION$1&&(e=6),F<0?(V=0,F=-F):F>15&&(V=2,F-=16),$<1||$>MAX_MEM_LEVEL||C!==Z_DEFLATED$2||F<8||F>15||e<0||e>9||Y<0||Y>Z_FIXED||F===8&&V!==1)return err(J,Z_STREAM_ERROR$2);F===8&&(F=9);const te=new DeflateState;return J.state=te,te.strm=J,te.status=INIT_STATE,te.wrap=V,te.gzhead=null,te.w_bits=F,te.w_size=1<<te.w_bits,te.w_mask=te.w_size-1,te.hash_bits=$+7,te.hash_size=1<<te.hash_bits,te.hash_mask=te.hash_size-1,te.hash_shift=~~((te.hash_bits+MIN_MATCH-1)/MIN_MATCH),te.window=new Uint8Array(te.w_size*2),te.head=new Uint16Array(te.hash_size),te.prev=new Uint16Array(te.w_size),te.lit_bufsize=1<<$+6,te.pending_buf_size=te.lit_bufsize*4,te.pending_buf=new Uint8Array(te.pending_buf_size),te.sym_buf=te.lit_bufsize,te.sym_end=(te.lit_bufsize-1)*3,te.level=e,te.strategy=Y,te.method=C,deflateReset(J)},deflateInit=(J,e)=>deflateInit2(J,e,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(J,e)=>{if(deflateStateCheck(J)||e>Z_BLOCK$1||e<0)return J?err(J,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const C=J.state;if(!J.output||J.avail_in!==0&&!J.input||C.status===FINISH_STATE&&e!==Z_FINISH$3)return err(J,J.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const F=C.last_flush;if(C.last_flush=e,C.pending!==0){if(flush_pending(J),J.avail_out===0)return C.last_flush=-1,Z_OK$3}else if(J.avail_in===0&&rank(e)<=rank(F)&&e!==Z_FINISH$3)return err(J,Z_BUF_ERROR$1);if(C.status===FINISH_STATE&&J.avail_in!==0)return err(J,Z_BUF_ERROR$1);if(C.status===INIT_STATE&&C.wrap===0&&(C.status=BUSY_STATE),C.status===INIT_STATE){let $=Z_DEFLATED$2+(C.w_bits-8<<4)<<8,Y=-1;if(C.strategy>=Z_HUFFMAN_ONLY||C.level<2?Y=0:C.level<6?Y=1:C.level===6?Y=2:Y=3,$|=Y<<6,C.strstart!==0&&($|=PRESET_DICT),$+=31-$%31,putShortMSB(C,$),C.strstart!==0&&(putShortMSB(C,J.adler>>>16),putShortMSB(C,J.adler&65535)),J.adler=1,C.status=BUSY_STATE,flush_pending(J),C.pending!==0)return C.last_flush=-1,Z_OK$3}if(C.status===GZIP_STATE){if(J.adler=0,put_byte(C,31),put_byte(C,139),put_byte(C,8),C.gzhead)put_byte(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),put_byte(C,C.gzhead.time&255),put_byte(C,C.gzhead.time>>8&255),put_byte(C,C.gzhead.time>>16&255),put_byte(C,C.gzhead.time>>24&255),put_byte(C,C.level===9?2:C.strategy>=Z_HUFFMAN_ONLY||C.level<2?4:0),put_byte(C,C.gzhead.os&255),C.gzhead.extra&&C.gzhead.extra.length&&(put_byte(C,C.gzhead.extra.length&255),put_byte(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=EXTRA_STATE;else if(put_byte(C,0),put_byte(C,0),put_byte(C,0),put_byte(C,0),put_byte(C,0),put_byte(C,C.level===9?2:C.strategy>=Z_HUFFMAN_ONLY||C.level<2?4:0),put_byte(C,OS_CODE),C.status=BUSY_STATE,flush_pending(J),C.pending!==0)return C.last_flush=-1,Z_OK$3}if(C.status===EXTRA_STATE){if(C.gzhead.extra){let $=C.pending,Y=(C.gzhead.extra.length&65535)-C.gzindex;for(;C.pending+Y>C.pending_buf_size;){let te=C.pending_buf_size-C.pending;if(C.pending_buf.set(C.gzhead.extra.subarray(C.gzindex,C.gzindex+te),C.pending),C.pending=C.pending_buf_size,C.gzhead.hcrc&&C.pending>$&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending-$,$)),C.gzindex+=te,flush_pending(J),C.pending!==0)return C.last_flush=-1,Z_OK$3;$=0,Y-=te}let V=new Uint8Array(C.gzhead.extra);C.pending_buf.set(V.subarray(C.gzindex,C.gzindex+Y),C.pending),C.pending+=Y,C.gzhead.hcrc&&C.pending>$&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending-$,$)),C.gzindex=0}C.status=NAME_STATE}if(C.status===NAME_STATE){if(C.gzhead.name){let $=C.pending,Y;do{if(C.pending===C.pending_buf_size){if(C.gzhead.hcrc&&C.pending>$&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending-$,$)),flush_pending(J),C.pending!==0)return C.last_flush=-1,Z_OK$3;$=0}C.gzindex<C.gzhead.name.length?Y=C.gzhead.name.charCodeAt(C.gzindex++)&255:Y=0,put_byte(C,Y)}while(Y!==0);C.gzhead.hcrc&&C.pending>$&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending-$,$)),C.gzindex=0}C.status=COMMENT_STATE}if(C.status===COMMENT_STATE){if(C.gzhead.comment){let $=C.pending,Y;do{if(C.pending===C.pending_buf_size){if(C.gzhead.hcrc&&C.pending>$&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending-$,$)),flush_pending(J),C.pending!==0)return C.last_flush=-1,Z_OK$3;$=0}C.gzindex<C.gzhead.comment.length?Y=C.gzhead.comment.charCodeAt(C.gzindex++)&255:Y=0,put_byte(C,Y)}while(Y!==0);C.gzhead.hcrc&&C.pending>$&&(J.adler=crc32_1(J.adler,C.pending_buf,C.pending-$,$))}C.status=HCRC_STATE}if(C.status===HCRC_STATE){if(C.gzhead.hcrc){if(C.pending+2>C.pending_buf_size&&(flush_pending(J),C.pending!==0))return C.last_flush=-1,Z_OK$3;put_byte(C,J.adler&255),put_byte(C,J.adler>>8&255),J.adler=0}if(C.status=BUSY_STATE,flush_pending(J),C.pending!==0)return C.last_flush=-1,Z_OK$3}if(J.avail_in!==0||C.lookahead!==0||e!==Z_NO_FLUSH$2&&C.status!==FINISH_STATE){let $=C.level===0?deflate_stored(C,e):C.strategy===Z_HUFFMAN_ONLY?deflate_huff(C,e):C.strategy===Z_RLE?deflate_rle(C,e):configuration_table[C.level].func(C,e);if(($===BS_FINISH_STARTED||$===BS_FINISH_DONE)&&(C.status=FINISH_STATE),$===BS_NEED_MORE||$===BS_FINISH_STARTED)return J.avail_out===0&&(C.last_flush=-1),Z_OK$3;if($===BS_BLOCK_DONE&&(e===Z_PARTIAL_FLUSH?_tr_align(C):e!==Z_BLOCK$1&&(_tr_stored_block(C,0,0,!1),e===Z_FULL_FLUSH$1&&(zero(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),flush_pending(J),J.avail_out===0))return C.last_flush=-1,Z_OK$3}return e!==Z_FINISH$3?Z_OK$3:C.wrap<=0?Z_STREAM_END$3:(C.wrap===2?(put_byte(C,J.adler&255),put_byte(C,J.adler>>8&255),put_byte(C,J.adler>>16&255),put_byte(C,J.adler>>24&255),put_byte(C,J.total_in&255),put_byte(C,J.total_in>>8&255),put_byte(C,J.total_in>>16&255),put_byte(C,J.total_in>>24&255)):(putShortMSB(C,J.adler>>>16),putShortMSB(C,J.adler&65535)),flush_pending(J),C.wrap>0&&(C.wrap=-C.wrap),C.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=J=>{if(deflateStateCheck(J))return Z_STREAM_ERROR$2;const e=J.state.status;return J.state=null,e===BUSY_STATE?err(J,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary=(J,e)=>{let C=e.length;if(deflateStateCheck(J))return Z_STREAM_ERROR$2;const F=J.state,$=F.wrap;if($===2||$===1&&F.status!==INIT_STATE||F.lookahead)return Z_STREAM_ERROR$2;if($===1&&(J.adler=adler32_1(J.adler,e,C,0)),F.wrap=0,C>=F.w_size){$===0&&(zero(F.head),F.strstart=0,F.block_start=0,F.insert=0);let se=new Uint8Array(F.w_size);se.set(e.subarray(C-F.w_size,C),0),e=se,C=F.w_size}const Y=J.avail_in,V=J.next_in,te=J.input;for(J.avail_in=C,J.next_in=0,J.input=e,fill_window(F);F.lookahead>=MIN_MATCH;){let se=F.strstart,ne=F.lookahead-(MIN_MATCH-1);do F.ins_h=HASH(F,F.ins_h,F.window[se+MIN_MATCH-1]),F.prev[se&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=se,se++;while(--ne);F.strstart=se,F.lookahead=MIN_MATCH-1,fill_window(F)}return F.strstart+=F.lookahead,F.block_start=F.strstart,F.insert=F.lookahead,F.lookahead=0,F.match_length=F.prev_length=MIN_MATCH-1,F.match_available=0,J.next_in=V,J.input=te,J.avail_in=Y,F.wrap=$,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has=(J,e)=>Object.prototype.hasOwnProperty.call(J,e);var assign=function(J){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const C=e.shift();if(C){if(typeof C!="object")throw new TypeError(C+"must be non-object");for(const F in C)_has(C,F)&&(J[F]=C[F])}}return J},flattenChunks=J=>{let e=0;for(let F=0,$=J.length;F<$;F++)e+=J[F].length;const C=new Uint8Array(e);for(let F=0,$=0,Y=J.length;F<Y;F++){let V=J[F];C.set(V,$),$+=V.length}return C},common={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(J){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let J=0;J<256;J++)_utf8len[J]=J>=252?6:J>=248?5:J>=240?4:J>=224?3:J>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=J=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(J);let e,C,F,$,Y,V=J.length,te=0;for($=0;$<V;$++)C=J.charCodeAt($),(C&64512)===55296&&$+1<V&&(F=J.charCodeAt($+1),(F&64512)===56320&&(C=65536+(C-55296<<10)+(F-56320),$++)),te+=C<128?1:C<2048?2:C<65536?3:4;for(e=new Uint8Array(te),Y=0,$=0;Y<te;$++)C=J.charCodeAt($),(C&64512)===55296&&$+1<V&&(F=J.charCodeAt($+1),(F&64512)===56320&&(C=65536+(C-55296<<10)+(F-56320),$++)),C<128?e[Y++]=C:C<2048?(e[Y++]=192|C>>>6,e[Y++]=128|C&63):C<65536?(e[Y++]=224|C>>>12,e[Y++]=128|C>>>6&63,e[Y++]=128|C&63):(e[Y++]=240|C>>>18,e[Y++]=128|C>>>12&63,e[Y++]=128|C>>>6&63,e[Y++]=128|C&63);return e};const buf2binstring=(J,e)=>{if(e<65534&&J.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,J.length===e?J:J.subarray(0,e));let C="";for(let F=0;F<e;F++)C+=String.fromCharCode(J[F]);return C};var buf2string=(J,e)=>{const C=e||J.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(J.subarray(0,e));let F,$;const Y=new Array(C*2);for($=0,F=0;F<C;){let V=J[F++];if(V<128){Y[$++]=V;continue}let te=_utf8len[V];if(te>4){Y[$++]=65533,F+=te-1;continue}for(V&=te===2?31:te===3?15:7;te>1&&F<C;)V=V<<6|J[F++]&63,te--;if(te>1){Y[$++]=65533;continue}V<65536?Y[$++]=V:(V-=65536,Y[$++]=55296|V>>10&1023,Y[$++]=56320|V&1023)}return buf2binstring(Y,$)},utf8border=(J,e)=>{e=e||J.length,e>J.length&&(e=J.length);let C=e-1;for(;C>=0&&(J[C]&192)===128;)C--;return C<0||C===0?e:C+_utf8len[J[C]]>e?C:e},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const toString$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2;function Deflate$1(J){this.options=common.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},J||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let C=deflate_1$2.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(C!==Z_OK$2)throw new Error(messages[C]);if(e.header&&deflate_1$2.deflateSetHeader(this.strm,e.header),e.dictionary){let F;if(typeof e.dictionary=="string"?F=strings.string2buf(e.dictionary):toString$1.call(e.dictionary)==="[object ArrayBuffer]"?F=new Uint8Array(e.dictionary):F=e.dictionary,C=deflate_1$2.deflateSetDictionary(this.strm,F),C!==Z_OK$2)throw new Error(messages[C]);this._dict_set=!0}}Deflate$1.prototype.push=function(J,e){const C=this.strm,F=this.options.chunkSize;let $,Y;if(this.ended)return!1;for(e===~~e?Y=e:Y=e===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof J=="string"?C.input=strings.string2buf(J):toString$1.call(J)==="[object ArrayBuffer]"?C.input=new Uint8Array(J):C.input=J,C.next_in=0,C.avail_in=C.input.length;;){if(C.avail_out===0&&(C.output=new Uint8Array(F),C.next_out=0,C.avail_out=F),(Y===Z_SYNC_FLUSH||Y===Z_FULL_FLUSH)&&C.avail_out<=6){this.onData(C.output.subarray(0,C.next_out)),C.avail_out=0;continue}if($=deflate_1$2.deflate(C,Y),$===Z_STREAM_END$2)return C.next_out>0&&this.onData(C.output.subarray(0,C.next_out)),$=deflate_1$2.deflateEnd(this.strm),this.onEnd($),this.ended=!0,$===Z_OK$2;if(C.avail_out===0){this.onData(C.output);continue}if(Y>0&&C.next_out>0){this.onData(C.output.subarray(0,C.next_out)),C.avail_out=0;continue}if(C.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(J){this.chunks.push(J)};Deflate$1.prototype.onEnd=function(J){J===Z_OK$2&&(this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=J,this.msg=this.strm.msg};function deflate$1(J,e){const C=new Deflate$1(e);if(C.push(J,!0),C.err)throw C.msg||messages[C.err];return C.result}function deflateRaw$1(J,e){return e=e||{},e.raw=!0,deflate$1(J,e)}function gzip$1(J,e){return e=e||{},e.gzip=!0,deflate$1(J,e)}var Deflate_1$1=Deflate$1,deflate_2=deflate$1,deflateRaw_1$1=deflateRaw$1,gzip_1$1=gzip$1,constants$1=constants$2,deflate_1$1={Deflate:Deflate_1$1,deflate:deflate_2,deflateRaw:deflateRaw_1$1,gzip:gzip_1$1,constants:constants$1};const BAD$1=16209,TYPE$1=16191;var inffast=function J(e,C){let F,$,Y,V,te,se,ne,ee,ie,ae,re,oe,ce,he,de,pe,fe,ye,_e,Ee,be,Ae,we,Te;const Me=e.state;F=e.next_in,we=e.input,$=F+(e.avail_in-5),Y=e.next_out,Te=e.output,V=Y-(C-e.avail_out),te=Y+(e.avail_out-257),se=Me.dmax,ne=Me.wsize,ee=Me.whave,ie=Me.wnext,ae=Me.window,re=Me.hold,oe=Me.bits,ce=Me.lencode,he=Me.distcode,de=(1<<Me.lenbits)-1,pe=(1<<Me.distbits)-1;e:do{oe<15&&(re+=we[F++]<<oe,oe+=8,re+=we[F++]<<oe,oe+=8),fe=ce[re&de];t:for(;;){if(ye=fe>>>24,re>>>=ye,oe-=ye,ye=fe>>>16&255,ye===0)Te[Y++]=fe&65535;else if(ye&16){_e=fe&65535,ye&=15,ye&&(oe<ye&&(re+=we[F++]<<oe,oe+=8),_e+=re&(1<<ye)-1,re>>>=ye,oe-=ye),oe<15&&(re+=we[F++]<<oe,oe+=8,re+=we[F++]<<oe,oe+=8),fe=he[re&pe];n:for(;;){if(ye=fe>>>24,re>>>=ye,oe-=ye,ye=fe>>>16&255,ye&16){if(Ee=fe&65535,ye&=15,oe<ye&&(re+=we[F++]<<oe,oe+=8,oe<ye&&(re+=we[F++]<<oe,oe+=8)),Ee+=re&(1<<ye)-1,Ee>se){e.msg="invalid distance too far back",Me.mode=BAD$1;break e}if(re>>>=ye,oe-=ye,ye=Y-V,Ee>ye){if(ye=Ee-ye,ye>ee&&Me.sane){e.msg="invalid distance too far back",Me.mode=BAD$1;break e}if(be=0,Ae=ae,ie===0){if(be+=ne-ye,ye<_e){_e-=ye;do Te[Y++]=ae[be++];while(--ye);be=Y-Ee,Ae=Te}}else if(ie<ye){if(be+=ne+ie-ye,ye-=ie,ye<_e){_e-=ye;do Te[Y++]=ae[be++];while(--ye);if(be=0,ie<_e){ye=ie,_e-=ye;do Te[Y++]=ae[be++];while(--ye);be=Y-Ee,Ae=Te}}}else if(be+=ie-ye,ye<_e){_e-=ye;do Te[Y++]=ae[be++];while(--ye);be=Y-Ee,Ae=Te}for(;_e>2;)Te[Y++]=Ae[be++],Te[Y++]=Ae[be++],Te[Y++]=Ae[be++],_e-=3;_e&&(Te[Y++]=Ae[be++],_e>1&&(Te[Y++]=Ae[be++]))}else{be=Y-Ee;do Te[Y++]=Te[be++],Te[Y++]=Te[be++],Te[Y++]=Te[be++],_e-=3;while(_e>2);_e&&(Te[Y++]=Te[be++],_e>1&&(Te[Y++]=Te[be++]))}}else if(ye&64){e.msg="invalid distance code",Me.mode=BAD$1;break e}else{fe=he[(fe&65535)+(re&(1<<ye)-1)];continue n}break}}else if(ye&64)if(ye&32){Me.mode=TYPE$1;break e}else{e.msg="invalid literal/length code",Me.mode=BAD$1;break e}else{fe=ce[(fe&65535)+(re&(1<<ye)-1)];continue t}break}}while(F<$&&Y<te);_e=oe>>3,F-=_e,oe-=_e<<3,re&=(1<<oe)-1,e.next_in=F,e.next_out=Y,e.avail_in=F<$?5+($-F):5-(F-$),e.avail_out=Y<te?257+(te-Y):257-(Y-te),Me.hold=re,Me.bits=oe};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(J,e,C,F,$,Y,V,te)=>{const se=te.bits;let ne=0,ee=0,ie=0,ae=0,re=0,oe=0,ce=0,he=0,de=0,pe=0,fe,ye,_e,Ee,be,Ae=null,we;const Te=new Uint16Array(MAXBITS+1),Me=new Uint16Array(MAXBITS+1);let Be=null,$e,Fe,Xe;for(ne=0;ne<=MAXBITS;ne++)Te[ne]=0;for(ee=0;ee<F;ee++)Te[e[C+ee]]++;for(re=se,ae=MAXBITS;ae>=1&&Te[ae]===0;ae--);if(re>ae&&(re=ae),ae===0)return $[Y++]=1<<24|64<<16|0,$[Y++]=1<<24|64<<16|0,te.bits=1,0;for(ie=1;ie<ae&&Te[ie]===0;ie++);for(re<ie&&(re=ie),he=1,ne=1;ne<=MAXBITS;ne++)if(he<<=1,he-=Te[ne],he<0)return-1;if(he>0&&(J===CODES$1||ae!==1))return-1;for(Me[1]=0,ne=1;ne<MAXBITS;ne++)Me[ne+1]=Me[ne]+Te[ne];for(ee=0;ee<F;ee++)e[C+ee]!==0&&(V[Me[e[C+ee]]++]=ee);if(J===CODES$1?(Ae=Be=V,we=20):J===LENS$1?(Ae=lbase,Be=lext,we=257):(Ae=dbase,Be=dext,we=0),pe=0,ee=0,ne=ie,be=Y,oe=re,ce=0,_e=-1,de=1<<re,Ee=de-1,J===LENS$1&&de>ENOUGH_LENS$1||J===DISTS$1&&de>ENOUGH_DISTS$1)return 1;for(;;){$e=ne-ce,V[ee]+1<we?(Fe=0,Xe=V[ee]):V[ee]>=we?(Fe=Be[V[ee]-we],Xe=Ae[V[ee]-we]):(Fe=32+64,Xe=0),fe=1<<ne-ce,ye=1<<oe,ie=ye;do ye-=fe,$[be+(pe>>ce)+ye]=$e<<24|Fe<<16|Xe|0;while(ye!==0);for(fe=1<<ne-1;pe&fe;)fe>>=1;if(fe!==0?(pe&=fe-1,pe+=fe):pe=0,ee++,--Te[ne]===0){if(ne===ae)break;ne=e[C+V[ee]]}if(ne>re&&(pe&Ee)!==_e){for(ce===0&&(ce=re),be+=ie,oe=ne-ce,he=1<<oe;oe+ce<ae&&(he-=Te[oe+ce],!(he<=0));)oe++,he<<=1;if(de+=1<<oe,J===LENS$1&&de>ENOUGH_LENS$1||J===DISTS$1&&de>ENOUGH_DISTS$1)return 1;_e=pe&Ee,$[_e]=re<<24|oe<<16|be-Y|0}}return pe!==0&&($[be+pe]=ne-ce<<24|64<<16|0),te.bits=re,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=J=>(J>>>24&255)+(J>>>8&65280)+((J&65280)<<8)+((J&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=J=>{if(!J)return 1;const e=J.state;return!e||e.strm!==J||e.mode<HEAD||e.mode>SYNC?1:0},inflateResetKeep=J=>{if(inflateStateCheck(J))return Z_STREAM_ERROR$1;const e=J.state;return J.total_in=J.total_out=e.total=0,J.msg="",e.wrap&&(J.adler=e.wrap&1),e.mode=HEAD,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(ENOUGH_LENS),e.distcode=e.distdyn=new Int32Array(ENOUGH_DISTS),e.sane=1,e.back=-1,Z_OK$1},inflateReset=J=>{if(inflateStateCheck(J))return Z_STREAM_ERROR$1;const e=J.state;return e.wsize=0,e.whave=0,e.wnext=0,inflateResetKeep(J)},inflateReset2=(J,e)=>{let C;if(inflateStateCheck(J))return Z_STREAM_ERROR$1;const F=J.state;return e<0?(C=0,e=-e):(C=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Z_STREAM_ERROR$1:(F.window!==null&&F.wbits!==e&&(F.window=null),F.wrap=C,F.wbits=e,inflateReset(J))},inflateInit2=(J,e)=>{if(!J)return Z_STREAM_ERROR$1;const C=new InflateState;J.state=C,C.strm=J,C.window=null,C.mode=HEAD;const F=inflateReset2(J,e);return F!==Z_OK$1&&(J.state=null),F},inflateInit=J=>inflateInit2(J,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=J=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let e=0;for(;e<144;)J.lens[e++]=8;for(;e<256;)J.lens[e++]=9;for(;e<280;)J.lens[e++]=7;for(;e<288;)J.lens[e++]=8;for(inftrees(LENS,J.lens,0,288,lenfix,0,J.work,{bits:9}),e=0;e<32;)J.lens[e++]=5;inftrees(DISTS,J.lens,0,32,distfix,0,J.work,{bits:5}),virgin=!1}J.lencode=lenfix,J.lenbits=9,J.distcode=distfix,J.distbits=5},updatewindow=(J,e,C,F)=>{let $;const Y=J.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new Uint8Array(Y.wsize)),F>=Y.wsize?(Y.window.set(e.subarray(C-Y.wsize,C),0),Y.wnext=0,Y.whave=Y.wsize):($=Y.wsize-Y.wnext,$>F&&($=F),Y.window.set(e.subarray(C-F,C-F+$),Y.wnext),F-=$,F?(Y.window.set(e.subarray(C-F,C),0),Y.wnext=F,Y.whave=Y.wsize):(Y.wnext+=$,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=$))),0},inflate$2=(J,e)=>{let C,F,$,Y,V,te,se,ne,ee,ie,ae,re,oe,ce,he=0,de,pe,fe,ye,_e,Ee,be,Ae;const we=new Uint8Array(4);let Te,Me;const Be=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(J)||!J.output||!J.input&&J.avail_in!==0)return Z_STREAM_ERROR$1;C=J.state,C.mode===TYPE&&(C.mode=TYPEDO),V=J.next_out,$=J.output,se=J.avail_out,Y=J.next_in,F=J.input,te=J.avail_in,ne=C.hold,ee=C.bits,ie=te,ae=se,Ae=Z_OK$1;e:for(;;)switch(C.mode){case HEAD:if(C.wrap===0){C.mode=TYPEDO;break}for(;ee<16;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(C.wrap&2&&ne===35615){C.wbits===0&&(C.wbits=15),C.check=0,we[0]=ne&255,we[1]=ne>>>8&255,C.check=crc32_1(C.check,we,2,0),ne=0,ee=0,C.mode=FLAGS;break}if(C.head&&(C.head.done=!1),!(C.wrap&1)||(((ne&255)<<8)+(ne>>8))%31){J.msg="incorrect header check",C.mode=BAD;break}if((ne&15)!==Z_DEFLATED){J.msg="unknown compression method",C.mode=BAD;break}if(ne>>>=4,ee-=4,be=(ne&15)+8,C.wbits===0&&(C.wbits=be),be>15||be>C.wbits){J.msg="invalid window size",C.mode=BAD;break}C.dmax=1<<C.wbits,C.flags=0,J.adler=C.check=1,C.mode=ne&512?DICTID:TYPE,ne=0,ee=0;break;case FLAGS:for(;ee<16;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(C.flags=ne,(C.flags&255)!==Z_DEFLATED){J.msg="unknown compression method",C.mode=BAD;break}if(C.flags&57344){J.msg="unknown header flags set",C.mode=BAD;break}C.head&&(C.head.text=ne>>8&1),C.flags&512&&C.wrap&4&&(we[0]=ne&255,we[1]=ne>>>8&255,C.check=crc32_1(C.check,we,2,0)),ne=0,ee=0,C.mode=TIME;case TIME:for(;ee<32;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}C.head&&(C.head.time=ne),C.flags&512&&C.wrap&4&&(we[0]=ne&255,we[1]=ne>>>8&255,we[2]=ne>>>16&255,we[3]=ne>>>24&255,C.check=crc32_1(C.check,we,4,0)),ne=0,ee=0,C.mode=OS;case OS:for(;ee<16;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}C.head&&(C.head.xflags=ne&255,C.head.os=ne>>8),C.flags&512&&C.wrap&4&&(we[0]=ne&255,we[1]=ne>>>8&255,C.check=crc32_1(C.check,we,2,0)),ne=0,ee=0,C.mode=EXLEN;case EXLEN:if(C.flags&1024){for(;ee<16;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}C.length=ne,C.head&&(C.head.extra_len=ne),C.flags&512&&C.wrap&4&&(we[0]=ne&255,we[1]=ne>>>8&255,C.check=crc32_1(C.check,we,2,0)),ne=0,ee=0}else C.head&&(C.head.extra=null);C.mode=EXTRA;case EXTRA:if(C.flags&1024&&(re=C.length,re>te&&(re=te),re&&(C.head&&(be=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Uint8Array(C.head.extra_len)),C.head.extra.set(F.subarray(Y,Y+re),be)),C.flags&512&&C.wrap&4&&(C.check=crc32_1(C.check,F,re,Y)),te-=re,Y+=re,C.length-=re),C.length))break e;C.length=0,C.mode=NAME;case NAME:if(C.flags&2048){if(te===0)break e;re=0;do be=F[Y+re++],C.head&&be&&C.length<65536&&(C.head.name+=String.fromCharCode(be));while(be&&re<te);if(C.flags&512&&C.wrap&4&&(C.check=crc32_1(C.check,F,re,Y)),te-=re,Y+=re,be)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=COMMENT;case COMMENT:if(C.flags&4096){if(te===0)break e;re=0;do be=F[Y+re++],C.head&&be&&C.length<65536&&(C.head.comment+=String.fromCharCode(be));while(be&&re<te);if(C.flags&512&&C.wrap&4&&(C.check=crc32_1(C.check,F,re,Y)),te-=re,Y+=re,be)break e}else C.head&&(C.head.comment=null);C.mode=HCRC;case HCRC:if(C.flags&512){for(;ee<16;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(C.wrap&4&&ne!==(C.check&65535)){J.msg="header crc mismatch",C.mode=BAD;break}ne=0,ee=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),J.adler=C.check=0,C.mode=TYPE;break;case DICTID:for(;ee<32;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}J.adler=C.check=zswap32(ne),ne=0,ee=0,C.mode=DICT;case DICT:if(C.havedict===0)return J.next_out=V,J.avail_out=se,J.next_in=Y,J.avail_in=te,C.hold=ne,C.bits=ee,Z_NEED_DICT$1;J.adler=C.check=1,C.mode=TYPE;case TYPE:if(e===Z_BLOCK||e===Z_TREES)break e;case TYPEDO:if(C.last){ne>>>=ee&7,ee-=ee&7,C.mode=CHECK;break}for(;ee<3;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}switch(C.last=ne&1,ne>>>=1,ee-=1,ne&3){case 0:C.mode=STORED;break;case 1:if(fixedtables(C),C.mode=LEN_,e===Z_TREES){ne>>>=2,ee-=2;break e}break;case 2:C.mode=TABLE;break;case 3:J.msg="invalid block type",C.mode=BAD}ne>>>=2,ee-=2;break;case STORED:for(ne>>>=ee&7,ee-=ee&7;ee<32;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if((ne&65535)!==(ne>>>16^65535)){J.msg="invalid stored block lengths",C.mode=BAD;break}if(C.length=ne&65535,ne=0,ee=0,C.mode=COPY_,e===Z_TREES)break e;case COPY_:C.mode=COPY;case COPY:if(re=C.length,re){if(re>te&&(re=te),re>se&&(re=se),re===0)break e;$.set(F.subarray(Y,Y+re),V),te-=re,Y+=re,se-=re,V+=re,C.length-=re;break}C.mode=TYPE;break;case TABLE:for(;ee<14;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(C.nlen=(ne&31)+257,ne>>>=5,ee-=5,C.ndist=(ne&31)+1,ne>>>=5,ee-=5,C.ncode=(ne&15)+4,ne>>>=4,ee-=4,C.nlen>286||C.ndist>30){J.msg="too many length or distance symbols",C.mode=BAD;break}C.have=0,C.mode=LENLENS;case LENLENS:for(;C.have<C.ncode;){for(;ee<3;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}C.lens[Be[C.have++]]=ne&7,ne>>>=3,ee-=3}for(;C.have<19;)C.lens[Be[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,Te={bits:C.lenbits},Ae=inftrees(CODES,C.lens,0,19,C.lencode,0,C.work,Te),C.lenbits=Te.bits,Ae){J.msg="invalid code lengths set",C.mode=BAD;break}C.have=0,C.mode=CODELENS;case CODELENS:for(;C.have<C.nlen+C.ndist;){for(;he=C.lencode[ne&(1<<C.lenbits)-1],de=he>>>24,pe=he>>>16&255,fe=he&65535,!(de<=ee);){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(fe<16)ne>>>=de,ee-=de,C.lens[C.have++]=fe;else{if(fe===16){for(Me=de+2;ee<Me;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(ne>>>=de,ee-=de,C.have===0){J.msg="invalid bit length repeat",C.mode=BAD;break}be=C.lens[C.have-1],re=3+(ne&3),ne>>>=2,ee-=2}else if(fe===17){for(Me=de+3;ee<Me;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}ne>>>=de,ee-=de,be=0,re=3+(ne&7),ne>>>=3,ee-=3}else{for(Me=de+7;ee<Me;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}ne>>>=de,ee-=de,be=0,re=11+(ne&127),ne>>>=7,ee-=7}if(C.have+re>C.nlen+C.ndist){J.msg="invalid bit length repeat",C.mode=BAD;break}for(;re--;)C.lens[C.have++]=be}}if(C.mode===BAD)break;if(C.lens[256]===0){J.msg="invalid code -- missing end-of-block",C.mode=BAD;break}if(C.lenbits=9,Te={bits:C.lenbits},Ae=inftrees(LENS,C.lens,0,C.nlen,C.lencode,0,C.work,Te),C.lenbits=Te.bits,Ae){J.msg="invalid literal/lengths set",C.mode=BAD;break}if(C.distbits=6,C.distcode=C.distdyn,Te={bits:C.distbits},Ae=inftrees(DISTS,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,Te),C.distbits=Te.bits,Ae){J.msg="invalid distances set",C.mode=BAD;break}if(C.mode=LEN_,e===Z_TREES)break e;case LEN_:C.mode=LEN;case LEN:if(te>=6&&se>=258){J.next_out=V,J.avail_out=se,J.next_in=Y,J.avail_in=te,C.hold=ne,C.bits=ee,inffast(J,ae),V=J.next_out,$=J.output,se=J.avail_out,Y=J.next_in,F=J.input,te=J.avail_in,ne=C.hold,ee=C.bits,C.mode===TYPE&&(C.back=-1);break}for(C.back=0;he=C.lencode[ne&(1<<C.lenbits)-1],de=he>>>24,pe=he>>>16&255,fe=he&65535,!(de<=ee);){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(pe&&!(pe&240)){for(ye=de,_e=pe,Ee=fe;he=C.lencode[Ee+((ne&(1<<ye+_e)-1)>>ye)],de=he>>>24,pe=he>>>16&255,fe=he&65535,!(ye+de<=ee);){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}ne>>>=ye,ee-=ye,C.back+=ye}if(ne>>>=de,ee-=de,C.back+=de,C.length=fe,pe===0){C.mode=LIT;break}if(pe&32){C.back=-1,C.mode=TYPE;break}if(pe&64){J.msg="invalid literal/length code",C.mode=BAD;break}C.extra=pe&15,C.mode=LENEXT;case LENEXT:if(C.extra){for(Me=C.extra;ee<Me;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}C.length+=ne&(1<<C.extra)-1,ne>>>=C.extra,ee-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=DIST;case DIST:for(;he=C.distcode[ne&(1<<C.distbits)-1],de=he>>>24,pe=he>>>16&255,fe=he&65535,!(de<=ee);){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(!(pe&240)){for(ye=de,_e=pe,Ee=fe;he=C.distcode[Ee+((ne&(1<<ye+_e)-1)>>ye)],de=he>>>24,pe=he>>>16&255,fe=he&65535,!(ye+de<=ee);){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}ne>>>=ye,ee-=ye,C.back+=ye}if(ne>>>=de,ee-=de,C.back+=de,pe&64){J.msg="invalid distance code",C.mode=BAD;break}C.offset=fe,C.extra=pe&15,C.mode=DISTEXT;case DISTEXT:if(C.extra){for(Me=C.extra;ee<Me;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}C.offset+=ne&(1<<C.extra)-1,ne>>>=C.extra,ee-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){J.msg="invalid distance too far back",C.mode=BAD;break}C.mode=MATCH;case MATCH:if(se===0)break e;if(re=ae-se,C.offset>re){if(re=C.offset-re,re>C.whave&&C.sane){J.msg="invalid distance too far back",C.mode=BAD;break}re>C.wnext?(re-=C.wnext,oe=C.wsize-re):oe=C.wnext-re,re>C.length&&(re=C.length),ce=C.window}else ce=$,oe=V-C.offset,re=C.length;re>se&&(re=se),se-=re,C.length-=re;do $[V++]=ce[oe++];while(--re);C.length===0&&(C.mode=LEN);break;case LIT:if(se===0)break e;$[V++]=C.length,se--,C.mode=LEN;break;case CHECK:if(C.wrap){for(;ee<32;){if(te===0)break e;te--,ne|=F[Y++]<<ee,ee+=8}if(ae-=se,J.total_out+=ae,C.total+=ae,C.wrap&4&&ae&&(J.adler=C.check=C.flags?crc32_1(C.check,$,ae,V-ae):adler32_1(C.check,$,ae,V-ae)),ae=se,C.wrap&4&&(C.flags?ne:zswap32(ne))!==C.check){J.msg="incorrect data check",C.mode=BAD;break}ne=0,ee=0}C.mode=LENGTH;case LENGTH:if(C.wrap&&C.flags){for(;ee<32;){if(te===0)break e;te--,ne+=F[Y++]<<ee,ee+=8}if(C.wrap&4&&ne!==(C.total&4294967295)){J.msg="incorrect length check",C.mode=BAD;break}ne=0,ee=0}C.mode=DONE;case DONE:Ae=Z_STREAM_END$1;break e;case BAD:Ae=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return J.next_out=V,J.avail_out=se,J.next_in=Y,J.avail_in=te,C.hold=ne,C.bits=ee,(C.wsize||ae!==J.avail_out&&C.mode<BAD&&(C.mode<CHECK||e!==Z_FINISH$1))&&updatewindow(J,J.output,J.next_out,ae-J.avail_out),ie-=J.avail_in,ae-=J.avail_out,J.total_in+=ie,J.total_out+=ae,C.total+=ae,C.wrap&4&&ae&&(J.adler=C.check=C.flags?crc32_1(C.check,$,ae,J.next_out-ae):adler32_1(C.check,$,ae,J.next_out-ae)),J.data_type=C.bits+(C.last?64:0)+(C.mode===TYPE?128:0)+(C.mode===LEN_||C.mode===COPY_?256:0),(ie===0&&ae===0||e===Z_FINISH$1)&&Ae===Z_OK$1&&(Ae=Z_BUF_ERROR),Ae},inflateEnd=J=>{if(inflateStateCheck(J))return Z_STREAM_ERROR$1;let e=J.state;return e.window&&(e.window=null),J.state=null,Z_OK$1},inflateGetHeader=(J,e)=>{if(inflateStateCheck(J))return Z_STREAM_ERROR$1;const C=J.state;return C.wrap&2?(C.head=e,e.done=!1,Z_OK$1):Z_STREAM_ERROR$1},inflateSetDictionary=(J,e)=>{const C=e.length;let F,$,Y;return inflateStateCheck(J)||(F=J.state,F.wrap!==0&&F.mode!==DICT)?Z_STREAM_ERROR$1:F.mode===DICT&&($=1,$=adler32_1($,e,C,0),$!==F.check)?Z_DATA_ERROR$1:(Y=updatewindow(J,e,C,C),Y?(F.mode=MEM,Z_MEM_ERROR$1):(F.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(J){this.options=common.assign({chunkSize:1024*64,windowBits:15,to:""},J||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(J&&J.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let C=inflate_1$2.inflateInit2(this.strm,e.windowBits);if(C!==Z_OK)throw new Error(messages[C]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=strings.string2buf(e.dictionary):toString.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(C=inflate_1$2.inflateSetDictionary(this.strm,e.dictionary),C!==Z_OK)))throw new Error(messages[C])}Inflate$1.prototype.push=function(J,e){const C=this.strm,F=this.options.chunkSize,$=this.options.dictionary;let Y,V,te;if(this.ended)return!1;for(e===~~e?V=e:V=e===!0?Z_FINISH:Z_NO_FLUSH,toString.call(J)==="[object ArrayBuffer]"?C.input=new Uint8Array(J):C.input=J,C.next_in=0,C.avail_in=C.input.length;;){for(C.avail_out===0&&(C.output=new Uint8Array(F),C.next_out=0,C.avail_out=F),Y=inflate_1$2.inflate(C,V),Y===Z_NEED_DICT&&$&&(Y=inflate_1$2.inflateSetDictionary(C,$),Y===Z_OK?Y=inflate_1$2.inflate(C,V):Y===Z_DATA_ERROR&&(Y=Z_NEED_DICT));C.avail_in>0&&Y===Z_STREAM_END&&C.state.wrap>0&&J[C.next_in]!==0;)inflate_1$2.inflateReset(C),Y=inflate_1$2.inflate(C,V);switch(Y){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(Y),this.ended=!0,!1}if(te=C.avail_out,C.next_out&&(C.avail_out===0||Y===Z_STREAM_END))if(this.options.to==="string"){let se=strings.utf8border(C.output,C.next_out),ne=C.next_out-se,ee=strings.buf2string(C.output,se);C.next_out=ne,C.avail_out=F-ne,ne&&C.output.set(C.output.subarray(se,se+ne),0),this.onData(ee)}else this.onData(C.output.length===C.next_out?C.output:C.output.subarray(0,C.next_out));if(!(Y===Z_OK&&te===0)){if(Y===Z_STREAM_END)return Y=inflate_1$2.inflateEnd(this.strm),this.onEnd(Y),this.ended=!0,!0;if(C.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(J){this.chunks.push(J)};Inflate$1.prototype.onEnd=function(J){J===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=J,this.msg=this.strm.msg};const{Deflate,deflate,deflateRaw,gzip}=deflate_1$1;var deflate_1=deflate;class DecodedStream{_sourceStream;_buffer;_minBufferLength=512;_bufferLength=0;_current=0;_ended=!1;constructor(e){this._sourceStream=e}get length(){return this._buffer.length}ensureBuffer(e){const C=this._buffer;if(C&&e<=C.byteLength)return C;let F=this._minBufferLength;for(;F<e;)F*=2;const $=new Uint8Array(F);return C&&$.set(C),this._buffer=$}takeByte(){const e=this._current;for(;this._bufferLength<=e;){if(this._ended)return-1;this._readBlock()}return this._buffer[this._current++]}takeBytes(e){let C;const F=this._current;if(e){for(this.ensureBuffer(F+e),C=F+e;!this._ended&&this._bufferLength<C;)this._readBlock();C>this._bufferLength&&(C=this._bufferLength)}else{for(;!this._ended;)this._readBlock();C=this._bufferLength}return this._current=C,this._buffer.subarray(F,C)}takeUint16(){const e=this.takeByte(),C=this.takeByte();return e===-1||C===-1?-1:(e<<8)+C}takeInt32(){const e=this.takeByte(),C=this.takeByte(),F=this.takeByte(),$=this.takeByte();return(e<<24)+(C<<16)+(F<<8)+$}peekByte(){const e=this.takeByte();return e!==-1&&this._current--,e}peekBytes(e){const C=this.takeBytes(e);return this._current-=C.length,C}skip(e){this._current+=e||1}reset(){this._current=0}}class FlateStream extends DecodedStream{static codeLenCodeMap=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);static lengthDecode=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]);static distDecode=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]);static fixedLitCodeTab=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9];static fixedDistCodeTab=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];_codeSize=0;_codeBuf=0;constructor(e){super(e);const C=e.takeByte(),F=e.takeByte();if(C===-1||F===-1)throw new Error(`Invalid header in flate stream: ${C}, ${F}`);if((C&15)!==8)throw new Error(`Unknown compression method in flate stream: ${C}, ${F}`);if(((C<<8)+F)%31!==0)throw new Error(`Bad FCHECK in flate stream: ${C}, ${F}`);if(F&32)throw new Error(`FDICT bit set in flate stream: ${C}, ${F}`);this._codeSize=0,this._codeBuf=0}_readBlock(){let e,C;const F=this._sourceStream;let $=this.getBits(3);if($&1&&(this._ended=!0),$>>=1,$===0){let ne;if((ne=F.takeByte())===-1)throw new Error("Bad block header in flate stream");let ee=ne;if((ne=F.takeByte())===-1)throw new Error("Bad block header in flate stream");if(ee|=ne<<8,(ne=F.takeByte())===-1)throw new Error("Bad block header in flate stream");let ie=ne;if((ne=F.takeByte())===-1)throw new Error("Bad block header in flate stream");if(ie|=ne<<8,ie!==(~ee&65535)&&(ee!==0||ie!==0))throw new Error("Bad uncompressed block length in flate stream");this._codeBuf=0,this._codeSize=0;const ae=this._bufferLength,re=ae+ee;if(e=this.ensureBuffer(re),this._bufferLength=re,ee===0)F.peekByte()===-1&&(this._ended=!0);else{const oe=F.takeBytes(ee);e.set(oe,ae),oe.length<ee&&(this._ended=!0)}return}let Y,V;if($===1)Y=FlateStream.fixedLitCodeTab,V=FlateStream.fixedDistCodeTab;else if($===2){const ne=this.getBits(5)+257,ee=this.getBits(5)+1,ie=this.getBits(4)+4,ae=new Uint8Array(FlateStream.codeLenCodeMap.length);let re;for(re=0;re<ie;re++)ae[FlateStream.codeLenCodeMap[re]]=this.getBits(3);const oe=this.generateHuffmanTable(ae);C=0,re=0;const ce=ne+ee,he=new Uint8Array(ce);let de,pe,fe;for(;re<ce;){const ye=this.getCode(oe);if(ye===16)de=2,pe=3,fe=C;else if(ye===17)de=3,pe=3,fe=C=0;else if(ye===18)de=7,pe=11,fe=C=0;else{he[re++]=C=ye;continue}let _e=this.getBits(de)+pe;for(;_e-- >0;)he[re++]=fe}Y=this.generateHuffmanTable(he.subarray(0,ne)),V=this.generateHuffmanTable(he.subarray(ne,ce))}else throw new Error("Unknown block type in flate stream");e=this._buffer;let te=e?e.length:0,se=this._bufferLength;for(;;){let ne=this.getCode(Y);if(ne<256){se+1>=te&&(e=this.ensureBuffer(se+1),te=e.length),e[se++]=ne;continue}if(ne===256){this._bufferLength=se;return}ne-=257,ne=FlateStream.lengthDecode[ne];let ee=ne>>16;ee>0&&(ee=this.getBits(ee)),C=(ne&65535)+ee,ne=this.getCode(V),ne=FlateStream.distDecode[ne],ee=ne>>16,ee>0&&(ee=this.getBits(ee));const ie=(ne&65535)+ee;se+C>=te&&(e=this.ensureBuffer(se+C),te=e.length);for(let ae=0;ae<C;++ae,++se)e[se]=e[se-ie]}}getBits(e){const C=this._sourceStream;let F=this._codeSize,$=this._codeBuf,Y;for(;F<e;){if((Y=C.takeByte())===-1)throw new Error("Bad encoding in flate stream");$|=Y<<F,F+=8}return Y=$&(1<<e)-1,this._codeBuf=$>>e,this._codeSize=F-=e,Y}getCode(e){const C=this._sourceStream,[F,$]=e;let Y=this._codeSize,V=this._codeBuf,te;for(;Y<$&&(te=C.takeByte())!==-1;)V|=te<<Y,Y+=8;const se=F[V&(1<<$)-1],ne=se>>16,ee=se&65535;if(ne<1||Y<ne)throw new Error("Bad encoding in flate stream");return this._codeBuf=V>>ne,this._codeSize=Y-ne,ee}generateHuffmanTable(e){const C=e.length;let F=0,$;for($=0;$<C;$++)e[$]>F&&(F=e[$]);const Y=1<<F,V=new Int32Array(Y);for(let te=1,se=0,ne=2;te<=F;te++,se<<=1,ne<<=1)for(let ee=0;ee<C;ee++)if(e[ee]===te){let ie=0,ae=se;for($=0;$<te;$++)ie=ie<<1|ae&1,ae>>=1;for($=ie;$<Y;$+=ne)V[$]=te<<16|ee;se++}return[V,F]}}class Stream{_bytes;_start;_end;_current;constructor(e,C=0,F){if(F&&F<0)throw new Error("Stream length can't be negative");this._bytes=e instanceof Uint8Array?e:new Uint8Array(e),this._start=C,this._current=C,this._end=C+F||e.length}get length(){return this._end-this._start}takeByte(){return this._current>=this._end?-1:this._bytes[this._current++]}takeBytes(e){const C=this._bytes,F=this._current,$=this._end;if(e){let Y=F+e;return Y>$&&(Y=$),this._current=Y,C.subarray(F,Y)}else return C.subarray(F,$)}takeUint16(){const e=this.takeByte(),C=this.takeByte();return e===-1||C===-1?-1:(e<<8)+C}takeInt32(){const e=this.takeByte(),C=this.takeByte(),F=this.takeByte(),$=this.takeByte();return(e<<24)+(C<<16)+(F<<8)+$}peekByte(){const e=this.takeByte();return e!==-1&&this._current--,e}peekBytes(e){const C=this.takeBytes(e);return this._current-=C.length,C}getByte(e){return this._bytes[e]}getByteRange(e,C){return this._bytes.subarray(Math.max(e,0),Math.min(C,this._end))}skip(e){this._current+=e||1}reset(){this._current=this._start}}class FlateDecoder{static Decode(e,C=flatePredictors.NONE,F=1,$=1,Y=8){const V=new Stream(e,0,e.length),se=new FlateStream(V).takeBytes(null);switch(C){case flatePredictors.NONE:return se;case flatePredictors.PNG_NONE:case flatePredictors.PNG_SUB:case flatePredictors.PNG_UP:case flatePredictors.PNG_AVERAGE:case flatePredictors.PNG_PAETH:case flatePredictors.PNG_OPTIMUM:return FlateDecoder.removePngFilter(se,F,$,Y);case flatePredictors.TIFF:throw new Error("Unsupported filter predictor")}}static Encode(e,C=flatePredictors.PNG_UP,F=5,$=1,Y=8){let V;switch(C){case flatePredictors.NONE:V=e;break;case flatePredictors.PNG_NONE:case flatePredictors.PNG_SUB:case flatePredictors.PNG_UP:case flatePredictors.PNG_AVERAGE:case flatePredictors.PNG_PAETH:case flatePredictors.PNG_OPTIMUM:V=FlateDecoder.applyPngFilter(e,C,F,$,Y);break;case flatePredictors.TIFF:throw new Error("Unsupported filter predictor")}return deflate_1(V)}static removePngFilter(e,C,F,$){const Y=Math.ceil(F*$/8),V=C*Y,te=V+1;if(e.length%te)throw new Error(`Data length doesn't match filter columns: ${e.length} % ${te}`);const se=new Uint8Array(e.length/te*V),ne=new Array(V).fill(0),ee=new Array(V).fill(0),ie=ye=>ye-Y<0?0:ee[ye-Y],ae=ye=>ne[ye],re=ye=>ye-Y<0?0:ne[ye-Y];let oe=0,ce=0,he=0,de=0,pe=0,fe=0;for(let ye=0;ye<e.length;ye++)if(ye%te===0){if(pe=e[ye],oe=0,ye)for(he=0;he<V;he++)ne[he]=se[de+he];de=ce}else{switch(ee[oe]=e[ye],pe){case 0:fe=ee[oe];break;case 1:fe=(ee[oe]+ie(oe))%256;break;case 2:fe=(ee[oe]+ae(oe))%256;break;case 3:fe=(ee[oe]+Math.floor((ae(oe)+ie(oe))/2))%256;break;case 4:fe=(ee[oe]+this.paethPredictor(ie(oe),ae(oe),re(oe)))%256;break}se[ce++]=fe,oe++}return se}static applyPngFilter(e,C=12,F=5,$=1,Y=8){let V;switch(C){case flatePredictors.PNG_NONE:V=0;break;case flatePredictors.PNG_SUB:V=1;break;case flatePredictors.PNG_UP:V=2;break;case flatePredictors.PNG_AVERAGE:V=3;break;case flatePredictors.PNG_PAETH:V=4;break;default:throw new Error("Invalid PNG filter type")}const te=Math.ceil($*Y/8),se=F*te,ne=se+1,ie=Math.ceil(e.length/se)*ne,ae=new Uint8Array(ie),re=new Array(se).fill(0),oe=new Array(se).fill(0),ce=be=>be-te<0?0:oe[be-te],he=be=>re[be],de=be=>be-te<0?0:re[be-te];let pe=0,fe=0,ye=0,_e=0,Ee=0;for(let be=0;be<ie;be++)if(be%ne===0){if(pe=0,be)for(ye=0;ye<se;ye++)re[ye]=e[_e+ye];_e=fe,ae[be]=V}else{switch(oe[pe]=e[fe++]||0,V){case 0:Ee=oe[pe];break;case 1:Ee=(oe[pe]-ce(pe))%256;break;case 2:Ee=(oe[pe]-he(pe))%256;break;case 3:Ee=(oe[pe]-Math.floor((he(pe)+ce(pe))/2))%256;break;case 4:Ee=(oe[pe]-this.paethPredictor(ce(pe),he(pe),de(pe)))%256;break}ae[be]=Ee,pe++}return ae}static paethPredictor(e,C,F){const $=e+C-F,Y=Math.abs($-e),V=Math.abs($-C),te=Math.abs($-F);return Y<=V&&Y<=te?e:V<=te?C:F}}class PdfStream extends PdfObject{Type;Length;Filter;DecodeParms;DL;_streamData;get streamData(){return this._streamData}set streamData(e){this.setStreamData(e),this._edited=!0}_decodedStreamData;get decodedStreamData(){return this._decodedStreamData||this.decodeStreamData(),this._decodedStreamData}get decodedStreamDataChars(){return new TextDecoder().decode(this.decodedStreamData)}constructor(e){super(),this.Type=e}async getStreamDataParserAsync(){return await PdfStream.getDataParserAsync(this.decodedStreamData)}toArray(e){const C=e?.ref&&e.streamCryptor?e.streamCryptor.encrypt(this.streamData,e.ref):this.streamData,F=new TextEncoder,$=[...keywordCodes.DICT_START];$.push(...F.encode("/Length "),...F.encode(" "+C.length)),this.Type&&$.push(...keywordCodes.TYPE,...F.encode(this.Type)),this.Filter&&$.push(...F.encode("/Filter "),...F.encode(this.Filter)),this.DecodeParms&&$.push(...F.encode("/DecodeParms "),...this.DecodeParms.toArray(e)),$.push(...keywordCodes.DICT_END,...keywordCodes.END_OF_LINE,...keywordCodes.STREAM_START,...keywordCodes.END_OF_LINE);for(let Y=0;Y<C.length;Y++)$.push(C[Y]);return $.push(...keywordCodes.END_OF_LINE,...keywordCodes.STREAM_END),new Uint8Array($)}setTextStreamData(e){const F=new TextEncoder().encode(e);this.streamData=F}async parsePropsAsync(e){if(!e)throw new Error("Parse info is empty");const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;this._ref=e.cryptInfo?.ref,this._sourceBytes=await C.sliceCharCodesAsync($,Y);const V=await C.findSubarrayIndexAsync(keywordCodes.STREAM_END,{direction:!1,minIndex:$,maxIndex:Y,closedOnly:!0});if(!V)throw new Error("Object is not a stream");const te=await C.findSubarrayIndexAsync(keywordCodes.STREAM_START,{direction:!1,minIndex:$,maxIndex:V.start-1,closedOnly:!0});if(!te)throw new Error("Stream start is out of the data bounds");const se=await C.getDictBoundsAtAsync($);let ne=await C.skipToNextNameAsync(se.contentStart,se.contentEnd);if(ne===-1)throw new Error("Dict is empty (has no properties)");let ee,ie;for(;ie=await C.parseNameAtAsync(ne),ie;)switch(ne=ie.end+1,ee=ie.value,ee){case"/Type":const he=await C.parseNameAtAsync(ne);if(he){if(this.Type&&this.Type!==he.value)throw new Error(`Ivalid dict type: '${he.value}' instead of '${this.Type}'`);ne=he.end+1}else throw new Error("Can't parse /Type property value");break;case"/Length":case"/DL":ne=await this.parseNumberPropAsync(ee,C,ne,!1);break;case"/Filter":const de=await C.getValueTypeAtAsync(ne);if(de===valueTypes.NAME){const fe=await C.parseNameAtAsync(ne);if(fe&&supportedFilters.has(fe.value)){this.Filter=fe.value,ne=fe.end+1;break}else throw new Error(`Unsupported /Filter property value: ${fe.value}`)}else if(de===valueTypes.ARRAY){const fe=await C.parseNameArrayAtAsync(ne);if(fe){const ye=fe.value;if(ye.length===1&&supportedFilters.has(ye[0])){this.Filter=ye[0],ne=fe.end+1;break}else throw new Error(`Unsupported /Filter property value: ${ye.toString()}`)}}throw new Error(`Unsupported /Filter property value type: ${de}`);case"/DecodeParms":const pe=await C.getValueTypeAtAsync(ne);if(pe===valueTypes.DICTIONARY){const fe=await C.getDictBoundsAtAsync(ne);if(fe){const ye=await DecodeParamsDict.parseAsync({parser:C,bounds:fe,cryptInfo:e.cryptInfo});if(ye){this.DecodeParms=ye.value,ne=fe.end+1;break}}throw new Error("Can't parse /DecodeParms property value")}else if(pe===valueTypes.ARRAY){const fe=await DecodeParamsDict.parseArrayAsync(C,ne,e.cryptInfo);if(fe){const ye=fe.value;if(ye.length===1){this.DecodeParms=ye[0],ne=fe.end+1;break}}throw new Error("Can't parse /DecodeParms property value")}throw new Error(`Unsupported /DecodeParms property value type: ${pe}`);default:ne=await C.skipToNextNameAsync(ne,se.contentEnd);break}const ae=await C.findNewLineIndexAsync(!0,te.end+1),re=await C.findNewLineIndexAsync(!1,V.start-1),oe=await C.sliceCharCodesAsync(ae,re),ce=e.cryptInfo?.ref&&e.cryptInfo.streamCryptor?e.cryptInfo.streamCryptor.decrypt(oe,e.cryptInfo.ref):oe;this._streamData=ce}setStreamData(e){if(!e?.length)throw new Error("Can't set emprty stream data");let C;if(this.DecodeParms)C=this.DecodeParms;else{let $,Y=10;for(;;){if(e.length%Y===0){$=Y;break}Y--}C=new DecodeParamsDict,C.setIntProp("/Predictor",flatePredictors.PNG_UP),C.setIntProp("/Columns",$),this.DecodeParms=C}const F=FlateDecoder.Encode(e,C?.getIntProp("/Predictor")||flatePredictors.NONE,C?.getIntProp("/Columns")||1,C?.getIntProp("/Colors")||1,C?.getIntProp("/BitsPerComponent")||8);this._streamData=F,this.Length=F.length,this.DL=e.length,this._decodedStreamData=e}decodeStreamData(){let e;switch(this.Filter){case streamFilters.FLATE:if(this.DecodeParms){const C=this.DecodeParms;e=FlateDecoder.Decode(this._streamData,C.getIntProp("/Predictor")||flatePredictors.NONE,C.getIntProp("/Columns")||1,C.getIntProp("/Colors")||1,C.getIntProp("/BitsPerComponent")||8)}else e=FlateDecoder.Decode(this._streamData);break;default:e=new Uint8Array(this._streamData);break}this._decodedStreamData=e}}class TrailerStream extends PdfStream{Size;Prev;Root;Encrypt;Info;ID;Index;W;constructor(){super(streamTypes.XREF)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new TrailerStream;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Size&&$.push(...F.encode("/Size "),...F.encode(" "+this.Size)),this.Prev&&$.push(...F.encode("/Prev "),...F.encode(" "+this.Prev)),this.Root&&$.push(...F.encode("/Root "),...this.Root.toArray(e)),this.Encrypt&&$.push(...F.encode("/Encrypt "),...this.Encrypt.toArray(e)),this.Info&&$.push(...F.encode("/Info "),...this.Info.toArray(e)),this.ID&&$.push(...F.encode("/ID "),...this.encodeSerializableArray(this.ID,e)),this.Index&&$.push(...F.encode("/Index "),...this.encodePrimitiveArray(this.Index,F)),this.W&&$.push(...F.encode("/W "),...this.encodePrimitiveArray(this.W,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=await C.getDictBoundsAtAsync($);let V=await C.skipToNextNameAsync(Y.contentStart,Y.contentEnd),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Size":case"/Prev":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Root":case"/Info":V=await this.parseRefPropAsync(te,C,V);break;case"/Encrypt":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae){this.Encrypt=ae.value,V=ae.end+1;break}else throw new Error("Can't parse /Encrypt property value")}throw new Error(`Unsupported /Encrypt property value type: ${ne}`);case"/ID":const ee=await HexString.parseArrayAsync(C,V);if(ee&&ee.value[0]&&ee.value[1]){this.ID=[ee.value[0],ee.value[1]],V=ee.end+1;break}const ie=await LiteralString.parseArrayAsync(C,V);if(ie&&ie.value[0]&&ie.value[1]){this.ID=[HexString.fromHexBytes(ie.value[0].bytes),HexString.fromHexBytes(ie.value[1].bytes)],V=ie.end+1;break}throw new Error("Can't parse /ID property value");case"/Index":case"/W":V=await this.parseNumberArrayPropAsync(te,C,V,!1);break;default:V=await C.skipToNextNameAsync(V,Y.contentEnd);break}if(!this.W||!this.Size||!this.Root||this.Encrypt&&!this.ID)throw new Error("Not all required properties parsed");this.Index?.length||(this.Index=[0,this.Size])}}class XRef{_type;get type(){return this._type}_offset;get offset(){return this._offset}constructor(e){this._type=e}}class XRefStream extends XRef{_trailerStream;get prev(){return this._trailerStream?.Prev}get size(){return this._trailerStream?.Size}get root(){return this._trailerStream?.Root}get info(){return this._trailerStream?.Info}get encrypt(){return this._trailerStream?.Encrypt}get id(){return this._trailerStream?.ID}constructor(e,C){super(xRefTypes.STREAM),this._trailerStream=e,this._offset=C}static createFrom(e,C,F){if(!C?.length||!e)return null;const $=Math.max(...C.map(V=>V.id))+2,Y=Math.max($,e.size);return XRefStream.create(C,Y,F,e.root,e.offset,e.info,e.encrypt,e.id)}static create(e,C,F,$,Y,V,te,se){if(!e?.length||!C||!F||!$)return null;const ne=new TrailerStream;ne.Size=C,ne.Root=$,ne.Prev=Y,ne.Info=V,ne.Encrypt=te,ne.ID=se;const ee=[1,4,2],ie=ee[0]+ee[1]+ee[2],ae=new DecodeParamsDict;ae.setIntProp("/Predictor",flatePredictors.PNG_UP),ae.setIntProp("/Columns",ie),ae.setIntProp("/Colors",1),ae.setIntProp("/BitsPerComponent",8);const re=XRefEntry.toStreamBytes(e,ee),oe=new XRefStream(ne,F);return oe._trailerStream.Filter=streamFilters.FLATE,oe._trailerStream.DecodeParms=ae,oe._trailerStream.W=ee,oe._trailerStream.Index=re.index,oe._trailerStream.streamData=re.bytes,oe}static async parseAsync(e,C){if(!e)return null;const F=await TrailerStream.parseAsync(e);return F?{value:new XRefStream(F.value,C),start:null,end:null}:null}createUpdate(e,C){return XRefStream.createFrom(this,e,C)}getEntries(){return this._trailerStream?XRefEntry.fromStreamBytes(this._trailerStream.decodedStreamData,this._trailerStream.W,this._trailerStream.Index):[]}toArray(e){return this._trailerStream.toArray(e)}}class TextStream extends PdfStream{constructor(e=null){super(e)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new TextStream;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}getText(){return null}toArray(e){return super.toArray(e)}async parsePropsAsync(e){await super.parsePropsAsync(e)}}class IndexedColorSpaceArray{baseColorSpace;highestValue;lookupArray;componentsNumber;constructor(e,C,F){switch(e){case colorSpaces.GRAYSCALE:this.componentsNumber=1;break;case colorSpaces.RGB:this.componentsNumber=3;break;case colorSpaces.CMYK:this.componentsNumber=4;break;default:throw new Error(`Unsupported base color space for indexed color space: ${e}`)}if(this.baseColorSpace=e,F.length!==this.componentsNumber*(C+1))throw new Error(`Invalid lookup array length: ${F.length}`);this.highestValue=C,this.lookupArray=F}static async parseAsync(e,C=!0){const{parser:F,bounds:$,cryptInfo:Y}=e;let V;C&&(V=await F.findNonSpaceIndexAsync(!0,$.start));const te=V;if(V<0||V>F.maxIndex||!await F.isCodeAtAsync(te,codes.L_BRACKET))return console.log("Color space array start not found"),null;V++;const se=await F.parseNameAtAsync(V);if(!se||se.value!=="/Indexed")return console.log("Array is not representing an indexed color space"),null;V=se.end+1;const ne=await F.parseNameAtAsync(V);if(!ne)return console.log("Can't parse base color space name of the indexed color space"),null;V=ne.end+2;const ee=await F.parseNumberAtAsync(V);if(!ee||isNaN(ee.value))return console.log("Can't parse the highest value of the indexed color space"),null;V=ee.end+1;let ie;const ae=await F.getValueTypeAtAsync(V);if(ae===valueTypes.REF)try{const re=await ObjectId.parseRefAsync(F,V),oe=await e.parseInfoGetterAsync(re.value.id);ie=(await TextStream.parseAsync(oe)).value.decodedStreamData,V=re.end+1}catch(re){throw new Error(`Can't parse indexed color array lookup ref: ${re.message}`)}else if(ae===valueTypes.STRING_HEX){const re=await HexString.parseAsync(F,V,Y);if(re)ie=re.value.hex,V=re.end+1;else throw new Error("Can't parse indexed color array lookup hex string")}try{return{value:new IndexedColorSpaceArray(ne.value,ee.value,ie),start:te,end:V-1}}catch(re){return console.log(re.message),null}}toArray(e){const C=new TextEncoder,F=[];return F.push(codes.L_BRACKET,...C.encode("/Indexed "),...C.encode(this.baseColorSpace+" "),...C.encode(this.highestValue+" "),...HexString.fromHexBytes(this.lookupArray).toArray(e),codes.R_BRACKET),new Uint8Array(F)}getColor(e){switch(this.baseColorSpace){case colorSpaces.GRAYSCALE:const C=this.lookupArray[e];return[C,C,C];case colorSpaces.RGB:return[this.lookupArray[e*3],this.lookupArray[e*3+1],this.lookupArray[e*3+2]];case colorSpaces.CMYK:const F=this.lookupArray[e*4]/255,$=this.lookupArray[e*4+1]/255,Y=this.lookupArray[e*4+2]/255,V=this.lookupArray[e*4+3]/255;return[255*(1-F)*(1-V),255*(1-$)*(1-V),255*(1-Y)*(1-V)]}}}class ImageStream extends PdfStream{Subtype="/Image";Width;Height;ColorSpace;BitsPerComponent;ImageMask=!1;Mask;Decode;Interpolate=!1;SMask;SMaskInData=0;Matte;StructParent;Metadata;_sMask;get sMask(){return this._sMask}set sMask(e){this._sMask=e}_indexedColorSpace;_imageUrl;constructor(){super(streamTypes.FORM_XOBJECT)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new ImageStream;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Subtype&&$.push(...F.encode("/Subtype "),...F.encode(this.Subtype)),this.Width&&$.push(...F.encode("/Width "),...F.encode(" "+this.Width)),this.Height&&$.push(...F.encode("/Height "),...F.encode(" "+this.Height)),this.ColorSpace&&(this._indexedColorSpace?$.push(...F.encode("/ColorSpace "),...this._indexedColorSpace.toArray(e)):$.push(...F.encode("/ColorSpace "),...F.encode(this.ColorSpace))),this.BitsPerComponent&&$.push(...F.encode("/BitsPerComponent "),...F.encode(" "+this.BitsPerComponent)),$.push(...F.encode("/ImageMask "),...F.encode(" "+!!this.ImageMask)),this.Mask&&$.push(...F.encode("/Mask "),...this.encodePrimitiveArray(this.Mask,F)),this.Decode&&$.push(...F.encode("/Decode "),...this.encodePrimitiveArray(this.Decode,F)),$.push(...F.encode("/Interpolate "),...F.encode(" "+!!this.Interpolate)),this.SMask&&$.push(...F.encode("/SMask "),...this.SMask.toArray(e)),this.SMaskInData&&$.push(...F.encode("/SMaskInData "),...F.encode(" "+this.SMaskInData)),this.Matte&&$.push(...F.encode("/Matte "),...this.encodePrimitiveArray(this.Matte,F)),this.StructParent&&$.push(...F.encode("/StructParent "),...F.encode(" "+this.StructParent)),this.Metadata&&$.push(...F.encode("/Metadata "),...this.Metadata.toArray(e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async getImageUrlAsync(){if(this._imageUrl&&URL.revokeObjectURL(this._imageUrl),this.Filter===streamFilters.DCT||this.Filter===streamFilters.JBIG2||this.Filter===streamFilters.JPX){const e=new Blob([this.decodedStreamData],{type:"application/octet-binary"}),C=URL.createObjectURL(e);return this._imageUrl=C,C}if(this.Filter===streamFilters.FLATE){const e=this.Width*this.Height;let C;if(this.sMask){if(C=this.sMask.decodedStreamData,C.length!==e)throw new Error(`Invalid alpha mask data length: ${C.length} (must be ${e})`)}else C=new Uint8Array(e).fill(255);const F=new Uint8ClampedArray(e*4),$=this.getRgbColors();let Y,V;for(let ee=0;ee<e;ee++)Y=ee*4,V=ee*3,F[Y]=$[V],F[Y+1]=$[V+1],F[Y+2]=$[V+2],F[Y+3]=C[ee];const te=new ImageData(F,this.Width,this.Height),ne=await new Promise((ee,ie)=>{const ae=document.createElement("canvas");ae.width=this.Width,ae.height=this.Height,ae.getContext("2d").putImageData(te,0,0),ae.toBlob(re=>{const oe=URL.createObjectURL(re);ee(oe)})});return this._imageUrl=ne,ne}throw new Error(`Unsupported image filter type: ${this.Filter}`)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=await C.getDictBoundsAtAsync($);let V=await C.skipToNextNameAsync(Y.contentStart,Y.contentEnd),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Subtype":const ne=await C.parseNameAtAsync(V);if(ne){if(this.Subtype&&this.Subtype!==ne.value)throw new Error(`Invalid dict subtype: '${ne.value}' instead of '${this.Subtype}'`);V=ne.end+1}else throw new Error("Can't parse /Subtype property value");break;case"/Width":case"/Height":case"/BitsPerComponent":case"/SMaskInData":case"/StructParent":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Decode":V=await this.parseNumberArrayPropAsync(te,C,V,!1);break;case"/Matte":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/Interpolate":V=await this.parseBoolPropAsync(te,C,V);break;case"/SMask":case"/Metadata":V=await this.parseRefPropAsync(te,C,V);break;case"/ColorSpace":const ee=await C.getValueTypeAtAsync(V);if(ee===valueTypes.NAME){const re=await C.parseNameAtAsync(V);if(re){this.ColorSpace=re.value,V=re.end+1;break}throw new Error("Can't parse /ColorSpace name")}else if(ee===valueTypes.ARRAY){const re=await C.getArrayBoundsAtAsync(V);if(re){const oe=await IndexedColorSpaceArray.parseAsync({parser:C,bounds:re,cryptInfo:e.cryptInfo,parseInfoGetterAsync:e.parseInfoGetterAsync});if(oe){this.ColorSpace=colorSpaces.SPECIAL_INDEXED,this._indexedColorSpace=oe.value,V=re.end+1;break}throw new Error("Can't parse /ColorSpace object:"+C.sliceCharsAsync(re.start,re.end))}throw new Error("Can't parse /ColorSpace value array")}else if(ee===valueTypes.REF){const re=await ObjectId.parseRefAsync(C,V);if(re){const oe=await e.parseInfoGetterAsync(re.value.id);if(oe){const ce=await IndexedColorSpaceArray.parseAsync(oe);if(ce){this.ColorSpace=colorSpaces.SPECIAL_INDEXED,this._indexedColorSpace=ce.value,V=re.end+1;break}throw new Error("Can't parse /ColorSpace object:"+await oe.parser.sliceCharsAsync(oe.bounds.start,oe.bounds.end))}}throw new Error("Can't parse /ColorSpace ref")}throw new Error(`Unsupported /ColorSpace property value type: ${ee}`);case"/ImageMask":const ie=await C.parseBoolAtAsync(V,!1);if(ie)this.ImageMask=ie.value,V=ie.end+1,this.ImageMask&&(this.BitsPerComponent=1);else throw new Error("Can't parse /ImageMask property value");break;case"/Mask":const ae=await C.getValueTypeAtAsync(V);if(ae===valueTypes.REF){const re=await ObjectId.parseRefAsync(C,V);if(!re)throw new Error("Can't parse /Mask value reference: failed to parse ref");const oe=await e.parseInfoGetterAsync(re.value.id);if(!oe)throw new Error("Can't parse /Mask value reference: failed to get image parse info");const ce=await ImageStream.parseAsync(oe);if(!ce)throw new Error("Can't parse /Mask value reference: failed to parse image stream");const he=await ce.value.getStreamDataParserAsync(),de=[];let pe=0,fe;for(;pe<=he.maxIndex&&(fe=await he.parseNumberAtAsync(pe,!0,!0),!!fe);)de.push(fe.value),pe=fe.end+1;if(!de.length)throw new Error("Can't parse /Mask value reference: failed to parse decoded image data");this.Mask=de,V=re.end+1;break}else if(ae===valueTypes.ARRAY){const re=await C.parseNumberArrayAtAsync(V,!1);if(re){this.Mask=re.value,V=re.end+1;break}throw new Error("Can't parse /Mask property value")}throw new Error(`Unsupported /Mask property value type: ${ae}`);case"/OC":case"/Intent":case"/Alternates":case"/ID":case"/OPI":default:V=await C.skipToNextNameAsync(V,Y.contentEnd);break}if(!this.Width&&!this.Height)throw new Error("Not all required properties parsed");if(this.ImageMask&&(this.BitsPerComponent!==1||this.ColorSpace))throw new Error("Mutually exclusive properties found");if(!this.Decode&&!(this.Filter===streamFilters.JPX&&!this.ImageMask))switch(this.ColorSpace){case colorSpaces.GRAYSCALE:this.Decode=[0,1];break;case colorSpaces.RGB:this.Decode=[0,1,0,1,0,1];break;case colorSpaces.CMYK:this.Decode=[0,1,0,1,0,1,0,1];break;case colorSpaces.SPECIAL_INDEXED:this.Decode=[0,Math.pow(2,this.BitsPerComponent||1)-1];break;default:this.Decode=[0,1];break}if(this.DecodeParms||(this.DecodeParms=new DecodeParamsDict),this.DecodeParms.getIntProp("/BitsPerComponent")||this.DecodeParms.setIntProp("/BitsPerComponent",this.BitsPerComponent),this.DecodeParms.getIntProp("/Columns")||this.DecodeParms.setIntProp("/Columns",this.Width),!this.DecodeParms.getIntProp("/Colors"))switch(this.ColorSpace){case colorSpaces.GRAYSCALE:case colorSpaces.SPECIAL_INDEXED:this.DecodeParms.setIntProp("/Colors",1);break;case colorSpaces.RGB:this.DecodeParms.setIntProp("/Colors",3);break;case colorSpaces.CMYK:this.DecodeParms.setIntProp("/Colors",4);break;default:this.DecodeParms.setIntProp("/Colors",1);break}if(this.SMask){const ne=await e.parseInfoGetterAsync(this.SMask.id);if(!ne)throw new Error(`Can't get parse info for ref: ${this.SMask.id} ${this.sMask.generation} R`);const ee=await ImageStream.parseAsync(ne);if(!ee)throw new Error(`Can't parse SMask: ${this.SMask.id} ${this.sMask.generation} R`);this._sMask=ee.value}}getRgbColor(e){const C=this.decodedStreamData;switch(this.ColorSpace){case colorSpaces.GRAYSCALE:const F=C[e];return[F,F,F];case colorSpaces.RGB:return[C[e*3],C[e*3+1],C[e*3+2]];case colorSpaces.CMYK:const $=C[e*4]/255,Y=C[e*4+1]/255,V=C[e*4+2]/255,te=C[e*4+3]/255;return[255*(1-$)*(1-te),255*(1-Y)*(1-te),255*(1-V)*(1-te)];case colorSpaces.SPECIAL_INDEXED:return this._indexedColorSpace?.getColor(e)||[0,0,0]}}getRgbColors(){const e=this.decodedStreamData,C=this.Width*this.Height,F=C*3,$=new Uint8ClampedArray(F);let Y,V,te;switch(this.ColorSpace){case colorSpaces.GRAYSCALE:let se;for(Y=0;Y<C;Y++)se=e[Y],V=Y*3,$[V]=se,$[V+1]=se,$[V+2]=se;break;case colorSpaces.RGB:for(Y=0;Y<F;Y++)$[Y]=e[Y];break;case colorSpaces.CMYK:let ne,ee,ie,ae;for(Y=0;Y<C;Y++)V=Y*3,te=Y*4,ne=e[te]/255,ee=e[te+1]/255,ie=e[te+2]/255,ae=e[te+3]/255,$[V]=255*(1-ne)*(1-ae),$[V+1]=255*(1-ee)*(1-ae),$[V+2]=255*(1-ie)*(1-ae);break;case colorSpaces.SPECIAL_INDEXED:let re,oe,ce;for(Y=0;Y<C;Y++)[re,oe,ce]=this._indexedColorSpace?.getColor(Y)||[0,0,0],V=Y*3,$[V]=re,$[V+1]=oe,$[V+2]=ce;break}return $}}class ObjectMapDict extends PdfDict{_objectIdMap=new Map;_dictParserMap=new Map;constructor(){super(null)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new ObjectMapDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}getObjectId(e){return this._objectIdMap.get(e)}*getObjectIds(){for(const e of this._objectIdMap)yield e}getDictParser(e){return this._dictParserMap.get(e)}*getDictParsers(){for(const e of this._dictParserMap)yield e}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this._objectIdMap.forEach((V,te)=>{$.push(...F.encode(te+" "),...V.toArray(e))});const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){default:const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ee=await ObjectId.parseRefAsync(C,V);if(ee){this._objectIdMap.set(te,ee.value),V=ee.end+1;break}}else if(ne===valueTypes.DICTIONARY){const ee=await C.getDictBoundsAtAsync(V);if(ee){const ie={parser:await PdfDict.getDataParserAsync(await C.sliceCharCodesAsync(ee.start,ee.end)),bounds:{start:0,end:ee.end-ee.start,contentStart:ee.contentStart-ee.start,contentEnd:ee.contentEnd-ee.start},cryptInfo:e.cryptInfo};this._dictParserMap.set(te,ie),V=ee.end+1;break}}V=await C.skipToNextNameAsync(V,Y-1);break}}}class UnicodeCmapStream extends PdfStream{_codeRanges=[];_map=new Map;constructor(e=null){super(e)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new UnicodeCmapStream;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){return super.toArray(e)}hexBytesToUtfString(e){let C="";e:for(let F=0;F<e.length;F++)for(let $=1;F+$<=e.length&&$<=4;$++){const Y=e.subarray(F,F+$);if(this.isInsideAnyRange(Y)){C+=this._map.get(ByteUtils.parseIntFromBytes(Y))||"";continue e}}return C}isInsideAnyRange(e){e:for(const C of this._codeRanges)if(e.length===C.length){for(let F=0;F<C.length;F++)if(e[F]<C.start[F]||e[F]>C.end[F])continue e;return!0}return!1}async parseCodeRangesAsync(e){let C=0;const F=(await e.findSubarrayIndexAsync(keywordCodes.CMAP_BEGIN_CODE_RANGE,{closedOnly:!0}))?.end;if(!F)return;C=F+1;const $=(await e.findSubarrayIndexAsync(keywordCodes.CMAP_END_CODE_RANGE,{closedOnly:!0,minIndex:C}))?.start;for(;C<$-1;){const Y=await HexString.parseAsync(e,C);C=Y.end+1;const V=await HexString.parseAsync(e,C);C=V.end+1,this._codeRanges.push({length:Y.value.hex.length,start:Y.value.hex,end:V.value.hex})}}async parseCharMapAsync(e,C){let F=0;for(;;){const $=(await e.findSubarrayIndexAsync(keywordCodes.CMAP_BEGIN_CHAR,{closedOnly:!0,minIndex:F}))?.end;if(!$)break;F=$+1;const Y=(await e.findSubarrayIndexAsync(keywordCodes.CMAP_END_CHAR,{closedOnly:!0,minIndex:F}))?.start;for(;F<Y-1;){const V=await HexString.parseAsync(e,F);F=V.end+1;const te=await HexString.parseAsync(e,F);F=te.end+1,this._map.set(ByteUtils.parseIntFromBytes(V.value.hex),C.decode(te.value.hex))}}}async parseCharRangesMapAsync(e,C){let F=0;for(;;){const $=(await e.findSubarrayIndexAsync(keywordCodes.CMAP_BEGIN_RANGE,{closedOnly:!0,minIndex:F}))?.end;if(!$)break;F=$+1;const Y=(await e.findSubarrayIndexAsync(keywordCodes.CMAP_END_RANGE,{closedOnly:!0,minIndex:F}))?.start;for(;F<Y-1;){const V=await HexString.parseAsync(e,F);F=V.end+1;const te=await HexString.parseAsync(e,F);F=te.end+1;let se=ByteUtils.parseIntFromBytes(V.value.hex);if(await e.getValueTypeAtAsync(F,!0)===valueTypes.ARRAY){const ee=await HexString.parseArrayAsync(e,F);F=ee.end+1;for(const ie of ee.value)this._map.set(se++,C.decode(ie.hex))}else{const ee=await HexString.parseAsync(e,F);F=ee.end+1;let ie=ByteUtils.parseIntFromBytes(ee.value.hex);for(;se<=ByteUtils.parseIntFromBytes(te.value.hex);){const ae=(ie++).toString(16),oe=(ae.length%2?"0":"")+ae;this._map.set(se++,C.decode(ByteUtils.hexStringToBytes(oe)))}}}}}async fillMapAsync(){this._codeRanges.length=0,this._map.clear();const e=await this.getStreamDataParserAsync(),C=new TextDecoder("utf-16be");await this.parseCodeRangesAsync(e),await this.parseCharMapAsync(e,C),await this.parseCharRangesMapAsync(e,C)}async parsePropsAsync(e){await super.parsePropsAsync(e),await this.fillMapAsync()}}const pdfCharCodesByName={A:{name:"A",char:"A",stdCode:65,macCode:65,winCode:65,pdfCode:65,utfCode:65},AE:{name:"AE",char:"Æ",stdCode:225,macCode:174,winCode:198,pdfCode:198,utfCode:198},Aacute:{name:"Aacute",char:"Á",stdCode:null,macCode:231,winCode:193,pdfCode:193,utfCode:193},Acircumflex:{name:"Acircumflex",char:"Â",stdCode:null,macCode:229,winCode:194,pdfCode:194,utfCode:194},Adieresis:{name:"Adieresis",char:"Ä",stdCode:null,macCode:128,winCode:196,pdfCode:196,utfCode:196},Agrave:{name:"Agrave",char:"À",stdCode:null,macCode:203,winCode:192,pdfCode:192,utfCode:192},Aring:{name:"Aring",char:"Å",stdCode:null,macCode:129,winCode:197,pdfCode:197,utfCode:197},Atilde:{name:"Atilde",char:"Ã",stdCode:null,macCode:204,winCode:195,pdfCode:195,utfCode:195},B:{name:"B",char:"B",stdCode:66,macCode:66,winCode:66,pdfCode:66,utfCode:66},C:{name:"C",char:"C",stdCode:67,macCode:67,winCode:67,pdfCode:67,utfCode:67},Ccedilla:{name:"Ccedilla",char:"Ç",stdCode:null,macCode:130,winCode:199,pdfCode:199,utfCode:199},D:{name:"D",char:"D",stdCode:68,macCode:68,winCode:68,pdfCode:68,utfCode:68},E:{name:"E",char:"E",stdCode:69,macCode:69,winCode:69,pdfCode:69,utfCode:69},Eacute:{name:"Eacute",char:"É",stdCode:null,macCode:131,winCode:201,pdfCode:201,utfCode:201},Ecircumflex:{name:"Ecircumflex",char:"Ê",stdCode:null,macCode:230,winCode:202,pdfCode:202,utfCode:202},Edieresis:{name:"Edieresis",char:"Ë",stdCode:null,macCode:232,winCode:203,pdfCode:203,utfCode:203},Egrave:{name:"Egrave",char:"È",stdCode:null,macCode:233,winCode:200,pdfCode:200,utfCode:200},Eth:{name:"Eth",char:"Ð",stdCode:null,macCode:null,winCode:208,pdfCode:208,utfCode:208},Euro:{name:"Euro",char:"€",stdCode:null,macCode:null,winCode:128,pdfCode:160,utfCode:8364},F:{name:"F",char:"F",stdCode:70,macCode:70,winCode:70,pdfCode:70,utfCode:70},G:{name:"G",char:"G",stdCode:71,macCode:71,winCode:71,pdfCode:71,utfCode:71},H:{name:"H",char:"H",stdCode:72,macCode:72,winCode:72,pdfCode:72,utfCode:72},I:{name:"I",char:"I",stdCode:73,macCode:73,winCode:73,pdfCode:73,utfCode:73},Iacute:{name:"Iacute",char:"Í",stdCode:null,macCode:234,winCode:205,pdfCode:205,utfCode:205},Icircumflex:{name:"Icircumflex",char:"Î",stdCode:null,macCode:235,winCode:206,pdfCode:206,utfCode:206},Idieresis:{name:"Idieresis",char:"Ï",stdCode:null,macCode:236,winCode:207,pdfCode:207,utfCode:207},Igrave:{name:"Igrave",char:"Ì",stdCode:null,macCode:237,winCode:204,pdfCode:204,utfCode:204},J:{name:"J",char:"J",stdCode:74,macCode:74,winCode:74,pdfCode:74,utfCode:74},K:{name:"K",char:"K",stdCode:75,macCode:75,winCode:75,pdfCode:75,utfCode:75},L:{name:"L",char:"L",stdCode:76,macCode:76,winCode:76,pdfCode:76,utfCode:76},Lslash:{name:"Lslash",char:"Ł",stdCode:232,macCode:null,winCode:null,pdfCode:149,utfCode:321},M:{name:"M",char:"M",stdCode:77,macCode:77,winCode:77,pdfCode:77,utfCode:77},N:{name:"N",char:"N",stdCode:78,macCode:78,winCode:78,pdfCode:78,utfCode:78},Ntilde:{name:"Ntilde",char:"Ñ",stdCode:null,macCode:132,winCode:209,pdfCode:209,utfCode:209},O:{name:"O",char:"O",stdCode:79,macCode:79,winCode:79,pdfCode:79,utfCode:79},OE:{name:"OE",char:"OE",stdCode:234,macCode:206,winCode:140,pdfCode:150,utfCode:338},Oacute:{name:"Oacute",char:"Ó",stdCode:null,macCode:238,winCode:211,pdfCode:211,utfCode:211},Ocircumflex:{name:"Ocircumflex",char:"Ô",stdCode:null,macCode:239,winCode:212,pdfCode:212,utfCode:212},Odieresis:{name:"Odieresis",char:"Ö",stdCode:null,macCode:133,winCode:214,pdfCode:214,utfCode:214},Ograve:{name:"Ograve",char:"Ò",stdCode:null,macCode:241,winCode:210,pdfCode:210,utfCode:210},Oslash:{name:"Oslash",char:"Ø",stdCode:233,macCode:175,winCode:216,pdfCode:216,utfCode:216},Otilde:{name:"Otilde",char:"Õ",stdCode:null,macCode:205,winCode:213,pdfCode:213,utfCode:213},P:{name:"P",char:"P",stdCode:80,macCode:80,winCode:80,pdfCode:80,utfCode:80},Q:{name:"Q",char:"Q",stdCode:81,macCode:81,winCode:81,pdfCode:81,utfCode:81},R:{name:"R",char:"R",stdCode:82,macCode:82,winCode:82,pdfCode:82,utfCode:82},S:{name:"S",char:"S",stdCode:83,macCode:83,winCode:83,pdfCode:83,utfCode:83},Scaron:{name:"Scaron",char:"Š",stdCode:null,macCode:null,winCode:138,pdfCode:151,utfCode:352},T:{name:"T",char:"T",stdCode:84,macCode:84,winCode:84,pdfCode:84,utfCode:84},Thorn:{name:"Thorn",char:"Þ",stdCode:null,macCode:null,winCode:222,pdfCode:222,utfCode:222},U:{name:"U",char:"U",stdCode:85,macCode:85,winCode:85,pdfCode:85,utfCode:85},Uacute:{name:"Uacute",char:"Ú",stdCode:null,macCode:242,winCode:218,pdfCode:218,utfCode:218},Ucircumflex:{name:"Ucircumflex",char:"Û",stdCode:null,macCode:243,winCode:219,pdfCode:219,utfCode:219},Udieresis:{name:"Udieresis",char:"Ü",stdCode:null,macCode:134,winCode:220,pdfCode:220,utfCode:220},Ugrave:{name:"Ugrave",char:"Ù",stdCode:null,macCode:244,winCode:217,pdfCode:217,utfCode:217},V:{name:"V",char:"V",stdCode:86,macCode:86,winCode:86,pdfCode:86,utfCode:86},W:{name:"W",char:"W",stdCode:87,macCode:87,winCode:87,pdfCode:87,utfCode:87},X:{name:"X",char:"X",stdCode:88,macCode:88,winCode:88,pdfCode:88,utfCode:88},Y:{name:"Y",char:"Y",stdCode:89,macCode:89,winCode:89,pdfCode:89,utfCode:89},Yacute:{name:"Yacute",char:"Ý",stdCode:null,macCode:null,winCode:221,pdfCode:221,utfCode:221},Ydieresis:{name:"Ydieresis",char:"Ÿ",stdCode:null,macCode:217,winCode:159,pdfCode:152,utfCode:376},Z:{name:"Z",char:"Z",stdCode:90,macCode:90,winCode:90,pdfCode:90,utfCode:90},Zcaron:{name:"Zcaron",char:"Ž",stdCode:null,macCode:null,winCode:142,pdfCode:153,utfCode:381},a:{name:"a",char:"a",stdCode:97,macCode:97,winCode:97,pdfCode:97,utfCode:97},aacute:{name:"aacute",char:"á",stdCode:null,macCode:135,winCode:225,pdfCode:225,utfCode:225},acircumflex:{name:"acircumflex",char:"â",stdCode:null,macCode:137,winCode:226,pdfCode:226,utfCode:226},acute:{name:"acute",char:"´",stdCode:194,macCode:171,winCode:180,pdfCode:180,utfCode:180},adieresis:{name:"adieresis",char:"ä",stdCode:null,macCode:138,winCode:228,pdfCode:228,utfCode:228},ae:{name:"ae",char:"æ",stdCode:241,macCode:190,winCode:230,pdfCode:230,utfCode:230},agrave:{name:"agrave",char:"à",stdCode:null,macCode:136,winCode:224,pdfCode:224,utfCode:224},ampersand:{name:"ampersand",char:"&",stdCode:38,macCode:38,winCode:38,pdfCode:38,utfCode:38},aring:{name:"aring",char:"å",stdCode:null,macCode:140,winCode:229,pdfCode:229,utfCode:229},asciicircum:{name:"asciicircum",char:"^",stdCode:94,macCode:94,winCode:94,pdfCode:94,utfCode:94},asciitilde:{name:"asciitilde",char:"~",stdCode:126,macCode:126,winCode:126,pdfCode:126,utfCode:126},asterisk:{name:"asterisk",char:"*",stdCode:42,macCode:42,winCode:42,pdfCode:42,utfCode:42},at:{name:"at",char:"@",stdCode:64,macCode:64,winCode:64,pdfCode:64,utfCode:64},atilde:{name:"atilde",char:"ã",stdCode:null,macCode:139,winCode:227,pdfCode:227,utfCode:227},b:{name:"b",char:"b",stdCode:98,macCode:98,winCode:98,pdfCode:98,utfCode:98},backslash:{name:"backslash",char:'"',stdCode:92,macCode:92,winCode:92,pdfCode:92,utfCode:92},bar:{name:"bar",char:"|",stdCode:124,macCode:124,winCode:124,pdfCode:124,utfCode:124},braceleft:{name:"braceleft",char:"{",stdCode:123,macCode:123,winCode:123,pdfCode:123,utfCode:123},braceright:{name:"braceright",char:"}",stdCode:125,macCode:125,winCode:125,pdfCode:125,utfCode:125},bracketleft:{name:"bracketleft",char:"[",stdCode:91,macCode:91,winCode:91,pdfCode:91,utfCode:91},bracketright:{name:"bracketright",char:"]",stdCode:93,macCode:93,winCode:93,pdfCode:93,utfCode:93},breve:{name:"breve",char:"˘",stdCode:198,macCode:249,winCode:null,pdfCode:24,utfCode:728},brokenbar:{name:"brokenbar",char:"¦",stdCode:null,macCode:null,winCode:166,pdfCode:166,utfCode:166},bullet:{name:"bullet",char:"•",stdCode:183,macCode:165,winCode:149,pdfCode:128,utfCode:8226},c:{name:"c",char:"c",stdCode:99,macCode:99,winCode:99,pdfCode:99,utfCode:99},caron:{name:"caron",char:"ˇ",stdCode:207,macCode:255,winCode:null,pdfCode:25,utfCode:711},ccedilla:{name:"ccedilla",char:"ç",stdCode:null,macCode:141,winCode:231,pdfCode:231,utfCode:231},cedilla:{name:"cedilla",char:"¸",stdCode:203,macCode:252,winCode:184,pdfCode:184,utfCode:184},cent:{name:"cent",char:"¢",stdCode:162,macCode:162,winCode:162,pdfCode:162,utfCode:162},circumflex:{name:"circumflex",char:"ˆ",stdCode:195,macCode:246,winCode:136,pdfCode:26,utfCode:710},colon:{name:"colon",char:":",stdCode:58,macCode:58,winCode:58,pdfCode:58,utfCode:58},comma:{name:"comma",char:",",stdCode:44,macCode:44,winCode:44,pdfCode:44,utfCode:44},copyright:{name:"copyright",char:"©",stdCode:null,macCode:169,winCode:169,pdfCode:169,utfCode:169},currency1:{name:"currency1",char:"¤",stdCode:168,macCode:219,winCode:164,pdfCode:164,utfCode:164},d:{name:"d",char:"d",stdCode:100,macCode:100,winCode:100,pdfCode:100,utfCode:100},dagger:{name:"dagger",char:"†",stdCode:178,macCode:160,winCode:134,pdfCode:129,utfCode:8224},daggerdbl:{name:"daggerdbl",char:"‡",stdCode:179,macCode:224,winCode:135,pdfCode:130,utfCode:8225},degree:{name:"degree",char:"°",stdCode:null,macCode:161,winCode:176,pdfCode:176,utfCode:176},dieresis:{name:"dieresis",char:"¨",stdCode:200,macCode:172,winCode:168,pdfCode:168,utfCode:168},divide:{name:"divide",char:"÷",stdCode:null,macCode:214,winCode:247,pdfCode:247,utfCode:247},dollar:{name:"dollar",char:"$",stdCode:36,macCode:36,winCode:36,pdfCode:36,utfCode:36},dotaccent:{name:"dotaccent",char:"˙",stdCode:199,macCode:250,winCode:null,pdfCode:27,utfCode:729},dotlessi:{name:"dotlessi",char:"ı",stdCode:245,macCode:245,winCode:null,pdfCode:154,utfCode:305},e:{name:"e",char:"e",stdCode:101,macCode:101,winCode:101,pdfCode:101,utfCode:101},eacute:{name:"eacute",char:"é",stdCode:null,macCode:142,winCode:233,pdfCode:233,utfCode:233},ecircumflex:{name:"ecircumflex",char:"ê",stdCode:null,macCode:144,winCode:234,pdfCode:234,utfCode:234},edieresis:{name:"edieresis",char:"ë",stdCode:null,macCode:145,winCode:235,pdfCode:235,utfCode:235},egrave:{name:"egrave",char:"è",stdCode:null,macCode:143,winCode:232,pdfCode:232,utfCode:232},eight:{name:"eight",char:"8",stdCode:56,macCode:56,winCode:56,pdfCode:56,utfCode:56},ellipsis:{name:"ellipsis",char:"…",stdCode:188,macCode:201,winCode:133,pdfCode:131,utfCode:8230},emdash:{name:"emdash",char:"—",stdCode:208,macCode:209,winCode:151,pdfCode:132,utfCode:8212},endash:{name:"endash",char:"–",stdCode:177,macCode:208,winCode:150,pdfCode:133,utfCode:8211},equal:{name:"equal",char:"=",stdCode:61,macCode:61,winCode:61,pdfCode:61,utfCode:61},eth:{name:"eth",char:"ð",stdCode:null,macCode:null,winCode:240,pdfCode:240,utfCode:240},exclam:{name:"exclam",char:"!",stdCode:33,macCode:33,winCode:33,pdfCode:33,utfCode:33},exclamdown:{name:"exclamdown",char:"¡",stdCode:161,macCode:193,winCode:161,pdfCode:161,utfCode:161},f:{name:"f",char:"f",stdCode:102,macCode:102,winCode:102,pdfCode:102,utfCode:102},fi:{name:"fi",char:"fi",stdCode:174,macCode:222,winCode:null,pdfCode:147,utfCode:64257},five:{name:"five",char:"5",stdCode:53,macCode:53,winCode:53,pdfCode:53,utfCode:53},fl:{name:"fl",char:"fl",stdCode:175,macCode:223,winCode:null,pdfCode:148,utfCode:64258},florin:{name:"florin",char:"ƒ",stdCode:166,macCode:196,winCode:131,pdfCode:134,utfCode:402},four:{name:"four",char:"4",stdCode:52,macCode:52,winCode:52,pdfCode:52,utfCode:52},fraction:{name:"fraction",char:"⁄",stdCode:164,macCode:218,winCode:null,pdfCode:135,utfCode:8260},g:{name:"g",char:"g",stdCode:103,macCode:103,winCode:103,pdfCode:103,utfCode:103},germandbls:{name:"germandbls",char:"ß",stdCode:251,macCode:167,winCode:223,pdfCode:223,utfCode:223},grave:{name:"grave",char:"`",stdCode:193,macCode:96,winCode:96,pdfCode:96,utfCode:96},greater:{name:"greater",char:">",stdCode:62,macCode:62,winCode:62,pdfCode:62,utfCode:62},guillemotleft:{name:"guillemotleft",char:"«",stdCode:171,macCode:199,winCode:171,pdfCode:171,utfCode:171},guillemotright:{name:"guillemotright",char:"»",stdCode:187,macCode:200,winCode:187,pdfCode:187,utfCode:187},guilsinglleft:{name:"guilsinglleft",char:"‹",stdCode:172,macCode:220,winCode:139,pdfCode:136,utfCode:8249},guilsinglright:{name:"guilsinglright",char:"›",stdCode:173,macCode:221,winCode:155,pdfCode:137,utfCode:8250},h:{name:"h",char:"h",stdCode:104,macCode:104,winCode:104,pdfCode:104,utfCode:104},hungarumlaut:{name:"hungarumlaut",char:"˝",stdCode:205,macCode:253,winCode:null,pdfCode:28,utfCode:733},hyphen:{name:"hyphen",char:"-",stdCode:45,macCode:45,winCode:45,pdfCode:45,utfCode:45},i:{name:"i",char:"i",stdCode:105,macCode:105,winCode:105,pdfCode:105,utfCode:105},iacute:{name:"iacute",char:"í",stdCode:null,macCode:146,winCode:237,pdfCode:237,utfCode:237},icircumflex:{name:"icircumflex",char:"î",stdCode:null,macCode:148,winCode:238,pdfCode:238,utfCode:238},idieresis:{name:"idieresis",char:"ï",stdCode:null,macCode:149,winCode:239,pdfCode:239,utfCode:239},igrave:{name:"igrave",char:"ì",stdCode:null,macCode:147,winCode:236,pdfCode:236,utfCode:236},j:{name:"j",char:"j",stdCode:106,macCode:106,winCode:106,pdfCode:106,utfCode:106},k:{name:"k",char:"k",stdCode:107,macCode:107,winCode:107,pdfCode:107,utfCode:107},l:{name:"l",char:"l",stdCode:108,macCode:108,winCode:108,pdfCode:108,utfCode:108},less:{name:"less",char:"<",stdCode:60,macCode:60,winCode:60,pdfCode:60,utfCode:60},logicalnot:{name:"logicalnot",char:"¬",stdCode:null,macCode:194,winCode:172,pdfCode:172,utfCode:172},lslash:{name:"lslash",char:"ł",stdCode:248,macCode:null,winCode:null,pdfCode:155,utfCode:322},m:{name:"m",char:"m",stdCode:109,macCode:109,winCode:109,pdfCode:109,utfCode:109},macron:{name:"macron",char:"¯",stdCode:197,macCode:248,winCode:175,pdfCode:175,utfCode:175},minus:{name:"minus",char:"−",stdCode:null,macCode:null,winCode:null,pdfCode:138,utfCode:8722},mu:{name:"mu",char:"μ",stdCode:null,macCode:181,winCode:181,pdfCode:181,utfCode:181},multiply:{name:"multiply",char:"×",stdCode:null,macCode:null,winCode:215,pdfCode:215,utfCode:215},n:{name:"n",char:"n",stdCode:110,macCode:110,winCode:110,pdfCode:110,utfCode:110},nine:{name:"nine",char:"9",stdCode:57,macCode:57,winCode:57,pdfCode:57,utfCode:57},ntilde:{name:"ntilde",char:"ñ",stdCode:null,macCode:150,winCode:241,pdfCode:241,utfCode:241},numbersign:{name:"numbersign",char:"#",stdCode:35,macCode:35,winCode:35,pdfCode:35,utfCode:35},o:{name:"o",char:"o",stdCode:111,macCode:111,winCode:111,pdfCode:111,utfCode:111},oacute:{name:"oacute",char:"ó",stdCode:null,macCode:151,winCode:243,pdfCode:243,utfCode:243},ocircumflex:{name:"ocircumflex",char:"ô",stdCode:null,macCode:153,winCode:244,pdfCode:244,utfCode:244},odieresis:{name:"odieresis",char:"ö",stdCode:null,macCode:154,winCode:246,pdfCode:246,utfCode:246},oe:{name:"oe",char:"oe",stdCode:250,macCode:207,winCode:156,pdfCode:156,utfCode:339},ogonek:{name:"ogonek",char:"˛",stdCode:206,macCode:254,winCode:null,pdfCode:29,utfCode:731},ograve:{name:"ograve",char:"ò",stdCode:null,macCode:152,winCode:242,pdfCode:242,utfCode:242},one:{name:"one",char:"1",stdCode:49,macCode:49,winCode:49,pdfCode:49,utfCode:49},onehalf:{name:"onehalf",char:"½",stdCode:null,macCode:null,winCode:189,pdfCode:189,utfCode:189},onequarter:{name:"onequarter",char:"¼",stdCode:null,macCode:null,winCode:188,pdfCode:188,utfCode:188},onesuperior:{name:"onesuperior",char:"¹",stdCode:null,macCode:null,winCode:185,pdfCode:185,utfCode:185},ordfeminine:{name:"ordfeminine",char:"ª",stdCode:227,macCode:187,winCode:170,pdfCode:170,utfCode:170},ordmasculine:{name:"ordmasculine",char:"º",stdCode:235,macCode:188,winCode:186,pdfCode:186,utfCode:186},oslash:{name:"oslash",char:"ø",stdCode:249,macCode:191,winCode:248,pdfCode:248,utfCode:248},otilde:{name:"otilde",char:"õ",stdCode:null,macCode:155,winCode:245,pdfCode:245,utfCode:245},p:{name:"p",char:"p",stdCode:112,macCode:112,winCode:112,pdfCode:112,utfCode:112},paragraph:{name:"paragraph",char:"¶",stdCode:182,macCode:166,winCode:182,pdfCode:182,utfCode:182},parenleft:{name:"parenleft",char:"(",stdCode:40,macCode:40,winCode:40,pdfCode:40,utfCode:40},parenright:{name:"parenright",char:")",stdCode:41,macCode:41,winCode:41,pdfCode:41,utfCode:41},percent:{name:"percent",char:"%",stdCode:37,macCode:37,winCode:37,pdfCode:37,utfCode:37},period:{name:"period",char:".",stdCode:46,macCode:46,winCode:46,pdfCode:46,utfCode:46},periodcentered:{name:"periodcentered",char:"·",stdCode:180,macCode:225,winCode:183,pdfCode:183,utfCode:183},perthousand:{name:"perthousand",char:"‰",stdCode:189,macCode:228,winCode:137,pdfCode:139,utfCode:8240},plus:{name:"plus",char:"+",stdCode:43,macCode:43,winCode:43,pdfCode:43,utfCode:43},plusminus:{name:"plusminus",char:"±",stdCode:null,macCode:177,winCode:177,pdfCode:177,utfCode:177},q:{name:"q",char:"q",stdCode:113,macCode:113,winCode:113,pdfCode:113,utfCode:113},question:{name:"question",char:"?",stdCode:63,macCode:63,winCode:63,pdfCode:63,utfCode:63},questiondown:{name:"questiondown",char:"¿",stdCode:191,macCode:192,winCode:191,pdfCode:191,utfCode:191},quotedbl:{name:"quotedbl",char:'"',stdCode:34,macCode:34,winCode:34,pdfCode:34,utfCode:34},quotedblbase:{name:"quotedblbase",char:"„",stdCode:185,macCode:227,winCode:132,pdfCode:140,utfCode:8222},quotedblleft:{name:"quotedblleft",char:"“",stdCode:170,macCode:210,winCode:147,pdfCode:141,utfCode:8220},quotedblright:{name:"quotedblright",char:"”",stdCode:186,macCode:211,winCode:148,pdfCode:142,utfCode:8221},quoteleft:{name:"quoteleft",char:"‘",stdCode:96,macCode:212,winCode:145,pdfCode:143,utfCode:8216},quoteright:{name:"quoteright",char:"’",stdCode:39,macCode:213,winCode:146,pdfCode:144,utfCode:8217},quotesinglbase:{name:"quotesinglbase",char:"‚",stdCode:184,macCode:226,winCode:130,pdfCode:145,utfCode:8218},quotesingle:{name:"quotesingle",char:"'",stdCode:169,macCode:39,winCode:39,pdfCode:39,utfCode:39},r:{name:"r",char:"r",stdCode:114,macCode:114,winCode:114,pdfCode:114,utfCode:114},registered:{name:"registered",char:"®",stdCode:null,macCode:168,winCode:174,pdfCode:174,utfCode:174},ring:{name:"ring",char:"°",stdCode:202,macCode:251,winCode:null,pdfCode:30,utfCode:730},s:{name:"s",char:"s",stdCode:115,macCode:115,winCode:115,pdfCode:115,utfCode:115},scaron:{name:"scaron",char:"š",stdCode:null,macCode:null,winCode:154,pdfCode:157,utfCode:353},section:{name:"section",char:"§",stdCode:167,macCode:164,winCode:167,pdfCode:167,utfCode:167},semicolon:{name:"semicolon",char:";",stdCode:59,macCode:59,winCode:59,pdfCode:59,utfCode:59},seven:{name:"seven",char:"7",stdCode:55,macCode:55,winCode:55,pdfCode:55,utfCode:55},six:{name:"six",char:"6",stdCode:54,macCode:54,winCode:54,pdfCode:54,utfCode:54},slash:{name:"slash",char:"/",stdCode:47,macCode:47,winCode:47,pdfCode:47,utfCode:47},sterling:{name:"sterling",char:"£",stdCode:163,macCode:163,winCode:163,pdfCode:163,utfCode:163},t:{name:"t",char:"t",stdCode:116,macCode:116,winCode:116,pdfCode:116,utfCode:116},thorn:{name:"thorn",char:"þ",stdCode:null,macCode:null,winCode:254,pdfCode:254,utfCode:254},three:{name:"three",char:"3",stdCode:51,macCode:51,winCode:51,pdfCode:51,utfCode:51},threequarters:{name:"threequarters",char:"¾",stdCode:null,macCode:null,winCode:190,pdfCode:190,utfCode:190},threesuperior:{name:"threesuperior",char:"³",stdCode:null,macCode:null,winCode:179,pdfCode:179,utfCode:179},tilde:{name:"tilde",char:"˜",stdCode:196,macCode:247,winCode:152,pdfCode:31,utfCode:732},trademark:{name:"trademark",char:"™",stdCode:null,macCode:170,winCode:153,pdfCode:146,utfCode:8482},two:{name:"two",char:"2",stdCode:50,macCode:50,winCode:50,pdfCode:50,utfCode:50},twosuperior:{name:"twosuperior",char:"²",stdCode:null,macCode:null,winCode:178,pdfCode:178,utfCode:178},u:{name:"u",char:"u",stdCode:117,macCode:117,winCode:117,pdfCode:117,utfCode:117},uacute:{name:"uacute",char:"ú",stdCode:null,macCode:156,winCode:250,pdfCode:250,utfCode:250},ucircumflex:{name:"ucircumflex",char:"û",stdCode:null,macCode:158,winCode:251,pdfCode:251,utfCode:251},udieresis:{name:"udieresis",char:"ü",stdCode:null,macCode:159,winCode:252,pdfCode:252,utfCode:252},ugrave:{name:"ugrave",char:"ù",stdCode:null,macCode:157,winCode:249,pdfCode:249,utfCode:249},underscore:{name:"underscore",char:"_",stdCode:95,macCode:95,winCode:95,pdfCode:95,utfCode:95},v:{name:"v",char:"v",stdCode:118,macCode:118,winCode:118,pdfCode:118,utfCode:118},w:{name:"w",char:"w",stdCode:119,macCode:119,winCode:119,pdfCode:119,utfCode:119},x:{name:"x",char:"x",stdCode:120,macCode:120,winCode:120,pdfCode:120,utfCode:120},y:{name:"y",char:"y",stdCode:121,macCode:121,winCode:121,pdfCode:121,utfCode:121},yacute:{name:"yacute",char:"ý",stdCode:null,macCode:null,winCode:253,pdfCode:253,utfCode:253},ydieresis:{name:"ydieresis",char:"ÿ",stdCode:null,macCode:216,winCode:255,pdfCode:255,utfCode:255},yen:{name:"yen",char:"¥",stdCode:165,macCode:180,winCode:165,pdfCode:165,utfCode:165},z:{name:"z",char:"z",stdCode:122,macCode:122,winCode:122,pdfCode:122,utfCode:122},zcaron:{name:"zcaron",char:"ž",stdCode:null,macCode:null,winCode:158,pdfCode:158,utfCode:382},zero:{name:"zero",char:"0",stdCode:48,macCode:48,winCode:48,pdfCode:48,utfCode:48},Djecyrillic:{name:"Djecyrillic",char:"Ђ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1026},afii10051:{name:"afii10051",char:"Ђ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1026},Gjecyrillic:{name:"Gjecyrillic",char:"Ѓ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1027},afii10052:{name:"afii10052",char:"Ѓ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1027},Ljecyrillic:{name:"Ljecyrillic",char:"Љ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1033},afii10058:{name:"afii10058",char:"Љ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1033},Njecyrillic:{name:"Njecyrillic",char:"Њ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1034},afii10059:{name:"afii10059",char:"Њ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1034},Kjecyrillic:{name:"Kjecyrillic",char:"Ќ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1036},afii10061:{name:"afii10061",char:"Ќ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1036},Tshecyrillic:{name:"Tshecyrillic",char:"Ћ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1035},afii10060:{name:"afii10060",char:"Ћ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1035},Dzhecyrillic:{name:"Dzhecyrillic",char:"Џ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1039},afii10145:{name:"afii10145",char:"Џ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1039},afii10100:{name:"afii10100",char:"ѓ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1107},gjecyrillic:{name:"gjecyrillic",char:"ѓ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1107},afii10099:{name:"afii10099",char:"ђ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1106},djecyrillic:{name:"djecyrillic",char:"ђ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1106},afii10106:{name:"afii10106",char:"љ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1113},ljecyrillic:{name:"ljecyrillic",char:"љ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1113},afii10107:{name:"afii10107",char:"њ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1114},njecyrillic:{name:"njecyrillic",char:"њ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1114},afii10109:{name:"afii10109",char:"ќ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1116},kjecyrillic:{name:"kjecyrillic",char:"ќ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1116},afii10108:{name:"afii10108",char:"ћ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1115},tshecyrillic:{name:"tshecyrillic",char:"ћ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1115},afii10193:{name:"afii10193",char:"џ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1119},dzhecyrillic:{name:"dzhecyrillic",char:"џ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1119},Ushortcyrillic:{name:"Ushortcyrillic",char:"Ў",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1038},afii10062:{name:"afii10062",char:"Ў",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1038},afii10110:{name:"afii10110",char:"ў",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1118},ushortcyrillic:{name:"ushortcyrillic",char:"ў",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1118},Jecyrillic:{name:"Jecyrillic",char:"Ј",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1032},afii10057:{name:"afii10057",char:"Ј",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1032},Gheupturncyrillic:{name:"Gheupturncyrillic",char:"Ґ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1168},afii10050:{name:"afii10050",char:"Ґ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1168},Iocyrillic:{name:"Iocyrillic",char:"Ё",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1025},afii10023:{name:"afii10023",char:"Ё",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1025},Ecyrillic:{name:"Ecyrillic",char:"Є",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1028},afii10053:{name:"afii10053",char:"Є",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1028},Yicyrillic:{name:"Yicyrillic",char:"Ї",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1031},afii10056:{name:"afii10056",char:"Ї",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1031},Icyrillic:{name:"Icyrillic",char:"І",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1030},afii10055:{name:"afii10055",char:"І",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1030},afii10103:{name:"afii10103",char:"і",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1110},icyrillic:{name:"icyrillic",char:"і",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1110},afii10098:{name:"afii10098",char:"ґ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1169},gheupturncyrillic:{name:"gheupturncyrillic",char:"ґ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1169},afii10071:{name:"afii10071",char:"ё",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1105},iocyrillic:{name:"iocyrillic",char:"ё",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1105},afii10101:{name:"afii10101",char:"є",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1108},ecyrillic:{name:"ecyrillic",char:"є",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1108},afii10105:{name:"afii10105",char:"ј",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1112},jecyrillic:{name:"jecyrillic",char:"ј",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1112},Dzecyrillic:{name:"Dzecyrillic",char:"Ѕ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1029},afii10054:{name:"afii10054",char:"Ѕ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1029},afii10102:{name:"afii10102",char:"ѕ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1109},dzecyrillic:{name:"dzecyrillic",char:"ѕ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1109},afii10104:{name:"afii10104",char:"ї",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1111},yicyrillic:{name:"yicyrillic",char:"ї",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1111},Acyrillic:{name:"Acyrillic",char:"А",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1040},afii10017:{name:"afii10017",char:"А",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1040},Becyrillic:{name:"Becyrillic",char:"Б",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1041},afii10018:{name:"afii10018",char:"Б",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1041},Vecyrillic:{name:"Vecyrillic",char:"В",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1042},afii10019:{name:"afii10019",char:"В",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1042},Gecyrillic:{name:"Gecyrillic",char:"Г",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1043},afii10020:{name:"afii10020",char:"Г",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1043},Decyrillic:{name:"Decyrillic",char:"Д",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1044},afii10021:{name:"afii10021",char:"Д",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1044},Iecyrillic:{name:"Iecyrillic",char:"Е",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1045},afii10022:{name:"afii10022",char:"Е",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1045},Zhecyrillic:{name:"Zhecyrillic",char:"Ж",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1046},afii10024:{name:"afii10024",char:"Ж",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1046},Zecyrillic:{name:"Zecyrillic",char:"З",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1047},afii10025:{name:"afii10025",char:"З",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1047},Iicyrillic:{name:"Iicyrillic",char:"И",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1048},afii10026:{name:"afii10026",char:"И",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1048},Iishortcyrillic:{name:"Iishortcyrillic",char:"Й",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1049},afii10027:{name:"afii10027",char:"Й",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1049},Kacyrillic:{name:"Kacyrillic",char:"К",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1050},afii10028:{name:"afii10028",char:"К",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1050},Elcyrillic:{name:"Elcyrillic",char:"Л",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1051},afii10029:{name:"afii10029",char:"Л",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1051},Emcyrillic:{name:"Emcyrillic",char:"М",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1052},afii10030:{name:"afii10030",char:"М",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1052},Encyrillic:{name:"Encyrillic",char:"Н",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1053},afii10031:{name:"afii10031",char:"Н",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1053},Ocyrillic:{name:"Ocyrillic",char:"О",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1054},afii10032:{name:"afii10032",char:"О",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1054},Pecyrillic:{name:"Pecyrillic",char:"П",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1055},afii10033:{name:"afii10033",char:"П",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1055},Ercyrillic:{name:"Ercyrillic",char:"Р",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1056},afii10034:{name:"afii10034",char:"Р",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1056},Escyrillic:{name:"Escyrillic",char:"С",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1057},afii10035:{name:"afii10035",char:"С",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1057},Tecyrillic:{name:"Tecyrillic",char:"Т",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1058},afii10036:{name:"afii10036",char:"Т",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1058},Ucyrillic:{name:"Ucyrillic",char:"У",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1059},afii10037:{name:"afii10037",char:"У",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1059},Efcyrillic:{name:"Efcyrillic",char:"Ф",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1060},afii10038:{name:"afii10038",char:"Ф",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1060},Khacyrillic:{name:"Khacyrillic",char:"Х",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1061},afii10039:{name:"afii10039",char:"Х",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1061},Tsecyrillic:{name:"Tsecyrillic",char:"Ц",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1062},afii10040:{name:"afii10040",char:"Ц",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1062},Checyrillic:{name:"Checyrillic",char:"Ч",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1063},afii10041:{name:"afii10041",char:"Ч",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1063},Shacyrillic:{name:"Shacyrillic",char:"Ш",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1064},afii10042:{name:"afii10042",char:"Ш",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1064},Shchacyrillic:{name:"Shchacyrillic",char:"Щ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1065},afii10043:{name:"afii10043",char:"Щ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1065},Hardsigncyrillic:{name:"Hardsigncyrillic",char:"Ъ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1066},afii10044:{name:"afii10044",char:"Ъ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1066},Yericyrillic:{name:"Yericyrillic",char:"Ы",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1067},afii10045:{name:"afii10045",char:"Ы",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1067},Softsigncyrillic:{name:"Softsigncyrillic",char:"Ь",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1068},afii10046:{name:"afii10046",char:"Ь",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1068},Ereversedcyrillic:{name:"Ereversedcyrillic",char:"Э",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1069},afii10047:{name:"afii10047",char:"Э",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1069},IUcyrillic:{name:"IUcyrillic",char:"Ю",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1070},afii10048:{name:"afii10048",char:"Ю",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1070},IAcyrillic:{name:"IAcyrillic",char:"Я",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1071},afii10049:{name:"afii10049",char:"Я",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1071},afii10065:{name:"afii10065",char:"а",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1072},acyrillic:{name:"acyrillic",char:"а",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1072},afii10066:{name:"afii10066",char:"б",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1073},becyrillic:{name:"becyrillic",char:"б",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1073},afii10067:{name:"afii10067",char:"в",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1074},vecyrillic:{name:"vecyrillic",char:"в",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1074},afii10068:{name:"afii10068",char:"г",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1075},gecyrillic:{name:"gecyrillic",char:"г",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1075},afii10069:{name:"afii10069",char:"д",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1076},decyrillic:{name:"decyrillic",char:"д",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1076},afii10070:{name:"afii10070",char:"е",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1077},iecyrillic:{name:"iecyrillic",char:"е",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1077},afii10072:{name:"afii10072",char:"ж",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1078},zhecyrillic:{name:"zhecyrillic",char:"ж",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1078},afii10073:{name:"afii10073",char:"з",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1079},zecyrillic:{name:"zecyrillic",char:"з",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1079},afii10074:{name:"afii10074",char:"и",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1080},iicyrillic:{name:"iicyrillic",char:"и",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1080},afii10075:{name:"afii10075",char:"й",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1081},iishortcyrillic:{name:"iishortcyrillic",char:"й",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1081},afii10076:{name:"afii10076",char:"к",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1082},kacyrillic:{name:"kacyrillic",char:"к",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1082},afii10077:{name:"afii10077",char:"л",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1083},elcyrillic:{name:"elcyrillic",char:"л",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1083},afii10078:{name:"afii10078",char:"м",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1084},emcyrillic:{name:"emcyrillic",char:"м",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1084},afii10079:{name:"afii10079",char:"н",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1085},encyrillic:{name:"encyrillic",char:"н",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1085},afii10080:{name:"afii10080",char:"о",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1086},ocyrillic:{name:"ocyrillic",char:"о",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1086},afii10081:{name:"afii10081",char:"п",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1087},pecyrillic:{name:"pecyrillic",char:"п",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1087},afii10082:{name:"afii10082",char:"р",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1088},ercyrillic:{name:"ercyrillic",char:"р",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1088},afii10083:{name:"afii10083",char:"с",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1089},escyrillic:{name:"escyrillic",char:"с",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1089},afii10084:{name:"afii10084",char:"т",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1090},tecyrillic:{name:"tecyrillic",char:"т",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1090},afii10085:{name:"afii10085",char:"у",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1091},ucyrillic:{name:"ucyrillic",char:"у",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1091},afii10086:{name:"afii10086",char:"ф",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1092},efcyrillic:{name:"efcyrillic",char:"ф",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1092},afii10087:{name:"afii10087",char:"х",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1093},khacyrillic:{name:"khacyrillic",char:"х",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1093},afii10088:{name:"afii10088",char:"ц",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1094},tsecyrillic:{name:"tsecyrillic",char:"ц",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1094},afii10089:{name:"afii10089",char:"ч",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1095},checyrillic:{name:"checyrillic",char:"ч",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1095},afii10090:{name:"afii10090",char:"ш",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1096},shacyrillic:{name:"shacyrillic",char:"ш",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1096},afii10091:{name:"afii10091",char:"щ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1097},shchacyrillic:{name:"shchacyrillic",char:"щ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1097},afii10092:{name:"afii10092",char:"ъ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1098},hardsigncyrillic:{name:"hardsigncyrillic",char:"ъ",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1098},afii10093:{name:"afii10093",char:"ы",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1099},yericyrillic:{name:"yericyrillic",char:"ы",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1099},afii10094:{name:"afii10094",char:"ь",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1100},softsigncyrillic:{name:"softsigncyrillic",char:"ь",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1100},afii10095:{name:"afii10095",char:"э",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1101},ereversedcyrillic:{name:"ereversedcyrillic",char:"э",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1101},afii10096:{name:"afii10096",char:"ю",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1102},iucyrillic:{name:"iucyrillic",char:"ю",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1102},afii10097:{name:"afii10097",char:"я",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1103},iacyrillic:{name:"iacyrillic",char:"я",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:1103},afii61352:{name:"afii61352",char:"№",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:8470},numero:{name:"numero",char:"№",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:8470},nbspace:{name:"nbspace",char:"",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:160},currency:{name:"currency",char:"¤",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:164},sfthyphen:{name:"sfthyphen",char:"",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:173},middot:{name:"middot",char:"·",stdCode:null,macCode:null,winCode:null,pdfCode:null,utfCode:183},".notdef":{name:".notdef",char:" ",stdCode:32,macCode:32,winCode:32,pdfCode:32,utfCode:32},space:{name:"space",char:" ",stdCode:32,macCode:32,winCode:32,pdfCode:32,utfCode:32}};function getCharCodesMapByCode(J){const e=new Map;let C;switch(J){case"StandardEncoding":C="stdCode";break;case"WinAnsiEncoding":C="winCode";break;case"MacRomanEncoding":C="macCode";break;case"PDFDocEncoding":C="pdfCode";break;case"Utf-16":C="utfCode";break;default:return console.log(`Unsupported encoding: '${J}'`),e}for(const[,F]of Object.entries(pdfCharCodesByName))F[C]&&e.set(F[C],F);return e}class EncodingDict extends PdfDict{BaseEncoding;Differences;_charMap;get charMap(){return this._charMap||this.refreshCharMaps(),this._charMap}_codeMap;get codeMap(){return this._codeMap||this.refreshCharMaps(),this._codeMap}constructor(){super(dictTypes.ENCODING)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new EncodingDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.BaseEncoding&&$.push(...F.encode("/BaseEncoding "),...F.encode(" "+this.BaseEncoding)),this.Differences&&$.push(...F.encode("/Differences "),...this.encodePrimitiveArray(this.Differences,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/BaseEncoding":V=await this.parseNamePropAsync(te,C,V);break;case"/Differences":const ne=await C.getValueTypeAtAsync(V,!0);if(ne===valueTypes.ARRAY){this.Differences=[];const ee=await C.getArrayBoundsAtAsync(V);let ie=ee.start+1;for(;ie<ee.end-1&&ie!==-1;){const ae=await C.getValueTypeAtAsync(ie,!0);switch(ae){case valueTypes.NAME:const re=await C.parseNameAtAsync(ie,!0);this.Differences.push(re.value),ie=re.end+1;break;case valueTypes.NUMBER:const oe=await C.parseNumberAtAsync(ie,!0);this.Differences.push(oe.value),ie=oe.end+1;break;default:throw new Error(`Invalid differences array value type: ${ae}`)}}V=ee.end+1}else throw new Error(`Invalid differences value type: ${ne}`);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}refreshCharMaps(){if(this.Differences){if(typeof this.Differences[0]!="number")throw new Error("First element of encoding difference array must be a number");let e;const C=getCharCodesMapByCode(this.BaseEncoding.substring(1));for(const F of this.Differences){if(typeof F=="number"){e=F;continue}const $=pdfCharCodesByName[F.substring(1)];$&&C.set(e++,$)}this._charMap=new Map,this._codeMap=new Map,C.forEach((F,$)=>{this.charMap.set($,F.char),this._codeMap.set(F.char,$)})}}}class FontDescriptorDict extends PdfDict{FontName;FontFamily;FontStretch;FontWeight;Flags;FontBBox;ItalicAngle;Ascent;Descent;CapHeight;StemV;StemH=0;Leading=0;AvgWidth=0;MaxWidth=0;MissingWidth=0;XHeight=0;CharSet;FontFile;FontFile2;FontFile3;constructor(){super(dictTypes.FONT_DESCRIPTOR)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new FontDescriptorDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.FontName&&$.push(...F.encode("/FontName "),...F.encode(" "+this.FontName)),this.FontFamily&&$.push(...F.encode("/FontFamily "),...this.FontFamily.toArray(e)),this.FontStretch&&$.push(...F.encode("/FontStretch "),...F.encode(" "+this.FontStretch)),this.FontWeight&&$.push(...F.encode("/FontWeight "),...F.encode(" "+this.FontWeight)),this.Flags&&$.push(...F.encode("/Flags "),...F.encode(" "+this.Flags)),this.FontBBox&&$.push(...F.encode("/FontBBox "),...this.encodePrimitiveArray(this.FontBBox,F)),(this.ItalicAngle||this.ItalicAngle===0)&&$.push(...F.encode("/ItalicAngle "),...F.encode(" "+this.ItalicAngle)),this.Ascent&&$.push(...F.encode("/Ascent "),...F.encode(" "+this.Ascent)),this.Descent&&$.push(...F.encode("/Descent "),...F.encode(" "+this.Descent)),this.CapHeight&&$.push(...F.encode("/CapHeight "),...F.encode(" "+this.CapHeight)),this.StemV&&$.push(...F.encode("/StemV "),...F.encode(" "+this.StemV)),this.StemH&&$.push(...F.encode("/StemV "),...F.encode(" "+this.StemH)),this.Leading&&$.push(...F.encode("/Leading "),...F.encode(" "+this.Leading)),this.AvgWidth&&$.push(...F.encode("/AvgWidth "),...F.encode(" "+this.AvgWidth)),this.MaxWidth&&$.push(...F.encode("/MaxWidth "),...F.encode(" "+this.MaxWidth)),this.MissingWidth&&$.push(...F.encode("/MissingWidth "),...F.encode(" "+this.MissingWidth)),this.XHeight&&$.push(...F.encode("/XHeight "),...F.encode(" "+this.XHeight)),this.CharSet&&$.push(...F.encode("/CharSet "),...this.CharSet.toArray(e)),this.FontFile&&$.push(...F.encode("/FontFile "),...this.FontFile.toArray(e)),this.FontFile2&&$.push(...F.encode("/FontFile2 "),...this.FontFile2.toArray(e)),this.FontFile3&&$.push(...F.encode("/FontFile3 "),...this.FontFile3.toArray(e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/FontName":case"/FontStretch":V=await this.parseNamePropAsync(te,C,V);break;case"/FontFile":case"/FontFile2":case"/FontFile3":V=await this.parseRefPropAsync(te,C,V);break;case"/Flags":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/FontWeight":case"/ItalicAngle":case"/Ascent":case"/Descent":case"/Leading":case"/CapHeight":case"/XHeight":case"/StemV":case"/StemH":case"/AvgWidth":case"/MaxWidth":case"/MissingWidth":V=await this.parseNumberPropAsync(te,C,V,!0);break;case"/FontBBox":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/CharSet":case"/FontFamily":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.STRING_HEX)V=await this.parseHexPropAsync(te,C,V);else if(ne===valueTypes.STRING_LITERAL)V=await this.parseLiteralPropAsync(te,C,V);else throw new Error(`Unsupported '${te}' property value type: '${ne}'`);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.FontName||!this.Flags&&this.Flags!==0||!this.ItalicAngle&&this.ItalicAngle!==0)throw new Error("Not all required properties parsed")}}const cyrillicEncodingDifferences=[128,"/Djecyrillic","/Gjecyrillic","/quotesinglbase","/afii10100","/quotedblbase","/ellipsis","/dagger","/daggerdbl","/Euro","/perthousand","/Ljecyrillic","/guilsinglleft","/Njecyrillic","/Kjecyrillic","/Tshecyrillic","/Dzhecyrillic","/afii10099","/quoteleft","/quoteright","/quotedblleft","/quotedblright","/bullet","/endash","/emdash","/.notdef","/trademark","/afii10106","/guilsinglright","/afii10107","/afii10109","/afii10108","/afii10193","/nbspace","/Ushortcyrillic","/afii10110","/Jecyrillic","/currency","/Gheupturncyrillic","/brokenbar","/section","/Iocyrillic","/copyright","/Ecyrillic","/guillemotleft","/logicalnot","/sfthyphen","/registered","/Yicyrillic","/degree","/plusminus","/Icyrillic","/afii10103","/afii10098","/mu","/paragraph","/middot","/afii10071","/afii61352","/afii10101","/guillemotright","/afii10105","/Dzecyrillic","/afii10102","/afii10104","/Acyrillic","/Becyrillic","/Vecyrillic","/Gecyrillic","/Decyrillic","/Iecyrillic","/Zhecyrillic","/Zecyrillic","/Iicyrillic","/Iishortcyrillic","/Kacyrillic","/Elcyrillic","/Emcyrillic","/Encyrillic","/Ocyrillic","/Pecyrillic","/Ercyrillic","/Escyrillic","/Tecyrillic","/Ucyrillic","/Efcyrillic","/Khacyrillic","/Tsecyrillic","/Checyrillic","/Shacyrillic","/Shchacyrillic","/Hardsigncyrillic","/Yericyrillic","/Softsigncyrillic","/Ereversedcyrillic","/IUcyrillic","/IAcyrillic","/acyrillic","/afii10066","/afii10067","/afii10068","/afii10069","/afii10070","/afii10072","/afii10073","/afii10074","/afii10075","/afii10076","/afii10077","/afii10078","/afii10079","/afii10080","/afii10081","/afii10082","/afii10083","/afii10084","/afii10085","/afii10086","/afii10087","/afii10088","/afii10089","/afii10090","/afii10091","/afii10092","/afii10093","/afii10094","/afii10095","/afii10096","/afii10097"];class FontDict extends PdfDict{Subtype;BaseFont;Encoding;FontDescriptor;ToUnicode;FirstChar;LastChar;Widths;FontBBox;FontMatrix;Resources;CharProcs;DescendantFonts;_name;get name(){return this._name}_encoding;get encoding(){return this._encoding}set encoding(e){this._encoding=e,this.Encoding=e.ref?new ObjectId(e.ref.id,e.ref.generation):null}get encodingValue(){return!this.Encoding&&this._encoding?.ref&&(this.Encoding=new ObjectId(this._encoding.ref.id,this._encoding.ref.generation)),this.Encoding}_descriptor;get descriptor(){return this._descriptor}set descriptor(e){this._descriptor=e,this.FontDescriptor=e.ref?new ObjectId(e.ref.id,e.ref.generation):null}get descriptorValue(){return!this.FontDescriptor&&this._descriptor?.ref&&(this.FontDescriptor=new ObjectId(this._descriptor.ref.id,this._descriptor.ref.generation)),this.FontDescriptor}_toUtfCmap;get toUtfCmap(){return this._toUtfCmap}get isMonospace(){if(!this._descriptor)return!1;const e=this._descriptor?.Flags;return!!ByteUtils.getBit(e,0)}get isSerif(){if(!this._descriptor)return!1;const e=this._descriptor?.Flags;return!!ByteUtils.getBit(e,1)}get isScript(){if(!this._descriptor)return!1;const e=this._descriptor?.Flags;return!!ByteUtils.getBit(e,3)}get isItalic(){if(!this._descriptor)return!1;const e=this._descriptor?.Flags;return!!ByteUtils.getBit(e,6)}constructor(){super(dictTypes.FONT)}static newFontMap(){const e=new Map,C=new EncodingDict;return C.BaseEncoding="/WinAnsiEncoding",C.Differences=cyrillicEncodingDifferences.slice(),e.set("arial",FontDict.createArialFont(C)),e.set("calibri",FontDict.createCalibriFont(C)),e.set("cambria",FontDict.createCambriaFont(C)),e.set("courier",FontDict.createCourierFont(C)),e.set("tnr",FontDict.createTnrFont(C)),e.set("verdana",FontDict.createVerdanaFont(C)),e}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new FontDict;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}static createArialFont(e){const C=new FontDescriptorDict;C.FontName="/ArialMT",C.Flags=32,C.ItalicAngle=0,C.Ascent=905,C.Descent=-211,C.FontBBox=[-664,-324,2e3,1039],C.CapHeight=716,C.StemV=0;const F=new FontDict;return F.encoding=e,F.descriptor=C,F.Subtype="/TrueType",F.BaseFont="/ArialMT",F.FirstChar=32,F.LastChar=255,F.Widths=[277,277,354,556,556,889,666,190,333,333,389,583,277,333,277,277,556,556,556,556,556,556,556,556,556,556,277,277,583,583,583,556,925,666,666,722,722,666,610,777,722,277,500,666,556,833,722,777,666,777,722,666,610,722,666,943,666,666,610,277,277,277,469,556,333,556,556,500,556,556,277,556,556,222,222,500,222,833,556,556,556,556,333,500,277,556,500,722,500,500,500,333,259,333,583,750,864,541,222,364,333,1e3,556,556,556,1e3,1014,333,893,582,854,718,556,222,222,333,333,350,556,1e3,750,1e3,906,333,812,437,556,552,277,635,500,500,556,488,259,556,666,736,718,556,583,333,736,277,399,548,277,222,411,576,537,333,556,953,510,556,222,666,500,277,666,656,666,541,677,666,923,604,718,718,582,656,833,722,777,718,666,722,610,635,760,666,739,666,916,937,791,885,656,718,879,722,556,572,531,364,583,556,668,458,558,558,437,583,687,552,556,541,556,500,458,500,822,500,572,520,802,822,625,718,520,510,750,541],F._name="/tspdfFarial",F}static createCalibriFont(e){const C=new FontDescriptorDict;C.FontName="/Calibri",C.Flags=32,C.ItalicAngle=0,C.Ascent=750,C.Descent=-250,C.FontBBox=[-502,-312,1240,1026],C.CapHeight=631,C.StemV=0;const F=new FontDict;return F.encoding=e,F.descriptor=C,F.Subtype="/TrueType",F.BaseFont="/Calibri",F.FirstChar=32,F.LastChar=255,F.Widths=[226,325,400,498,506,714,682,220,303,303,498,498,249,306,252,386,506,506,506,506,506,506,506,506,506,506,267,267,498,498,498,463,894,578,543,533,615,488,459,630,623,251,318,519,420,854,645,662,516,672,542,459,487,641,567,889,519,487,468,306,386,306,498,498,291,479,525,422,525,497,305,470,525,229,239,454,229,798,525,527,525,525,348,391,334,525,451,714,433,452,395,314,460,314,498,506,624,429,249,345,418,690,498,498,506,967,872,338,876,542,618,619,540,249,249,418,418,498,498,905,0,705,750,338,769,463,532,524,226,527,452,318,498,432,498,498,488,834,547,512,498,306,506,251,338,498,251,229,354,549,585,252,497,890,443,512,239,459,391,229,578,537,543,429,644,488,800,473,641,641,542,610,854,623,662,621,516,533,487,527,697,519,638,555,868,889,614,761,531,547,878,555,479,532,479,345,558,497,688,422,540,540,463,510,676,534,527,520,525,422,387,452,624,433,541,468,728,749,536,666,469,442,721,474],F._name="/tspdfFcalibri",F}static createCambriaFont(e){const C=new FontDescriptorDict;C.FontName="/Cambria",C.Flags=32,C.ItalicAngle=0,C.Ascent=950,C.Descent=-222,C.FontBBox=[-1474,-2463,2867,3116],C.CapHeight=666,C.StemV=0;const F=new FontDict;return F.encoding=e,F.descriptor=C,F.Subtype="/TrueType",F.BaseFont="/Cambria",F.FirstChar=32,F.LastChar=255,F.Widths=[220,285,393,619,505,889,687,236,381,381,427,553,205,332,205,490,553,553,553,553,553,553,553,553,553,553,263,263,553,553,553,422,885,623,611,562,661,575,536,610,686,324,306,629,536,815,680,653,567,653,621,496,592,647,603,921,571,570,537,350,490,350,553,370,284,488,547,440,554,487,302,494,551,277,266,524,271,832,558,530,556,546,413,429,338,552,503,774,483,503,454,387,316,387,712,658,738,534,205,446,360,751,516,516,628,1160,935,302,932,649,752,666,538,221,221,375,375,443,500,1e3,0,679,763,302,797,540,551,566,220,600,503,306,543,501,316,500,575,850,569,487,553,332,850,324,375,553,324,277,416,543,587,282,487,927,470,487,266,496,429,277,623,599,611,534,654,575,922,542,691,691,649,677,815,686,653,674,567,562,592,600,778,571,671,625,926,926,731,850,597,573,920,630,488,541,522,446,558,487,713,458,589,589,540,559,672,588,530,566,556,440,511,503,685,483,569,530,800,800,617,748,514,470,767,530],F._name="/tspdfFcambria",F}static createCourierFont(e){const C=new FontDescriptorDict;C.FontName="/CourierNewPSMT",C.Flags=32,C.ItalicAngle=0,C.Ascent=832,C.Descent=-300,C.FontBBox=[-121,-679,622,1020],C.CapHeight=571,C.StemV=0;const F=new FontDict;return F.encoding=e,F.descriptor=C,F.Subtype="/TrueType",F.BaseFont="/CourierNewPSMT",F.FirstChar=32,F.LastChar=255,F.Widths=[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],F._name="/tspdfFcourier",F}static createTnrFont(e){const C=new FontDescriptorDict;C.FontName="/TimesNewRomanPSMT",C.Flags=32,C.ItalicAngle=0,C.Ascent=891,C.Descent=-216,C.FontBBox=[-568,-306,2045,1039],C.CapHeight=662,C.StemV=0;const F=new FontDict;return F.encoding=e,F.descriptor=C,F.Subtype="/TrueType",F.BaseFont="/TimesNewRomanPSMT",F.FirstChar=32,F.LastChar=255,F.Widths=[250,333,408,500,500,833,777,180,333,333,500,563,250,333,250,277,500,500,500,500,500,500,500,500,500,500,277,277,563,563,563,443,920,722,666,666,722,610,556,722,722,333,389,722,610,889,722,722,556,722,666,556,610,722,722,943,722,722,610,333,277,333,469,500,333,443,500,443,500,443,333,500,500,277,277,500,277,777,500,500,500,500,333,389,277,500,500,722,500,500,443,479,200,479,541,777,751,578,333,410,443,1e3,500,500,500,1e3,872,333,872,666,741,722,482,333,333,443,443,350,500,1e3,777,979,727,333,723,485,500,535,250,708,500,389,500,450,200,500,610,759,660,500,563,333,759,333,399,548,333,277,351,576,453,333,443,954,429,500,277,556,389,277,722,574,666,578,682,610,895,500,722,722,666,678,889,722,722,722,556,666,610,708,790,722,722,649,953,953,706,872,574,660,973,666,443,508,472,410,508,443,690,395,535,535,485,499,632,535,500,535,500,443,437,500,647,500,535,502,770,770,517,671,456,429,747,459],F._name="/tspdfFtnr",F}static createVerdanaFont(e){const C=new FontDescriptorDict;C.FontName="/Verdana",C.Flags=32,C.ItalicAngle=0,C.Ascent=1005,C.Descent=-209,C.FontBBox=[-559,-303,1522,1050],C.CapHeight=727,C.StemV=0;const F=new FontDict;return F.encoding=e,F.descriptor=C,F.Subtype="/TrueType",F.BaseFont="/Verdana",F.FirstChar=32,F.LastChar=255,F.Widths=[351,393,458,818,635,931,726,268,454,454,635,818,363,454,363,454,635,635,635,635,635,635,635,635,635,635,454,454,818,818,818,545,1e3,683,685,698,770,632,574,775,751,420,454,692,556,842,748,787,603,787,695,683,616,731,683,988,685,615,685,454,454,454,818,635,635,600,623,520,623,595,351,623,632,274,344,591,274,972,632,606,623,623,426,520,394,632,591,818,591,591,525,634,454,634,818,1e3,792,566,268,471,458,818,635,635,635,1374,1071,454,966,692,817,751,632,268,268,458,458,545,635,1e3,1e3,976,914,454,914,591,632,637,351,615,591,454,635,566,454,635,632,1e3,700,644,818,454,1e3,420,541,818,420,274,471,641,635,363,595,993,546,644,344,683,520,274,683,685,685,566,745,632,973,615,750,750,692,734,842,751,787,751,603,698,616,615,818,685,761,711,835,904,783,920,680,701,881,706,600,614,594,471,621,595,797,524,640,640,591,620,696,637,606,637,623,534,496,591,840,591,644,605,875,887,640,794,570,546,838,599],F._name="/tspdfFverdana",F}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Subtype&&$.push(...F.encode("/Subtype "),...F.encode(" "+this.Subtype)),this.BaseFont&&$.push(...F.encode("/BaseFont "),...F.encode(" "+this.BaseFont)),this.ToUnicode&&$.push(...F.encode("/G "),...this.ToUnicode.toArray(e)),this.FirstChar&&$.push(...F.encode("/FirstChar "),...F.encode(" "+this.FirstChar)),this.LastChar&&$.push(...F.encode("/LastChar "),...F.encode(" "+this.LastChar)),this.Widths&&(this.Widths instanceof ObjectId?$.push(...F.encode("/Widths "),...this.Widths.toArray(e)):$.push(...F.encode("/Widths "),...this.encodePrimitiveArray(this.Widths,F))),(this.Encoding||this.encodingValue)&&(this.Encoding instanceof ObjectId?$.push(...F.encode("/Encoding "),...this.Encoding.toArray(e)):$.push(...F.encode("/Encoding "),...F.encode(" "+this.Encoding))),this.descriptorValue&&$.push(...F.encode("/FontDescriptor "),...this.descriptorValue.toArray(e)),this.Resources&&$.push(...F.encode("/Resources "),...this.Resources),this.CharProcs&&$.push(...F.encode("/CharProcs "),...this.CharProcs),this.FontBBox&&$.push(...F.encode("/FontBBox "),...this.encodePrimitiveArray(this.FontBBox,F)),this.FontMatrix&&$.push(...F.encode("/FontMatrix "),...this.encodePrimitiveArray(this.FontMatrix,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}decodeText(e){if(this.toUtfCmap)return this.toUtfCmap.hexBytesToUtfString(e);if(this.encoding?.charMap){const $=this.encoding.charMap;let Y="";return e.forEach(V=>Y+=$.get(V)??" "),Y}return(e[0]===254&&e[1]===255?new TextDecoder("utf-16be"):new TextDecoder).decode(e)||""}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Subtype":const ne=await C.parseNameAtAsync(V,!0);if(ne){this.Subtype=ne.value,V=ne.end+1;break}throw new Error("Can't parse /Subtype property value");case"/BaseFont":V=await this.parseNamePropAsync(te,C,V);break;case"/Encoding":const ee=await C.getValueTypeAtAsync(V);if(ee===valueTypes.NAME)V=await this.parseNamePropAsync(te,C,V);else if(ee===valueTypes.REF)V=await this.parseRefPropAsync(te,C,V);else throw new Error(`Unsupported '${te}' property value type: '${ee}'`);break;case"/ToUnicode":V=await this.parseRefPropAsync(te,C,V);break;case"/FirstChar":case"/LastChar":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/FontBBox":case"/FontMatrix":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/Widths":const ie=await C.getValueTypeAtAsync(V);if(ie===valueTypes.ARRAY)V=await this.parseNumberArrayPropAsync(te,C,V,!0);else if(ie===valueTypes.REF)V=await this.parseRefPropAsync(te,C,V);else throw new Error(`Unsupported '${te}' property value type: '${ee}'`);break;case"/FontDescriptor":V=await this.parseRefPropAsync(te,C,V);break;case"/Resources":case"/CharProcs":const ae=await C.getValueTypeAtAsync(V);if(ae===valueTypes.REF){const re=await ObjectId.parseRefAsync(C,V);if(re&&e.parseInfoGetterAsync){this[te.slice(1)]=await C.sliceCharCodesAsync(re.start,re.end),V=re.end+1;break}throw new Error(`Can't parse ${te} value reference`)}else if(ae===valueTypes.DICTIONARY){const re=await C.getDictBoundsAtAsync(V);if(re){this[te.slice(1)]=await C.sliceCharCodesAsync(re.start,re.end),V=re.end+1;break}throw new Error(`Can't parse ${te} dictionary bounds`)}throw new Error(`Unsupported ${te} property value type: ${ae}`);default:V=await C.skipToNextNameAsync(V,Y-1);break}if(this.Encoding&&this.Encoding instanceof ObjectId){const ne=await e.parseInfoGetterAsync(this.Encoding.id),ee=await EncodingDict.parseAsync(ne);this._encoding=ee?.value}if(this.ToUnicode){const ne=await e.parseInfoGetterAsync(this.ToUnicode.id),ee=await UnicodeCmapStream.parseAsync(ne);this._toUtfCmap=ee?.value}if(this.FontDescriptor){const ne=await e.parseInfoGetterAsync(this.FontDescriptor.id),ee=await FontDescriptorDict.parseAsync(ne);this._descriptor=ee?.value}if(this.Subtype!=="/Type1"&&this.Subtype!=="/Type3"&&this.Subtype!=="/TrueType"&&!(this.Subtype==="/Type0"&&this._toUtfCmap))throw new Error(`Font type is not supported: ${this.Subtype}`);if(this.Subtype==="/Type3"&&(!this.FontBBox||!this.FontMatrix||!this.Encoding||!this.FirstChar||!this.LastChar||!this.Widths||!this.CharProcs))throw new Error("Not all required properties parsed")}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class SoftMaskDict extends PdfDict{S;G;BC;TR="/Identity";constructor(){super(dictTypes.SOFT_MASK)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new SoftMaskDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.S&&$.push(...F.encode("/S "),...F.encode(this.S)),this.G&&$.push(...F.encode("/G "),...this.G.toArray(e)),this.BC&&$.push(...F.encode("/BC "),...this.encodePrimitiveArray(this.BC,F)),this.TR&&$.push(...F.encode("/TR "),...F.encode(" "+this.TR));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/S":const ne=await C.parseNameAtAsync(V,!0);if(ne&&Object.values(softMaskTypes).includes(ne.value))this.S=ne.value,V=ne.end+1;else throw new Error("Can't parse /S property value");break;case"/G":V=await this.parseRefPropAsync(te,C,V);break;case"/BC":V=await this.parseNumberArrayPropAsync(te,C,V);break;case"/TR":default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class GraphicsStateDict extends PdfDict{LW;LC;LJ;ML;D;RI;OP;op;OPM;Font;FL;SM;SA;BM;SMask;CA;ca;AIS;TK;constructor(){super(dictTypes.GRAPHICS_STATE)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new GraphicsStateDict;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.LW&&$.push(...F.encode("/LW "),...F.encode(" "+this.LW)),this.LC&&$.push(...F.encode("/LC "),...F.encode(" "+this.LC)),this.LJ&&$.push(...F.encode("/LJ "),...F.encode(" "+this.LJ)),this.ML&&$.push(...F.encode("/ML "),...F.encode(" "+this.ML)),this.D&&$.push(...F.encode("/D "),codes.L_BRACKET,codes.L_BRACKET,...F.encode(""+this.D[0][0]),...F.encode(" "+this.D[0][1]),codes.R_BRACKET,...F.encode(" "+this.D[1]),codes.R_BRACKET),this.RI&&$.push(...F.encode("/RI "),...F.encode(this.RI)),this.OP&&$.push(...F.encode("/OP "),...F.encode(" "+this.OP)),this.op&&$.push(...F.encode("/op "),...F.encode(" "+this.op)),this.OPM&&$.push(...F.encode("/OPM "),...F.encode(" "+this.OPM)),this.Font&&$.push(...F.encode("/Font "),codes.L_BRACKET,...this.Font[0].toArray(e),...F.encode(" "+this.Font[1]),codes.R_BRACKET),this.FL&&$.push(...F.encode("/FL "),...F.encode(" "+this.FL)),this.SM&&$.push(...F.encode("/SM "),...F.encode(" "+this.SM)),this.SA&&$.push(...F.encode("/SA "),...F.encode(" "+this.SA)),this.BM&&$.push(...F.encode("/BM "),...F.encode(this.BM)),this.SMask&&(this.SMask instanceof SoftMaskDict?$.push(...F.encode("/SMask "),...this.SMask.toArray(e)):$.push(...F.encode("/SMask "),...F.encode(this.SMask))),this.CA&&$.push(...F.encode("/CA "),...F.encode(" "+this.CA)),this.ca&&$.push(...F.encode("/ca "),...F.encode(" "+this.ca)),this.AIS&&$.push(...F.encode("/AIS "),...F.encode(" "+this.AIS)),this.TK&&$.push(...F.encode("/TK "),...F.encode(" "+this.TK));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toParams(){const e={};if(isNaN(this.LW)||(e.strokeWidth=this.LW),!isNaN(this.LC))switch(this.LC){case lineCapStyles.BUTT:e.strokeLineCap="butt";break;case lineCapStyles.ROUND:e.strokeLineCap="round";break;case lineCapStyles.SQUARE:e.strokeLineCap="square";break}if(!isNaN(this.LJ))switch(this.LJ){case lineJoinStyles.BEVEL:e.strokeLineJoin="bevel";break;case lineJoinStyles.ROUND:e.strokeLineJoin="round";break;case lineJoinStyles.MITER:e.strokeLineJoin="miter";break}if(this.ML&&(e.strokeMiterLimit=this.ML),this.D&&(e.strokeDashArray=`${this.D[0][0]} ${this.D[0][1]}`,e.strokeDashOffset=this.D[1]),this.Font,this.BM)switch(this.BM){case"/Normal":e.mixBlendMode="normal";break;case"/Multiply":e.mixBlendMode="multiply";break;case"/Screen":e.mixBlendMode="screen";break;case"/Overlay":e.mixBlendMode="overlay";break;case"/Darken":e.mixBlendMode="darken";break;case"/Lighten":e.mixBlendMode="lighten";break;case"/ColorDodge":e.mixBlendMode="color-dodge";break;case"/ColorBurn":e.mixBlendMode="color-burn";break;case"/HardLight":e.mixBlendMode="hard-light";break;case"/SoftLight":e.mixBlendMode="soft-light";break;case"/Difference":e.mixBlendMode="difference";break;case"/Exclusion":e.mixBlendMode="exclusion";break;default:throw new Error(`Unsupported blend mode: ${this.BM}`)}return this.SMask,this.CA&&(e.strokeAlpha=this.CA),this.ca&&(e.fillAlpha=this.ca),this.AIS,e}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/LC":const ne=await C.parseNumberAtAsync(V,!0);if(ne&&Object.values(lineCapStyles).includes(ne.value))this.LC=ne.value,V=ne.end+1;else throw new Error("Can't parse /LC property value");break;case"/OPM":const ee=await C.parseNumberAtAsync(V,!0);if(ee&&[0,1].includes(ee.value))this.OPM=ee.value,V=ee.end+1;else throw new Error("Can't parse /OPM property value");break;case"/LJ":const ie=await C.parseNumberAtAsync(V,!0);if(ie&&Object.values(lineJoinStyles).includes(ie.value))this.LJ=ie.value,V=ie.end+1;else throw new Error("Can't parse /LJ property value");break;case"/RI":const ae=await C.parseNameAtAsync(V,!0);if(ae&&Object.values(renderingIntents).includes(ae.value))this.RI=ae.value,V=ae.end+1;else throw new Error("Can't parse /RI property value");break;case"/BM":const re=await C.parseNameAtAsync(V,!0);if(re&&Object.values(blendModes).includes(re.value))this.BM=re.value,V=re.end+1;else throw new Error("Can't parse /BM property value");break;case"/SMask":const oe=await C.getValueTypeAtAsync(V);if(oe===valueTypes.NAME){const de=await C.parseNameAtAsync(V);if(de){this.SMask=de.value,V=de.end+1;break}throw new Error("Can't parse /SMask property name")}else if(oe===valueTypes.DICTIONARY){const de=await C.getDictBoundsAtAsync(V);if(de){const pe=await SoftMaskDict.parseAsync({parser:C,bounds:de});if(pe){this.SMask=pe.value,V=pe.end+1;break}}throw new Error("Can't parse /SMask value dictionary")}throw new Error(`Unsupported /SMask property value type: ${oe}`);case"/Font":const ce=await C.getValueTypeAtAsync(V);if(ce===valueTypes.ARRAY){const de=await C.getArrayBoundsAtAsync(V);if(de){const pe=await ObjectId.parseAsync(C,de.start+1);if(pe){const fe=await C.parseNumberAtAsync(pe.end+1);if(fe){this.Font=[pe.value,fe.value],V=de.end+1;break}}}}else throw new Error(`Unsupported /Font property value type: ${ce}`);throw new Error("Can't parse /Font property value");case"/D":const he=await C.getValueTypeAtAsync(V);if(he===valueTypes.ARRAY){const de=await C.getArrayBoundsAtAsync(V);if(de){const pe=await C.parseNumberArrayAtAsync(de.start+1);if(pe){const fe=await C.parseNumberAtAsync(pe.end+1);if(fe){this.D=[[pe.value[0],pe.value[1]],fe.value],V=de.end+1;break}}}}else throw new Error(`Unsupported /D property value type: ${he}`);throw new Error("Can't parse /D property value");case"/OP":case"/op":case"/SA":case"/AIS":case"/TK":V=await this.parseBoolPropAsync(te,C,V);break;case"/LW":case"/ML":case"/FL":case"/SM":case"/CA":case"/ca":V=await this.parseNumberPropAsync(te,C,V);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class ResourceDict extends PdfDict{ExtGState;ColorSpace;Pattern;Shading;XObject;Font;Properties;ProcSet;_streamParsers;_gsMap=new Map;_fontsMap=new Map;_xObjectsMap=new Map;constructor(e){super(null),this._streamParsers=e}static async parseAsync(e,C){if(!e)throw new Error("Parsing information not passed");try{const F=new ResourceDict(C);return await F.parsePropsAsync(e),{value:F.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(F){return console.log(F.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];if(this._gsMap.size){$.push(...F.encode("/ExtGState ")),$.push(...keywordCodes.DICT_START);for(const[V,te]of this._gsMap)$.push(...F.encode(V.slice(10)),codes.WHITESPACE),te.ref?$.push(...ObjectId.fromRef(te.ref).toArray(e)):$.push(...te.toArray(e));$.push(...keywordCodes.DICT_END)}if(this._fontsMap.size){$.push(...F.encode("/Font ")),$.push(...keywordCodes.DICT_START);for(const[V,te]of this._fontsMap)$.push(...F.encode(V.slice(5)),codes.WHITESPACE),te.ref?$.push(...ObjectId.fromRef(te.ref).toArray(e)):$.push(...te.toArray(e));$.push(...keywordCodes.DICT_END)}if(this._xObjectsMap.size){$.push(...F.encode("/XObject "),...keywordCodes.DICT_START);for(const[V,te]of this._xObjectsMap){const se=te.ref;if(!se)throw new Error("XObject has no reference");$.push(...F.encode(V.slice(8)),codes.WHITESPACE),$.push(...ObjectId.fromRef(se).toArray(e))}$.push(...keywordCodes.DICT_END)}this.ColorSpace&&$.push(...F.encode("/ColorSpace "),...this.ColorSpace.toArray(e)),this.Pattern&&$.push(...F.encode("/Pattern "),...this.Pattern.toArray(e)),this.Shading&&$.push(...F.encode("/Shading "),...this.Shading.toArray(e)),this.Properties&&$.push(...F.encode("/Properties "),...this.Properties.toArray(e)),this.ProcSet&&$.push(...F.encode("/ProcSet "),...this.encodePrimitiveArray(this.ProcSet,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}getGraphicsState(e){return this._gsMap.get(e)}*getGraphicsStates(){for(const e of this._gsMap)yield e}setGraphicsState(e,C){this._gsMap.set(`/ExtGState${e}`,C),this._edited=!0}getFont(e){return this._fontsMap.get("/Font"+e)}*getFonts(){for(const e of this._fontsMap)yield e}setFont(e,C){this._fontsMap.set(`/Font${e}`,C),this._edited=!0}getXObject(e){return this._xObjectsMap.get(e)}*getXObjects(){for(const e of this._xObjectsMap)yield e}setXObject(e,C){this._xObjectsMap.set(`/XObject${e}`,C),this._edited=!0}async fillMapsAsync(e,C){if(this._gsMap.clear(),this._fontsMap.clear(),this._xObjectsMap.clear(),this.ExtGState){for(const[F,$]of this.ExtGState.getObjectIds()){const Y=await e($.id);if(!Y)continue;const V=await GraphicsStateDict.parseAsync(Y);V&&this._gsMap.set(`/ExtGState${F}`,V.value)}for(const[F,$]of this.ExtGState.getDictParsers()){const Y=await GraphicsStateDict.parseAsync($);Y&&this._gsMap.set(`/ExtGState${F}`,Y.value)}}if(this.XObject&&this._streamParsers)for(const[F,$]of this.XObject.getObjectIds()){const Y=await e($.id);if(!Y)continue;const V=await Y.parser.findSubarrayIndexAsync(keywordCodes.FORM,{direction:!0,minIndex:Y.bounds.start,maxIndex:Y.bounds.end})?await this._streamParsers.xform(Y):await this._streamParsers.image(Y);V&&this._xObjectsMap.set(`/XObject${F}`,V.value)}if(this.Font)for(const[F,$]of this.Font.getObjectIds()){const Y=await e($.id);if(!Y)continue;const V=await FontDict.parseAsync(Y);V&&this._fontsMap.set(`/Font${F}`,V.value)}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/ExtGState":case"/ColorSpace":case"/Pattern":case"/Shading":case"/XObject":case"/Font":case"/Properties":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ee=await ObjectId.parseRefAsync(C,V);if(ee&&e.parseInfoGetterAsync){const ie=await e.parseInfoGetterAsync(ee.value.id);if(ie){const ae=await ObjectMapDict.parseAsync(ie);if(ae){this[te.slice(1)]=ae.value,V=ae.end+1;break}}}throw new Error(`Can't parse ${te} value reference`)}else if(ne===valueTypes.DICTIONARY){const ee=await C.getDictBoundsAtAsync(V);if(ee){const ie=await ObjectMapDict.parseAsync({parser:C,bounds:ee});if(ie){this[te.slice(1)]=ie.value,V=ee.end+1;break}else throw new Error(`Can't parse ${te} value dictionary`)}throw new Error(`Can't parse ${te} dictionary bounds`)}throw new Error(`Unsupported /Resources property value type: ${ne}`);case"/ProcSet":V=await this.parseNameArrayPropAsync(te,C,V);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}e.parseInfoGetterAsync&&await this.fillMapsAsync(e.parseInfoGetterAsync,e.cryptInfo)}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class MeasureDict extends PdfDict{Subtype="/RL";constructor(){super(dictTypes.MEASURE)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new MeasureDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Subtype&&$.push(...F.encode("/Subtype "),...F.encode(this.Subtype));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Subtype":const ne=await C.parseNameAtAsync(V);if(ne){if(this.Subtype&&this.Subtype!==ne.value)throw new Error(`Invalid dict subtype: '${ne.value}' instead of '${this.Subtype}'`);V=ne.end+1}else throw new Error("Can't parse /Subtype property value");break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class GroupDict extends PdfDict{S="/Transparency";constructor(){super(dictTypes.GROUP)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.S&&$.push(...F.encode("/S "),...F.encode(this.S));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/S":const ne=await C.parseNameAtAsync(V,!0);if(ne)if(Object.values(groupDictTypes).includes(ne.value))this.S=ne.value,V=ne.end+1;else throw new Error(`Invalid dict subtype: '${ne.value}'`);else throw new Error("Can't parse /S property value");break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class TransparencyGroupDict extends GroupDict{CS;I=!1;K=!1;constructor(){super()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new TransparencyGroupDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.CS&&$.push(...F.encode("/CS "),...F.encode(this.CS)),this.I&&$.push(...F.encode("/I "),...F.encode(" "+this.I)),this.K&&$.push(...F.encode("/K "),...F.encode(" "+this.K));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){if(await super.parsePropsAsync(e),this.S!=="/Transparency")throw new Error("Not a transparency dict");const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/CS":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.NAME){const ee=await C.parseNameAtAsync(V);if(ee){this.CS=ee.value,V=ee.end+1;break}throw new Error("Can't parse /CS property name")}else if(ne===valueTypes.ARRAY){const ee=await C.getArrayBoundsAtAsync(V);if(ee){V=ee.end+1;break}throw new Error("Can't parse /CS value dictionary")}throw new Error(`Unsupported /CS property value type: ${ne}`);case"/I":case"/K":V=await this.parseBoolPropAsync(te,C,V);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class XFormStream extends PdfStream{Subtype="/Form";FormType=1;BBox;Matrix=[1,0,0,1,0,0];Resources;Metadata;LastModified;StructParent;StructParents;Measure;Group;get matrix(){const e=new l;if(this.Matrix){const[C,F,$,Y,V,te]=this.Matrix;e.set(C,F,0,$,Y,0,V,te,1)}return e}set matrix(e){e&&(this.Matrix=[...e.toFloatShortArray()])}get bBox(){return{ll:new u(this.BBox[0],this.BBox[1]),lr:new u(this.BBox[2],this.BBox[1]),ur:new u(this.BBox[2],this.BBox[3]),ul:new u(this.BBox[0],this.BBox[3])}}get transformedBBox(){const e=new l;if(this.Matrix){const[V,te,se,ne,ee,ie]=this.Matrix;e.set(V,te,0,se,ne,0,ee,ie,1)}const C=new u(this.BBox[0],this.BBox[1]),F=new u(this.BBox[2],this.BBox[1]),$=new u(this.BBox[2],this.BBox[3]),Y=new u(this.BBox[0],this.BBox[3]);return{ll:u.applyMat3(C,e),lr:u.applyMat3(F,e),ur:u.applyMat3($,e),ul:u.applyMat3(Y,e)}}get edited(){return this._edited||this.Resources.edited}constructor(){super(streamTypes.FORM_XOBJECT)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new XFormStream;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Subtype&&$.push(...F.encode("/Subtype "),...F.encode(this.Subtype)),this.FormType&&$.push(...F.encode("/FormType "),...F.encode(" "+this.FormType)),this.BBox&&$.push(...F.encode("/BBox "),...this.encodePrimitiveArray(this.BBox,F)),this.Matrix&&$.push(...F.encode("/Matrix "),...this.encodePrimitiveArray(this.Matrix,F)),this.Resources&&$.push(...F.encode("/Resources "),...this.Resources.toArray(e)),this.Metadata&&$.push(...F.encode("/Metadata "),...this.Metadata.toArray(e)),this.LastModified&&$.push(...F.encode("/LastModified "),...this.LastModified.toArray(e)),this.StructParent&&$.push(...F.encode("/StructParent "),...F.encode(" "+this.StructParent)),this.StructParents&&$.push(...F.encode("/StructParents "),...F.encode(" "+this.StructParents)),this.Measure&&$.push(...F.encode("/Measure "),...this.Measure.toArray(e)),this.Group&&$.push(...F.encode("/Group "),...this.Group.toArray(e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=await C.getDictBoundsAtAsync($);let V=await C.skipToNextNameAsync(Y.contentStart,Y.contentEnd),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Subtype":const ne=await C.parseNameAtAsync(V);if(ne){if(this.Subtype&&this.Subtype!==ne.value)throw new Error(`Invalid dict subtype: '${ne.value}' instead of '${this.Subtype}'`);V=ne.end+1}else throw new Error("Can't parse /Subtype property value");break;case"/FormType":const ee=await C.parseNumberAtAsync(V,!1);if(ee){if(ee.value!==1)throw new Error(`Ivalid form type: '${ee.value}' instead of '1'`);V=ee.end+1}else throw new Error("Can't parse /FormType property value");break;case"/BBox":case"/Matrix":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/LastModified":V=await this.parseDatePropAsync(te,C,V,e.cryptInfo);break;case"/Metadata":V=await this.parseRefPropAsync(te,C,V);break;case"/StructParent":case"/StructParents":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Resources":const ie=await C.getValueTypeAtAsync(V);if(ie===valueTypes.REF){const oe=await ObjectId.parseRefAsync(C,V);if(oe&&e.parseInfoGetterAsync){const ce=await e.parseInfoGetterAsync(oe.value.id);if(ce){const he=await ResourceDict.parseAsync(ce,{xform:XFormStream.parseAsync,image:ImageStream.parseAsync});if(he){this.Resources=he.value,V=he.end+1;break}}}throw new Error("Can't parse /Resources value reference")}else if(ie===valueTypes.DICTIONARY){const oe=await C.getDictBoundsAtAsync(V);if(oe){if(oe.contentStart){const ce=await ResourceDict.parseAsync({parser:C,bounds:oe,parseInfoGetterAsync:e.parseInfoGetterAsync},{xform:XFormStream.parseAsync,image:ImageStream.parseAsync});if(ce)this.Resources=ce.value;else throw new Error("Can't parse /Resources value dictionary")}V=oe.end+1;break}throw new Error("Can't parse /Resources dictionary bounds")}throw new Error(`Unsupported /Resources property value type: ${ie}`);case"/Measure":const ae=await C.getValueTypeAtAsync(V);if(ae===valueTypes.REF){const oe=await ObjectId.parseRefAsync(C,V);if(oe&&e.parseInfoGetterAsync){const ce=await e.parseInfoGetterAsync(oe.value.id);if(ce){const he=await MeasureDict.parseAsync(ce);if(he){this.Measure=he.value,V=he.end+1;break}}}throw new Error("Can't parse /Measure value reference")}else if(ae===valueTypes.DICTIONARY){const oe=await C.getDictBoundsAtAsync(V);if(oe){const ce=await MeasureDict.parseAsync({parser:C,bounds:oe,cryptInfo:e.cryptInfo});if(ce){this.Measure=ce.value,V=ce.end+1;break}}throw new Error("Can't parse /Measure value dictionary")}throw new Error(`Unsupported /Measure property value type: ${ae}`);case"/Group":const re=await C.getValueTypeAtAsync(V);if(re===valueTypes.REF){const oe=await ObjectId.parseRefAsync(C,V);if(oe&&e.parseInfoGetterAsync){const ce=await e.parseInfoGetterAsync(oe.value.id);if(ce){const he=await TransparencyGroupDict.parseAsync(ce);if(he){this.Group=he.value,V=he.end+1;break}}}throw new Error("Can't parse /Group value reference")}else if(re===valueTypes.DICTIONARY){const oe=await C.getDictBoundsAtAsync(V);if(oe){const ce=await TransparencyGroupDict.parseAsync({parser:C,bounds:oe,cryptInfo:e.cryptInfo});if(ce){this.Group=ce.value,V=ce.end+1;break}}throw new Error("Can't parse /Group value dictionary")}throw new Error(`Unsupported /Group property value type: ${re}`);case"/OC":case"/OPI":default:V=await C.skipToNextNameAsync(V,Y.contentEnd);break}if(!this.BBox)throw new Error("Not all required properties parsed")}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class TextData{width;height;rect;relativeRect;lines;static async buildAsync(e,C){let F;if(e){const $=document.createElement("p");$.style.color="black",$.style.fontSize=C.fontSize+"px",$.style.fontFamily="arial",$.style.fontWeight="normal",$.style.fontStyle="normal",$.style.lineHeight="normal",$.style.overflowWrap="normal",$.style.textAlign=C.textAlign,$.style.textDecoration="none",$.style.verticalAlign="top",$.style.whiteSpace="pre-wrap",$.style.wordBreak="normal",$.style.position="fixed",$.style.left="0",$.style.top="0",$.style.margin="0",$.style.padding="0",$.style.maxWidth=C.maxWidth.toFixed()+"px",$.style.visibility="hidden",$.style.transform="scale(0.1)",$.style.transformOrigin="top left",document.body.append($);const Y=e.split(/([- \n\r])/u),V=[];let te="",se=0;for(let de=0;de<Y.length;de++){const pe=Y[de];$.textContent+=pe,await DomUtils.runEmptyTimeout();const fe=$.offsetHeight;se||=fe,fe>se?(V.push(te),te=pe,se=fe):te+=pe}V.push(te),$.innerHTML="";const ne=[];for(const de of V){const pe=document.createElement("span");pe.style.position="relative",pe.textContent=de,ne.push(pe),$.append(pe)}await DomUtils.runEmptyTimeout();const ee=$.offsetWidth,ie=$.offsetHeight;let ae;switch(C.pivotPoint){case"top-left":ae=new u(0,ie);break;case"bottom-margin":ae=new u(ee/2,C.strokeWidth);break;case"center":default:ae=new u(ee/2,ie/2);break}const re=[];for(let de=0;de<V.length;de++){const pe=ne[de],fe=pe.offsetLeft,ye=pe.offsetTop,_e=pe.offsetWidth,Ee=pe.offsetHeight,be=new u(fe,ie-(ye+Ee)),Ae=new u(fe+_e,ie-ye),we=[be.x,be.y,Ae.x,Ae.y],Te=u.subtract(be,ae),Me=u.subtract(Ae,ae),Be=[Te.x,Te.y,Me.x,Me.y];re.push({text:V[de],rect:we,relativeRect:Be})}const oe=[0,0,ee,ie],ce=[0-ae.x,0-ae.y,ee-ae.x,ie-ae.y],he={width:ee,height:ie,rect:oe,relativeRect:ce,lines:re};$.remove(),F=he}else F=null;return F}}const SELECTION_STROKE_WIDTH=20,BEZIER_CONSTANT=.551915,LINE_END_MULTIPLIER=3,LINE_END_MIN_SIZE=10;function buildSquigglyLine(J,e,C){if(!J||!e)return null;if(isNaN(C)||C<=0)throw new Error(`Invalid maximal squiggle size ${C}`);const F=u.subtract(J,e).getMagnitude();if(!F)return null;const $=[J.clone()],Y=new u,V=new u(F,0),te=l.from4Vec2(Y,V,J,e),se=Math.ceil(F/C),ne=F/se,ee=ne/2;for(let ie=0;ie<se;ie++)$.push(new u(ie*ne+ee,-ee).applyMat3(te).truncate(2),new u((ie+1)*ne,0).applyMat3(te).truncate(2));return $}function calcPdfBBoxToRectMatrices(J,e,C){const F=new l;if(C){const[oe,ce,he,de,pe,fe]=C;F.set(oe,ce,0,he,de,0,pe,fe,1)}const $=new u(J[0],J[1]),Y=new u(J[2],J[1]),V=new u(J[2],J[3]),te=new u(J[0],J[3]),{min:se,max:ne}=u.minMax(u.applyMat3($,F),u.applyMat3(Y,F),u.applyMat3(V,F),u.applyMat3(te,F)),ee=new u(e[0],e[1]),ie=new u(e[2],e[3]),ae=l.from4Vec2(se,ne,ee,ie),re=l.fromMat3(F).multiply(ae);return{matAP:F,matA:ae,matAA:re}}class TextState{static defaultParams={matrix:new l,lineMatrix:new l,leading:12*-1.2,renderMode:textRenderModes.FILL,fontFamily:"helvetica, arial, sans-serif",fontSize:"10px",lineHeight:"1",letterSpacing:"normal",wordSpacing:"normal",horizontalScale:1,verticalAlign:"0",knockOut:!0};matrix;lineMatrix;customFontName;leading;renderMode;fontFamily;fontSize;lineHeight;letterSpacing;wordSpacing;horizontalScale;verticalAlign;knockOut;constructor(e){Object.assign(this,TextState.defaultParams,e)}clone(e){const C=new TextState(this);return e?Object.assign(C,e):C}setWordSpacing(e){this.wordSpacing=e?e+"px":"normal"}setLetterSpacing(e){this.letterSpacing=e?e+"px":"normal"}setScale(e){this.horizontalScale=e?e/100:1}setLeading(e){e?(this.leading=e,this.lineHeight=Math.abs(this.leading)+"px"):(this.leading=parseInt(this.fontSize,10)*-1.2,this.lineHeight="1")}setFontSize(e){this.fontSize=(e||12)+"px"}setVerticalAlign(e){this.verticalAlign=e?e/10+"em":"0"}moveAlongPx(e){const C=e,F=new l().set(1,0,0,0,1,0,C,0,1);this.matrix=F.multiply(this.matrix)}moveAlongPdfUnits(e){const C=-e/1e3*parseInt(this.fontSize,10),F=new l().set(1,0,0,0,1,0,C,0,1);this.matrix=F.multiply(this.matrix)}nextLine(e,C){e??=0,C??=this.leading||parseInt(this.fontSize,10)*-1.2;const F=new l().set(1,0,0,0,1,0,e,C,1);this.lineMatrix=F.multiply(this.lineMatrix),this.matrix=this.lineMatrix.clone()}}class GraphicsState{static defaultParams={matrix:new l,textState:new TextState,strokeColorSpace:"rgb",strokeAlpha:1,strokeColor:new z,fillColorSpace:"rgb",fillAlpha:1,fillColor:new z,strokeWidth:1,strokeMiterLimit:10,strokeLineCap:"square",strokeLineJoin:"miter"};matrix;textState;clipPath;strokeColorSpace;strokeAlpha;strokeColor;get stroke(){const{x:e,y:C,z:F}=this.strokeColor,$=this.strokeAlpha;return`rgba(${e},${C},${F},${$})`}fillColorSpace;fillAlpha;fillColor;get fill(){const{x:e,y:C,z:F}=this.fillColor,$=this.fillAlpha;return`rgba(${e},${C},${F},${$})`}strokeWidth;strokeMiterLimit;strokeLineCap;strokeLineJoin;strokeDashArray;strokeDashOffset;mixBlendMode;constructor(e){Object.assign(this,GraphicsState.defaultParams,e),this.matrix=this.matrix?.clone(),this.textState=this.textState?.clone(),this.strokeColor=this.strokeColor?.clone(),this.fillColor=this.fillColor?.clone()}clone(e){const C=new GraphicsState(this);return e?Object.assign(C,e):C}setColor(e,...C){let F,$,Y;switch(C.length){case 1:F=$=Y=C[0]*255;break;case 3:F=C[0]*255,$=C[1]*255,Y=C[2]*255;break;case 4:const[V,te,se,ne]=C;F=255*(1-V)*(1-ne),$=255*(1-te)*(1-ne),Y=255*(1-se)*(1-ne);break}e==="stroke"?this.strokeColor.set(F,$,Y):this.fillColor.set(F,$,Y)}}class AppearanceStreamRenderer{_stream;_objectName;_clipPaths=[];_selectionCopies=[];_graphicsStates=[];get state(){return this._graphicsStates[this._graphicsStates.length-1]}constructor(e,C,F){if(!e)throw new Error("Stream is not defined");this._stream=e,this._objectName=F;const{matAA:$}=calcPdfBBoxToRectMatrices(e.BBox,C,e.Matrix),[Y,V,te,se]=e.BBox,ne=new u(Y,V).applyMat3($),ee=new u(te,V).applyMat3($),ie=new u(te,se).applyMat3($),ae=new u(Y,se).applyMat3($),re=document.createElementNS("http://www.w3.org/2000/svg","clipPath");re.id=`clip0_${F}`,re.innerHTML=`<path d="M${ne.x},${ne.y} L${ee.x},${ee.y} L${ie.x},${ie.y} L${ae.x},${ae.y} z"/>`,this._clipPaths.push(re),this._graphicsStates.push(new GraphicsState({matrix:$,clipPath:re}))}static async parseNextCommandAsync(e,C){const F=[];let $;e:for(;!$;){const Y=await e.getValueTypeAtAsync(C,!0);switch(Y){case valueTypes.NUMBER:const V=await e.parseNumberAtAsync(C,!0);F.push(V.value),C=V.end+1;break;case valueTypes.NAME:const te=await e.parseNameAtAsync(C,!0);F.push(te.value),C=te.end+1;break;case valueTypes.ARRAY:const se=await e.getArrayBoundsAtAsync(C);let ne=se.start+1;for(;ne<se.end-1&&ne!==-1;){const re=await e.getValueTypeAtAsync(ne,!0);switch(re){case valueTypes.STRING_LITERAL:const oe=await LiteralString.parseAsync(e,ne);F.push(oe.value.bytes),ne=oe.end+1;break;case valueTypes.NUMBER:const ce=await e.parseNumberAtAsync(ne,!0);F.push(ce.value),ne=ce.end+1;break;default:console.log(`Unsupported value type in AP stream parameter array: ${re}`),ne=await e.findDelimiterIndexAsync(!0,ne+1);break}}C=se.end+1;break;case valueTypes.STRING_LITERAL:const ee=await LiteralString.parseAsync(e,C);F.push(ee.value.literal),C=ee.end+1;break;case valueTypes.STRING_HEX:const ie=await HexString.parseAsync(e,C);F.push(ie.value.hex),C=ie.end+1;break;case valueTypes.UNKNOWN:const ae=await e.parseStringAtAsync(C);$=ae.value,C=ae.end+1;break e;default:throw new Error(`Invalid appearance stream value type: ${Y}`)}}return{nextIndex:C,parameters:F,operator:$}}async renderAsync(){return this.reset(),{elements:await this.drawStreamAsync(this._stream),clipPaths:this._clipPaths.slice(),pickHelpers:this._selectionCopies.slice()}}reset(){this._graphicsStates.length=1,this._clipPaths.length=1,this._selectionCopies.length=0}pushState(e){const F=this._graphicsStates[this._graphicsStates.length-1].clone(e);this._graphicsStates.push(F)}popState(){return this._graphicsStates.length===1?null:this._graphicsStates.pop()}pushClipPath(e,C){const F=this._clipPaths.length-1,$=document.createElementNS("http://www.w3.org/2000/svg","clipPath");$.setAttribute("clip-rule",C?"nonzero":"evenodd"),$.setAttribute("clip-path",`url(#${this._clipPaths[F]})`),$.id=`clip${F+1}_${this._objectName}`,$.append(e),this._clipPaths.push($),this.state.clipPath=$}tryApplyingStateOperator(e,C){switch(e){case"q":this.pushState();break;case"Q":this.popState();break;case"gs":const F=this._stream.Resources.getGraphicsState(`/ExtGState${C[0]}`);if(!F)throw new Error("External state specified in appearance stream not found");const $=F.toParams();Object.assign(this.state,$);break;case"cm":const[Y,V,te,se,ne,ee]=C,ie=new l().set(Y,V,0,te,se,0,ne,ee,1);this.state.matrix=ie.multiply(this.state.matrix);break;case"w":this.state.strokeWidth=+C[0]||1;break;case"J":switch(C[0]){case lineCapStyles.ROUND:this.state.strokeLineCap="round";break;case lineCapStyles.SQUARE:this.state.strokeLineCap="square";break;case lineCapStyles.BUTT:default:this.state.strokeLineCap="butt";break}break;case"j":switch(C[0]){case lineJoinStyles.BEVEL:this.state.strokeLineJoin="bevel";break;case lineJoinStyles.ROUND:this.state.strokeLineJoin="round";break;case lineJoinStyles.MITER:default:this.state.strokeLineJoin="miter";break}break;case"M":this.state.strokeMiterLimit=+C[0]||10;break;case"d":let ae=3,re=0,oe=0;C.length===3?(ae=+C[0],re=+C[1],oe=+C[2]):C.length===2?(ae=+C[0],oe=+C[1]):C.length===1&&(oe=+C[0]),this.state.strokeDashArray=`${ae} ${re}`,this.state.strokeDashOffset=oe;break;case"CS":switch(C[0]){case colorSpaces.GRAYSCALE:this.state.strokeColorSpace="grayscale";break;case colorSpaces.RGB:this.state.strokeColorSpace="rgb";break;case colorSpaces.CMYK:this.state.strokeColorSpace="cmyk";break;default:throw new Error("Unsupported color space in appearance stream")}break;case"cs":switch(C[0]){case colorSpaces.GRAYSCALE:this.state.fillColorSpace="grayscale";break;case colorSpaces.RGB:this.state.fillColorSpace="rgb";break;case colorSpaces.CMYK:this.state.fillColorSpace="cmyk";break;default:throw new Error("Unsupported color space in appearance stream")}break;case"G":this.state.strokeColorSpace="grayscale",this.state.setColor("stroke",...C);break;case"g":this.state.fillColorSpace="grayscale",this.state.setColor("fill",...C);break;case"RG":this.state.strokeColorSpace="rgb",this.state.setColor("stroke",...C);break;case"rg":this.state.fillColorSpace="rgb",this.state.setColor("fill",...C);break;case"K":this.state.strokeColorSpace="cmyk",this.state.setColor("stroke",...C);break;case"k":this.state.fillColorSpace="cmyk",this.state.setColor("fill",...C);break;case"SC":this.state.setColor("stroke",...C);break;case"ri":case"i":break;case"Tc":this.state.textState.setLetterSpacing(+C[0]);break;case"Tw":this.state.textState.setWordSpacing(+C[0]);break;case"Tz":this.state.textState.setScale(+C[0]);break;case"TL":this.state.textState.setLeading(+C[0]);break;case"Tf":this.state.textState.customFontName=C[0]||"",this.state.textState.setFontSize(+C[1]);break;case"Tr":switch(C[0]){case 0:default:this.state.textState.renderMode=textRenderModes.FILL;break;case 1:this.state.textState.renderMode=textRenderModes.STROKE;break;case 2:this.state.textState.renderMode=textRenderModes.FILL_STROKE;break;case 3:this.state.textState.renderMode=textRenderModes.INVISIBLE;break;case 4:this.state.textState.renderMode=textRenderModes.FILL_USE_AS_CLIP;break;case 5:this.state.textState.renderMode=textRenderModes.STROKE_USE_AS_CLIP;break;case 6:this.state.textState.renderMode=textRenderModes.FILL_STROKE_USE_AS_CLIP;break;case 7:this.state.textState.renderMode=textRenderModes.USE_AS_CLIP;break}break;case"Ts":this.state.textState.setVerticalAlign(+C[0]);break;case"Td":if(C.length>1){const[ce,he]=C;this.state.textState.nextLine(ce,he)}break;case"TD":if(C.length>1){const[ce,he]=C;this.state.textState.setLeading(-he),this.state.textState.nextLine(ce,he)}break;case"Tm":if(C.length>5){const[ce,he,de,pe,fe,ye]=C,_e=new l().set(ce,he,0,de,pe,0,fe,ye,1);this.state.textState.matrix=_e,this.state.textState.lineMatrix=_e.clone()}break;case"T*":this.state.textState.nextLine();break;default:return!1}return!0}setTextStateFont(e){const C=this.state.textState;if(!e){C.fontFamily="arial, sans-serif";return}let F;e.isMonospace?F="courier, monospace":e.isScript?F="cursive":e.isSerif?F="times new roman, serif":F="arial, sans-serif";const $=e.BaseFont?.substring(1).toLowerCase();if(!$){C.fontFamily=F;return}$.includes("times")?C.fontFamily="times new roman, serif":$.includes("arial")?C.fontFamily="arial, sans-serif":$.includes("courier")?C.fontFamily="courier new, monospace":C.fontFamily=`${$}, ${F}`}decodeTextParam(e,C){return e instanceof Uint8Array?C.decodeText(e):e+""}createSvgElement(){return document.createElementNS("http://www.w3.org/2000/svg","g")}drawPath(e,C,F,$=!1,Y=!1){$&&e[e.length-1]!=="Z"&&(e+=" Z");const V=document.createElementNS("http://www.w3.org/2000/svg","path");V.setAttribute("transform",`matrix(${this.state.matrix.toFloatShortArray().join(" ")})`),V.setAttribute("d",e),F?(V.setAttribute("fill",this.state.fill),V.setAttribute("fill-rule",Y?"evenodd":"nonzero")):V.setAttribute("fill","none"),C?(V.setAttribute("stroke",this.state.stroke),V.setAttribute("stroke-width",this.state.strokeWidth+""),V.setAttribute("stroke-miterlimit",this.state.strokeMiterLimit+""),V.setAttribute("stroke-linecap",this.state.strokeLineCap),V.setAttribute("stroke-linejoin",this.state.strokeLineJoin),this.state.strokeDashArray&&V.setAttribute("stroke-dasharray",this.state.strokeDashArray),this.state.strokeDashOffset&&V.setAttribute("stroke-dashoffset",this.state.strokeDashOffset+"")):V.setAttribute("stroke","none");const te=this.createSvgElement();te.setAttribute("clip-path",`url(#${this._clipPaths[this._clipPaths.length-1].id})`),te.append(V);const se=this.createSvgElement();se.classList.add("annotation-pick-helper");const ne=V.cloneNode(!0),ee=!C||this.state.strokeWidth<SELECTION_STROKE_WIDTH?SELECTION_STROKE_WIDTH:this.state.strokeWidth;return ne.setAttribute("stroke-width",ee+""),ne.setAttribute("stroke","transparent"),ne.setAttribute("fill",F?"transparent":"none"),se.append(ne),this._selectionCopies.push(ne),{element:te,blendMode:this.state.mixBlendMode||"normal"}}async drawImageAsync(e){const C=await e.getImageUrlAsync();if(!C)throw new Error("Can't get image url from external image stream");const F=document.createElementNS("http://www.w3.org/2000/svg","image");F.onerror=ne=>{console.log(`Loading external image stream failed: ${ne}`)},F.setAttribute("href",C),F.setAttribute("width",e.Width+""),F.setAttribute("height",e.Height+"");const Y=new l().applyTranslation(-e.Width/2,-e.Height/2).applyScaling(1,-1).applyTranslation(e.Width/2,e.Height/2).applyScaling(1/e.Width,1/e.Height).multiply(this.state.matrix).toFloatShortArray().join(" ");F.setAttribute("transform",`matrix(${Y})`);const V=this.createSvgElement();V.setAttribute("clip-path",`url(#${this._clipPaths[this._clipPaths.length-1].id})`),V.append(F);const te=this.createSvgElement();te.classList.add("annotation-pick-helper");const se=document.createElementNS("http://www.w3.org/2000/svg","rect");return se.setAttribute("width",e.Width+""),se.setAttribute("height",e.Height+""),se.setAttribute("fill","transparent"),se.setAttribute("transform",`matrix(${Y})`),te.append(se),this._selectionCopies.push(se),V}async drawTextAsync(e,C){const F=this.state.textState,$=C.getFont(F.customFontName),Y=this.decodeTextParam(e,$);if(this.setTextStateFont($),!Y)return console.log(`Can't decode the stream text parameter: '${e}'`),null;const V=document.createElementNS("http://www.w3.org/2000/svg","text");V.setAttribute("transform",`matrix(${new l().applyScaling(1,-1).applyScaling(F.horizontalScale,1).multiply(l.multiply(F.matrix,this.state.matrix)).toFloatShortArray().join(" ")})`),V.setAttribute("x","0"),V.setAttribute("y","0"),V.textContent=Y,V.style.fontFamily=F.fontFamily,V.style.fontSize=F.fontSize,V.style.lineHeight=F.lineHeight,V.style.letterSpacing=F.letterSpacing,V.style.wordSpacing=F.wordSpacing,V.style.verticalAlign=F.verticalAlign,V.style.whiteSpace="pre",V.style.userSelect="none";let te,se,ne;switch(F.renderMode){case textRenderModes.FILL:default:te=this.state.fill;break;case textRenderModes.STROKE:se=!0;break;case textRenderModes.FILL_STROKE:te=this.state.fill,se=!0;break;case textRenderModes.INVISIBLE:break;case textRenderModes.FILL_USE_AS_CLIP:te=this.state.fill,ne=!0;break;case textRenderModes.STROKE_USE_AS_CLIP:se=!0,ne=!0;break;case textRenderModes.FILL_STROKE_USE_AS_CLIP:te=this.state.fill,se=!0,ne=!0;break;case textRenderModes.USE_AS_CLIP:te="transparent",ne=!0;break}V.style.fill=te||"none",se?(V.style.stroke=this.state.stroke,V.style.strokeWidth=this.state.strokeWidth+"",V.style.strokeMiterlimit=this.state.strokeMiterLimit+"",V.style.strokeLinecap=this.state.strokeLineCap,V.style.strokeLinejoin=this.state.strokeLineJoin,this.state.strokeDashArray&&(V.style.strokeDasharray=this.state.strokeDashArray),this.state.strokeDashOffset&&(V.style.strokeDashoffset=this.state.strokeDashOffset+"")):V.style.stroke="none",ne&&this.pushClipPath(V.cloneNode(),!0),await new Promise((re,oe)=>{const ce=document.createElementNS("http://www.w3.org/2000/svg","svg");ce.classList.add("annotation-content-element"),ce.setAttribute("viewBox","0 0 100 100"),ce.style.width="100px",ce.style.height="100px",ce.style.zIndex="-99",ce.style.position="fixed",ce.style.left="0",ce.style.top="0",ce.append(V),document.body.append(ce),setTimeout(()=>{const he=V.getBBox().width;this.state.textState.moveAlongPx(he),V.remove(),ce.remove(),re(!0)},0)});const ee=this.createSvgElement();ee.classList.add("annotation-pick-helper");const ie=V.cloneNode(!0),ae=!se||this.state.strokeWidth<SELECTION_STROKE_WIDTH?SELECTION_STROKE_WIDTH:this.state.strokeWidth;return ie.style.strokeWidth=ae+"",ie.style.stroke="transparent",ie.style.fill=te?"transparent":"none",ee.append(ie),this._selectionCopies.push(ie),{element:V,blendMode:this.state.mixBlendMode||"normal"}}async drawTextGroupAsync(e,C){const F=[],$=this.state.textState;let Y=0;for(;Y!==-1;){const{nextIndex:V,parameters:te,operator:se}=await AppearanceStreamRenderer.parseNextCommandAsync(e,Y);switch(Y=await e.skipEmptyAsync(V),se){case"Tj":F.push(await this.drawTextAsync(te[0],C));break;case"'":$.nextLine(),F.push(await this.drawTextAsync(te[0],C));break;case'"':const[ne,ee,ie]=te;$.setWordSpacing(+ne),$.setLetterSpacing(+ee),$.nextLine(),F.push(await this.drawTextAsync(ie,C));break;case"TJ":for(const re of te)re instanceof Uint8Array?F.push(await this.drawTextAsync(re,C)):typeof re=="number"&&+re.toFixed(0)&&$.moveAlongPdfUnits(re);break;default:if(!this.tryApplyingStateOperator(se,te))throw new Error(`Unsupported appearance stream operator: ${se}`)}}return F.filter(V=>V)}async drawStreamAsync(e){const C=await e.getStreamDataParserAsync(),F=[],$=new u;let Y,V="",te=0;for(;te!==-1;){const{nextIndex:se,parameters:ne,operator:ee}=await AppearanceStreamRenderer.parseNextCommandAsync(C,te);switch(te=await C.skipEmptyAsync(se+1),ee){case"m":const ie=new u(+ne[0],+ne[1]);V+=` M ${ie.x} ${ie.y}`,$.setFromVec2(ie);break;case"l":const ae=new u(+ne[0],+ne[1]);V+=` L ${ae.x} ${ae.y}`,$.setFromVec2(ae);break;case"re":const re=new u(+ne[0],+ne[1]),oe=new u(+ne[2],+ne[3]).add(re);V+=` M ${re.x} ${re.y} L ${oe.x} ${re.y} L ${oe.x} ${oe.y} L ${re.x} ${oe.y} L ${re.x} ${re.y}`,$.setFromVec2(re);break;case"c":const ce=new u(+ne[0],+ne[1]),he=new u(+ne[2],+ne[3]),de=new u(+ne[4],+ne[5]);V+=` C ${ce.x} ${ce.y}, ${he.x} ${he.y}, ${de.x} ${de.y}`,$.setFromVec2(de);break;case"v":const pe=new u(+ne[0],+ne[1]),fe=new u(+ne[2],+ne[3]);V+=` C ${$.x} ${$.y}, ${pe.x} ${pe.y}, ${fe.x} ${fe.y}`,$.setFromVec2(fe);break;case"y":const ye=new u(+ne[0],+ne[1]),_e=new u(+ne[2],+ne[3]);V+=` C ${ye.x} ${ye.y}, ${_e.x} ${_e.y}, ${_e.x} ${_e.y}`,$.setFromVec2(_e);break;case"h":V+=" Z";break;case"S":F.push(this.drawPath(V,!0,!1)),V="";break;case"s":F.push(this.drawPath(V,!0,!1,!0)),V="";break;case"F":case"f":F.push(this.drawPath(V,!1,!0,!0)),V="";break;case"F*":case"f*":F.push(this.drawPath(V,!1,!0,!0,!0)),V="";break;case"B":F.push(this.drawPath(V,!0,!0,!1,!1)),V="";break;case"B*":F.push(this.drawPath(V,!0,!0,!1,!0)),V="";break;case"b":F.push(this.drawPath(V,!0,!0,!0,!1)),V="";break;case"b*":F.push(this.drawPath(V,!0,!0,!0,!0)),V="";break;case"n":if(Y==="W"||Y==="W*"){V[V.length-1]!=="Z"&&(V+=" Z");const we=document.createElementNS("http://www.w3.org/2000/svg","path");we.setAttribute("d",V),this.pushClipPath(we,Y==="W")}V="";break;case"W":break;case"W*":break;case"BT":const Ee=await C.findSubarrayIndexAsync(keywordCodes.AP_STREAM_TEXT_END,{closedOnly:!0,minIndex:te});if(Ee){const we=await C.getSubParserAsync(te,Ee.start-1),Te=await this.drawTextGroupAsync(we,e.Resources);F.push(...Te),te=await C.skipEmptyAsync(Ee.end+1);break}throw new Error("Can't find the appearance stream text object end");case"Do":const be=e.Resources.getXObject(`/XObject${ne[0]}`);if(!be)throw new Error(`External object not found in the appearance stream resources: ${ne[0]}`);if(be instanceof XFormStream){const[we,Te,Me,Be,$e,Fe]=be.Matrix,Xe=new l().set(we,Te,0,Me,Be,0,$e,Fe,1);this.pushState(),this.state.matrix=Xe.multiply(this.state.matrix);const We=await this.drawStreamAsync(be);F.push(...We),this.popState()}else if(be instanceof ImageStream){const we=await this.drawImageAsync(be);F.push({element:we,blendMode:this.state.mixBlendMode||"normal"})}else throw new Error(`Unsupported appearance stream external object: ${ne[0]}`);break;default:if(!this.tryApplyingStateOperator(ee,ne))throw new Error(`Unsupported appearance stream operator: ${ee}`)}Y=ee}return F}}class BorderStyleDict extends PdfDict{W=1;S=borderStyles.SOLID;D=[3,0];constructor(){super(dictTypes.BORDER_STYLE)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new BorderStyleDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.W&&$.push(...F.encode("/W "),...F.encode(" "+this.W)),this.S&&$.push(...F.encode("/S "),...F.encode(this.S)),this.D&&$.push(...F.encode("/D "),...this.encodePrimitiveArray(this.D,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/W":V=await this.parseNumberPropAsync(te,C,V,!0);break;case"/S":const ne=await C.parseNameAtAsync(V,!0);if(ne&&Object.values(borderStyles).includes(ne.value))this.S=ne.value,V=ne.end+1;else throw new Error("Can't parse /S property value");break;case"/D":const ee=await C.parseNumberArrayAtAsync(V,!0);if(ee)this.D=[ee.value[0]??3,ee.value[1]??0],V=ee.end+1;else throw new Error("Can't parse /D property value");break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class AppearanceDict extends PdfDict{N;R;D;_streamsMap=new Map;constructor(){super(null)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new AppearanceDict;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}getStream(e){return this._streamsMap.get(e)}*getStreams(){for(const e of this._streamsMap)yield e[1]}setStream(e,C){this._streamsMap.set(e,C),this._edited=!0}clearStreams(){this._streamsMap.clear(),this._edited=!0}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[],Y=this._streamsMap.get("/N");Y?($.push(...F.encode("/N ")),$.push(...ObjectId.fromRef(Y.ref).toArray(e))):this.N&&($.push(...F.encode("/N ")),this.N instanceof ObjectMapDict?$.push(...this.N.toArray(e)):$.push(...this.N.toArray(e)));const V=this._streamsMap.get("/R");V?($.push(...F.encode("/R ")),$.push(...ObjectId.fromRef(V.ref).toArray(e))):this.R&&($.push(...F.encode("/R ")),this.R instanceof ObjectMapDict?$.push(...this.R.toArray(e)):$.push(...this.R.toArray(e)));const te=this._streamsMap.get("/D");te?($.push(...F.encode("/D ")),$.push(...ObjectId.fromRef(te.ref).toArray(e))):this.D&&($.push(...F.encode("/D ")),this.D instanceof ObjectMapDict?$.push(...this.D.toArray(e)):$.push(...this.D.toArray(e)));const se=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(se)}async fillStreamsMapAsync(e){this._streamsMap.clear();for(const C of["N","R","D"])if(this[C])if(this[C]instanceof ObjectId){const F=await e(this[C].id);if(!F)continue;const $=await XFormStream.parseAsync(F);if(!$)continue;$&&this._streamsMap.set(`/${C}`,$.value)}else for(const[F,$]of this[C].getProps()){const Y=await e($.id);if(!Y)continue;const V=await XFormStream.parseAsync(Y);V&&this._streamsMap.set(`/${C}${F}`,V.value)}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/N":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae){this.N=ae.value,V=ae.end+1;break}}else if(ne===valueTypes.DICTIONARY){const ae=await C.getDictBoundsAtAsync(V);if(ae){const re=await ObjectMapDict.parseAsync({parser:C,bounds:ae});if(re){this.N=re.value,V=re.end+1;break}}}else throw new Error(`Unsupported /N property value type: ${ne}`);throw new Error("Can't parse /N property value");case"/R":const ee=await C.getValueTypeAtAsync(V);if(ee===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae){this.R=ae.value,V=ae.end+1;break}}else if(ee===valueTypes.DICTIONARY){const ae=await C.getDictBoundsAtAsync(V);if(ae){const re=await ObjectMapDict.parseAsync({parser:C,bounds:ae});if(re){this.R=re.value,V=re.end+1;break}}}else throw new Error(`Unsupported /R property value type: ${ee}`);throw new Error("Can't parse /R property value");case"/D":const ie=await C.getValueTypeAtAsync(V);if(ie===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae){this.D=ae.value,V=ae.end+1;break}}else if(ie===valueTypes.DICTIONARY){const ae=await C.getDictBoundsAtAsync(V);if(ae){const re=await ObjectMapDict.parseAsync({parser:C,bounds:ae});if(re){this.D=re.value,V=re.end+1;break}}}else throw new Error(`Unsupported /D property value type: ${ie}`);throw new Error("Can't parse /D property value");default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.N)throw new Error("Not all required properties parsed");e.parseInfoGetterAsync&&await this.fillStreamsMapAsync(e.parseInfoGetterAsync)}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class BorderEffectDict extends PdfDict{S=borderEffects.NONE;L=0;constructor(){super(null)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new BorderEffectDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.S&&$.push(...F.encode("/S "),...F.encode(this.S)),this.L&&$.push(...F.encode("/L "),...F.encode(" "+this.L));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/S":const ne=await C.parseNameAtAsync(V,!0);if(ne&&Object.values(borderEffects).includes(ne.value))this.S=ne.value,V=ne.end+1;else throw new Error("Can't parse /S property value");break;case"/L":V=await this.parseNumberPropAsync(te,C,V,!0);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class BorderArray{hCornerR;vCornerR;width;dash;gap;constructor(e,C,F,$,Y){this.hCornerR=e??0,this.vCornerR=C??0,this.width=F??1,this.dash=$??3,this.gap=Y??0}static async parseAsync(e,C,F=!0){if(F&&(C=await e.findNonSpaceIndexAsync(!0,C)),C<0||C>e.maxIndex||!await e.isCodeAtAsync(C,codes.L_BRACKET))return null;const $=await e.parseNumberAtAsync(C+1);if(!$||isNaN($.value))return null;const Y=await e.parseNumberAtAsync($.end+2);if(!Y||isNaN(Y.value))return null;const V=await e.parseNumberAtAsync(Y.end+2);if(!V||isNaN(V.value))return null;const te=await e.findNonSpaceIndexAsync(!0,V.end+1);if(te){if(await e.isCodeAtAsync(te,codes.R_BRACKET))return{value:new BorderArray($.value,Y.value,V.value),start:C,end:te};if(await e.isCodeAtAsync(te,codes.L_BRACKET)){const se=await e.parseNumberAtAsync(te+1);if(!se||isNaN(se.value))return null;const ne=await e.parseNumberAtAsync(se.end+2);if(!ne||isNaN(ne.value))return null;const ee=await e.findNonSpaceIndexAsync(!0,ne.end+1);if(!ee||!await e.isCodeAtAsync(ee,codes.R_BRACKET))return null;const ie=await e.findNonSpaceIndexAsync(!0,ee+1);return!ie||!await e.isCodeAtAsync(ie,codes.R_BRACKET)?null:{value:new BorderArray($.value,Y.value,V.value,se.value,ne.value),start:C,end:ie}}}else return null;return null}toArray(e){const C=this.dash&&this.gap?`[${this.hCornerR} ${this.vCornerR} ${this.width}]`:`[${this.hCornerR} ${this.vCornerR} ${this.width} [${this.dash} ${this.gap}]]`;return new TextEncoder().encode(C)}}class AnnotationDict extends PdfDict{$name;$pageId;$translationEnabled;$onRenderUpdatedAction;$onPointerDownAction;$onPointerEnterAction;$onPointerLeaveAction;Subtype;Rect;Contents;P;NM;M;F=4;AP;AS;Border=new BorderArray(0,0,1);BS;BE;C;StructParent;_apStream;get apStream(){if(!this._apStream){const e=this.AP?.getStreams();e&&(this._apStream=[...e][0])}return this._apStream}set apStream(e){this._apStream=e,this._edited=!0}_bBox;_transformationPromise;_transformationTimer;_tempX;_tempY;_currentAngle=0;_moved;_tempTransformationMatrix=new l;_tempStartPoint=new u;_tempVecX=new u;_tempVecY=new u;_svgId=UUID.getRandomUuid();_pageInfo;_renderedBox;_renderedControls;_renderedContent;_svgContentCopy;get lastRenderResult(){return!this._renderedControls||!this._renderedContent?null:{controls:this._renderedControls,content:this._renderedContent}}get strokeWidth(){return this.BS?.W??this.Border?.width??1}constructor(e){super(dictTypes.ANNOTATION),this.Subtype=e}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];if(this.Subtype&&$.push(...F.encode("/Subtype "),...F.encode(this.Subtype)),this.Rect&&$.push(...F.encode("/Rect "),...this.encodePrimitiveArray(this.Rect,F)),this.Contents&&$.push(...F.encode("/Contents "),...this.Contents.toArray(e)),this.P&&$.push(...F.encode("/P "),...this.P.toArray(e)),this.NM&&$.push(...F.encode("/NM "),...this.NM.toArray(e)),this.M&&$.push(...F.encode("/M "),...this.M.toArray(e)),this.F&&$.push(...F.encode("/F "),...F.encode(" "+this.F)),this.AS&&$.push(...F.encode("/AS "),...F.encode(this.AS)),this.Border&&$.push(...F.encode("/Border "),...this.Border.toArray(e)),this.BS&&$.push(...F.encode("/BS "),...this.BS.toArray(e)),this.BE&&$.push(...F.encode("/BE "),...this.BE.toArray(e)),this.C&&$.push(...F.encode("/C "),...this.encodePrimitiveArray(this.C,F)),this.StructParent&&$.push(...F.encode("/StructParent "),...F.encode(" "+this.StructParent)),this.apStream){this.AP||(this.AP=new AppearanceDict);const V=this.apStream.ref;if(!V)throw new Error("Appearance stream has no reference");this.AP.N=ObjectId.fromRef(V),this.AP.R=null,this.AP.D=null,this.AP.clearStreams(),this.AP.setStream("/N",this.apStream),$.push(...F.encode("/AP "),...this.AP.toArray(e))}const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async renderAsync(e){if(!e)throw new Error("Can't render the annotation: view box is not defined");return this._pageInfo=e,this._renderedControls||(this._renderedControls=this.renderControls()),await new Promise((C,F)=>{setTimeout(async()=>{await this.updateRenderAsync(),C()},0)}),this.lastRenderResult}async renderApStreamAsync(){const e=this.apStream;if(e)try{return await new AppearanceStreamRenderer(e,this.Rect,this.$name).renderAsync()}catch(C){console.log(`Annotation stream render error: ${C.message}`)}return null}async moveToAsync(e){const C=this.Rect[2]-this.Rect[0],F=this.Rect[3]-this.Rect[1],$=e.x-C/2,Y=e.y-F/2,V=l.buildTranslate($,Y);await this.applyCommonTransformAsync(V)}async rotateByAsync(e,C){if(!C){const[$,Y,V,te]=this.Rect;C=new u(($+V)/2,(Y+te)/2)}const F=new l().applyTranslation(-C.x,-C.y).applyRotation(e).applyTranslation(C.x,C.y);await this.applyCommonTransformAsync(F)}toDto(){return{annotationType:this.Type,uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date?.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,matrix:this.apStream?.Matrix}}async setTextContentAsync(e,C=!0){const F=this.getProxy(),$=F.Contents?.literal;if(!e)F.Contents=null;else{const Y=LiteralString.fromString(e);F.Contents=Y}F.M=DateString.fromDate(new Date),F.$onEditAction&&F.$onEditAction(C?async()=>{await F.setTextContentAsync($,!1)}:void 0)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Subtype":const ne=await C.parseNameAtAsync(V);if(ne){if(this.Subtype&&this.Subtype!==ne.value)throw new Error(`Invalid dict subtype: '${ne.value}' instead of '${this.Subtype}'`);V=ne.end+1}else throw new Error("Can't parse /Subtype property value");break;case"/Rect":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/P":V=await this.parseRefPropAsync(te,C,V);break;case"/Contents":case"/NM":const ee=await C.getValueTypeAtAsync(V);ee===valueTypes.STRING_LITERAL?V=await this.parseLiteralPropAsync(te,C,V,e.cryptInfo):ee===valueTypes.STRING_HEX?V=await this.parseHexPropAsync(te,C,V,e.cryptInfo):V=await C.skipToNextNameAsync(V,Y-1);break;case"/M":const ie=await DateString.parseAsync(C,V,e.cryptInfo);if(ie){this.M=ie.value,V=ie.end+1;break}else{const he=await LiteralString.parseAsync(C,V,e.cryptInfo);if(he){this.M=he.value,V=he.end+1;break}}throw new Error("Can't parse /M property value");case"/C":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/F":case"/StructParent":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Border":const ae=await BorderArray.parseAsync(C,V);if(ae)this.Border=ae.value,V=ae.end+1;else throw new Error("Can't parse /Border property value");break;case"/BS":const re=await C.getValueTypeAtAsync(V);if(re===valueTypes.REF){const he=await ObjectId.parseRefAsync(C,V);if(he&&e.parseInfoGetterAsync){const de=await e.parseInfoGetterAsync(he.value.id);if(de){const pe=await BorderStyleDict.parseAsync(de);if(pe){this.BS=pe.value,V=pe.end+1;break}}}throw new Error("Can't parse /BS value reference")}else if(re===valueTypes.DICTIONARY){const he=await C.getDictBoundsAtAsync(V);if(he){const de=await BorderStyleDict.parseAsync({parser:C,bounds:he});if(de){this.BS=de.value,V=de.end+1;break}}throw new Error("Can't parse /BS value dictionary")}throw new Error(`Unsupported /BS property value type: ${re}`);case"/BE":const oe=await C.getValueTypeAtAsync(V);if(oe===valueTypes.REF){const he=await ObjectId.parseRefAsync(C,V);if(he&&e.parseInfoGetterAsync){const de=await e.parseInfoGetterAsync(he.value.id);if(de){const pe=await BorderEffectDict.parseAsync(de);if(pe){this.BE=pe.value,V=pe.end+1;break}}}throw new Error("Can't parse /BE value reference")}else if(oe===valueTypes.DICTIONARY){const he=await C.getDictBoundsAtAsync(V);if(he){const de=await BorderEffectDict.parseAsync({parser:C,bounds:he});if(de){this.BE=de.value,V=de.end+1;break}}throw new Error("Can't parse /BE value dictionary")}throw new Error(`Unsupported /BE property value type: ${oe}`);case"/AP":const ce=await C.getValueTypeAtAsync(V);if(ce===valueTypes.REF){const he=await ObjectId.parseRefAsync(C,V);if(he&&e.parseInfoGetterAsync){const de=await e.parseInfoGetterAsync(he.value.id);if(de){const pe=await AppearanceDict.parseAsync(de);if(pe){this.AP=pe.value,V=pe.end+1;break}}}throw new Error("Can't parse /AP value reference")}else if(ce===valueTypes.DICTIONARY){const he=await C.getDictBoundsAtAsync(V);if(he){const de=await AppearanceDict.parseAsync({parser:C,bounds:he,parseInfoGetterAsync:e.parseInfoGetterAsync});if(de){this.AP=de.value,V=de.end+1;break}}throw new Error("Can't parse /AP value dictionary")}throw new Error(`Unsupported /AP property value type: ${ce}`);case"/AS":V=await this.parseNamePropAsync(te,C,V);break;case"/OC":default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Subtype||!this.Rect)throw new Error("Not all required properties parsed");this.$name=this.NM?.literal||UUID.getRandomUuid()}getColorString(){let e;if(!this.C?.length)e="0 G 0 g";else if(this.C.length<3){const C=this.C[0];e=`${C} G ${C} g`}else if(this.C.length===3){const[C,F,$]=this.C;e=`${C} ${F} ${$} RG ${C} ${F} ${$} rg`}else{const[C,F,$,Y]=this.C;e=`${C} ${F} ${$} ${Y} K ${C} ${F} ${$} ${Y} k`}return e}getCurrentRotation(){const e=this.apStream?.matrix;if(!e)return 0;const{r:C}=e.getTRS();return C}getLocalBB(){let e,C,F,$;if(this._bBox)return this._bBox;if(this.apStream){const{ll:Y,lr:V,ur:te,ul:se}=this.apStream.transformedBBox,{min:ne,max:ee}=u.minMax(Y,V,te,se),ie=new u(this.Rect[0],this.Rect[1]),ae=new u(this.Rect[2],this.Rect[3]),re=l.from4Vec2(ne,ee,ie,ae,!0);e=Y.applyMat3(re),C=V.applyMat3(re),F=te.applyMat3(re),$=se.applyMat3(re)}else this.Rect?(e=new u(this.Rect[0],this.Rect[1]),C=new u(this.Rect[2],this.Rect[1]),F=new u(this.Rect[2],this.Rect[3]),$=new u(this.Rect[0],this.Rect[3])):(e=new u,C=new u,F=new u,$=new u);return this._bBox={ll:e,lr:C,ur:F,ul:$},this._bBox}convertClientCoordsToPage(e,C){if(!this._pageInfo)throw new Error("Can't get exact page coords without page info");const F=this._pageInfo.scale,$=this._pageInfo.rotation,[Y,V]=this.Rect,{x:te,y:se,width:ne,height:ee}=this._renderedBox.getBoundingClientRect(),ie=new u,ae=new u;switch($){case 0:ie.set(te-Y*F,se+ee+V*F),ae.set((e-ie.x)/F,(ie.y-C)/F);break;case 90:ie.set(te-V*F,se-Y*F),ae.set((C-ie.y)/F,(e-ie.x)/F);break;case 180:ie.set(te+ne+Y*F,se-V*F),ae.set((ie.x-e)/F,(C-ie.y)/F);break;case 270:ie.set(te+ne+V*F,se+ee+Y*F),ae.set((ie.y-C)/F,(ie.x-e)/F);break;default:throw new Error(`Invalid page rotation value: ${$}`)}return ae}convertPageCoordsToClient(e,C){if(!this._pageInfo)throw new Error("Can't get exact page coords without page info");const F=this._pageInfo.scale,$=this._pageInfo.rotation,[Y,V]=this.Rect,{x:te,y:se,width:ne,height:ee}=this._renderedBox.getBoundingClientRect(),ie=new u,ae=new u;switch($){case 0:ie.set(te-Y*F,se+ee+V*F),ae.set(e*F+ie.x,ie.y-C*F);break;case 90:ie.set(te-V*F,se-Y*F),ae.set(C*F+ie.x,e*F+ie.y);break;case 180:ie.set(te+ne+Y*F,se-V*F),ae.set(ie.x-e*F,C*F+ie.y);break;case 270:ie.set(te+ne+V*F,se+ee+Y*F),ae.set(ie.x-C*F,ie.y-e*F);break;default:throw new Error(`Invalid page rotation value: ${$}`)}return ae}applyRectTransform(e){const C=this.getLocalBB();C.ll.applyMat3(e),C.lr.applyMat3(e),C.ur.applyMat3(e),C.ul.applyMat3(e);const{min:F,max:$}=u.minMax(C.ll,C.lr,C.ur,C.ul);this.Rect=[F.x,F.y,$.x,$.y]}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy();F.applyRectTransform(e);const $=F.apStream;if($){const Y=l.multiply($.matrix,e);F.apStream.matrix=Y}if(F.M=DateString.fromDate(new Date),F.$onEditAction){const Y=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(Y,!1),await F.updateRenderAsync()}:void 0)}}async applyTempTransformAsync(){if(this._transformationTimer){clearTimeout(this._transformationTimer),this._transformationTimer=null;return}this._transformationPromise&&await this._transformationPromise,this._transformationPromise=new Promise(async e=>{this._svgContentCopy.remove(),this._svgContentCopy.setAttribute("transform","matrix(1 0 0 1 0 0)"),this._moved&&(await this.applyCommonTransformAsync(this._tempTransformationMatrix),await this.updateRenderAsync()),this._tempTransformationMatrix.reset(),e()}),await this._transformationPromise}renderAppearance(){return null}renderRect(){const e=document.createElementNS("http://www.w3.org/2000/svg","rect");return e.classList.add("annotation-rect"),e.setAttribute("data-annotation-name",this.$name),e.setAttribute("x",this.Rect[0]+""),e.setAttribute("y",this.Rect[1]+""),e.setAttribute("width",this.Rect[2]-this.Rect[0]+""),e.setAttribute("height",this.Rect[3]-this.Rect[1]+""),e}renderBox(){const{ll:e,lr:C,ur:F,ul:$}=this.getLocalBB(),Y=document.createElementNS("http://www.w3.org/2000/svg","path");return Y.classList.add("annotation-bbox"),Y.setAttribute("data-annotation-name",this.$name),Y.setAttribute("d",`M ${e.x} ${e.y} L ${C.x} ${C.y} L ${F.x} ${F.y} L ${$.x} ${$.y} Z`),Y}renderControls(){const e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.classList.add("annotation-controls"),e.setAttribute("data-annotation-name",this.$name),e.addEventListener("pointerdown",this.onSvgPointerDown),e.addEventListener("pointerenter",this.onSvgPointerEnter),e.addEventListener("pointerleave",this.onSvgPointerLeave),e}buildRenderedContentStructure(e){const C=document.createElement("div");C.id=this._svgId,C.classList.add("annotation-content"),C.setAttribute("data-annotation-name",this.$name);const{width:F,height:$}=this._pageInfo;if(e.clipPaths?.length){const Y=document.createElementNS("http://www.w3.org/2000/svg","svg");Y.append(...e.clipPaths),Y.setAttribute("viewBox",`0 0 ${F} ${$}`),Y.setAttribute("transform","scale(1, -1)"),C.append(Y)}return e.elements.forEach(Y=>{const V=document.createElementNS("http://www.w3.org/2000/svg","svg");V.classList.add("annotation-content-element"),V.setAttribute("viewBox",`0 0 ${F} ${$}`),V.setAttribute("transform","scale(1, -1)"),V.style.mixBlendMode=Y.blendMode,V.append(Y.element),C.append(V)}),C}buildRenderContentCopy(e){const C=document.createElementNS("http://www.w3.org/2000/svg","g");return e.elements.forEach(F=>{C.append(F.element.cloneNode(!0))}),C.classList.add("annotation-temp-copy"),C}renderScaleHandles(){const e=this.getLocalBB(),C=[];return["ll","lr","ur","ul"].forEach(F=>{const $=document.createElementNS("http://www.w3.org/2000/svg","line");$.classList.add("annotation-handle","scale"),$.setAttribute("data-handle-name",F),$.setAttribute("x1",e[F].x+""),$.setAttribute("y1",e[F].y+""),$.setAttribute("x2",e[F].x+""),$.setAttribute("y2",e[F].y+.1+""),$.addEventListener("pointerdown",this.onScaleHandlePointerDown),C.push($)}),C}renderRotationHandle(){const e=(this.Rect[0]+this.Rect[2])/2,C=(this.Rect[1]+this.Rect[3])/2,F=this.getCurrentRotation(),$=document.createElementNS("http://www.w3.org/2000/svg","g");$.classList.add("annotation-rotator"),$.setAttribute("data-handle-name","center");const Y=document.createElementNS("http://www.w3.org/2000/svg","circle");Y.classList.add("circle","dashed"),Y.setAttribute("cx",e+""),Y.setAttribute("cy",C+"");const V=new l().applyTranslation(-e,-C+35).applyRotation(F).applyTranslation(e,C),te=new u(e,C).applyMat3(V),se=document.createElementNS("http://www.w3.org/2000/svg","line");se.classList.add("dashed"),se.setAttribute("x1",e+""),se.setAttribute("y1",C+""),se.setAttribute("x2",te.x+""),se.setAttribute("y2",te.y+"");const ne=document.createElementNS("http://www.w3.org/2000/svg","line");return ne.classList.add("annotation-handle","rotation"),ne.setAttribute("data-handle-name","center"),ne.setAttribute("x1",te.x+""),ne.setAttribute("y1",te.y+""),ne.setAttribute("x2",te.x+""),ne.setAttribute("y2",te.y+.1+""),ne.addEventListener("pointerdown",this.onRotationHandlePointerDown),$.append(Y,se,ne),$}renderHandles(){return[...this.renderScaleHandles(),this.renderRotationHandle()]}async updateRenderAsync(){if(!this._renderedControls)return;this._renderedControls.innerHTML="";const e=this.renderAppearance()||await this.renderApStreamAsync();if(!e||!e.elements?.length)return this._renderedBox=null,this._svgContentCopy=null,null;const C=this.buildRenderedContentStructure(e);this._renderedContent=C;const F=this.renderRect(),$=this.renderBox(),Y=this.renderHandles();this._renderedBox=$,this._renderedControls.append(F,$,...e.pickHelpers,...Y);const V=this.buildRenderContentCopy(e);this._svgContentCopy=V,this.$onRenderUpdatedAction&&this.$onRenderUpdatedAction()}onSvgPointerEnter=e=>{this.$onPointerEnterAction&&this.$onPointerEnterAction(e)};onSvgPointerLeave=e=>{this.$onPointerLeaveAction&&this.$onPointerLeaveAction(e)};onSvgPointerDown=e=>{this.$pageId&&(this.$onPointerDownAction&&this.$onPointerDownAction(e),this.onTranslationPointerDown(e))};onTranslationPointerDown=e=>{if(!this.$translationEnabled||!e.isPrimary)return;const C=e.target;C.setPointerCapture(e.pointerId),C.addEventListener("pointerup",this.onTranslationPointerUp),C.addEventListener("pointerout",this.onTranslationPointerUp),this._moved=!1,this._transformationTimer=setTimeout(()=>{this._transformationTimer=null,this._renderedControls.after(this._svgContentCopy),this._tempStartPoint.setFromVec2(this.convertClientCoordsToPage(e.clientX,e.clientY)),C.addEventListener("pointermove",this.onTranslationPointerMove)},200)};onTranslationPointerMove=e=>{if(!e.isPrimary)return;const C=this.convertClientCoordsToPage(e.clientX,e.clientY);this._tempTransformationMatrix.reset().applyTranslation(C.x-this._tempStartPoint.x,C.y-this._tempStartPoint.y),this._svgContentCopy.setAttribute("transform",`matrix(${this._tempTransformationMatrix.toFloatShortArray().join(" ")})`),this._moved=!0};onTranslationPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onTranslationPointerMove),C.removeEventListener("pointerup",this.onTranslationPointerUp),C.removeEventListener("pointerout",this.onTranslationPointerUp),C.releasePointerCapture(e.pointerId),this.applyTempTransformAsync()};onRotationHandlePointerDown=e=>{if(!e.isPrimary)return;const C=e.target;C.setPointerCapture(e.pointerId),C.addEventListener("pointerup",this.onRotationHandlePointerUp),C.addEventListener("pointerout",this.onRotationHandlePointerUp),this._moved=!1,this._transformationTimer=setTimeout(()=>{this._transformationTimer=null,this._renderedControls.after(this._svgContentCopy),C.addEventListener("pointermove",this.onRotationHandlePointerMove)},200),e.stopPropagation()};onRotationHandlePointerMove=e=>{if(!e.isPrimary)return;const C=(this.Rect[0]+this.Rect[2])/2,F=(this.Rect[1]+this.Rect[3])/2,$=this.convertPageCoordsToClient(C,F),Y=this.getCurrentRotation(),V=Math.atan2(e.clientY-$.y,e.clientX-$.x)+Math.PI/2-Y;this._currentAngle=V,this._tempTransformationMatrix.reset().applyTranslation(-C,-F).applyRotation(V).applyTranslation(C,F),this._svgContentCopy.setAttribute("transform",`matrix(${this._tempTransformationMatrix.toFloatShortArray().join(" ")})`),this._moved=!0};onRotationHandlePointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onRotationHandlePointerMove),C.removeEventListener("pointerup",this.onRotationHandlePointerUp),C.removeEventListener("pointerout",this.onRotationHandlePointerUp),C.releasePointerCapture(e.pointerId),this.applyTempTransformAsync()};onScaleHandlePointerDown=e=>{if(!e.isPrimary)return;const C=e.target;C.setPointerCapture(e.pointerId),C.addEventListener("pointerup",this.onScaleHandlePointerUp),C.addEventListener("pointerout",this.onScaleHandlePointerUp);const{ll:F,lr:$,ur:Y,ul:V}=this.getLocalBB(),te=C.dataset.handleName;switch(te){case"ll":this._tempStartPoint.setFromVec2(Y),this._tempVecX.setFromVec2(V).subtract(Y),this._tempVecY.setFromVec2($).subtract(Y);break;case"lr":this._tempStartPoint.setFromVec2(V),this._tempVecX.setFromVec2(Y).subtract(V),this._tempVecY.setFromVec2(F).subtract(V);break;case"ur":this._tempStartPoint.setFromVec2(F),this._tempVecX.setFromVec2($).subtract(F),this._tempVecY.setFromVec2(V).subtract(F);break;case"ul":this._tempStartPoint.setFromVec2($),this._tempVecX.setFromVec2(F).subtract($),this._tempVecY.setFromVec2(Y).subtract($);break;default:throw new Error(`Invalid handle name: ${te}`)}this._tempX=this._tempVecX.getMagnitude(),this._tempY=this._tempVecY.getMagnitude(),this._moved=!1,this._transformationTimer=setTimeout(()=>{this._transformationTimer=null,this._renderedControls.after(this._svgContentCopy),C.addEventListener("pointermove",this.onScaleHandlePointerMove)},200),e.stopPropagation()};onScaleHandlePointerMove=e=>{if(!e.isPrimary)return;const C=this.convertClientCoordsToPage(e.clientX,e.clientY).subtract(this._tempStartPoint),F=C.getMagnitude(),Y=Math.abs(C.dotProduct(this._tempVecX))/F/this._tempX*F,V=Math.sqrt(F*F-Y*Y),te=Y/this._tempX,se=V/this._tempY,ne=(this.Rect[0]+this.Rect[2])/2,ee=(this.Rect[1]+this.Rect[3])/2,ie=this.getCurrentRotation();this._tempTransformationMatrix.reset().applyTranslation(-ne,-ee).applyRotation(-ie).applyScaling(te,se).applyRotation(ie).applyTranslation(ne,ee);const ae=this._tempStartPoint.clone().subtract(this._tempStartPoint.clone().applyMat3(this._tempTransformationMatrix));this._tempTransformationMatrix.applyTranslation(ae.x,ae.y),this._svgContentCopy.setAttribute("transform",`matrix(${this._tempTransformationMatrix.toFloatShortArray().join(" ")})`),this._moved=!0};onScaleHandlePointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onScaleHandlePointerMove),C.removeEventListener("pointerup",this.onScaleHandlePointerUp),C.removeEventListener("pointerout",this.onScaleHandlePointerUp),C.releasePointerCapture(e.pointerId),this.applyTempTransformAsync()};initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class MarkupAnnotation extends AnnotationDict{T;Popup;RC;CA;CreationDate;Subj;IRT;RT=markupAnnotationReplyTypes.REPLY;ExData;_textData;constructor(e){super(e)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.T&&$.push(...F.encode("/T "),...this.T.toArray(e)),this.Popup&&$.push(...F.encode("/Popup "),...this.Popup.toArray(e)),this.RC&&$.push(...F.encode("/RC "),...this.RC.toArray(e)),this.CA&&$.push(...F.encode("/CA "),...F.encode(" "+this.CA)),this.CreationDate&&$.push(...F.encode("/CreationDate "),...this.CreationDate.toArray(e)),this.Subj&&$.push(...F.encode("/Subj "),...this.Subj.toArray(e)),this.IRT&&$.push(...F.encode("/IRT "),...this.IRT.toArray(e)),this.RT&&$.push(...F.encode("/RT "),...F.encode(this.RT));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/T":case"/Subj":V=await this.parseLiteralPropAsync(te,C,V,e.cryptInfo);break;case"/Popup":case"/IRT":V=await this.parseRefPropAsync(te,C,V);break;case"/RC":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ie=await ObjectId.parseRefAsync(C,V);if(ie&&e.parseInfoGetterAsync){const ae=await e.parseInfoGetterAsync(ie.value.id);if(ae){const re=ae.type||ae.parser.getValueTypeAtAsync(ae.bounds.contentStart);if(re===valueTypes.STRING_LITERAL){const oe=await LiteralString.parseAsync(ae.parser,ae.bounds.contentStart);if(oe){this.RC=oe.value,V=ie.end+1;break}}else if(re===valueTypes.DICTIONARY){const oe=await TextStream.parseAsync(ae);if(oe){const ce=oe.value.getText();this.RC=LiteralString.fromString(ce),V=ie.end+1;break}}else throw new Error(`Unsupported /RC property value type: ${re}`)}}throw new Error("Can't parse /RC value reference")}else if(ne===valueTypes.STRING_LITERAL){const ie=await LiteralString.parseAsync(C,V,e.cryptInfo);if(ie){this.RC=ie.value,V=ie.end+1;break}throw new Error("Can't parse /RC property value")}throw new Error(`Unsupported /RC property value type: ${ne}`);case"/CA":V=await this.parseNumberPropAsync(te,C,V,!0);break;case"/CreationDate":V=await this.parseDatePropAsync(te,C,V,e.cryptInfo);break;case"/RT":const ee=await C.parseNameAtAsync(V,!0);if(ee&&Object.values(markupAnnotationReplyTypes).includes(ee.value))this.RT=ee.value,V=ee.end+1;else throw new Error("Can't parse /RT property value");break;case"/ExData":break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Subtype||!this.Rect)throw new Error("Not all required properties parsed")}getColorRect(){let e=0,C=0,F=0,$=1;if(this.C){if(this.C.length===1)e=C=F=this.C[0];else if(this.C.length===3)[e,C,F]=this.C;else if(this.C.length===4){const[V,te,se,ne]=this.C;e=(1-V)*(1-ne),C=(1-te)*(1-ne),F=(1-se)*(1-ne)}}return isNaN(this.CA)||($=this.CA),[e,C,F,$]}async updateTextDataAsync(e){const C=this.Contents?.literal,F=await TextData.buildAsync(C,e);return this._textData=F,this._textData}getLineEndingStreamPart(e,C,F,$){const Y=Math.max(F*LINE_END_MULTIPLIER,LINE_END_MIN_SIZE);let V="";switch(C){case lineEndingTypes.ARROW_OPEN:return $==="left"?(V+=`
${e.x+Y} ${e.y+Y/2} m`,V+=`
${e.x} ${e.y} l`,V+=`
${e.x+Y} ${e.y-Y/2} l`):(V+=`
${e.x-Y} ${e.y+Y/2} m`,V+=`
${e.x} ${e.y} l`,V+=`
${e.x-Y} ${e.y-Y/2} l`),V+=`
S`,V;case lineEndingTypes.ARROW_OPEN_R:return $==="left"?(V+=`
${e.x} ${e.y+Y/2} m`,V+=`
${e.x+Y} ${e.y} l`,V+=`
${e.x} ${e.y-Y/2} l`):(V+=`
${e.x} ${e.y+Y/2} m`,V+=`
${e.x-Y} ${e.y} l`,V+=`
${e.x} ${e.y-Y/2} l`),V+=`
S`,V;case lineEndingTypes.ARROW_CLOSED:return $==="left"?(V+=`
${e.x+Y} ${e.y+Y/2} m`,V+=`
${e.x} ${e.y} l`,V+=`
${e.x+Y} ${e.y-Y/2} l`):(V+=`
${e.x-Y} ${e.y+Y/2} m`,V+=`
${e.x} ${e.y} l`,V+=`
${e.x-Y} ${e.y-Y/2} l`),V+=`
s`,V;case lineEndingTypes.ARROW_CLOSED_R:return $==="left"?(V+=`
${e.x+Y} ${e.y} m`,V+=`
${e.x} ${e.y+Y/2} l`,V+=`
${e.x} ${e.y-Y/2} l`):(V+=`
${e.x-Y} ${e.y} m`,V+=`
${e.x} ${e.y-Y/2} l`,V+=`
${e.x} ${e.y+Y/2} l`),V+=`
s`,V;case lineEndingTypes.BUTT:return V+=`
${e.x} ${e.y+Y/2} m`,V+=`
${e.x} ${e.y-Y/2} l`,V+=`
S`,V;case lineEndingTypes.SLASH:return V+=`
${e.x+Y/2} ${e.y+Y/2} m`,V+=`
${e.x-Y/2} ${e.y-Y/2} l`,V+=`
S`,V;case lineEndingTypes.DIAMOND:return V+=`
${e.x} ${e.y+Y/2} m`,V+=`
${e.x+Y/2} ${e.y} l`,V+=`
${e.x} ${e.y-Y/2} l`,V+=`
${e.x-Y/2} ${e.y} l`,V+=`
s`,V;case lineEndingTypes.SQUARE:return V+=`
${e.x-Y/2} ${e.y+Y/2} m`,V+=`
${e.x+Y/2} ${e.y+Y/2} l`,V+=`
${e.x+Y/2} ${e.y-Y/2} l`,V+=`
${e.x-Y/2} ${e.y-Y/2} l`,V+=`
s`,V;case lineEndingTypes.CIRCLE:const te=BEZIER_CONSTANT,se=Y/2,ne=te*se,ee=e.x-se,ie=e.y-se,ae=e.x+se,re=e.y+se;return V+=`
${e.x} ${re} m`,V+=`
${e.x+ne} ${re} ${ae} ${e.y+ne} ${ae} ${e.y} c`,V+=`
${ae} ${e.y-ne} ${e.x+ne} ${ie} ${e.x} ${ie} c`,V+=`
${e.x-ne} ${ie} ${ee} ${e.y-ne} ${ee} ${e.y} c`,V+=`
${ee} ${e.y+ne} ${e.x-ne} ${re} ${e.x} ${re} c`,V+=`
S`,V;case lineEndingTypes.NONE:default:return""}}}class DataUpdater{_lastXref;_refData;_changeData;_writer;_stringCryptor;_streamCryptor;_writtenIds=new Set;constructor(e,C,F,$){this._lastXref=C,this._refData=F,this._changeData=new ReferenceDataChange(F),this._writer=new DataWriter(e),this._stringCryptor=$?.stringCryptor,this._streamCryptor=$?.streamCryptor}getDataWithUpdatedAnnotations(e){for(const{page:F,supportedAnnotations:$,allAnnotationIds:Y}of e)if($?.length){for(const V of $)if(V.deleted){if(!V.ref)continue;const te=Y.findIndex(se=>se.id===V.id);Y.splice(te,1),this._changeData.setRefFree(V.id),V instanceof MarkupAnnotation&&V.Popup&&this._changeData.setRefFree(V.Popup.id)}else if(!V.ref||V.edited){const te=V.apStream;if(te&&this.writeFormXObject(te),this.isNew(V)){const se=this.writeIndirectObject(V);Y.push(ObjectId.fromRef(se))}else this.writeUpdatedIndirectObject(V)}if(F.Annots instanceof ObjectId&&this._changeData.isUsedInSource(F.Annots.id)){const V={id:F.Annots.id,generation:F.Annots.generation,byteOffset:this._writer.offset},te={ref:V,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};this._changeData.updateUsedRef(V),this._writer.writeIndirectArray(te,Y)}else{const V=this._changeData.takeFreeRef(this._writer.offset,!0),te={ref:V,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};this._writer.writeIndirectArray(te,Y),F.Annots=ObjectId.fromRef(V)}this.writeUpdatedIndirectObject(F)}return this.writeXref(),this._writer.getCurrentData()}isNew(e){return!e.ref||!this._changeData.isUsedInSource(e.id)}writeIndirectObject(e){if(this._writtenIds.has(e.id))return this._changeData.getUsedRef(e.id);const C=this._changeData.takeFreeRef(this._writer.offset,!0),F={ref:C,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};return this._writer.writeIndirectObject(F,e),e.ref=C,this._writtenIds.add(C.id),C}writeUpdatedIndirectObject(e){const C={id:e.id,generation:e.generation,byteOffset:this._writer.offset},F={ref:C,streamCryptor:this._streamCryptor,stringCryptor:this._stringCryptor};return this._changeData.updateUsedRef(C),this._writer.writeIndirectObject(F,e),C}writeImageXObject=e=>{const C=e.sMask;if(this.isNew(C)){const F=this.writeIndirectObject(C);e.SMask=ObjectId.fromRef(F)}else C.edited&&this.writeUpdatedIndirectObject(C);return this.isNew(e)?this.writeIndirectObject(e):e.edited?this.writeUpdatedIndirectObject(e):{id:e.id,generation:e.generation,byteOffset:this._refData.getOffset(e.id)}};writeFormXObject(e){const C=e.Resources;return C&&C.edited&&([...C.getXObjects()].forEach(([F,$])=>{$ instanceof ImageStream?this.writeImageXObject($):$ instanceof XFormStream&&this.writeFormXObject($)}),[...C.getFonts()].forEach(([F,$])=>{$.encoding&&this.isNew($.encoding)&&this.writeIndirectObject($.encoding),$.descriptor&&this.isNew($.descriptor)&&this.writeIndirectObject($.descriptor),this.isNew($)?this.writeIndirectObject($):$.edited&&this.writeUpdatedIndirectObject($)})),this.isNew(e)?this.writeIndirectObject(e):e.edited?this.writeUpdatedIndirectObject(e):{id:e.id,generation:e.generation,byteOffset:this._refData.getOffset(e.id)}}writeXref(){const e=this._writer.offset,C=this._changeData.exportEntries(),F=this._lastXref.createUpdate(C,e);if(this._lastXref instanceof XRefStream){const $=this._changeData.takeFreeRef(e,!0);this._writer.writeIndirectObject({ref:$},F)}else this._writer.writeBytes(F.toArray());return this._writer.writeEof(e),e}}class Base{static create(...e){return new this(...e)}mixIn(e){return Object.assign(this,e)}clone(){const e=new this.constructor;return Object.assign(e,this),e}}class WordArray extends Base{constructor(e=[],C=e.length*4){super();let F=e;if(F instanceof ArrayBuffer&&(F=new Uint8Array(F)),(F instanceof Int8Array||F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)&&(F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength)),F instanceof Uint8Array){const $=F.byteLength,Y=[];for(let V=0;V<$;V+=1)Y[V>>>2]|=F[V]<<24-V%4*8;this.words=Y,this.sigBytes=$}else this.words=e,this.sigBytes=C}static random(e){const C=[],F=$=>{let Y=$,V=987654321;const te=4294967295;return()=>{V=36969*(V&65535)+(V>>16)&te,Y=18e3*(Y&65535)+(Y>>16)&te;let se=(V<<16)+Y&te;return se/=4294967296,se+=.5,se*(Math.random()>.5?1:-1)}};for(let $=0,Y;$<e;$+=4){const V=F((Y||Math.random())*4294967296);Y=V()*987654071,C.push(V()*4294967296|0)}return new WordArray(C,e)}toString(e=Hex){return e.stringify(this)}concat(e){const C=this.words,F=e.words,$=this.sigBytes,Y=e.sigBytes;if(this.clamp(),$%4)for(let V=0;V<Y;V+=1){const te=F[V>>>2]>>>24-V%4*8&255;C[$+V>>>2]|=te<<24-($+V)%4*8}else for(let V=0;V<Y;V+=4)C[$+V>>>2]=F[V>>>2];return this.sigBytes+=Y,this}clamp(){const{words:e,sigBytes:C}=this;e[C>>>2]&=4294967295<<32-C%4*8,e.length=Math.ceil(C/4)}clone(){const e=super.clone.call(this);return e.words=this.words.slice(0),e}}const Hex={stringify(J){const{words:e,sigBytes:C}=J,F=[];for(let $=0;$<C;$+=1){const Y=e[$>>>2]>>>24-$%4*8&255;F.push((Y>>>4).toString(16)),F.push((Y&15).toString(16))}return F.join("")},parse(J){const e=J.length,C=[];for(let F=0;F<e;F+=2)C[F>>>3]|=parseInt(J.substr(F,2),16)<<24-F%8*4;return new WordArray(C,e/2)}},Latin1={stringify(J){const{words:e,sigBytes:C}=J,F=[];for(let $=0;$<C;$+=1){const Y=e[$>>>2]>>>24-$%4*8&255;F.push(String.fromCharCode(Y))}return F.join("")},parse(J){const e=J.length,C=[];for(let F=0;F<e;F+=1)C[F>>>2]|=(J.charCodeAt(F)&255)<<24-F%4*8;return new WordArray(C,e)}},Utf8={stringify(J){try{return decodeURIComponent(escape(Latin1.stringify(J)))}catch{throw new Error("Malformed UTF-8 data")}},parse(J){return Latin1.parse(unescape(encodeURIComponent(J)))}};class BufferedBlockAlgorithm extends Base{constructor(){super(),this._minBufferSize=0}reset(){this._data=new WordArray,this._nDataBytes=0}_append(e){let C=e;typeof C=="string"&&(C=Utf8.parse(C)),this._data.concat(C),this._nDataBytes+=C.sigBytes}_process(e){let C;const{_data:F,blockSize:$}=this,Y=F.words,V=F.sigBytes,te=$*4;let se=V/te;e?se=Math.ceil(se):se=Math.max((se|0)-this._minBufferSize,0);const ne=se*$,ee=Math.min(ne*4,V);if(ne){for(let ie=0;ie<ne;ie+=$)this._doProcessBlock(Y,ie);C=Y.splice(0,ne),F.sigBytes-=ee}return new WordArray(C,ee)}clone(){const e=super.clone.call(this);return e._data=this._data.clone(),e}}class Hasher extends BufferedBlockAlgorithm{constructor(e){super(),this.blockSize=512/32,this.cfg=Object.assign(new Base,e),this.reset()}static _createHelper(e){return(C,F)=>new e(F).finalize(C)}static _createHmacHelper(e){return(C,F)=>new HMAC(e,F).finalize(C)}reset(){super.reset.call(this),this._doReset()}update(e){return this._append(e),this._process(),this}finalize(e){return e&&this._append(e),this._doFinalize()}}class HMAC extends Base{constructor(e,C){super();const F=new e;this._hasher=F;let $=C;typeof $=="string"&&($=Utf8.parse($));const Y=F.blockSize,V=Y*4;$.sigBytes>V&&($=F.finalize(C)),$.clamp();const te=$.clone();this._oKey=te;const se=$.clone();this._iKey=se;const ne=te.words,ee=se.words;for(let ie=0;ie<Y;ie+=1)ne[ie]^=1549556828,ee[ie]^=909522486;te.sigBytes=V,se.sigBytes=V,this.reset()}reset(){const e=this._hasher;e.reset(),e.update(this._iKey)}update(e){return this._hasher.update(e),this}finalize(e){const C=this._hasher,F=C.finalize(e);return C.reset(),C.finalize(this._oKey.clone().concat(F))}}const X32WordArray=WordArray;class X64Word extends Base{constructor(e,C){super(),this.high=e,this.low=C}}class X64WordArray extends Base{constructor(e=[],C=e.length*8){super(),this.words=e,this.sigBytes=C}toX32(){const e=this.words,C=e.length,F=[];for(let $=0;$<C;$+=1){const Y=e[$];F.push(Y.high),F.push(Y.low)}return X32WordArray.create(F,this.sigBytes)}clone(){const e=super.clone.call(this);e.words=this.words.slice(0);const{words:C}=e,F=C.length;for(let $=0;$<F;$+=1)C[$]=C[$].clone();return e}}const parseLoop=(J,e,C)=>{const F=[];let $=0;for(let Y=0;Y<e;Y+=1)if(Y%4){const V=C[J.charCodeAt(Y-1)]<<Y%4*2,te=C[J.charCodeAt(Y)]>>>6-Y%4*2,se=V|te;F[$>>>2]|=se<<24-$%4*8,$+=1}return WordArray.create(F,$)},Base64={stringify(J){const{words:e,sigBytes:C}=J,F=this._map;J.clamp();const $=[];for(let V=0;V<C;V+=3){const te=e[V>>>2]>>>24-V%4*8&255,se=e[V+1>>>2]>>>24-(V+1)%4*8&255,ne=e[V+2>>>2]>>>24-(V+2)%4*8&255,ee=te<<16|se<<8|ne;for(let ie=0;ie<4&&V+ie*.75<C;ie+=1)$.push(F.charAt(ee>>>6*(3-ie)&63))}const Y=F.charAt(64);if(Y)for(;$.length%4;)$.push(Y);return $.join("")},parse(J){let e=J.length;const C=this._map;let F=this._reverseMap;if(!F){this._reverseMap=[],F=this._reverseMap;for(let Y=0;Y<C.length;Y+=1)F[C.charCodeAt(Y)]=Y}const $=C.charAt(64);if($){const Y=J.indexOf($);Y!==-1&&(e=Y)}return parseLoop(J,e,F)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},T$1=[];for(let J=0;J<64;J+=1)T$1[J]=Math.abs(Math.sin(J+1))*4294967296|0;const FF=(J,e,C,F,$,Y,V)=>{const te=J+(e&C|~e&F)+$+V;return(te<<Y|te>>>32-Y)+e},GG=(J,e,C,F,$,Y,V)=>{const te=J+(e&F|C&~F)+$+V;return(te<<Y|te>>>32-Y)+e},HH=(J,e,C,F,$,Y,V)=>{const te=J+(e^C^F)+$+V;return(te<<Y|te>>>32-Y)+e},II=(J,e,C,F,$,Y,V)=>{const te=J+(C^(e|~F))+$+V;return(te<<Y|te>>>32-Y)+e};class MD5Algo extends Hasher{_doReset(){this._hash=new WordArray([1732584193,4023233417,2562383102,271733878])}_doProcessBlock(e,C){const F=e;for(let we=0;we<16;we+=1){const Te=C+we,Me=e[Te];F[Te]=(Me<<8|Me>>>24)&16711935|(Me<<24|Me>>>8)&4278255360}const $=this._hash.words,Y=F[C+0],V=F[C+1],te=F[C+2],se=F[C+3],ne=F[C+4],ee=F[C+5],ie=F[C+6],ae=F[C+7],re=F[C+8],oe=F[C+9],ce=F[C+10],he=F[C+11],de=F[C+12],pe=F[C+13],fe=F[C+14],ye=F[C+15];let _e=$[0],Ee=$[1],be=$[2],Ae=$[3];_e=FF(_e,Ee,be,Ae,Y,7,T$1[0]),Ae=FF(Ae,_e,Ee,be,V,12,T$1[1]),be=FF(be,Ae,_e,Ee,te,17,T$1[2]),Ee=FF(Ee,be,Ae,_e,se,22,T$1[3]),_e=FF(_e,Ee,be,Ae,ne,7,T$1[4]),Ae=FF(Ae,_e,Ee,be,ee,12,T$1[5]),be=FF(be,Ae,_e,Ee,ie,17,T$1[6]),Ee=FF(Ee,be,Ae,_e,ae,22,T$1[7]),_e=FF(_e,Ee,be,Ae,re,7,T$1[8]),Ae=FF(Ae,_e,Ee,be,oe,12,T$1[9]),be=FF(be,Ae,_e,Ee,ce,17,T$1[10]),Ee=FF(Ee,be,Ae,_e,he,22,T$1[11]),_e=FF(_e,Ee,be,Ae,de,7,T$1[12]),Ae=FF(Ae,_e,Ee,be,pe,12,T$1[13]),be=FF(be,Ae,_e,Ee,fe,17,T$1[14]),Ee=FF(Ee,be,Ae,_e,ye,22,T$1[15]),_e=GG(_e,Ee,be,Ae,V,5,T$1[16]),Ae=GG(Ae,_e,Ee,be,ie,9,T$1[17]),be=GG(be,Ae,_e,Ee,he,14,T$1[18]),Ee=GG(Ee,be,Ae,_e,Y,20,T$1[19]),_e=GG(_e,Ee,be,Ae,ee,5,T$1[20]),Ae=GG(Ae,_e,Ee,be,ce,9,T$1[21]),be=GG(be,Ae,_e,Ee,ye,14,T$1[22]),Ee=GG(Ee,be,Ae,_e,ne,20,T$1[23]),_e=GG(_e,Ee,be,Ae,oe,5,T$1[24]),Ae=GG(Ae,_e,Ee,be,fe,9,T$1[25]),be=GG(be,Ae,_e,Ee,se,14,T$1[26]),Ee=GG(Ee,be,Ae,_e,re,20,T$1[27]),_e=GG(_e,Ee,be,Ae,pe,5,T$1[28]),Ae=GG(Ae,_e,Ee,be,te,9,T$1[29]),be=GG(be,Ae,_e,Ee,ae,14,T$1[30]),Ee=GG(Ee,be,Ae,_e,de,20,T$1[31]),_e=HH(_e,Ee,be,Ae,ee,4,T$1[32]),Ae=HH(Ae,_e,Ee,be,re,11,T$1[33]),be=HH(be,Ae,_e,Ee,he,16,T$1[34]),Ee=HH(Ee,be,Ae,_e,fe,23,T$1[35]),_e=HH(_e,Ee,be,Ae,V,4,T$1[36]),Ae=HH(Ae,_e,Ee,be,ne,11,T$1[37]),be=HH(be,Ae,_e,Ee,ae,16,T$1[38]),Ee=HH(Ee,be,Ae,_e,ce,23,T$1[39]),_e=HH(_e,Ee,be,Ae,pe,4,T$1[40]),Ae=HH(Ae,_e,Ee,be,Y,11,T$1[41]),be=HH(be,Ae,_e,Ee,se,16,T$1[42]),Ee=HH(Ee,be,Ae,_e,ie,23,T$1[43]),_e=HH(_e,Ee,be,Ae,oe,4,T$1[44]),Ae=HH(Ae,_e,Ee,be,de,11,T$1[45]),be=HH(be,Ae,_e,Ee,ye,16,T$1[46]),Ee=HH(Ee,be,Ae,_e,te,23,T$1[47]),_e=II(_e,Ee,be,Ae,Y,6,T$1[48]),Ae=II(Ae,_e,Ee,be,ae,10,T$1[49]),be=II(be,Ae,_e,Ee,fe,15,T$1[50]),Ee=II(Ee,be,Ae,_e,ee,21,T$1[51]),_e=II(_e,Ee,be,Ae,de,6,T$1[52]),Ae=II(Ae,_e,Ee,be,se,10,T$1[53]),be=II(be,Ae,_e,Ee,ce,15,T$1[54]),Ee=II(Ee,be,Ae,_e,V,21,T$1[55]),_e=II(_e,Ee,be,Ae,re,6,T$1[56]),Ae=II(Ae,_e,Ee,be,ye,10,T$1[57]),be=II(be,Ae,_e,Ee,ie,15,T$1[58]),Ee=II(Ee,be,Ae,_e,pe,21,T$1[59]),_e=II(_e,Ee,be,Ae,ne,6,T$1[60]),Ae=II(Ae,_e,Ee,be,he,10,T$1[61]),be=II(be,Ae,_e,Ee,te,15,T$1[62]),Ee=II(Ee,be,Ae,_e,oe,21,T$1[63]),$[0]=$[0]+_e|0,$[1]=$[1]+Ee|0,$[2]=$[2]+be|0,$[3]=$[3]+Ae|0}_doFinalize(){const e=this._data,C=e.words,F=this._nDataBytes*8,$=e.sigBytes*8;C[$>>>5]|=128<<24-$%32;const Y=Math.floor(F/4294967296),V=F;C[($+64>>>9<<4)+15]=(Y<<8|Y>>>24)&16711935|(Y<<24|Y>>>8)&4278255360,C[($+64>>>9<<4)+14]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,e.sigBytes=(C.length+1)*4,this._process();const te=this._hash,se=te.words;for(let ne=0;ne<4;ne+=1){const ee=se[ne];se[ne]=(ee<<8|ee>>>24)&16711935|(ee<<24|ee>>>8)&4278255360}return te}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}const MD5=Hasher._createHelper(MD5Algo),HmacMD5=Hasher._createHmacHelper(MD5Algo);class EvpKDFAlgo extends Base{constructor(e){super(),this.cfg=Object.assign(new Base,{keySize:128/32,hasher:MD5Algo,iterations:1},e)}compute(e,C){let F;const{cfg:$}=this,Y=$.hasher.create(),V=WordArray.create(),te=V.words,{keySize:se,iterations:ne}=$;for(;te.length<se;){F&&Y.update(F),F=Y.update(e).finalize(C),Y.reset();for(let ee=1;ee<ne;ee+=1)F=Y.finalize(F),Y.reset();V.concat(F)}return V.sigBytes=se*4,V}}const EvpKDF=(J,e,C)=>EvpKDFAlgo.create(C).compute(J,e);class Cipher extends BufferedBlockAlgorithm{constructor(e,C,F){super(),this.cfg=Object.assign(new Base,F),this._xformMode=e,this._key=C,this.reset()}static createEncryptor(e,C){return this.create(this._ENC_XFORM_MODE,e,C)}static createDecryptor(e,C){return this.create(this._DEC_XFORM_MODE,e,C)}static _createHelper(e){const C=F=>typeof F=="string"?PasswordBasedCipher:SerializableCipher;return{encrypt(F,$,Y){return C($).encrypt(e,F,$,Y)},decrypt(F,$,Y){return C($).decrypt(e,F,$,Y)}}}reset(){super.reset.call(this),this._doReset()}process(e){return this._append(e),this._process()}finalize(e){return e&&this._append(e),this._doFinalize()}}Cipher._ENC_XFORM_MODE=1;Cipher._DEC_XFORM_MODE=2;Cipher.keySize=128/32;Cipher.ivSize=128/32;class StreamCipher extends Cipher{constructor(...e){super(...e),this.blockSize=1}_doFinalize(){return this._process(!0)}}class BlockCipherMode extends Base{constructor(e,C){super(),this._cipher=e,this._iv=C}static createEncryptor(e,C){return this.Encryptor.create(e,C)}static createDecryptor(e,C){return this.Decryptor.create(e,C)}}function xorBlock(J,e,C){const F=J;let $;const Y=this._iv;Y?($=Y,this._iv=void 0):$=this._prevBlock;for(let V=0;V<C;V+=1)F[e+V]^=$[V]}class CBC extends BlockCipherMode{}CBC.Encryptor=class extends CBC{processBlock(J,e){const C=this._cipher,{blockSize:F}=C;xorBlock.call(this,J,e,F),C.encryptBlock(J,e),this._prevBlock=J.slice(e,e+F)}};CBC.Decryptor=class extends CBC{processBlock(J,e){const C=this._cipher,{blockSize:F}=C,$=J.slice(e,e+F);C.decryptBlock(J,e),xorBlock.call(this,J,e,F),this._prevBlock=$}};const Pkcs7={pad(J,e){const C=e*4,F=C-J.sigBytes%C,$=F<<24|F<<16|F<<8|F,Y=[];for(let te=0;te<F;te+=4)Y.push($);const V=WordArray.create(Y,F);J.concat(V)},unpad(J){const e=J,C=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=C}};class BlockCipher extends Cipher{constructor(e,C,F){super(e,C,Object.assign({mode:CBC,padding:Pkcs7},F)),this.blockSize=128/32}reset(){let e;super.reset.call(this);const{cfg:C}=this,{iv:F,mode:$}=C;this._xformMode===this.constructor._ENC_XFORM_MODE?e=$.createEncryptor:(e=$.createDecryptor,this._minBufferSize=1),this._mode=e.call($,this,F&&F.words),this._mode.__creator=e}_doProcessBlock(e,C){this._mode.processBlock(e,C)}_doFinalize(){let e;const{padding:C}=this.cfg;return this._xformMode===this.constructor._ENC_XFORM_MODE?(C.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),C.unpad(e)),e}}class CipherParams extends Base{constructor(e){super(),this.mixIn(e)}toString(e){return(e||this.formatter).stringify(this)}}const OpenSSLFormatter={stringify(J){let e;const{ciphertext:C,salt:F}=J;return F?e=WordArray.create([1398893684,1701076831]).concat(F).concat(C):e=C,e.toString(Base64)},parse(J){let e;const C=Base64.parse(J),F=C.words;return F[0]===1398893684&&F[1]===1701076831&&(e=WordArray.create(F.slice(2,4)),F.splice(0,4),C.sigBytes-=16),CipherParams.create({ciphertext:C,salt:e})}};class SerializableCipher extends Base{static encrypt(e,C,F,$){const Y=Object.assign(new Base,this.cfg,$),V=e.createEncryptor(F,Y),te=V.finalize(C),se=V.cfg;return CipherParams.create({ciphertext:te,key:F,iv:se.iv,algorithm:e,mode:se.mode,padding:se.padding,blockSize:V.blockSize,formatter:Y.format})}static decrypt(e,C,F,$){let Y=C;const V=Object.assign(new Base,this.cfg,$);return Y=this._parse(Y,V.format),e.createDecryptor(F,V).finalize(Y.ciphertext)}static _parse(e,C){return typeof e=="string"?C.parse(e,this):e}}SerializableCipher.cfg=Object.assign(new Base,{format:OpenSSLFormatter});const OpenSSLKdf={execute(J,e,C,F){let $=F;$||($=WordArray.random(64/8));const Y=EvpKDFAlgo.create({keySize:e+C}).compute(J,$),V=WordArray.create(Y.words.slice(e),C*4);return Y.sigBytes=e*4,CipherParams.create({key:Y,iv:V,salt:$})}};class PasswordBasedCipher extends SerializableCipher{static encrypt(e,C,F,$){const Y=Object.assign(new Base,this.cfg,$),V=Y.kdf.execute(F,e.keySize,e.ivSize);Y.iv=V.iv;const te=SerializableCipher.encrypt.call(this,e,C,V.key,Y);return te.mixIn(V),te}static decrypt(e,C,F,$){let Y=C;const V=Object.assign(new Base,this.cfg,$);Y=this._parse(Y,V.format);const te=V.kdf.execute(F,e.keySize,e.ivSize,Y.salt);return V.iv=te.iv,SerializableCipher.decrypt.call(this,e,Y,te.key,V)}}PasswordBasedCipher.cfg=Object.assign(SerializableCipher.cfg,{kdf:OpenSSLKdf});const swapEndian=J=>J<<8&4278255360|J>>>8&16711935,Utf16BE={stringify(J){const{words:e,sigBytes:C}=J,F=[];for(let $=0;$<C;$+=2){const Y=e[$>>>2]>>>16-$%4*8&65535;F.push(String.fromCharCode(Y))}return F.join("")},parse(J){const e=J.length,C=[];for(let F=0;F<e;F+=1)C[F>>>1]|=J.charCodeAt(F)<<16-F%2*16;return WordArray.create(C,e*2)}},Utf16=Utf16BE,Utf16LE={stringify(J){const{words:e,sigBytes:C}=J,F=[];for(let $=0;$<C;$+=2){const Y=swapEndian(e[$>>>2]>>>16-$%4*8&65535);F.push(String.fromCharCode(Y))}return F.join("")},parse(J){const e=J.length,C=[];for(let F=0;F<e;F+=1)C[F>>>1]|=swapEndian(J.charCodeAt(F)<<16-F%2*16);return WordArray.create(C,e*2)}},W$2=[];class SHA1Algo extends Hasher{_doReset(){this._hash=new WordArray([1732584193,4023233417,2562383102,271733878,3285377520])}_doProcessBlock(e,C){const F=this._hash.words;let $=F[0],Y=F[1],V=F[2],te=F[3],se=F[4];for(let ne=0;ne<80;ne+=1){if(ne<16)W$2[ne]=e[C+ne]|0;else{const ie=W$2[ne-3]^W$2[ne-8]^W$2[ne-14]^W$2[ne-16];W$2[ne]=ie<<1|ie>>>31}let ee=($<<5|$>>>27)+se+W$2[ne];ne<20?ee+=(Y&V|~Y&te)+1518500249:ne<40?ee+=(Y^V^te)+1859775393:ne<60?ee+=(Y&V|Y&te|V&te)-1894007588:ee+=(Y^V^te)-899497514,se=te,te=V,V=Y<<30|Y>>>2,Y=$,$=ee}F[0]=F[0]+$|0,F[1]=F[1]+Y|0,F[2]=F[2]+V|0,F[3]=F[3]+te|0,F[4]=F[4]+se|0}_doFinalize(){const e=this._data,C=e.words,F=this._nDataBytes*8,$=e.sigBytes*8;return C[$>>>5]|=128<<24-$%32,C[($+64>>>9<<4)+14]=Math.floor(F/4294967296),C[($+64>>>9<<4)+15]=F,e.sigBytes=C.length*4,this._process(),this._hash}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}const SHA1=Hasher._createHelper(SHA1Algo),HmacSHA1=Hasher._createHmacHelper(SHA1Algo),H=[],K$1=[],isPrime=J=>{const e=Math.sqrt(J);for(let C=2;C<=e;C+=1)if(!(J%C))return!1;return!0},getFractionalBits=J=>(J-(J|0))*4294967296|0;let n=2,nPrime=0;for(;nPrime<64;)isPrime(n)&&(nPrime<8&&(H[nPrime]=getFractionalBits(n**(1/2))),K$1[nPrime]=getFractionalBits(n**(1/3)),nPrime+=1),n+=1;const W$1=[];class SHA256Algo extends Hasher{_doReset(){this._hash=new WordArray(H.slice(0))}_doProcessBlock(e,C){const F=this._hash.words;let $=F[0],Y=F[1],V=F[2],te=F[3],se=F[4],ne=F[5],ee=F[6],ie=F[7];for(let ae=0;ae<64;ae+=1){if(ae<16)W$1[ae]=e[C+ae]|0;else{const fe=W$1[ae-15],ye=(fe<<25|fe>>>7)^(fe<<14|fe>>>18)^fe>>>3,_e=W$1[ae-2],Ee=(_e<<15|_e>>>17)^(_e<<13|_e>>>19)^_e>>>10;W$1[ae]=ye+W$1[ae-7]+Ee+W$1[ae-16]}const re=se&ne^~se&ee,oe=$&Y^$&V^Y&V,ce=($<<30|$>>>2)^($<<19|$>>>13)^($<<10|$>>>22),he=(se<<26|se>>>6)^(se<<21|se>>>11)^(se<<7|se>>>25),de=ie+he+re+K$1[ae]+W$1[ae],pe=ce+oe;ie=ee,ee=ne,ne=se,se=te+de|0,te=V,V=Y,Y=$,$=de+pe|0}F[0]=F[0]+$|0,F[1]=F[1]+Y|0,F[2]=F[2]+V|0,F[3]=F[3]+te|0,F[4]=F[4]+se|0,F[5]=F[5]+ne|0,F[6]=F[6]+ee|0,F[7]=F[7]+ie|0}_doFinalize(){const e=this._data,C=e.words,F=this._nDataBytes*8,$=e.sigBytes*8;return C[$>>>5]|=128<<24-$%32,C[($+64>>>9<<4)+14]=Math.floor(F/4294967296),C[($+64>>>9<<4)+15]=F,e.sigBytes=C.length*4,this._process(),this._hash}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}const SHA256=Hasher._createHelper(SHA256Algo),HmacSHA256=Hasher._createHmacHelper(SHA256Algo);class SHA224Algo extends SHA256Algo{_doReset(){this._hash=new WordArray([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])}_doFinalize(){const e=super._doFinalize.call(this);return e.sigBytes-=4,e}}const SHA224=SHA256Algo._createHelper(SHA224Algo),HmacSHA224=SHA256Algo._createHmacHelper(SHA224Algo),K=[new X64Word(1116352408,3609767458),new X64Word(1899447441,602891725),new X64Word(3049323471,3964484399),new X64Word(3921009573,2173295548),new X64Word(961987163,4081628472),new X64Word(1508970993,3053834265),new X64Word(2453635748,2937671579),new X64Word(2870763221,3664609560),new X64Word(3624381080,2734883394),new X64Word(310598401,1164996542),new X64Word(607225278,1323610764),new X64Word(1426881987,3590304994),new X64Word(1925078388,4068182383),new X64Word(2162078206,991336113),new X64Word(2614888103,633803317),new X64Word(3248222580,3479774868),new X64Word(3835390401,2666613458),new X64Word(4022224774,944711139),new X64Word(264347078,2341262773),new X64Word(604807628,2007800933),new X64Word(770255983,1495990901),new X64Word(1249150122,1856431235),new X64Word(1555081692,3175218132),new X64Word(1996064986,2198950837),new X64Word(2554220882,3999719339),new X64Word(2821834349,766784016),new X64Word(2952996808,2566594879),new X64Word(3210313671,3203337956),new X64Word(3336571891,1034457026),new X64Word(3584528711,2466948901),new X64Word(113926993,3758326383),new X64Word(338241895,168717936),new X64Word(666307205,1188179964),new X64Word(773529912,1546045734),new X64Word(1294757372,1522805485),new X64Word(1396182291,2643833823),new X64Word(1695183700,2343527390),new X64Word(1986661051,1014477480),new X64Word(2177026350,1206759142),new X64Word(2456956037,344077627),new X64Word(2730485921,1290863460),new X64Word(2820302411,3158454273),new X64Word(3259730800,3505952657),new X64Word(3345764771,106217008),new X64Word(3516065817,3606008344),new X64Word(3600352804,1432725776),new X64Word(4094571909,1467031594),new X64Word(275423344,851169720),new X64Word(430227734,3100823752),new X64Word(506948616,1363258195),new X64Word(659060556,3750685593),new X64Word(883997877,3785050280),new X64Word(958139571,3318307427),new X64Word(1322822218,3812723403),new X64Word(1537002063,2003034995),new X64Word(1747873779,3602036899),new X64Word(1955562222,1575990012),new X64Word(2024104815,1125592928),new X64Word(2227730452,2716904306),new X64Word(2361852424,442776044),new X64Word(2428436474,593698344),new X64Word(2756734187,3733110249),new X64Word(3204031479,2999351573),new X64Word(3329325298,3815920427),new X64Word(3391569614,3928383900),new X64Word(3515267271,566280711),new X64Word(3940187606,3454069534),new X64Word(4118630271,4000239992),new X64Word(116418474,1914138554),new X64Word(174292421,2731055270),new X64Word(289380356,3203993006),new X64Word(460393269,320620315),new X64Word(685471733,587496836),new X64Word(852142971,1086792851),new X64Word(1017036298,365543100),new X64Word(1126000580,2618297676),new X64Word(1288033470,3409855158),new X64Word(1501505948,4234509866),new X64Word(1607167915,987167468),new X64Word(1816402316,1246189591)],W=[];for(let J=0;J<80;J+=1)W[J]=new X64Word;class SHA512Algo extends Hasher{constructor(){super(),this.blockSize=1024/32}_doReset(){this._hash=new X64WordArray([new X64Word(1779033703,4089235720),new X64Word(3144134277,2227873595),new X64Word(1013904242,4271175723),new X64Word(2773480762,1595750129),new X64Word(1359893119,2917565137),new X64Word(2600822924,725511199),new X64Word(528734635,4215389547),new X64Word(1541459225,327033209)])}_doProcessBlock(e,C){const F=this._hash.words,$=F[0],Y=F[1],V=F[2],te=F[3],se=F[4],ne=F[5],ee=F[6],ie=F[7],ae=$.high;let re=$.low;const oe=Y.high;let ce=Y.low;const he=V.high;let de=V.low;const pe=te.high;let fe=te.low;const ye=se.high;let _e=se.low;const Ee=ne.high;let be=ne.low;const Ae=ee.high;let we=ee.low;const Te=ie.high;let Me=ie.low,Be=ae,$e=re,Fe=oe,Xe=ce,We=he,Ie=de,Oe=pe,Pe=fe,ge=ye,ue=_e,xe=Ee,ve=be,le=Ae,me=we,Ce=Te,Se=Me;for(let Re=0;Re<80;Re+=1){let ke,De;const Ne=W[Re];if(Re<16)Ne.high=e[C+Re*2]|0,De=Ne.high,Ne.low=e[C+Re*2+1]|0,ke=Ne.low;else{const gt=W[Re-15],ot=gt.high,mt=gt.low,ht=(ot>>>1|mt<<31)^(ot>>>8|mt<<24)^ot>>>7,pt=(mt>>>1|ot<<31)^(mt>>>8|ot<<24)^(mt>>>7|ot<<25),wt=W[Re-2],yt=wt.high,qe=wt.low,He=(yt>>>19|qe<<13)^(yt<<3|qe>>>29)^yt>>>6,Ue=(qe>>>19|yt<<13)^(qe<<3|yt>>>29)^(qe>>>6|yt<<26),Qe=W[Re-7],st=Qe.high,ct=Qe.low,at=W[Re-16],_t=at.high,At=at.low;ke=pt+ct,De=ht+st+(ke>>>0<pt>>>0?1:0),ke+=Ue,De=De+He+(ke>>>0<Ue>>>0?1:0),ke+=At,De=De+_t+(ke>>>0<At>>>0?1:0),Ne.high=De,Ne.low=ke}const Ge=ge&xe^~ge&le,Le=ue&ve^~ue&me,ze=Be&Fe^Be&We^Fe&We,Ve=$e&Xe^$e&Ie^Xe&Ie,je=(Be>>>28|$e<<4)^(Be<<30|$e>>>2)^(Be<<25|$e>>>7),Ke=($e>>>28|Be<<4)^($e<<30|Be>>>2)^($e<<25|Be>>>7),Ye=(ge>>>14|ue<<18)^(ge>>>18|ue<<14)^(ge<<23|ue>>>9),Ze=(ue>>>14|ge<<18)^(ue>>>18|ge<<14)^(ue<<23|ge>>>9),Je=K[Re],tt=Je.high,nt=Je.low;let et=Se+Ze,it=Ce+Ye+(et>>>0<Se>>>0?1:0);et+=Le,it=it+Ge+(et>>>0<Le>>>0?1:0),et+=nt,it=it+tt+(et>>>0<nt>>>0?1:0),et+=ke,it=it+De+(et>>>0<ke>>>0?1:0);const lt=Ke+Ve,rt=je+ze+(lt>>>0<Ke>>>0?1:0);Ce=le,Se=me,le=xe,me=ve,xe=ge,ve=ue,ue=Pe+et|0,ge=Oe+it+(ue>>>0<Pe>>>0?1:0)|0,Oe=We,Pe=Ie,We=Fe,Ie=Xe,Fe=Be,Xe=$e,$e=et+lt|0,Be=it+rt+($e>>>0<et>>>0?1:0)|0}$.low=re+$e,re=$.low,$.high=ae+Be+(re>>>0<$e>>>0?1:0),Y.low=ce+Xe,ce=Y.low,Y.high=oe+Fe+(ce>>>0<Xe>>>0?1:0),V.low=de+Ie,de=V.low,V.high=he+We+(de>>>0<Ie>>>0?1:0),te.low=fe+Pe,fe=te.low,te.high=pe+Oe+(fe>>>0<Pe>>>0?1:0),se.low=_e+ue,_e=se.low,se.high=ye+ge+(_e>>>0<ue>>>0?1:0),ne.low=be+ve,be=ne.low,ne.high=Ee+xe+(be>>>0<ve>>>0?1:0),ee.low=we+me,we=ee.low,ee.high=Ae+le+(we>>>0<me>>>0?1:0),ie.low=Me+Se,Me=ie.low,ie.high=Te+Ce+(Me>>>0<Se>>>0?1:0)}_doFinalize(){const e=this._data,C=e.words,F=this._nDataBytes*8,$=e.sigBytes*8;return C[$>>>5]|=128<<24-$%32,C[($+128>>>10<<5)+30]=Math.floor(F/4294967296),C[($+128>>>10<<5)+31]=F,e.sigBytes=C.length*4,this._process(),this._hash.toX32()}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}const SHA512=Hasher._createHelper(SHA512Algo),HmacSHA512=Hasher._createHmacHelper(SHA512Algo);class SHA384Algo extends SHA512Algo{_doReset(){this._hash=new X64WordArray([new X64Word(3418070365,3238371032),new X64Word(1654270250,914150663),new X64Word(2438529370,812702999),new X64Word(355462360,4144912697),new X64Word(1731405415,4290775857),new X64Word(2394180231,1750603025),new X64Word(3675008525,1694076839),new X64Word(1203062813,3204075428)])}_doFinalize(){const e=super._doFinalize.call(this);return e.sigBytes-=16,e}}const SHA384=SHA512Algo._createHelper(SHA384Algo),HmacSHA384=SHA512Algo._createHmacHelper(SHA384Algo),RHO_OFFSETS=[],PI_INDEXES=[],ROUND_CONSTANTS=[];let _x=1,_y=0;for(let J=0;J<24;J+=1){RHO_OFFSETS[_x+5*_y]=(J+1)*(J+2)/2%64;const e=_y%5,C=(2*_x+3*_y)%5;_x=e,_y=C}for(let J=0;J<5;J+=1)for(let e=0;e<5;e+=1)PI_INDEXES[J+5*e]=e+(2*J+3*e)%5*5;let LFSR=1;for(let J=0;J<24;J+=1){let e=0,C=0;for(let F=0;F<7;F+=1){if(LFSR&1){const $=(1<<F)-1;$<32?C^=1<<$:e^=1<<$-32}LFSR&128?LFSR=LFSR<<1^113:LFSR<<=1}ROUND_CONSTANTS[J]=X64Word.create(e,C)}const T=[];for(let J=0;J<25;J+=1)T[J]=X64Word.create();class SHA3Algo extends Hasher{constructor(e){super(Object.assign({outputLength:512},e))}_doReset(){this._state=[];const e=this._state;for(let C=0;C<25;C+=1)e[C]=new X64Word;this.blockSize=(1600-2*this.cfg.outputLength)/32}_doProcessBlock(e,C){const F=this._state,$=this.blockSize/2;for(let Y=0;Y<$;Y+=1){let V=e[C+2*Y],te=e[C+2*Y+1];V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,te=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360;const se=F[Y];se.high^=te,se.low^=V}for(let Y=0;Y<24;Y+=1){for(let ee=0;ee<5;ee+=1){let ie=0,ae=0;for(let oe=0;oe<5;oe+=1){const ce=F[ee+5*oe];ie^=ce.high,ae^=ce.low}const re=T[ee];re.high=ie,re.low=ae}for(let ee=0;ee<5;ee+=1){const ie=T[(ee+4)%5],ae=T[(ee+1)%5],re=ae.high,oe=ae.low,ce=ie.high^(re<<1|oe>>>31),he=ie.low^(oe<<1|re>>>31);for(let de=0;de<5;de+=1){const pe=F[ee+5*de];pe.high^=ce,pe.low^=he}}for(let ee=1;ee<25;ee+=1){let ie,ae;const re=F[ee],oe=re.high,ce=re.low,he=RHO_OFFSETS[ee];he<32?(ie=oe<<he|ce>>>32-he,ae=ce<<he|oe>>>32-he):(ie=ce<<he-32|oe>>>64-he,ae=oe<<he-32|ce>>>64-he);const de=T[PI_INDEXES[ee]];de.high=ie,de.low=ae}const V=T[0],te=F[0];V.high=te.high,V.low=te.low;for(let ee=0;ee<5;ee+=1)for(let ie=0;ie<5;ie+=1){const ae=ee+5*ie,re=F[ae],oe=T[ae],ce=T[(ee+1)%5+5*ie],he=T[(ee+2)%5+5*ie];re.high=oe.high^~ce.high&he.high,re.low=oe.low^~ce.low&he.low}const se=F[0],ne=ROUND_CONSTANTS[Y];se.high^=ne.high,se.low^=ne.low}}_doFinalize(){const e=this._data,C=e.words,F=e.sigBytes*8,$=this.blockSize*32;C[F>>>5]|=1<<24-F%32,C[(Math.ceil((F+1)/$)*$>>>5)-1]|=128,e.sigBytes=C.length*4,this._process();const Y=this._state,V=this.cfg.outputLength/8,te=V/8,se=[];for(let ne=0;ne<te;ne+=1){const ee=Y[ne];let ie=ee.high,ae=ee.low;ie=(ie<<8|ie>>>24)&16711935|(ie<<24|ie>>>8)&4278255360,ae=(ae<<8|ae>>>24)&16711935|(ae<<24|ae>>>8)&4278255360,se.push(ae),se.push(ie)}return new WordArray(se,V)}clone(){const e=super.clone.call(this);e._state=this._state.slice(0);const C=e._state;for(let F=0;F<25;F+=1)C[F]=C[F].clone();return e}}const SHA3=Hasher._createHelper(SHA3Algo),HmacSHA3=Hasher._createHmacHelper(SHA3Algo);/** @preserve
(c) 2012 by Cédric Mesnil. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted
provided that the following conditions are met:

    - Redistributions of source code must retain the above copyright notice, this list of
    conditions and the following disclaimer.
    - Redistributions in binary form must reproduce the above copyright notice, this list
    of conditions and the following disclaimer in the documentation and/or other materials
    provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY
WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/const _zl=WordArray.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),_zr=WordArray.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),_sl=WordArray.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),_sr=WordArray.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),_hl=WordArray.create([0,1518500249,1859775393,2400959708,2840853838]),_hr=WordArray.create([1352829926,1548603684,1836072691,2053994217,0]),f1=(J,e,C)=>J^e^C,f2=(J,e,C)=>J&e|~J&C,f3=(J,e,C)=>(J|~e)^C,f4=(J,e,C)=>J&C|e&~C,f5=(J,e,C)=>J^(e|~C),rotl=(J,e)=>J<<e|J>>>32-e;class RIPEMD160Algo extends Hasher{_doReset(){this._hash=WordArray.create([1732584193,4023233417,2562383102,271733878,3285377520])}_doProcessBlock(e,C){const F=e;for(let Ee=0;Ee<16;Ee+=1){const be=C+Ee,Ae=F[be];F[be]=(Ae<<8|Ae>>>24)&16711935|(Ae<<24|Ae>>>8)&4278255360}const $=this._hash.words,Y=_hl.words,V=_hr.words,te=_zl.words,se=_zr.words,ne=_sl.words,ee=_sr.words;let ie=$[0],ae=$[1],re=$[2],oe=$[3],ce=$[4],he=$[0],de=$[1],pe=$[2],fe=$[3],ye=$[4],_e;for(let Ee=0;Ee<80;Ee+=1)_e=ie+F[C+te[Ee]]|0,Ee<16?_e+=f1(ae,re,oe)+Y[0]:Ee<32?_e+=f2(ae,re,oe)+Y[1]:Ee<48?_e+=f3(ae,re,oe)+Y[2]:Ee<64?_e+=f4(ae,re,oe)+Y[3]:_e+=f5(ae,re,oe)+Y[4],_e|=0,_e=rotl(_e,ne[Ee]),_e=_e+ce|0,ie=ce,ce=oe,oe=rotl(re,10),re=ae,ae=_e,_e=he+F[C+se[Ee]]|0,Ee<16?_e+=f5(de,pe,fe)+V[0]:Ee<32?_e+=f4(de,pe,fe)+V[1]:Ee<48?_e+=f3(de,pe,fe)+V[2]:Ee<64?_e+=f2(de,pe,fe)+V[3]:_e+=f1(de,pe,fe)+V[4],_e|=0,_e=rotl(_e,ee[Ee]),_e=_e+ye|0,he=ye,ye=fe,fe=rotl(pe,10),pe=de,de=_e;_e=$[1]+re+fe|0,$[1]=$[2]+oe+ye|0,$[2]=$[3]+ce+he|0,$[3]=$[4]+ie+de|0,$[4]=$[0]+ae+pe|0,$[0]=_e}_doFinalize(){const e=this._data,C=e.words,F=this._nDataBytes*8,$=e.sigBytes*8;C[$>>>5]|=128<<24-$%32,C[($+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,e.sigBytes=(C.length+1)*4,this._process();const Y=this._hash,V=Y.words;for(let te=0;te<5;te+=1){const se=V[te];V[te]=(se<<8|se>>>24)&16711935|(se<<24|se>>>8)&4278255360}return Y}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}const RIPEMD160=Hasher._createHelper(RIPEMD160Algo),HmacRIPEMD160=Hasher._createHmacHelper(RIPEMD160Algo);class PBKDF2Algo extends Base{constructor(e){super(),this.cfg=Object.assign(new Base,{keySize:128/32,hasher:SHA1Algo,iterations:1},e)}compute(e,C){const{cfg:F}=this,$=HMAC.create(F.hasher,e),Y=WordArray.create(),V=WordArray.create([1]),te=Y.words,se=V.words,{keySize:ne,iterations:ee}=F;for(;te.length<ne;){const ie=$.update(C).finalize(V);$.reset();const ae=ie.words,re=ae.length;let oe=ie;for(let ce=1;ce<ee;ce+=1){oe=$.finalize(oe),$.reset();const he=oe.words;for(let de=0;de<re;de+=1)ae[de]^=he[de]}Y.concat(ie),se[0]+=1}return Y.sigBytes=ne*4,Y}}const PBKDF2=(J,e,C)=>PBKDF2Algo.create(C).compute(J,e),_SBOX=[],INV_SBOX=[],_SUB_MIX_0=[],_SUB_MIX_1=[],_SUB_MIX_2=[],_SUB_MIX_3=[],INV_SUB_MIX_0=[],INV_SUB_MIX_1=[],INV_SUB_MIX_2=[],INV_SUB_MIX_3=[],d=[];for(let J=0;J<256;J+=1)J<128?d[J]=J<<1:d[J]=J<<1^283;let x=0,xi=0;for(let J=0;J<256;J+=1){let e=xi^xi<<1^xi<<2^xi<<3^xi<<4;e=e>>>8^e&255^99,_SBOX[x]=e,INV_SBOX[e]=x;const C=d[x],F=d[C],$=d[F];let Y=d[e]*257^e*16843008;_SUB_MIX_0[x]=Y<<24|Y>>>8,_SUB_MIX_1[x]=Y<<16|Y>>>16,_SUB_MIX_2[x]=Y<<8|Y>>>24,_SUB_MIX_3[x]=Y,Y=$*16843009^F*65537^C*257^x*16843008,INV_SUB_MIX_0[e]=Y<<24|Y>>>8,INV_SUB_MIX_1[e]=Y<<16|Y>>>16,INV_SUB_MIX_2[e]=Y<<8|Y>>>24,INV_SUB_MIX_3[e]=Y,x?(x=C^d[d[d[$^C]]],xi^=d[d[xi]]):(xi=1,x=xi)}const RCON=[0,1,2,4,8,16,32,64,128,27,54];class AESAlgo extends BlockCipher{_doReset(){let e;if(this._nRounds&&this._keyPriorReset===this._key)return;this._keyPriorReset=this._key;const C=this._keyPriorReset,F=C.words,$=C.sigBytes/4;this._nRounds=$+6;const V=(this._nRounds+1)*4;this._keySchedule=[];const te=this._keySchedule;for(let ne=0;ne<V;ne+=1)ne<$?te[ne]=F[ne]:(e=te[ne-1],ne%$?$>6&&ne%$===4&&(e=_SBOX[e>>>24]<<24|_SBOX[e>>>16&255]<<16|_SBOX[e>>>8&255]<<8|_SBOX[e&255]):(e=e<<8|e>>>24,e=_SBOX[e>>>24]<<24|_SBOX[e>>>16&255]<<16|_SBOX[e>>>8&255]<<8|_SBOX[e&255],e^=RCON[ne/$|0]<<24),te[ne]=te[ne-$]^e);this._invKeySchedule=[];const se=this._invKeySchedule;for(let ne=0;ne<V;ne+=1){const ee=V-ne;ne%4?e=te[ee]:e=te[ee-4],ne<4||ee<=4?se[ne]=e:se[ne]=INV_SUB_MIX_0[_SBOX[e>>>24]]^INV_SUB_MIX_1[_SBOX[e>>>16&255]]^INV_SUB_MIX_2[_SBOX[e>>>8&255]]^INV_SUB_MIX_3[_SBOX[e&255]]}}encryptBlock(e,C){this._doCryptBlock(e,C,this._keySchedule,_SUB_MIX_0,_SUB_MIX_1,_SUB_MIX_2,_SUB_MIX_3,_SBOX)}decryptBlock(e,C){const F=e;let $=F[C+1];F[C+1]=F[C+3],F[C+3]=$,this._doCryptBlock(F,C,this._invKeySchedule,INV_SUB_MIX_0,INV_SUB_MIX_1,INV_SUB_MIX_2,INV_SUB_MIX_3,INV_SBOX),$=F[C+1],F[C+1]=F[C+3],F[C+3]=$}_doCryptBlock(e,C,F,$,Y,V,te,se){const ne=e,ee=this._nRounds;let ie=ne[C]^F[0],ae=ne[C+1]^F[1],re=ne[C+2]^F[2],oe=ne[C+3]^F[3],ce=4;for(let ye=1;ye<ee;ye+=1){const _e=$[ie>>>24]^Y[ae>>>16&255]^V[re>>>8&255]^te[oe&255]^F[ce];ce+=1;const Ee=$[ae>>>24]^Y[re>>>16&255]^V[oe>>>8&255]^te[ie&255]^F[ce];ce+=1;const be=$[re>>>24]^Y[oe>>>16&255]^V[ie>>>8&255]^te[ae&255]^F[ce];ce+=1;const Ae=$[oe>>>24]^Y[ie>>>16&255]^V[ae>>>8&255]^te[re&255]^F[ce];ce+=1,ie=_e,ae=Ee,re=be,oe=Ae}const he=(se[ie>>>24]<<24|se[ae>>>16&255]<<16|se[re>>>8&255]<<8|se[oe&255])^F[ce];ce+=1;const de=(se[ae>>>24]<<24|se[re>>>16&255]<<16|se[oe>>>8&255]<<8|se[ie&255])^F[ce];ce+=1;const pe=(se[re>>>24]<<24|se[oe>>>16&255]<<16|se[ie>>>8&255]<<8|se[ae&255])^F[ce];ce+=1;const fe=(se[oe>>>24]<<24|se[ie>>>16&255]<<16|se[ae>>>8&255]<<8|se[re&255])^F[ce];ce+=1,ne[C]=he,ne[C+1]=de,ne[C+2]=pe,ne[C+3]=fe}}AESAlgo.keySize=256/32;const AES=BlockCipher._createHelper(AESAlgo),PC1=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],PC2=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],BIT_SHIFTS=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],SBOX_P=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],SBOX_MASK=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679];function exchangeLR(J,e){const C=(this._lBlock>>>J^this._rBlock)&e;this._rBlock^=C,this._lBlock^=C<<J}function exchangeRL(J,e){const C=(this._rBlock>>>J^this._lBlock)&e;this._lBlock^=C,this._rBlock^=C<<J}class DESAlgo extends BlockCipher{_doReset(){const C=this._key.words,F=[];for(let V=0;V<56;V+=1){const te=PC1[V]-1;F[V]=C[te>>>5]>>>31-te%32&1}this._subKeys=[];const $=this._subKeys;for(let V=0;V<16;V+=1){$[V]=[];const te=$[V],se=BIT_SHIFTS[V];for(let ne=0;ne<24;ne+=1)te[ne/6|0]|=F[(PC2[ne]-1+se)%28]<<31-ne%6,te[4+(ne/6|0)]|=F[28+(PC2[ne+24]-1+se)%28]<<31-ne%6;te[0]=te[0]<<1|te[0]>>>31;for(let ne=1;ne<7;ne+=1)te[ne]>>>=(ne-1)*4+3;te[7]=te[7]<<5|te[7]>>>27}this._invSubKeys=[];const Y=this._invSubKeys;for(let V=0;V<16;V+=1)Y[V]=$[15-V]}encryptBlock(e,C){this._doCryptBlock(e,C,this._subKeys)}decryptBlock(e,C){this._doCryptBlock(e,C,this._invSubKeys)}_doCryptBlock(e,C,F){const $=e;this._lBlock=e[C],this._rBlock=e[C+1],exchangeLR.call(this,4,252645135),exchangeLR.call(this,16,65535),exchangeRL.call(this,2,858993459),exchangeRL.call(this,8,16711935),exchangeLR.call(this,1,1431655765);for(let V=0;V<16;V+=1){const te=F[V],se=this._lBlock,ne=this._rBlock;let ee=0;for(let ie=0;ie<8;ie+=1)ee|=SBOX_P[ie][((ne^te[ie])&SBOX_MASK[ie])>>>0];this._lBlock=ne,this._rBlock=se^ee}const Y=this._lBlock;this._lBlock=this._rBlock,this._rBlock=Y,exchangeLR.call(this,1,1431655765),exchangeRL.call(this,8,16711935),exchangeRL.call(this,2,858993459),exchangeLR.call(this,16,65535),exchangeLR.call(this,4,252645135),$[C]=this._lBlock,$[C+1]=this._rBlock}}DESAlgo.keySize=64/32;DESAlgo.ivSize=64/32;DESAlgo.blockSize=64/32;const DES=BlockCipher._createHelper(DESAlgo);class TripleDESAlgo extends BlockCipher{_doReset(){const C=this._key.words;if(C.length!==2&&C.length!==4&&C.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");const F=C.slice(0,2),$=C.length<4?C.slice(0,2):C.slice(2,4),Y=C.length<6?C.slice(0,2):C.slice(4,6);this._des1=DESAlgo.createEncryptor(WordArray.create(F)),this._des2=DESAlgo.createEncryptor(WordArray.create($)),this._des3=DESAlgo.createEncryptor(WordArray.create(Y))}encryptBlock(e,C){this._des1.encryptBlock(e,C),this._des2.decryptBlock(e,C),this._des3.encryptBlock(e,C)}decryptBlock(e,C){this._des3.decryptBlock(e,C),this._des2.encryptBlock(e,C),this._des1.decryptBlock(e,C)}}TripleDESAlgo.keySize=192/32;TripleDESAlgo.ivSize=64/32;TripleDESAlgo.blockSize=64/32;const TripleDES=BlockCipher._createHelper(TripleDESAlgo),S$1=[],C_$1=[],G$1=[];function nextState$1(){const J=this._X,e=this._C;for(let C=0;C<8;C+=1)C_$1[C]=e[C];e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<C_$1[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<C_$1[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<C_$1[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<C_$1[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<C_$1[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<C_$1[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<C_$1[6]>>>0?1:0)|0,this._b=e[7]>>>0<C_$1[7]>>>0?1:0;for(let C=0;C<8;C+=1){const F=J[C]+e[C],$=F&65535,Y=F>>>16,V=(($*$>>>17)+$*Y>>>15)+Y*Y,te=((F&4294901760)*F|0)+((F&65535)*F|0);G$1[C]=V^te}J[0]=G$1[0]+(G$1[7]<<16|G$1[7]>>>16)+(G$1[6]<<16|G$1[6]>>>16)|0,J[1]=G$1[1]+(G$1[0]<<8|G$1[0]>>>24)+G$1[7]|0,J[2]=G$1[2]+(G$1[1]<<16|G$1[1]>>>16)+(G$1[0]<<16|G$1[0]>>>16)|0,J[3]=G$1[3]+(G$1[2]<<8|G$1[2]>>>24)+G$1[1]|0,J[4]=G$1[4]+(G$1[3]<<16|G$1[3]>>>16)+(G$1[2]<<16|G$1[2]>>>16)|0,J[5]=G$1[5]+(G$1[4]<<8|G$1[4]>>>24)+G$1[3]|0,J[6]=G$1[6]+(G$1[5]<<16|G$1[5]>>>16)+(G$1[4]<<16|G$1[4]>>>16)|0,J[7]=G$1[7]+(G$1[6]<<8|G$1[6]>>>24)+G$1[5]|0}class RabbitAlgo extends StreamCipher{constructor(...e){super(...e),this.blockSize=128/32,this.ivSize=64/32}_doReset(){const e=this._key.words,{iv:C}=this.cfg;for(let Y=0;Y<4;Y+=1)e[Y]=(e[Y]<<8|e[Y]>>>24)&16711935|(e[Y]<<24|e[Y]>>>8)&4278255360;this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16];const F=this._X;this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535];const $=this._C;this._b=0;for(let Y=0;Y<4;Y+=1)nextState$1.call(this);for(let Y=0;Y<8;Y+=1)$[Y]^=F[Y+4&7];if(C){const Y=C.words,V=Y[0],te=Y[1],se=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,ne=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360,ee=se>>>16|ne&4294901760,ie=ne<<16|se&65535;$[0]^=se,$[1]^=ee,$[2]^=ne,$[3]^=ie,$[4]^=se,$[5]^=ee,$[6]^=ne,$[7]^=ie;for(let ae=0;ae<4;ae+=1)nextState$1.call(this)}}_doProcessBlock(e,C){const F=e,$=this._X;nextState$1.call(this),S$1[0]=$[0]^$[5]>>>16^$[3]<<16,S$1[1]=$[2]^$[7]>>>16^$[5]<<16,S$1[2]=$[4]^$[1]>>>16^$[7]<<16,S$1[3]=$[6]^$[3]>>>16^$[1]<<16;for(let Y=0;Y<4;Y+=1)S$1[Y]=(S$1[Y]<<8|S$1[Y]>>>24)&16711935|(S$1[Y]<<24|S$1[Y]>>>8)&4278255360,F[C+Y]^=S$1[Y]}}const Rabbit=StreamCipher._createHelper(RabbitAlgo),S=[],C_=[],G=[];function nextState(){const J=this._X,e=this._C;for(let C=0;C<8;C+=1)C_[C]=e[C];e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<C_[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<C_[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<C_[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<C_[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<C_[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<C_[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<C_[6]>>>0?1:0)|0,this._b=e[7]>>>0<C_[7]>>>0?1:0;for(let C=0;C<8;C+=1){const F=J[C]+e[C],$=F&65535,Y=F>>>16,V=(($*$>>>17)+$*Y>>>15)+Y*Y,te=((F&4294901760)*F|0)+((F&65535)*F|0);G[C]=V^te}J[0]=G[0]+(G[7]<<16|G[7]>>>16)+(G[6]<<16|G[6]>>>16)|0,J[1]=G[1]+(G[0]<<8|G[0]>>>24)+G[7]|0,J[2]=G[2]+(G[1]<<16|G[1]>>>16)+(G[0]<<16|G[0]>>>16)|0,J[3]=G[3]+(G[2]<<8|G[2]>>>24)+G[1]|0,J[4]=G[4]+(G[3]<<16|G[3]>>>16)+(G[2]<<16|G[2]>>>16)|0,J[5]=G[5]+(G[4]<<8|G[4]>>>24)+G[3]|0,J[6]=G[6]+(G[5]<<16|G[5]>>>16)+(G[4]<<16|G[4]>>>16)|0,J[7]=G[7]+(G[6]<<8|G[6]>>>24)+G[5]|0}class RabbitLegacyAlgo extends StreamCipher{constructor(...e){super(...e),this.blockSize=128/32,this.ivSize=64/32}_doReset(){const e=this._key.words,{iv:C}=this.cfg;this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16];const F=this._X;this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535];const $=this._C;this._b=0;for(let Y=0;Y<4;Y+=1)nextState.call(this);for(let Y=0;Y<8;Y+=1)$[Y]^=F[Y+4&7];if(C){const Y=C.words,V=Y[0],te=Y[1],se=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,ne=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360,ee=se>>>16|ne&4294901760,ie=ne<<16|se&65535;$[0]^=se,$[1]^=ee,$[2]^=ne,$[3]^=ie,$[4]^=se,$[5]^=ee,$[6]^=ne,$[7]^=ie;for(let ae=0;ae<4;ae+=1)nextState.call(this)}}_doProcessBlock(e,C){const F=e,$=this._X;nextState.call(this),S[0]=$[0]^$[5]>>>16^$[3]<<16,S[1]=$[2]^$[7]>>>16^$[5]<<16,S[2]=$[4]^$[1]>>>16^$[7]<<16,S[3]=$[6]^$[3]>>>16^$[1]<<16;for(let Y=0;Y<4;Y+=1)S[Y]=(S[Y]<<8|S[Y]>>>24)&16711935|(S[Y]<<24|S[Y]>>>8)&4278255360,F[C+Y]^=S[Y]}}const RabbitLegacy=StreamCipher._createHelper(RabbitLegacyAlgo);function generateKeystreamWord(){const J=this._S;let e=this._i,C=this._j,F=0;for(let $=0;$<4;$+=1){e=(e+1)%256,C=(C+J[e])%256;const Y=J[e];J[e]=J[C],J[C]=Y,F|=J[(J[e]+J[C])%256]<<24-$*8}return this._i=e,this._j=C,F}class RC4Algo extends StreamCipher{_doReset(){const e=this._key,C=e.words,F=e.sigBytes;this._S=[];const $=this._S;for(let Y=0;Y<256;Y+=1)$[Y]=Y;for(let Y=0,V=0;Y<256;Y+=1){const te=Y%F,se=C[te>>>2]>>>24-te%4*8&255;V=(V+$[Y]+se)%256;const ne=$[Y];$[Y]=$[V],$[V]=ne}this._j=0,this._i=this._j}_doProcessBlock(e,C){const F=e;F[C]^=generateKeystreamWord.call(this)}}RC4Algo.keySize=256/32;RC4Algo.ivSize=0;const RC4=StreamCipher._createHelper(RC4Algo);class RC4DropAlgo extends RC4Algo{constructor(...e){super(...e),Object.assign(this.cfg,{drop:192})}_doReset(){super._doReset.call(this);for(let e=this.cfg.drop;e>0;e-=1)generateKeystreamWord.call(this)}}const RC4Drop=StreamCipher._createHelper(RC4DropAlgo);function generateKeystreamAndEncrypt(J,e,C,F){const $=J;let Y;const V=this._iv;V?(Y=V.slice(0),this._iv=void 0):Y=this._prevBlock,F.encryptBlock(Y,0);for(let te=0;te<C;te+=1)$[e+te]^=Y[te]}class CFB extends BlockCipherMode{}CFB.Encryptor=class extends CFB{processBlock(J,e){const C=this._cipher,{blockSize:F}=C;generateKeystreamAndEncrypt.call(this,J,e,F,C),this._prevBlock=J.slice(e,e+F)}};CFB.Decryptor=class extends CFB{processBlock(J,e){const C=this._cipher,{blockSize:F}=C,$=J.slice(e,e+F);generateKeystreamAndEncrypt.call(this,J,e,F,C),this._prevBlock=$}};class CTR extends BlockCipherMode{}CTR.Encryptor=class extends CTR{processBlock(J,e){const C=J,F=this._cipher,{blockSize:$}=F,Y=this._iv;let V=this._counter;Y&&(this._counter=Y.slice(0),V=this._counter,this._iv=void 0);const te=V.slice(0);F.encryptBlock(te,0),V[$-1]=V[$-1]+1|0;for(let se=0;se<$;se+=1)C[e+se]^=te[se]}};CTR.Decryptor=CTR.Encryptor;const incWord=J=>{let e=J;if((J>>24&255)===255){let C=J>>16&255,F=J>>8&255,$=J&255;C===255?(C=0,F===255?(F=0,$===255?$=0:$+=1):F+=1):C+=1,e=0,e+=C<<16,e+=F<<8,e+=$}else e+=1<<24;return e},incCounter=J=>{const e=J;return e[0]=incWord(e[0]),e[0]===0&&(e[1]=incWord(e[1])),e};/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */class CTRGladman extends BlockCipherMode{}CTRGladman.Encryptor=class extends CTRGladman{processBlock(J,e){const C=J,F=this._cipher,{blockSize:$}=F,Y=this._iv;let V=this._counter;Y&&(this._counter=Y.slice(0),V=this._counter,this._iv=void 0),incCounter(V);const te=V.slice(0);F.encryptBlock(te,0);for(let se=0;se<$;se+=1)C[e+se]^=te[se]}};CTRGladman.Decryptor=CTRGladman.Encryptor;class ECB extends BlockCipherMode{}ECB.Encryptor=class extends ECB{processBlock(J,e){this._cipher.encryptBlock(J,e)}};ECB.Decryptor=class extends ECB{processBlock(J,e){this._cipher.decryptBlock(J,e)}};class OFB extends BlockCipherMode{}OFB.Encryptor=class extends OFB{processBlock(J,e){const C=J,F=this._cipher,{blockSize:$}=F,Y=this._iv;let V=this._keystream;Y&&(this._keystream=Y.slice(0),V=this._keystream,this._iv=void 0),F.encryptBlock(V,0);for(let te=0;te<$;te+=1)C[e+te]^=V[te]}};OFB.Decryptor=OFB.Encryptor;const AnsiX923={pad(J,e){const C=J,F=C.sigBytes,$=e*4,Y=$-F%$,V=F+Y-1;C.clamp(),C.words[V>>>2]|=Y<<24-V%4*8,C.sigBytes+=Y},unpad(J){const e=J,C=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=C}},Iso10126={pad(J,e){const C=e*4,F=C-J.sigBytes%C;J.concat(WordArray.random(F-1)).concat(WordArray.create([F<<24],1))},unpad(J){const e=J,C=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=C}},ZeroPadding={pad(J,e){const C=J,F=e*4;C.clamp(),C.sigBytes+=F-(J.sigBytes%F||F)},unpad(J){const e=J,C=e.words;for(let F=e.sigBytes-1;F>=0;F-=1)if(C[F>>>2]>>>24-F%4*8&255){e.sigBytes=F+1;break}}},Iso97971={pad(J,e){J.concat(WordArray.create([2147483648],1)),ZeroPadding.pad(J,e)},unpad(J){const e=J;ZeroPadding.unpad(e),e.sigBytes-=1}},NoPadding={pad(){},unpad(){}},HexFormatter={stringify(J){return J.ciphertext.toString(Hex)},parse(J){const e=Hex.parse(J);return CipherParams.create({ciphertext:e})}},CryptoES={lib:{Base,WordArray,BufferedBlockAlgorithm,Hasher,Cipher,StreamCipher,BlockCipherMode,BlockCipher,CipherParams,SerializableCipher,PasswordBasedCipher},x64:{Word:X64Word,WordArray:X64WordArray},enc:{Hex,Latin1,Utf8,Utf16,Utf16BE,Utf16LE,Base64},algo:{HMAC,MD5:MD5Algo,SHA1:SHA1Algo,SHA224:SHA224Algo,SHA256:SHA256Algo,SHA384:SHA384Algo,SHA512:SHA512Algo,SHA3:SHA3Algo,RIPEMD160:RIPEMD160Algo,PBKDF2:PBKDF2Algo,EvpKDF:EvpKDFAlgo,AES:AESAlgo,DES:DESAlgo,TripleDES:TripleDESAlgo,Rabbit:RabbitAlgo,RabbitLegacy:RabbitLegacyAlgo,RC4:RC4Algo,RC4Drop:RC4DropAlgo},mode:{CBC,CFB,CTR,CTRGladman,ECB,OFB},pad:{Pkcs7,AnsiX923,Iso10126,Iso97971,NoPadding,ZeroPadding},format:{OpenSSL:OpenSSLFormatter,Hex:HexFormatter},kdf:{OpenSSL:OpenSSLKdf},MD5,HmacMD5,SHA1,HmacSHA1,SHA224,HmacSHA224,SHA256,HmacSHA256,SHA384,HmacSHA384,SHA512,HmacSHA512,SHA3,HmacSHA3,RIPEMD160,HmacRIPEMD160,PBKDF2,EvpKDF,AES,DES,TripleDES,Rabbit,RabbitLegacy,RC4,RC4Drop};function bytesToWordArray(J){return CryptoES.lib.WordArray.create(J)}function wordArrayToBytes(J){return ByteUtils.int32ArrayToBytes(J.words).slice(0,J.sigBytes)}function md5(J){return J instanceof Uint8Array&&(J=bytesToWordArray(J)),CryptoES.MD5(J)}function rc4(J,e){return J instanceof Uint8Array&&(J=bytesToWordArray(J)),e instanceof Uint8Array&&(e=bytesToWordArray(e)),CryptoES.RC4.encrypt(J,e).ciphertext}function aes(J,e,C=!1){if(J instanceof Uint8Array&&(J=bytesToWordArray(J)),e instanceof Uint8Array&&(e=bytesToWordArray(e)),C){const F=CryptoES.lib.WordArray.create(J.words.slice(0,4));return CryptoES.algo.AES.createDecryptor(e,{mode:CryptoES.mode.CBC,iv:F,padding:CryptoES.pad.Pkcs7}).finalize(J)}else{const F=CryptoES.lib.WordArray.random(16);return CryptoES.algo.AES.createEncryptor(e,{mode:CryptoES.mode.CBC,iv:F,padding:CryptoES.pad.Pkcs7}).finalize(J)}}const AESV2_KEY_PADDING=[115,65,108,84];class AESV2DataCryptor{_n;_key;_tempKey;constructor(e){if(!e)throw new Error("Empty key");if(e.length!==16)throw new Error(`Invalid key length: ${e.length} (shall be 16)`);this._n=e.length,this._key=e,this._tempKey=new Uint8Array(e.length+9)}encrypt(e,C){return this.run(e,C.id,C.generation)}decrypt(e,C){return this.run(e,C.id,C.generation,!0)}run(e,C,F,$=!1){const Y=ByteUtils.int32ToBytes(C,!0),V=ByteUtils.int32ToBytes(F,!0);this._tempKey.set(this._key,0),this._tempKey.set(Y.subarray(0,3),this._n),this._tempKey.set(V.subarray(0,2),this._n+3),this._tempKey.set(AESV2_KEY_PADDING,this._n+5);const te=wordArrayToBytes(md5(this._tempKey)),se=Math.min(this._n+5,16),ne=te.slice(0,se),ee=wordArrayToBytes(aes(e,ne,$));return $?ee.slice(16):ee}}class AESV3DataCryptor{_n;_key;constructor(e){if(!e)throw new Error("Empty key");if(e.length!==32)throw new Error(`Invalid key length: ${e.length} (shall be 32)`);this._n=e.length,this._key=e}encrypt(e,C){return this.run(e,C.id,C.generation)}decrypt(e,C){return this.run(e,C.id,C.generation,!0)}run(e,C,F,$=!1){const Y=wordArrayToBytes(aes(e,this._key,$));return $?Y.slice(16):Y}}class IdentityDataCryptor{constructor(){}encrypt(e,C){return e}decrypt(e,C){return e}}class RC4DataCryptor{_n;_key;_tempKey;constructor(e){if(!e)throw new Error("Empty key");if(e.length<5||e.length>16)throw new Error(`Invalid key length: ${e.length} (shall be a multiple of 8 in the range from 40 to 128)`);this._n=e.length,this._key=e,this._tempKey=new Uint8Array(e.length+5)}encrypt(e,C){const F=ByteUtils.int32ToBytes(C.id,!0),$=ByteUtils.int32ToBytes(C.generation,!0);this._tempKey.set(this._key,0),this._tempKey.set(F.slice(0,3),this._n),this._tempKey.set($.slice(0,2),this._n+3);const Y=wordArrayToBytes(md5(this._tempKey)),V=Math.min(this._n+5,16),te=Y.slice(0,V);return wordArrayToBytes(rc4(e,te))}decrypt(e,C){return this.encrypt(e,C)}}const PASSWORD_32_PADDING=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122];class DataCryptHandler{_filter;_version;_revision;_permissions;_encryptMetadata;_keyLength;_stringKeyLength;_streamKeyLength;_stringMethod;_streamMethod;_oPasswordHash;_uPasswordHash;_oEncPasswordHash;_uEncPasswordHash;_perms;_fileId;_lastEncryptionKey;constructor(e,C){const{filter:F,version:$,revision:Y,permissions:V,encryptMetadata:te,keyLength:se,stringKeyLength:ne,streamKeyLength:ee,stringMethod:ie,streamMethod:ae,oPasswordHash:re,uPasswordHash:oe,oEncPasswordHash:ce,uEncPasswordHash:he,perms:de}=e;if(F!=="/Standard")throw new Error(`Unsupported filter name: ${F}`);if(![1,2,4,5].includes($))throw new Error(`Unsupported algorithm version: ${$}`);if(![2,3,4,5,6].includes(Y))throw new Error(`Unsupported algorithm revision: ${Y}`);if(isNaN(V))throw new Error("Permissions not provided");if(!re||!oe)throw new Error("Password hash not provided");this._filter=F,this._version=$,this._revision=Y,this._permissions=V,this._keyLength=se,this._encryptMetadata=te,this._stringKeyLength=ne,this._streamKeyLength=ee,this._stringMethod=ie,this._streamMethod=ae,this._oPasswordHash=re,this._uPasswordHash=oe,this._oEncPasswordHash=ce,this._uEncPasswordHash=he,this._perms=de,this._fileId=C}authenticate(e){const C=this._version,F=this._stringMethod,$=this._streamMethod;let Y=!1;if(this.authOwnerPassword(e))Y=!0;else if(!this.authUserPassword(e))return null;const te=this._lastEncryptionKey;switch(C){case 1:const se=new RC4DataCryptor(te);return{owner:Y,stringCryptor:se,streamCryptor:se};case 2:const ne=new RC4DataCryptor(te);return{owner:Y,stringCryptor:ne,streamCryptor:ne};case 4:let ee;if(!F||F===cryptMethods.NONE)ee=new IdentityDataCryptor;else if(F===cryptMethods.RC4)ee=new RC4DataCryptor(te);else if(F===cryptMethods.AES_128)ee=new AESV2DataCryptor(te);else throw new Error(`Invalid crypt method: ${F}`);let ie;if(!$||$===cryptMethods.NONE)ie=new IdentityDataCryptor;else if($===cryptMethods.RC4)ie=new RC4DataCryptor(te);else if($===cryptMethods.AES_128)ie=new AESV2DataCryptor(te);else throw new Error(`Invalid crypt method: ${$}`);return{owner:Y,stringCryptor:ee,streamCryptor:ie};case 5:let ae;if(!F||F===cryptMethods.NONE)ee=new IdentityDataCryptor;else if(F===cryptMethods.AES_256)ee=new AESV3DataCryptor(te);else throw new Error(`Invalid crypt method: ${F}`);let re;if(!$||$===cryptMethods.NONE)ie=new IdentityDataCryptor;else if($===cryptMethods.AES_256)ie=new AESV3DataCryptor(te);else throw new Error(`Invalid crypt method: ${$}`);return{owner:Y,stringCryptor:ae,streamCryptor:re}}}padPassword32(e){if(!e)return new Uint8Array(PASSWORD_32_PADDING);const C=new TextEncoder().encode(e),F=new Uint8Array(32);return F.set(C.slice(0,32)),C.length<32&&F.set(PASSWORD_32_PADDING.slice(0,32-C.length),C.length),F}computeEncryptionKey(e){if([2,3,4].includes(this._revision)){const C=this.padPassword32(e),F=ByteUtils.int32ToBytes(this._permissions,!0),$=this._revision>=4&&!this._encryptMetadata?new Uint8Array([255,255,255,255]):new Uint8Array(0),Y=new Uint8Array([...C,...this._oPasswordHash,...F,...this._fileId,...$]);let V=wordArrayToBytes(md5(Y));const te=this._keyLength>>3;if(this._revision>=3)for(let ne=0;ne<50;ne++)V=wordArrayToBytes(md5(V.slice(0,te)));const se=V.slice(0,te);return this._lastEncryptionKey=se,se}else{if(this._revision===5)throw new Error("Not implemented yet");if(this._revision===6)throw new Error("Not implemented yet")}}computeOHashEncryptionKey_R2R3R4(e){const C=this.padPassword32(e);let F=md5(C);if(this._revision>=3)for(let V=0;V<50;V++)F=md5(F);const $=wordArrayToBytes(F),Y=this._keyLength>>3;return $.slice(0,Y)}computeOHash_R2R3R4(e,C){const F=this.computeOHashEncryptionKey_R2R3R4(e||C),$=this.padPassword32(C);let Y=rc4($,F);if(this._revision>=3)for(let V=1;V<20;V++)Y=rc4(Y,ByteUtils.xorBytes(F,V));return wordArrayToBytes(Y)}computeUHash_R2(e){const C=this.computeEncryptionKey(e),F=new Uint8Array(PASSWORD_32_PADDING);return wordArrayToBytes(rc4(F,C))}computeUHash_R3R4(e){const C=this.computeEncryptionKey(e),F=new Uint8Array([...PASSWORD_32_PADDING,...this._fileId]);let $=md5(F);$=rc4($,C);for(let Y=1;Y<20;Y++)$=rc4($,ByteUtils.xorBytes(C,Y));return wordArrayToBytes($)}authOwnerPassword(e){if([2,3,4].includes(this._revision)){const C=this.computeOHashEncryptionKey_R2R3R4(e);let F;if(this._revision===2)F=wordArrayToBytes(rc4(this._oPasswordHash,C));else{let V=bytesToWordArray(this._oPasswordHash);for(let te=19;te>=0;te--)V=rc4(V,ByteUtils.xorBytes(C,te));F=wordArrayToBytes(V)}const $=ByteUtils.findSubarrayIndex(F,new Uint8Array(PASSWORD_32_PADDING)),Y=new TextDecoder().decode($===-1?F:F.subarray(0,$));return this.authUserPassword(Y)}else{if(this._revision===5)throw new Error("Not implemented yet");if(this._revision===6)throw new Error("Not implemented yet")}}authUserPassword(e){let C;if(this._revision===2)return C=this.computeUHash_R2(e),ByteUtils.arraysEqual(this._uPasswordHash,C);if(this._revision===3||this._revision===4)return C=this.computeUHash_R3R4(e),ByteUtils.arraysEqual(this._uPasswordHash.subarray(0,16),C);if(this._revision===5)throw new Error("Not implemented yet");if(this._revision===6)throw new Error("Not implemented yet")}}class ObjectStream extends PdfStream{N;First;Extends;constructor(){super(streamTypes.OBJECT_STREAM)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new ObjectStream;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}async getObjectDataAsync(e){if(!this._streamData||!this.N||!this.First)return null;const C=await this.getStreamDataParserAsync(),F=new Map;let $,Y,V,te=0;for(let re=0;re<this.N;re++)$=await C.parseNumberAtAsync(te,!1,!1),Y=$.value,te=$.end+2,$=await C.parseNumberAtAsync(te,!1,!1),V=$.value,te=$.end+2,F.set(Y,V);if(!F.has(e))return null;const se=this.First+F.get(e),ne=await C.getValueTypeAtAsync(se);if(ne===null)return;let ee,ie;switch(ne){case objectTypes.DICTIONARY:ee=await C.getDictBoundsAtAsync(se,!1);break;case objectTypes.ARRAY:ee=await C.getArrayBoundsAtAsync(se,!1);break;case objectTypes.STRING_LITERAL:const re=await LiteralString.parseAsync(C,se);re&&(ee={start:re.start,end:re.end},ie=re);break;case objectTypes.STRING_HEX:const oe=await HexString.parseAsync(C,se);oe&&(ee={start:oe.start,end:oe.end},ie=oe);break;case objectTypes.NUMBER:const ce=await C.parseNumberAtAsync(se);ce&&(ee={start:ce.start,end:ce.end},ie=ce);break}if(!ee)return null;const ae=await C.sliceCharCodesAsync(ee.start,ee.end);if(!ae.length)throw new Error("Object byte array is empty");return{parser:await PdfStream.getDataParserAsync(ae),bounds:{start:0,end:ae.length-1,contentStart:ee.contentStart?ee.contentStart-ee.start:void 0,contentEnd:ee.contentEnd?ae.length-1-(ee.end-ee.contentEnd):void 0},type:ne,value:ie,cryptInfo:{ref:{id:e,generation:0}},streamId:this.id}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.N&&$.push(...F.encode("/N "),...F.encode(" "+this.N)),this.First&&$.push(...F.encode("/First "),...F.encode(" "+this.First)),this.Extends&&$.push(...F.encode("/Extends "),...this.Extends.toArray(e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=await C.getDictBoundsAtAsync($);let V=await C.skipToNextNameAsync(Y.contentStart,Y.contentEnd),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/N":case"/First":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Extends":V=await this.parseRefPropAsync(te,C,V);break;default:V=await C.skipToNextNameAsync(V,Y.contentEnd);break}}}class CryptFilterDict extends PdfDict{CFM=cryptMethods.NONE;AuthEvent=authEvents.DOC_OPEN;Length=40;EncryptMetadata=!0;Recipients;constructor(){super(dictTypes.CRYPT_FILTER)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new CryptFilterDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.CFM&&$.push(...F.encode("/CFM "),...F.encode(this.CFM)),this.AuthEvent&&$.push(...F.encode("/AuthEvent "),...F.encode(this.AuthEvent)),this.Length&&$.push(...F.encode("/Length "),...F.encode(" "+this.Length)),this.EncryptMetadata&&$.push(...F.encode("/EncryptMetadata "),...F.encode(" "+this.EncryptMetadata)),this.Recipients&&(this.Recipients instanceof HexString?$.push(...F.encode("/Recipients "),...this.Recipients.toArray(e)):$.push(...F.encode("/Recipients "),...this.encodeSerializableArray(this.Recipients,e)));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/CFM":const ne=await C.parseNameAtAsync(V,!0);if(ne&&Object.values(cryptMethods).includes(ne.value))this.CFM=ne.value,V=ne.end+1;else throw new Error("Can't parse /CFM property value");break;case"/AuthEvent":const ee=await C.parseNameAtAsync(V,!0);if(ee&&Object.values(authEvents).includes(ee.value))this.AuthEvent=ee.value,V=ee.end+1;else throw new Error("Can't parse /AuthEvent property value");break;case"/Length":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/EncryptMetadata":V=await this.parseBoolPropAsync(te,C,V);break;case"/Recipients":const ie=await C.getValueTypeAtAsync(V);if(ie===valueTypes.STRING_HEX){const ae=await HexString.parseAsync(C,V,e.cryptInfo);if(ae){this.Recipients=ae.value,V=ae.end+1;break}else throw new Error("Can't parse /Recipients property value")}else if(ie===valueTypes.ARRAY){const ae=await HexString.parseArrayAsync(C,V);if(ae){this.Recipients=ae.value,V=ae.end+1;break}else throw new Error("Can't parse /Recipients property value")}throw new Error(`Unsupported /Filter property value type: ${ie}`);default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class CryptMapDict extends PdfDict{_filtersMap=new Map;constructor(){super(null)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new CryptMapDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}getProp(e){return this._filtersMap.get(e)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this._filtersMap.size&&this._filtersMap.forEach((V,te)=>$.push(...F.encode(te),...V.toArray(e)));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){default:if(await C.getValueTypeAtAsync(V)===valueTypes.DICTIONARY){const ee=await C.getDictBoundsAtAsync(V);if(ee){const ie=await CryptFilterDict.parseAsync({parser:C,bounds:ee});if(ie){this._filtersMap.set(te,ie.value),V=ie.end+1;break}}}V=await C.skipToNextNameAsync(V,Y-1);break}}}class EncryptionDict extends PdfDict{Filter="/Standard";SubFilter;V;Length=40;CF;StmF="/Identity";StrF="/Identity";EFF;R;O;U;OE;UE;P;Perms;EncryptMetadata=!0;Recipients;stringFilter;streamFilter;constructor(){super(dictTypes.EMPTY)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new EncryptionDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Filter&&$.push(...F.encode("/Filter "),...F.encode(this.Filter)),this.SubFilter&&$.push(...F.encode("/SubFilter "),...F.encode(this.SubFilter)),this.V&&$.push(...F.encode("/V "),...F.encode(" "+this.V)),this.Length&&$.push(...F.encode("/Length "),...F.encode(" "+this.Length)),this.CF&&$.push(...F.encode("/CF "),...this.CF.toArray(e)),this.StmF&&$.push(...F.encode("/StmF "),...F.encode(this.StmF)),this.StrF&&$.push(...F.encode("/StrF "),...F.encode(this.StrF)),this.EFF&&$.push(...F.encode("/EFF "),...F.encode(this.EFF)),this.R&&$.push(...F.encode("/R "),...F.encode(" "+this.R)),this.O&&$.push(...F.encode("/O "),...this.O.toArray(e)),this.U&&$.push(...F.encode("/U "),...this.U.toArray(e)),this.OE&&$.push(...F.encode("/OE "),...this.OE.toArray(e)),this.UE&&$.push(...F.encode("/UE "),...this.UE.toArray(e)),this.P&&$.push(...F.encode("/P "),...F.encode(" "+this.P)),this.Perms&&$.push(...F.encode("/Perms "),...this.Perms.toArray(e)),this.U&&$.push(...F.encode("/U "),...this.U.toArray(e)),this.EncryptMetadata&&$.push(...F.encode("/EncryptMetadata "),...F.encode(" "+this.EncryptMetadata)),this.Recipients&&(this.Recipients instanceof HexString?$.push(...F.encode("/Recipients "),...this.Recipients.toArray(e)):$.push(...F.encode("/Recipients "),...this.encodeSerializableArray(this.Recipients,e)));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toCryptOptions(){return this.V?{filter:this.Filter,version:this.V,revision:this.R,permissions:this.P,keyLength:this.Length,encryptMetadata:this.EncryptMetadata,stringKeyLength:this.stringFilter?.Length,streamKeyLength:this.streamFilter?.Length,stringMethod:this.stringFilter?.CFM,streamMethod:this.streamFilter?.CFM,oPasswordHash:this.O?.bytes,uPasswordHash:this.U?.bytes,oEncPasswordHash:this.OE?.bytes,uEncPasswordHash:this.UE?.bytes,perms:this.Perms?.bytes}:null}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Filter":case"/SubFilter":case"/StmF":case"/StrF":case"/EFF":V=await this.parseNamePropAsync(te,C,V);break;case"/V":const ne=await C.parseNumberAtAsync(V,!1);if(ne&&Object.values(cryptVersions).includes(ne.value))this.V=ne.value,V=ne.end+1;else throw new Error("Can't parse /V property value");break;case"/R":const ee=await C.parseNumberAtAsync(V,!1);if(ee&&Object.values(cryptRevisions).includes(ee.value))this.R=ee.value,V=ee.end+1;else throw new Error("Can't parse /R property value");break;case"/Length":case"/P":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/O":case"/U":case"/OE":case"/UE":case"/Perms":V=await this.parseLiteralPropAsync(te,C,V,e.cryptInfo);break;case"/EncryptMetadata":V=await this.parseBoolPropAsync(te,C,V);break;case"/CF":const ie=await C.getDictBoundsAtAsync(V);if(F){const re=await CryptMapDict.parseAsync({parser:C,bounds:ie});re&&(this.CF=re.value,V=re.end+1)}else throw new Error("Can't parse /CF property value");break;case"/Recipients":const ae=await C.getValueTypeAtAsync(V);if(ae===valueTypes.STRING_HEX){const re=await HexString.parseAsync(C,V,e.cryptInfo);if(re){this.Recipients=re.value,V=re.end+1;break}else throw new Error("Can't parse /Recipients property value")}else if(ae===valueTypes.ARRAY){const re=await HexString.parseArrayAsync(C,V);if(re){this.Recipients=re.value,V=re.end+1;break}else throw new Error("Can't parse /Recipients property value")}throw new Error(`Unsupported /Filter property value type: ${ae}`);default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Filter)throw new Error("Not all required properties parsed");if(this.Filter==="/Standard"&&(!this.R||!this.O||!this.U||isNaN(this.P)||this.V===5&&(this.R<5||!this.OE||!this.UE||!this.Perms)))throw new Error("Not all required properties parsed");if((this.SubFilter==="adbe.pkcs7.s3"||this.SubFilter==="adbe.pkcs7.s4")&&!this.Recipients)throw new Error("Not all required properties parsed");this.StrF!=="/Identity"&&(this.stringFilter=this.CF?.getProp(this.StrF)),this.StmF!=="/Identity"&&(this.streamFilter=this.CF?.getProp(this.StmF))}}class TrailerDict extends PdfDict{Size;Prev;Root;Encrypt;Info;ID;constructor(){super(dictTypes.EMPTY)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new TrailerDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Size&&$.push(...F.encode("/Size "),...F.encode(" "+this.Size)),this.Prev&&$.push(...F.encode("/Prev "),...F.encode(" "+this.Prev)),this.Root&&$.push(...F.encode("/Root "),...this.Root.toArray(e)),this.Encrypt&&$.push(...F.encode("/Encrypt "),...this.Encrypt.toArray(e)),this.Info&&$.push(...F.encode("/Info "),...this.Info.toArray(e)),this.ID&&$.push(...F.encode("/ID "),...this.encodeSerializableArray(this.ID,e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Size":case"/Prev":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Root":case"/Info":V=await this.parseRefPropAsync(te,C,V);break;case"/Encrypt":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae){this.Encrypt=ae.value,V=ae.end+1;break}else throw new Error("Can't parse /Encrypt property value")}throw new Error(`Unsupported /Encrypt property value type: ${ne}`);case"/ID":const ee=await HexString.parseArrayAsync(C,V);if(ee&&ee.value[0]&&ee.value[1]){this.ID=[ee.value[0],ee.value[1]],V=ee.end+1;break}const ie=await LiteralString.parseArrayAsync(C,V);if(ie&&ie.value[0]&&ie.value[1]){this.ID=[HexString.fromHexBytes(ie.value[0].bytes),HexString.fromHexBytes(ie.value[1].bytes)],V=ie.end+1;break}throw new Error("Can't parse /ID property value");default:V=await C.skipToNextNameAsync(V,Y-1);break}if(this.Root||console.log("Trailer 'Root' property is missing. Look like the file is linearized, which is not oficially supported atm!"),!this.Size)throw new Error("Not all required properties parsed: Size is missing");if(this.Encrypt&&!this.ID)throw new Error("Not all required properties parsed: ID is missing while Encryption is used")}}class XRefTable extends XRef{_trailerDict;_table;get prev(){return this._trailerDict?.Prev}get size(){return this._trailerDict?.Size}get root(){return this._trailerDict?.Root}get info(){return this._trailerDict?.Root}get encrypt(){return this._trailerDict?.Encrypt}get id(){return this._trailerDict?.ID}constructor(e,C,F){super(xRefTypes.TABLE),this._table=e,this._trailerDict=C,this._offset=F}static createFrom(e,C,F){if(!C?.length||!e)return null;const $=Math.max(...C.map(V=>V.id))+1,Y=Math.max($,e.size);return XRefTable.create(C,Y,F,e.root,e.offset,e.info,e.encrypt,e.id)}static create(e,C,F,$,Y,V,te,se){if(!e?.length||!C||!F||!$)return null;const ne=new TrailerDict;ne.Size=C,ne.Prev=Y,ne.Root=$,ne.Info=V,ne.Encrypt=te,ne.ID=se;const ee=XRefEntry.toTableBytes(e);return new XRefTable(ee,ne,F)}static async parseAsync(e,C,F){if(!e||isNaN(C))return null;const $=await e.getXrefTableBoundsAtAsync(C);if(!$)return null;const Y=await e.getDictBoundsAtAsync($.end+1);if(!Y)return null;const V=await e.sliceCharCodesAsync($.contentStart,$.contentEnd),te=await TrailerDict.parseAsync({parser:e,bounds:Y});return te?{value:new XRefTable(V,te.value,F),start:null,end:null}:null}createUpdate(e,C){return XRefTable.createFrom(this,e,C)}getEntries(){return this._table.length?XRefEntry.fromTableBytes(this._table):[]}toArray(e){const C=this._trailerDict.toArray(e),F=[...keywordCodes.XREF_TABLE,...keywordCodes.END_OF_LINE,...this._table,...keywordCodes.TRAILER,...keywordCodes.END_OF_LINE,...C,...keywordCodes.END_OF_LINE];return new Uint8Array(F)}}class XrefParser{_dataParser;constructor(e){if(!e)throw new Error("Parser is not defined");this._dataParser=e}async getPdfVersionAsync(){const e=await this._dataParser.findSubarrayIndexAsync(keywordCodes.VERSION);if(!e)return null;const C=(await this._dataParser.parseNumberAtAsync(e.end+1,!0))?.value;return C?C.toFixed(1):null}async getLastXrefIndexAsync(){const e=await this._dataParser.findSubarrayIndexAsync(keywordCodes.XREF_START,{maxIndex:this._dataParser.maxIndex,direction:!1});if(!e)return null;const C=this._dataParser.parseNumberAtAsync(e.end+1);return C||null}async parseXrefAsync(e,C){if(!e)return null;const F=e,$=await this._dataParser.findSubarrayIndexAsync(keywordCodes.XREF_TABLE,{minIndex:e,closedOnly:!0});if($&&$.start===e){const se=await this._dataParser.findSubarrayIndexAsync(keywordCodes.XREF_HYBRID,{minIndex:e,maxIndex:C,closedOnly:!0});if(se){const ne=await this._dataParser.parseNumberAtAsync(se.end+1);if(!ne)return null;e=ne.value}else return(await XRefTable.parseAsync(this._dataParser,e,F))?.value}const Y=await ObjectId.parseAsync(this._dataParser,e,!1);if(!Y)return null;const V=await this._dataParser.getIndirectObjectBoundsAtAsync(Y.end+1);return V?(await XRefStream.parseAsync({parser:this._dataParser,bounds:V},F))?.value:null}async parseAllXrefsAsync(e){const C=[];let F=this._dataParser.maxIndex,$;for(;e&&($=await this.parseXrefAsync(e,F),$);)C.push($),F=e,e=$.prev;return C}}class ReferenceData{size;freeLinkedList;freeOutsideListMap;usedMap;constructor(e){const C=[],F=[],$=[];let Y=0;e.forEach(oe=>{for(const ce of oe.getEntries()){switch(ce.type){case xRefEntryTypes.FREE:C.push(ce);break;case xRefEntryTypes.NORMAL:F.push(ce);break;case xRefEntryTypes.COMPRESSED:$.push(ce);break;default:continue}ce.id>Y&&(Y=ce.id)}}),this.size=Y+1;const V={id:0,generation:maxGeneration,nextFreeId:0},te=new LinkedList(V),se=new Map,ne=new Map;let ee=!1;for(const oe of C){if(!ee&&oe.id===0){ee=!0,V.nextFreeId=oe.nextFreeId;continue}const ce=ne.get(oe.id);(!ce||ce.generation<oe.generation)&&ne.set(oe.id,{id:oe.id,generation:oe.generation,nextFreeId:oe.nextFreeId})}let ie=V.nextFreeId,ae;for(;ie;)ae=ne.get(ie),ne.delete(ie),te.push(ae),ie=ae.nextFreeId;[...ne].forEach(oe=>{const ce=oe[1];ce.generation===maxGeneration&&ce.nextFreeId===0&&se.set(ce.id,ce)}),this.freeLinkedList=te,this.freeOutsideListMap=se;const re=new Map;for(const oe of F){if(this.isFreed(oe))continue;const ce=re.get(oe.id);ce&&ce.generation>=oe.generation||re.set(oe.id,{id:oe.id,generation:oe.generation,byteOffset:oe.byteOffset})}for(const oe of $){if(this.isFreed(oe)||re.get(oe.id))continue;const he=re.get(oe.streamId)?.byteOffset;he&&re.set(oe.id,{id:oe.id,generation:oe.generation,byteOffset:he,compressed:!0,streamId:oe.streamId,streamIndex:oe.streamIndex})}this.usedMap=re}getOffset(e){return this.usedMap.get(e)?.byteOffset}getGeneration(e){return this.usedMap.get(e)?.generation}isFreed(e){return this.freeOutsideListMap.has(e.id)||this.freeLinkedList.has(e,(C,F)=>C.id===F.id&&C.generation<F.generation)}isUsed(e){return this.usedMap.has(e)}}class CatalogDict extends PdfDict{Version;Pages;Lang;constructor(){super(dictTypes.CATALOG)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new CatalogDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Version&&$.push(...F.encode("/Version "),...F.encode(this.Version)),this.Pages&&$.push(...F.encode("/Pages "),...this.Pages.toArray(e)),this.Lang&&$.push(...F.encode("/Lang "),...this.Lang.toArray(e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Version":V=await this.parseNamePropAsync(te,C,V);break;case"/Pages":V=await this.parseRefPropAsync(te,C,V);break;case"/Lang":V=await this.parseLiteralPropAsync(te,C,V,e.cryptInfo);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Pages)throw new Error("Not all required properties parsed")}}class PageDict extends PdfDict{Parent;LastModified;Resources;MediaBox;CropBox;BleedBox;TrimBox;ArtBox;Contents;Rotate=0;Thumb;B;Dur;Annots;Metadata;StructParent;ID;PZ;Tabs;TemplateInstantiated;UserUnit;constructor(){super(dictTypes.PAGE)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new PageDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Parent&&$.push(...F.encode("/Parent "),...this.Parent.toArray(e)),this.LastModified&&$.push(...F.encode("/LastModified "),...this.LastModified.toArray(e)),this.Resources&&$.push(...F.encode("/Resources "),...this.Resources),this.MediaBox&&$.push(...F.encode("/MediaBox "),...this.encodePrimitiveArray(this.MediaBox,F)),this.CropBox&&$.push(...F.encode("/CropBox "),...this.encodePrimitiveArray(this.CropBox,F)),this.BleedBox&&$.push(...F.encode("/BleedBox "),...this.encodePrimitiveArray(this.BleedBox,F)),this.TrimBox&&$.push(...F.encode("/TrimBox "),...this.encodePrimitiveArray(this.TrimBox,F)),this.ArtBox&&$.push(...F.encode("/ArtBox "),...this.encodePrimitiveArray(this.ArtBox,F)),this.Contents&&(this.Contents instanceof ObjectId?$.push(...F.encode("/Contents "),...this.Contents.toArray(e)):$.push(...F.encode("/Contents "),...this.encodeSerializableArray(this.Contents,e))),this.Rotate&&$.push(...F.encode("/Rotate "),...F.encode(" "+this.Rotate)),this.Thumb&&$.push(...F.encode("/Thumb "),...this.Thumb.toArray(e)),this.B&&(this.B instanceof ObjectId?$.push(...F.encode("/B "),...this.B.toArray(e)):$.push(...F.encode("/B "),...this.encodeSerializableArray(this.B,e))),this.Dur&&$.push(...F.encode("/Dur "),...F.encode(" "+this.Dur)),this.Annots&&(this.Annots instanceof ObjectId?$.push(...F.encode("/Annots "),...this.Annots.toArray(e)):$.push(...F.encode("/Annots "),...this.encodeSerializableArray(this.Annots,e))),this.Metadata&&$.push(...F.encode("/Metadata "),...this.Metadata.toArray(e)),this.StructParent&&$.push(...F.encode("/StructParent "),...F.encode(" "+this.StructParent)),this.ID&&$.push(...F.encode("/ID "),...this.ID.toArray(e)),this.PZ&&$.push(...F.encode("/PZ "),...F.encode(" "+this.PZ)),this.Tabs&&$.push(...F.encode("/Tabs "),...F.encode(this.Tabs)),this.TemplateInstantiated&&$.push(...F.encode("/TemplateInstantiated "),...F.encode(this.TemplateInstantiated)),this.UserUnit&&$.push(...F.encode("/UserUnit "),...F.encode(" "+this.UserUnit));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Parent":case"/Thumb":case"/Metadata":V=await this.parseRefPropAsync(te,C,V);break;case"/LastModified":V=await this.parseDatePropAsync(te,C,V,e.cryptInfo);break;case"/Resources":const ne=await C.getValueTypeAtAsync(V);if(ne===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae&&e.parseInfoGetterAsync){this.Resources=await C.sliceCharCodesAsync(ae.start,ae.end),V=ae.end+1;break}throw new Error("Can't parse /Resources value reference")}else if(ne===valueTypes.DICTIONARY){const ae=await C.getDictBoundsAtAsync(V);if(ae){this.Resources=await C.sliceCharCodesAsync(ae.start,ae.end),V=ae.end+1;break}throw new Error("Can't parse /Resources dictionary bounds")}throw new Error(`Unsupported /Resources property value type: ${ne}`);case"/MediaBox":case"/CropBox":case"/BleedBox":case"/TrimBox":case"/ArtBox":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/Contents":case"/B":case"/Annots":const ee=await C.getValueTypeAtAsync(V);if(ee===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae){this[te.slice(1)]=ae.value,V=ae.end+1;break}}else if(ee===valueTypes.ARRAY){const ae=await ObjectId.parseRefArrayAsync(C,V);if(ae){this[te.slice(1)]=ae.value,V=ae.end+1;break}}throw new Error(`Unsupported ${te} property value type: ${ee}`);case"/Rotate":case"/Dur":case"/StructParent":case"/PZ":case"/UserUnit":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/ID":const ie=await C.getValueTypeAtAsync(V);if(ie===valueTypes.REF){const ae=await ObjectId.parseRefAsync(C,V);if(ae&&ae&&e.parseInfoGetterAsync){const re=await e.parseInfoGetterAsync(ae.value.id);if(re){const oe=await HexString.parseAsync(re.parser,re.bounds.start,re.cryptInfo);if(oe){this.ID=oe.value,V=ae.end+1;break}}}throw new Error("Can't parse /ID property value")}else if(ie===valueTypes.STRING_HEX){const ae=await HexString.parseAsync(C,V,e.cryptInfo);if(ae){this.ID=ae.value,V=ae.end+1;break}}throw new Error(`Unsupported /ID property value type: ${ie}`);case"/Tabs":case"/TemplateInstantiated":V=await this.parseNamePropAsync(te,C,V);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Parent)throw new Error("Not all required properties parsed")}}class PageTreeDict extends PdfDict{Parent;Kids;Count;MediaBox;Rotate=0;constructor(){super(dictTypes.PAGE_TREE)}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new PageTreeDict;return await C.parsePropsAsync(e),{value:C,start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Parent&&$.push(...F.encode("/Parent "),...this.Parent.toArray(e)),this.Kids&&$.push(...F.encode("/Kids "),...this.encodeSerializableArray(this.Kids,e)),this.Count&&$.push(...F.encode("/Count "),...F.encode(" "+this.Count)),this.MediaBox&&$.push(...F.encode("/MediaBox "),...this.encodePrimitiveArray(this.MediaBox,F)),this.Rotate&&$.push(...F.encode("/Rotate "),...F.encode(" "+this.Rotate));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Parent":V=await this.parseRefPropAsync(te,C,V);break;case"/Kids":V=await this.parseRefArrayPropAsync(te,C,V);break;case"/Count":case"/Rotate":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/MediaBox":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Kids||isNaN(this.Count))throw new Error("Not all required properties parsed")}}const standardStampColors={redColor:[.804,0,0],greenColor:[0,.804,0],blueColor:[0,0,.804]},standardStampBBox=[0,0,440,120],standardStampRect=[0,0,220,60],standardStampForms={DRAFT:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  150 61 m
  150.047 65.947 149.114 70.413 147.2 74.4 c
  145.287 78.333 142.853 81.373 139.9 83.52 c
  137.68 85.127 135.24 86.263 132.58 86.93 c
  129.92 87.593 126.763 87.957 123.11 88.02 c
  106.91 88.29 l
  106.401 35.19 l
  123.001 34.912 l
  126.734 34.85 129.961 35.165 132.681 35.857 c
  135.394 36.524 137.681 37.507 139.541 38.807 c
  142.721 40.994 145.234 43.974 147.081 47.747 c
  148.941 51.5 149.898 55.934 149.951 61.047 c
  h
  137.8 61.097 m
  137.767 57.597 137.183 54.621 136.05 52.167 c
  134.937 49.687 133.183 47.764 130.79 46.397 c
  129.57 45.731 128.323 45.287 127.05 45.067 c
  125.797 44.827 123.897 44.728 121.35 44.77 c
  118.36 44.82 l
  118.678 78.12 l
  121.668 78.07 l
  124.481 78.023 126.541 77.846 127.848 77.538 c
  129.161 77.207 130.438 76.637 131.678 75.828 c
  133.818 74.362 135.381 72.432 136.368 70.038 c
  137.348 67.618 137.821 64.648 137.788 61.128 c
  f
  185 50 m
  184.987 48.667 184.74 47.53 184.259 46.59 c
  183.778 45.643 182.961 44.907 181.809 44.38 c
  181.002 44.013 180.066 43.802 178.999 43.749 c
  177.932 43.672 176.689 43.645 175.269 43.669 c
  170.989 43.74 l
  171.126 58.04 l
  174.756 57.979 l
  176.643 57.948 178.223 57.814 179.496 57.579 c
  180.769 57.344 181.833 56.837 182.686 56.059 c
  183.499 55.306 184.086 54.486 184.446 53.599 c
  184.827 52.686 185.011 51.483 184.996 49.989 c
  h
  203.8 86.6 m
  189.4 86.841 l
  176.7 67.541 l
  171.25 67.632 l
  171.437 87.132 l
  159.637 87.329 l
  159.128 34.229 l
  178.928 33.897 l
  181.635 33.852 183.965 33.991 185.918 34.315 c
  187.871 34.639 189.705 35.382 191.418 36.545 c
  193.151 37.705 194.531 39.228 195.558 41.115 c
  196.605 42.975 197.141 45.335 197.168 48.195 c
  197.206 52.122 196.446 55.335 194.888 57.835 c
  193.355 60.335 191.138 62.432 188.238 64.125 c
  f
  251 85.8 m
  238.8 86.004 l
  235.53 75.304 l
  218.53 75.588 l
  215.46 86.388 l
  203.56 86.587 l
  219.96 33.187 l
  233.56 32.959 l
  h
  232.6 65.6 m
  226.78 46.6 l
  221.33 65.8 l
  f
  290 42.3 m
  268.9 42.653 l
  268.995 52.543 l
  288.495 52.216 l
  288.593 62.516 l
  269.093 62.843 l
  269.31 85.543 l
  257.51 85.74 l
  257.001 32.64 l
  289.801 32.091 l
  f
  334 41.5 m
  319.7 41.739 l
  320.11 84.639 l
  308.31 84.837 l
  307.9 41.937 l
  293.6 42.176 l
  293.502 31.876 l
  333.902 31.199 l
  f
  `,APPROVED:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  88.9 86.4 m
  78 86.585 l
  75.08 76.895 l
  59.88 77.153 l
  57.14 86.933 l
  46.54 87.114 l
  61.24 38.714 l
  73.34 38.508 l
  h
  72.4 68.1 m
  67.21 50.9 l
  62.35 68.3 l
  f
  128 52.8 m
  128.02 54.953 127.72 57.073 127.098 59.16 c
  126.477 61.22 125.577 62.96 124.398 64.38 c
  122.785 66.307 120.975 67.77 118.968 68.77 c
  116.981 69.777 114.495 70.303 111.508 70.35 c
  104.938 70.462 l
  105.086 86.162 l
  94.586 86.341 l
  94.132 38.141 l
  111.532 37.846 l
  114.132 37.802 116.322 38.034 118.102 38.543 c
  119.902 39.03 121.492 39.79 122.872 40.823 c
  124.532 42.07 125.802 43.676 126.682 45.643 c
  127.582 47.61 128.045 49.986 128.072 52.773 c
  h
  117.1 53.276 m
  117.087 51.916 116.765 50.756 116.133 49.796 c
  115.501 48.816 114.771 48.139 113.943 47.766 c
  112.836 47.267 111.763 47.005 110.723 46.98 c
  109.676 46.933 108.283 46.924 106.543 46.954 c
  104.733 46.985 l
  104.869 61.385 l
  107.889 61.333 l
  109.682 61.303 111.156 61.149 112.309 60.87 c
  113.476 60.592 114.449 60.058 115.229 59.27 c
  115.902 58.57 116.379 57.744 116.659 56.79 c
  116.961 55.817 117.106 54.64 117.093 53.26 c
  f
  170 52.1 m
  170.02 54.253 169.72 56.373 169.098 58.46 c
  168.477 60.52 167.577 62.26 166.398 63.68 c
  164.785 65.607 162.975 67.07 160.968 68.07 c
  158.981 69.077 156.495 69.603 153.508 69.65 c
  146.938 69.762 l
  147.086 85.462 l
  136.586 85.641 l
  136.132 37.441 l
  153.532 37.146 l
  156.132 37.102 158.322 37.334 160.102 37.843 c
  161.902 38.33 163.492 39.09 164.872 40.123 c
  166.532 41.37 167.802 42.976 168.682 44.943 c
  169.582 46.91 170.045 49.286 170.072 52.073 c
  h
  159.1 52.576 m
  159.087 51.216 158.765 50.056 158.133 49.096 c
  157.501 48.116 156.771 47.439 155.943 47.066 c
  154.836 46.567 153.763 46.305 152.723 46.28 c
  151.676 46.233 150.283 46.224 148.543 46.254 c
  146.733 46.285 l
  146.869 60.685 l
  149.889 60.633 l
  151.682 60.603 153.156 60.449 154.309 60.17 c
  155.476 59.892 156.449 59.358 157.229 58.57 c
  157.902 57.87 158.379 57.044 158.659 56.09 c
  158.961 55.117 159.106 53.94 159.093 52.56 c
  f
  200 51.1 m
  199.989 49.893 199.768 48.863 199.339 48.01 c
  198.91 47.157 198.18 46.49 197.149 46.01 c
  196.429 45.677 195.592 45.487 194.639 45.438 c
  193.686 45.368 192.576 45.344 191.309 45.365 c
  187.489 45.43 l
  187.611 58.43 l
  190.851 58.375 l
  192.538 58.346 193.948 58.225 195.081 58.012 c
  196.214 57.799 197.161 57.342 197.921 56.642 c
  198.648 55.962 199.171 55.219 199.491 54.412 c
  199.831 53.585 199.995 52.492 199.982 51.132 c
  h
  216.8 84.2 m
  203.9 84.419 l
  192.6 66.919 l
  187.74 67.002 l
  187.906 84.702 l
  177.406 84.88 l
  176.952 36.68 l
  194.652 36.379 l
  197.072 36.338 199.152 36.464 200.892 36.758 c
  202.632 37.052 204.269 37.725 205.802 38.778 c
  207.349 39.831 208.579 41.211 209.492 42.918 c
  210.425 44.604 210.902 46.741 210.922 49.328 c
  210.956 52.888 210.279 55.801 208.892 58.068 c
  207.519 60.334 205.539 62.234 202.952 63.768 c
  f
  261 59.4 m
  261.073 67.067 259.263 73.2 255.57 77.8 c
  251.877 82.373 246.743 84.713 240.17 84.82 c
  233.597 84.932 228.43 82.765 224.67 78.32 c
  220.89 73.853 218.963 67.787 218.89 60.12 c
  218.817 52.387 220.627 46.253 224.32 41.72 c
  228.013 37.147 233.147 34.807 239.72 34.7 c
  246.273 34.589 251.44 36.755 255.22 41.2 c
  259.013 45.62 260.947 51.687 261.02 59.4 c
  h
  247.1 71.8 m
  248.113 70.313 248.857 68.577 249.33 66.59 c
  249.805 64.577 250.03 62.223 250.005 59.53 c
  249.978 56.643 249.671 54.19 249.084 52.17 c
  248.497 50.15 247.741 48.523 246.814 47.29 c
  245.867 46.01 244.777 45.09 243.544 44.53 c
  242.331 43.968 241.064 43.698 239.744 43.721 c
  238.404 43.744 237.144 44.045 235.964 44.626 c
  234.797 45.207 233.724 46.153 232.744 47.466 c
  231.837 48.686 231.101 50.369 230.534 52.516 c
  229.986 54.636 229.725 57.099 229.752 59.906 c
  229.779 62.773 230.077 65.216 230.645 67.236 c
  231.232 69.229 231.988 70.856 232.915 72.116 c
  233.842 73.376 234.922 74.296 236.155 74.876 c
  237.388 75.459 238.682 75.739 240.035 75.716 c
  241.388 75.693 242.675 75.369 243.895 74.745 c
  245.115 74.099 246.178 73.122 247.085 71.815 c
  f
  306 34.6 m
  291.5 83 l
  279.7 83.201 l
  264.3 35.301 l
  275.4 35.113 l
  285.6 68.813 l
  295.17 34.813 l
  f
  342 82.1 m
  312.4 82.603 l
  311.946 34.403 l
  341.546 33.9 l
  341.634 43.22 l
  322.534 43.544 l
  322.612 51.854 l
  340.312 51.553 l
  340.4 60.873 l
  322.7 61.174 l
  322.812 73.074 l
  341.912 72.75 l
  f
  389 57.3 m
  389.042 61.787 388.209 65.82 386.5 69.4 c
  384.793 72.967 382.62 75.72 379.98 77.66 c
  378 79.12 375.82 80.15 373.44 80.75 c
  371.067 81.351 368.25 81.68 364.99 81.735 c
  350.59 81.98 l
  350.136 33.78 l
  364.936 33.528 l
  368.269 33.471 371.146 33.757 373.566 34.384 c
  375.993 34.99 378.033 35.883 379.686 37.064 c
  382.526 39.044 384.769 41.744 386.416 45.164 c
  388.076 48.564 388.929 52.597 388.976 57.264 c
  h
  378.1 57.388 m
  378.07 54.222 377.55 51.525 376.54 49.298 c
  375.547 47.052 373.983 45.308 371.85 44.068 c
  370.763 43.461 369.65 43.058 368.51 42.858 c
  367.39 42.64 365.693 42.551 363.42 42.589 c
  360.76 42.634 l
  361.044 72.734 l
  363.704 72.689 l
  366.211 72.647 368.051 72.486 369.224 72.207 c
  370.391 71.907 371.531 71.391 372.644 70.657 c
  374.557 69.331 375.951 67.581 376.824 65.407 c
  377.704 63.214 378.127 60.521 378.094 57.327 c
  f
  `,NOT_APPROVED:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  57.1 85.5 m
  49.12 85.636 l
  35.32 55.036 l
  35.469 85.936 l
  27.879 86.066 l
  27.662 41.066 l
  37.562 40.897 l
  49.362 66.497 l
  49.238 40.697 l
  56.828 40.567 l
  f
  96.4 62.4 m
  96.435 69.533 94.995 75.267 92.08 79.6 c
  89.167 83.86 85.133 86.033 79.98 86.12 c
  74.82 86.208 70.753 84.175 67.78 80.02 c
  64.827 75.84 63.333 70.173 63.3 63.02 c
  63.265 55.82 64.705 50.087 67.62 45.82 c
  70.533 41.56 74.567 39.387 79.72 39.3 c
  84.867 39.212 88.933 41.245 91.92 45.4 c
  94.887 49.533 96.387 55.2 96.42 62.4 c
  h
  85.5 74 m
  86.3 72.62 86.89 71 87.27 69.14 c
  87.649 67.26 87.833 65.063 87.82 62.55 c
  87.807 59.85 87.573 57.56 87.118 55.68 c
  86.663 53.793 86.073 52.273 85.348 51.12 c
  84.608 49.927 83.755 49.067 82.788 48.54 c
  81.835 48.013 80.841 47.758 79.808 47.776 c
  78.761 47.794 77.771 48.073 76.838 48.612 c
  75.918 49.151 75.075 50.031 74.308 51.252 c
  73.595 52.392 73.011 53.962 72.558 55.962 c
  72.122 57.942 71.91 60.242 71.923 62.862 c
  71.936 65.542 72.163 67.822 72.603 69.702 c
  73.058 71.569 73.648 73.089 74.373 74.262 c
  75.1 75.435 75.946 76.295 76.913 76.842 c
  77.88 77.389 78.893 77.654 79.953 77.635 c
  81.02 77.617 82.033 77.318 82.993 76.738 c
  83.953 76.138 84.79 75.228 85.503 74.008 c
  f
  128 48 m
  118 48.172 l
  118.175 84.472 l
  109.895 84.614 l
  109.72 48.314 l
  99.72 48.486 l
  99.678 39.786 l
  127.978 39.301 l
  f
  178 83.4 m
  169.44 83.546 l
  167.18 74.496 l
  155.28 74.7 l
  153.1 83.83 l
  144.76 83.973 l
  156.36 38.773 l
  165.89 38.61 l
  h
  165.1 66.3 m
  161.08 50.2 l
  157.21 66.4 l
  f
  209 52.1 m
  209.01 54.113 208.768 56.09 208.274 58.03 c
  207.78 59.95 207.07 61.573 206.144 62.9 c
  204.871 64.693 203.447 66.057 201.874 66.99 c
  200.314 67.923 198.361 68.41 196.014 68.45 c
  190.864 68.538 l
  190.935 83.138 l
  182.655 83.28 l
  182.438 38.28 l
  196.038 38.047 l
  198.078 38.012 199.798 38.235 201.198 38.714 c
  202.611 39.173 203.858 39.886 204.938 40.854 c
  206.238 42.021 207.231 43.524 207.918 45.364 c
  208.618 47.204 208.974 49.421 208.988 52.014 c
  h
  200.44 52.518 m
  200.434 51.251 200.184 50.168 199.691 49.268 c
  199.198 48.348 198.628 47.715 197.981 47.368 c
  197.114 46.9 196.271 46.653 195.451 46.626 c
  194.631 46.58 193.538 46.568 192.171 46.592 c
  190.751 46.616 l
  190.816 60.116 l
  193.186 60.075 l
  194.593 60.051 195.749 59.911 196.656 59.653 c
  197.576 59.396 198.343 58.899 198.956 58.163 c
  199.485 57.51 199.861 56.74 200.086 55.853 c
  200.326 54.947 200.443 53.847 200.437 52.553 c
  f
  241 51.6 m
  241.01 53.613 240.768 55.59 240.274 57.53 c
  239.78 59.45 239.07 61.073 238.144 62.4 c
  236.871 64.193 235.447 65.557 233.874 66.49 c
  232.314 67.423 230.361 67.91 228.014 67.95 c
  222.864 68.038 l
  222.935 82.638 l
  214.655 82.78 l
  214.438 37.78 l
  228.038 37.547 l
  230.078 37.512 231.798 37.735 233.198 38.214 c
  234.611 38.673 235.858 39.386 236.938 40.354 c
  238.238 41.521 239.231 43.024 239.918 44.864 c
  240.618 46.704 240.974 48.921 240.988 51.514 c
  h
  232.44 52.018 m
  232.434 50.751 232.184 49.668 231.691 48.768 c
  231.198 47.848 230.628 47.215 229.981 46.868 c
  229.114 46.4 228.271 46.153 227.451 46.126 c
  226.631 46.08 225.538 46.068 224.171 46.092 c
  222.751 46.116 l
  222.816 59.616 l
  225.186 59.575 l
  226.593 59.551 227.749 59.411 228.656 59.153 c
  229.576 58.896 230.343 58.399 230.956 57.663 c
  231.485 57.01 231.861 56.24 232.086 55.353 c
  232.326 54.447 232.443 53.347 232.437 52.053 c
  f
  265 50.7 m
  264.995 49.573 264.825 48.61 264.49 47.81 c
  264.155 47.01 263.585 46.387 262.78 45.94 c
  262.218 45.627 261.565 45.447 260.82 45.4 c
  260.073 45.332 259.203 45.307 258.21 45.324 c
  255.21 45.375 l
  255.269 57.475 l
  257.809 57.432 l
  259.129 57.409 260.235 57.299 261.129 57.103 c
  262.022 56.906 262.769 56.479 263.369 55.823 c
  263.941 55.189 264.354 54.499 264.609 53.753 c
  264.878 52.986 265.01 51.966 265.004 50.693 c
  h
  278.1 81.7 m
  268 81.873 l
  259.17 65.573 l
  255.35 65.638 l
  255.43 82.138 l
  247.19 82.279 l
  246.973 37.279 l
  260.873 37.041 l
  262.773 37.009 264.406 37.132 265.773 37.41 c
  267.139 37.689 268.423 38.322 269.623 39.31 c
  270.836 40.297 271.799 41.59 272.513 43.19 c
  273.239 44.77 273.609 46.767 273.623 49.18 c
  273.639 52.5 273.099 55.217 272.003 57.33 c
  270.923 59.444 269.366 61.21 267.333 62.63 c
  f
  313 58.7 m
  313.035 65.833 311.595 71.567 308.68 75.9 c
  305.767 80.16 301.733 82.333 296.58 82.42 c
  291.42 82.508 287.353 80.475 284.38 76.32 c
  281.427 72.14 279.933 66.473 279.9 59.32 c
  279.865 52.12 281.305 46.387 284.22 42.12 c
  287.133 37.86 291.167 35.687 296.32 35.6 c
  301.467 35.512 305.533 37.545 308.52 41.7 c
  311.487 45.833 312.987 51.5 313.02 58.7 c
  h
  302.1 70.3 m
  302.9 68.92 303.49 67.3 303.87 65.44 c
  304.249 63.56 304.433 61.363 304.42 58.85 c
  304.407 56.15 304.173 53.86 303.718 51.98 c
  303.263 50.093 302.673 48.573 301.948 47.42 c
  301.208 46.227 300.355 45.367 299.388 44.84 c
  298.435 44.313 297.441 44.058 296.408 44.076 c
  295.361 44.094 294.371 44.373 293.438 44.912 c
  292.518 45.451 291.675 46.331 290.908 47.552 c
  290.195 48.692 289.611 50.262 289.158 52.262 c
  288.722 54.242 288.51 56.542 288.523 59.162 c
  288.536 61.842 288.763 64.122 289.203 66.002 c
  289.658 67.869 290.248 69.389 290.973 70.562 c
  291.7 71.735 292.546 72.595 293.513 73.142 c
  297.62 73.917 298.633 73.618 299.593 73.038 c
  300.553 72.438 301.39 71.528 302.103 70.308 c
  f
  348 35.6 m
  336.5 80.8 l
  327.23 80.959 l
  315.33 36.159 l
  324.02 36.01 l
  331.93 67.41 l
  339.54 35.71 l
  f
  376 80 m
  352.8 80.397 l
  352.583 35.397 l
  375.783 35 l
  375.825 43.7 l
  360.825 43.956 l
  360.863 51.716 l
  374.762 51.478 l
  374.804 60.178 l
  360.904 60.416 l
  360.958 71.516 l
  375.958 71.26 l
  f
  413 57 m
  413.02 61.187 412.357 64.953 411.01 68.3 c
  409.663 71.627 407.95 74.193 405.87 76 c
  404.31 77.353 402.597 78.31 400.73 78.87 c
  398.863 79.425 396.65 79.725 394.09 79.769 c
  382.79 79.963 l
  382.573 34.963 l
  394.173 34.764 l
  396.786 34.719 399.043 34.993 400.943 35.584 c
  402.843 36.155 404.443 36.992 405.743 38.094 c
  407.963 39.947 409.713 42.474 410.993 45.674 c
  412.286 48.854 412.943 52.621 412.963 56.974 c
  h
  404.44 57.056 m
  404.426 54.096 404.026 51.576 403.24 49.496 c
  402.467 47.396 401.243 45.766 399.57 44.606 c
  398.717 44.037 397.847 43.66 396.96 43.476 c
  396.08 43.269 394.75 43.181 392.97 43.212 c
  390.88 43.248 l
  391.016 71.348 l
  393.106 71.312 l
  395.073 71.278 396.516 71.133 397.436 70.876 c
  398.356 70.599 399.253 70.122 400.126 69.446 c
  401.626 68.213 402.726 66.583 403.426 64.556 c
  404.119 62.509 404.459 59.996 404.446 57.016 c
  f
  `,DEPARTMENTAL:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  56.4 63.1 m
  56.412 67.46 55.746 71.393 54.4 74.9 c
  53.06 78.36 51.36 81.03 49.3 82.91 c
  47.753 84.317 46.053 85.31 44.2 85.89 c
  26.42 86.996 l
  26.286 40.196 l
  37.786 40.009 l
  40.379 39.967 42.616 40.256 44.496 40.875 c
  46.376 41.474 47.959 42.35 49.246 43.505 c
  51.446 45.438 53.176 48.072 54.436 51.405 c
  55.709 54.718 56.353 58.652 56.366 63.205 c
  h
  47.92 63.143 m
  47.911 60.063 47.518 57.437 46.74 55.263 c
  45.98 53.077 44.773 51.377 43.12 50.163 c
  42.28 49.569 41.417 49.175 40.53 48.983 c
  39.663 48.767 38.347 48.673 36.58 48.701 c
  34.51 48.735 l
  34.594 78.035 l
  36.664 78.001 l
  38.617 77.97 40.047 77.821 40.954 77.554 c
  41.867 77.267 42.757 76.77 43.624 76.064 c
  45.117 74.784 46.207 73.088 46.894 70.974 c
  47.587 68.848 47.927 66.231 47.914 63.124 c
  f
  85.8 86 m
  62.8 86.373 l
  62.666 39.573 l
  85.666 39.2 l
  85.692 48.26 l
  70.892 48.501 l
  70.915 56.581 l
  84.715 56.357 l
  84.741 65.417 l
  70.941 65.641 l
  70.974 77.241 l
  85.774 77 l
  f
  119 53.4 m
  119.006 55.493 118.763 57.553 118.27 59.58 c
  117.777 61.58 117.071 63.27 116.15 64.65 c
  114.89 66.517 113.477 67.933 111.91 68.9 c
  110.363 69.867 108.43 70.37 106.11 70.41 c
  101.01 70.493 l
  101.054 85.793 l
  92.854 85.926 l
  92.72 39.126 l
  106.22 38.907 l
  108.24 38.874 109.943 39.108 111.33 39.61 c
  112.723 40.091 113.956 40.837 115.03 41.85 c
  116.316 43.063 117.296 44.63 117.97 46.55 c
  118.656 48.47 119.003 50.78 119.01 53.48 c
  h
  110.52 53.821 m
  110.516 52.501 110.271 51.374 109.784 50.441 c
  109.297 49.488 108.734 48.824 108.094 48.451 c
  107.241 47.962 106.407 47.703 105.594 47.674 c
  104.781 47.624 103.697 47.61 102.344 47.632 c
  100.934 47.655 l
  100.974 61.655 l
  103.324 61.617 l
  104.717 61.595 105.864 61.45 106.764 61.184 c
  107.677 60.918 108.437 60.401 109.044 59.634 c
  109.569 58.954 109.945 58.151 110.174 57.224 c
  110.413 56.278 110.531 55.134 110.527 53.794 c
  f
  154 84.9 m
  145.52 85.038 l
  143.29 75.608 l
  131.49 75.799 l
  129.32 85.299 l
  121.06 85.433 l
  132.66 38.433 l
  142.1 38.28 l
  h
  141.3 67.1 m
  137.34 50.4 l
  133.48 67.3 l
  f
  176 52 m
  175.997 50.827 175.83 49.823 175.5 48.99 c
  175.17 48.157 174.607 47.507 173.81 47.04 c
  173.254 46.713 172.604 46.525 171.86 46.474 c
  171.12 46.402 170.26 46.374 169.28 46.39 c
  166.31 46.438 l
  166.346 59.038 l
  168.866 58.998 l
  170.173 58.976 171.269 58.864 172.156 58.662 c
  173.036 58.458 173.776 58.015 174.376 57.332 c
  174.943 56.672 175.353 55.952 175.606 55.172 c
  175.874 54.372 176.006 53.312 176.003 51.992 c
  h
  188.9 84.3 m
  178.9 84.463 l
  170.18 67.463 l
  166.4 67.524 l
  166.449 84.724 l
  158.289 84.856 l
  158.155 38.056 l
  171.955 37.833 l
  173.835 37.803 175.452 37.934 176.805 38.226 c
  178.158 38.519 179.428 39.179 180.615 40.206 c
  181.815 41.233 182.765 42.58 183.465 44.246 c
  184.178 45.893 184.542 47.973 184.555 50.486 c
  184.565 53.946 184.025 56.776 182.935 58.976 c
  181.862 61.176 180.315 63.016 178.295 64.496 c
  f
  218 46.1 m
  208.07 46.261 l
  208.178 84.061 l
  199.978 84.194 l
  199.87 46.394 l
  189.94 46.555 l
  189.914 37.495 l
  218.014 37.039 l
  f
  256 83.2 m
  247.84 83.332 l
  247.75 51.932 l
  241.91 72.332 l
  236.25 72.424 l
  230.3 52.124 l
  230.39 83.524 l
  222.66 83.65 l
  222.526 36.85 l
  232.046 36.695 l
  239.266 60.095 l
  246.336 36.495 l
  255.856 36.34 l
  f
  287 82.7 m
  264 83.073 l
  263.866 36.273 l
  286.866 35.9 l
  286.892 44.96 l
  272.092 45.201 l
  272.115 53.281 l
  285.915 53.057 l
  285.941 62.117 l
  272.141 62.341 l
  272.174 73.941 l
  286.974 73.7 l
  f
  323 82.2 m
  315.1 82.328 l
  301.5 50.428 l
  301.592 82.528 l
  294.072 82.65 l
  293.938 35.85 l
  303.738 35.691 l
  315.438 62.291 l
  315.361 35.491 l
  322.881 35.369 l
  f
  356 43.9 m
  346.07 44.061 l
  346.178 81.861 l
  337.978 81.994 l
  337.87 44.194 l
  327.94 44.355 l
  327.914 35.295 l
  356.014 34.839 l
  f
  390 81.1 m
  381.52 81.238 l
  379.29 71.808 l
  367.49 71.999 l
  365.32 81.499 l
  357.06 81.633 l
  368.66 34.633 l
  378.1 34.48 l
  h
  377.3 63.3 m
  373.34 46.6 l
  369.48 63.5 l
  f
  418 80.6 m
  395.1 80.972 l
  394.966 34.172 l
  403.166 34.039 l
  403.274 71.839 l
  417.974 71.6 l
  f
  `,CONFIDENTIAL:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  48 86.5 m
  45.613 86.541 43.403 86.084 41.37 85.13 c
  39.35 84.177 37.61 82.737 36.15 80.81 c
  34.69 78.883 33.55 76.467 32.73 73.56 c
  31.923 70.653 31.513 67.287 31.5 63.46 c
  31.483 59.9 31.849 56.663 32.6 53.75 c
  33.347 50.837 34.44 48.333 35.88 46.24 c
  37.267 44.227 38.983 42.657 41.03 41.53 c
  43.097 40.41 45.35 39.827 47.79 39.78 c
  49.143 39.757 50.36 39.847 51.44 40.05 c
  52.533 40.233 53.54 40.487 54.46 40.814 c
  55.427 41.18 56.297 41.597 57.07 42.064 c
  57.863 42.513 58.557 42.933 59.15 43.324 c
  59.203 54.224 l
  58.254 54.24 l
  57.849 53.764 57.336 53.201 56.714 52.55 c
  56.107 51.896 55.414 51.253 54.634 50.62 c
  53.84 49.99 52.984 49.46 52.064 49.03 c
  51.144 48.603 50.157 48.398 49.104 48.416 c
  47.937 48.436 46.83 48.717 45.784 49.258 c
  44.737 49.78 43.77 50.643 42.884 51.848 c
  42.044 53.008 41.36 54.538 40.834 56.438 c
  40.326 58.338 40.078 60.638 40.091 63.338 c
  40.104 66.158 40.396 68.508 40.966 70.388 c
  41.55 72.268 42.276 73.745 43.146 74.818 c
  44.026 75.912 45.006 76.692 46.086 77.158 c
  47.166 77.603 48.229 77.816 49.276 77.798 c
  50.282 77.781 51.272 77.553 52.246 77.113 c
  53.232 76.674 54.142 76.084 54.976 75.343 c
  55.676 74.747 56.326 74.111 56.926 73.433 c
  57.526 72.76 58.02 72.177 58.406 71.683 c
  59.268 71.668 l
  59.32 82.368 l
  58.52 82.885 57.753 83.372 57.02 83.828 c
  56.286 84.284 55.52 84.68 54.72 85.018 c
  53.673 85.459 52.69 85.799 51.77 86.038 c
  f
  96.6 62.3 m
  96.635 69.433 95.195 75.167 92.28 79.5 c
  89.367 83.76 85.333 85.933 80.18 86.02 c
  75.02 86.108 70.953 84.075 67.98 79.92 c
  65.027 75.74 63.533 70.073 63.5 62.92 c
  63.465 55.72 64.905 49.987 67.82 45.72 c
  70.733 41.46 74.767 39.287 79.92 39.2 c
  85.067 39.112 89.133 41.145 92.12 45.3 c
  95.087 49.433 96.587 55.1 96.62 62.3 c
  h
  85.7 73.9 m
  86.5 72.52 87.09 70.9 87.47 69.04 c
  87.849 67.16 88.033 64.963 88.02 62.45 c
  88.007 59.75 87.773 57.46 87.318 55.58 c
  86.863 53.693 86.273 52.173 85.548 51.02 c
  84.808 49.827 83.955 48.967 82.988 48.44 c
  82.035 47.913 81.041 47.658 80.008 47.676 c
  78.961 47.694 77.971 47.973 77.038 48.512 c
  76.118 49.051 75.275 49.931 74.508 51.152 c
  73.795 52.292 73.211 53.862 72.758 55.862 c
  72.322 57.842 72.11 60.142 72.123 62.762 c
  72.136 65.442 72.363 67.722 72.803 69.602 c
  73.258 71.469 73.848 72.989 74.573 74.162 c
  75.3 75.335 76.146 76.195 77.113 76.742 c
  78.08 77.289 79.093 77.554 80.153 77.535 c
  81.22 77.517 82.233 77.218 83.193 76.638 c
  84.153 76.038 84.99 75.128 85.703 73.908 c
  f
  132 84.2 m
  124.02 84.336 l
  110.22 53.736 l
  110.369 84.636 l
  102.779 84.766 l
  102.562 39.766 l
  112.462 39.597 l
  124.262 65.197 l
  124.138 39.397 l
  131.728 39.267 l
  f
  163 47.4 m
  148.2 47.653 l
  148.24 56.013 l
  161.94 55.779 l
  161.982 64.479 l
  148.282 64.713 l
  148.375 83.913 l
  140.135 84.054 l
  139.918 39.054 l
  162.918 38.66 l
  f
  186 83.3 m
  167.2 83.622 l
  167.161 75.652 l
  172.421 75.562 l
  172.281 46.562 l
  167.022 46.652 l
  166.983 38.682 l
  185.783 38.36 l
  185.822 46.33 l
  180.562 46.42 l
  180.702 75.42 l
  185.962 75.33 l
  f
  223 60.2 m
  223.02 64.387 222.357 68.153 221.01 71.5 c
  219.663 74.827 217.95 77.393 215.87 79.2 c
  214.31 80.553 212.597 81.51 210.73 82.07 c
  208.863 82.625 206.65 82.925 204.09 82.969 c
  192.79 83.163 l
  192.573 38.163 l
  204.173 37.964 l
  206.786 37.919 209.043 38.193 210.943 38.784 c
  212.843 39.355 214.443 40.192 215.743 41.294 c
  217.963 43.147 219.713 45.674 220.993 48.874 c
  222.286 52.054 222.943 55.821 222.963 60.174 c
  h
  214.44 60.256 m
  214.426 57.296 214.026 54.776 213.24 52.696 c
  212.467 50.596 211.243 48.966 209.57 47.806 c
  208.717 47.237 207.847 46.86 206.96 46.676 c
  206.08 46.469 204.75 46.381 202.97 46.412 c
  200.88 46.448 l
  201.016 74.548 l
  203.106 74.512 l
  205.073 74.478 206.516 74.333 207.436 74.076 c
  208.356 73.799 209.253 73.322 210.126 72.646 c
  211.626 71.413 212.726 69.783 213.426 67.756 c
  214.119 65.709 214.459 63.196 214.446 60.216 c
  f
  253 82.1 m
  229.8 82.497 l
  229.583 37.497 l
  252.783 37.1 l
  252.825 45.8 l
  237.825 46.056 l
  237.862 53.816 l
  251.762 53.578 l
  251.804 62.278 l
  237.904 62.516 l
  237.958 73.616 l
  252.958 73.36 l
  f
  289 81.5 m
  281.02 81.636 l
  267.22 51.036 l
  267.369 81.936 l
  259.779 82.066 l
  259.562 37.066 l
  269.462 36.897 l
  281.262 62.497 l
  281.138 36.697 l
  288.728 36.567 l
  f
  322 44.7 m
  312 44.872 l
  312.175 81.172 l
  303.895 81.314 l
  303.72 45.014 l
  293.72 45.186 l
  293.678 36.486 l
  321.978 36.001 l
  f
  345 80.6 m
  326.2 80.922 l
  326.161 72.952 l
  331.421 72.862 l
  331.281 43.862 l
  326.022 43.952 l
  325.983 35.982 l
  344.783 35.66 l
  344.822 43.63 l
  339.562 43.72 l
  339.702 72.72 l
  344.962 72.63 l
  f
  381 79.9 m
  372.44 80.046 l
  370.18 70.996 l
  358.28 71.2 l
  356.1 80.33 l
  347.76 80.473 l
  359.36 35.273 l
  368.89 35.11 l
  h
  368.1 62.8 m
  364.08 46.7 l
  360.21 62.9 l
  f
  409 79.5 m
  385.8 79.896 l
  385.583 34.896 l
  393.863 34.754 l
  394.038 71.054 l
  408.938 70.799 l
  f
  `,FINAL:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  148 44.7 m
  126.9 45.053 l
  126.995 54.943 l
  146.495 54.616 l
  146.593 64.916 l
  127.093 65.243 l
  127.31 87.943 l
  115.51 88.14 l
  115.001 35.04 l
  147.801 34.491 l
  f
  181 87 m
  154.2 87.449 l
  154.11 78.029 l
  161.62 77.903 l
  161.292 43.603 l
  153.782 43.729 l
  153.692 34.309 l
  180.492 33.86 l
  180.582 43.28 l
  173.072 43.406 l
  173.4 77.706 l
  180.91 77.58 l
  f
  233 86.1 m
  221.6 86.291 l
  201.8 50.191 l
  202.149 86.691 l
  191.349 86.872 l
  190.84 33.772 l
  204.94 33.536 l
  221.94 63.736 l
  221.649 33.336 l
  232.449 33.155 l
  f
  287 85.2 m
  274.8 85.404 l
  271.53 74.704 l
  254.53 74.988 l
  251.46 85.788 l
  239.56 85.987 l
  255.96 32.587 l
  269.56 32.359 l
  h
  268.6 65 m
  262.78 46 l
  257.33 65.2 l
  f
  326 84.5 m
  292.9 85.053 l
  292.391 31.953 l
  304.191 31.755 l
  304.601 74.655 l
  325.801 74.3 l
  f
  `,EXPIRED:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  99.4 88.3 m
  66.3 88.855 l
  65.791 35.755 l
  98.891 35.2 l
  98.989 45.5 l
  77.589 45.858 l
  77.677 55.028 l
  97.577 54.696 l
  97.676 64.996 l
  77.776 65.328 l
  77.902 78.428 l
  99.302 78.07 l
  f
  151 87.5 m
  137.3 87.729 l
  127.3 70.429 l
  117.4 88.129 l
  104.3 88.347 l
  120.3 61.347 l
  104.1 35.247 l
  117.7 35.019 l
  127.4 51.419 l
  137.06 34.719 l
  150.16 34.5 l
  134.36 60.6 l
  f
  195 50.4 m
  195.023 52.78 194.686 55.117 193.99 57.41 c
  193.297 59.683 192.29 61.603 190.97 63.17 c
  189.163 65.297 187.137 66.913 184.89 68.02 c
  182.663 69.127 179.877 69.71 176.53 69.77 c
  169.17 69.893 l
  169.336 87.193 l
  157.536 87.391 l
  157.027 34.291 l
  176.527 33.966 l
  179.44 33.917 181.894 34.174 183.887 34.735 c
  185.9 35.272 187.684 36.112 189.237 37.255 c
  191.097 38.628 192.52 40.402 193.507 42.575 c
  194.514 44.748 195.03 47.368 195.057 50.435 c
  h
  182.8 50.926 m
  182.786 49.426 182.426 48.146 181.72 47.086 c
  181.013 46.006 180.197 45.259 179.27 44.846 c
  178.037 44.295 176.833 44.006 175.66 43.978 c
  174.487 43.926 172.927 43.917 170.98 43.949 c
  168.95 43.983 l
  169.102 59.883 l
  172.492 59.827 l
  174.505 59.793 176.155 59.623 177.442 59.316 c
  178.755 59.008 179.849 58.418 180.722 57.546 c
  181.475 56.772 182.012 55.859 182.332 54.806 c
  182.671 53.732 182.833 52.432 182.818 50.906 c
  f
  228 86.2 m
  201.2 86.649 l
  201.11 77.229 l
  208.62 77.103 l
  208.292 42.803 l
  200.782 42.929 l
  200.692 33.509 l
  227.492 33.06 l
  227.582 42.48 l
  220.072 42.606 l
  220.4 76.906 l
  227.91 76.78 l
  f
  263 48.7 m
  262.987 47.367 262.74 46.23 262.259 45.29 c
  261.778 44.343 260.961 43.607 259.809 43.08 c
  259.002 42.713 258.066 42.502 256.999 42.449 c
  255.932 42.372 254.689 42.345 253.269 42.369 c
  248.989 42.44 l
  249.126 56.74 l
  252.756 56.679 l
  254.643 56.648 256.223 56.514 257.496 56.279 c
  258.769 56.044 259.833 55.537 260.686 54.759 c
  261.499 54.006 262.086 53.186 262.446 52.299 c
  262.827 51.386 263.011 50.183 262.996 48.689 c
  h
  281.8 85.3 m
  267.4 85.541 l
  254.7 66.241 l
  249.25 66.332 l
  249.437 85.832 l
  237.637 86.029 l
  237.128 32.929 l
  256.928 32.597 l
  259.635 32.552 261.965 32.691 263.918 33.015 c
  265.871 33.339 267.705 34.082 269.418 35.245 c
  271.151 36.405 272.531 37.928 273.558 39.815 c
  274.605 41.675 275.141 44.035 275.168 46.895 c
  275.206 50.822 274.446 54.035 272.888 56.535 c
  271.355 59.035 269.138 61.132 266.238 62.825 c
  f
  321 84.6 m
  287.9 85.155 l
  287.391 32.055 l
  320.491 31.5 l
  320.589 41.8 l
  299.189 42.158 l
  299.277 51.328 l
  319.177 50.996 l
  319.276 61.296 l
  299.376 61.628 l
  299.502 74.728 l
  320.902 74.37 l
  f
  373 57.2 m
  373.047 62.147 372.114 66.613 370.2 70.6 c
  368.287 74.533 365.853 77.573 362.9 79.72 c
  360.68 81.327 358.24 82.463 355.58 83.13 c
  352.92 83.793 349.763 84.157 346.11 84.22 c
  329.91 84.49 l
  329.401 31.39 l
  346.001 31.112 l
  349.734 31.05 352.961 31.365 355.681 32.057 c
  358.394 32.724 360.681 33.707 362.541 35.007 c
  365.721 37.194 368.234 40.174 370.081 43.947 c
  371.941 47.7 372.898 52.134 372.951 57.247 c
  h
  360.8 57.297 m
  360.767 53.797 360.183 50.821 359.05 48.367 c
  357.937 45.887 356.183 43.964 353.79 42.597 c
  352.57 41.931 351.323 41.487 350.05 41.267 c
  348.797 41.027 346.897 40.928 344.35 40.97 c
  341.36 41.02 l
  341.678 74.32 l
  344.668 74.27 l
  347.481 74.223 349.541 74.046 350.848 73.738 c
  352.161 73.407 353.438 72.837 354.678 72.028 c
  356.818 70.562 358.381 68.632 359.368 66.238 c
  360.348 63.818 360.821 60.848 360.788 57.328 c
  f
  `,AS_IS:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  170 87.2 m
  157.8 87.404 l
  154.53 76.704 l
  137.53 76.988 l
  134.46 87.788 l
  122.56 87.987 l
  138.96 34.587 l
  152.56 34.359 l
  h
  151.6 67 m
  145.78 48 l
  140.33 67.2 l
  f
  213 69.7 m
  213.05 74.933 211.173 79.233 207.37 82.6 c
  203.583 85.927 198.417 87.643 191.87 87.75 c
  188.077 87.813 184.76 87.488 181.92 86.774 c
  179.1 86.034 176.453 85.091 173.98 83.944 c
  173.858 71.244 l
  175.148 71.222 l
  177.615 73.442 180.361 75.132 183.388 76.292 c
  186.435 77.452 189.355 78.009 192.148 77.962 c
  192.868 77.95 193.811 77.863 194.978 77.7 c
  196.145 77.538 197.098 77.284 197.838 76.938 c
  198.738 76.495 199.471 75.948 200.038 75.298 c
  200.627 74.646 200.915 73.689 200.903 72.428 c
  200.892 71.262 200.452 70.268 199.583 69.448 c
  198.736 68.608 197.49 67.975 195.843 67.548 c
  194.116 67.101 192.286 66.691 190.353 66.318 c
  188.44 65.922 186.64 65.415 184.953 64.798 c
  181.08 63.412 178.28 61.495 176.553 59.048 c
  174.846 56.575 173.976 53.495 173.943 49.808 c
  173.896 44.862 175.766 40.795 179.553 37.608 c
  183.36 34.402 188.26 32.748 194.253 32.648 c
  197.266 32.598 200.246 32.893 203.193 33.534 c
  206.153 34.151 208.716 34.954 210.883 35.944 c
  211 48.144 l
  209.74 48.166 l
  207.88 46.486 205.6 45.095 202.9 43.995 c
  200.22 42.875 197.487 42.339 194.7 42.386 c
  193.713 42.402 192.73 42.502 191.75 42.684 c
  190.79 42.843 189.86 43.144 188.96 43.587 c
  188.16 43.958 187.477 44.518 186.91 45.267 c
  186.342 45.994 186.063 46.821 186.072 47.747 c
  186.085 49.154 186.559 50.227 187.492 50.967 c
  188.425 51.687 190.175 52.337 192.742 52.917 c
  194.429 53.293 196.042 53.66 197.582 54.017 c
  199.142 54.372 200.819 54.869 202.612 55.508 c
  206.132 56.781 208.735 58.557 210.422 60.837 c
  212.129 63.091 212.999 66.051 213.032 69.718 c
  f
  267 85.5 m
  240.2 85.949 l
  240.11 76.529 l
  247.62 76.403 l
  247.292 42.103 l
  239.782 42.229 l
  239.692 32.809 l
  266.492 32.36 l
  266.582 41.78 l
  259.072 41.906 l
  259.4 76.206 l
  266.91 76.08 l
  f
  313 68.1 m
  313.05 73.333 311.173 77.633 307.37 81 c
  303.583 84.327 298.417 86.043 291.87 86.15 c
  288.077 86.213 284.76 85.888 281.92 85.174 c
  279.1 84.434 276.453 83.491 273.98 82.344 c
  273.858 69.644 l
  275.148 69.622 l
  277.615 71.842 280.361 73.532 283.388 74.692 c
  286.435 75.852 289.355 76.409 292.148 76.362 c
  292.868 76.35 293.811 76.263 294.978 76.1 c
  298.738 74.895 299.471 74.348 300.038 73.698 c
  300.627 73.046 300.915 72.089 300.903 70.828 c
  300.892 69.662 300.452 68.668 299.583 67.848 c
  298.736 67.008 297.49 66.375 295.843 65.948 c
  294.116 65.501 292.286 65.091 290.353 64.718 c
  288.44 64.322 286.64 63.815 284.953 63.198 c
  281.08 61.812 278.28 59.895 276.553 57.448 c
  274.846 54.975 273.976 51.895 273.943 48.208 c
  273.896 43.262 275.766 39.195 279.553 36.008 c
  283.36 32.802 288.26 31.148 294.253 31.048 c
  297.266 30.998 300.246 31.293 303.193 31.934 c
  306.153 32.551 308.716 33.354 310.883 34.344 c
  311 46.544 l
  309.74 46.565 l
  307.88 44.885 305.6 43.495 302.9 42.395 c
  300.22 41.275 297.487 40.739 294.7 40.785 c
  293.713 40.802 292.73 40.902 291.75 41.084 c
  290.79 41.243 289.86 41.544 288.96 41.987 c
  288.16 42.357 287.477 42.917 286.91 43.667 c
  286.342 44.394 286.063 45.221 286.072 46.147 c
  286.085 47.554 286.559 48.627 287.492 49.367 c
  288.425 50.087 290.175 50.737 292.742 51.317 c
  294.429 51.693 296.042 52.06 297.582 52.417 c
  299.142 52.772 300.819 53.269 302.612 53.907 c
  306.132 55.181 308.735 56.957 310.422 59.237 c
  312.129 61.491 312.999 64.451 313.032 68.117 c
  f  
  `,SOLD:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  166 70.5 m
  166.05 75.733 164.173 80.033 160.37 83.4 c
  156.583 86.727 151.417 88.443 144.87 88.55 c
  141.077 88.613 137.76 88.288 134.92 87.574 c
  132.1 86.834 129.453 85.891 126.98 84.744 c
  126.858 72.044 l
  128.148 72.022 l
  130.615 74.242 133.361 75.932 136.388 77.092 c
  139.435 78.252 142.355 78.809 145.148 78.762 c
  145.868 78.75 146.811 78.663 147.978 78.5 c
  149.145 78.338 150.098 78.084 150.838 77.738 c
  151.738 77.295 152.471 76.748 153.038 76.098 c
  153.627 75.446 153.915 74.489 153.903 73.228 c
  153.892 72.062 153.452 71.068 152.583 70.248 c
  151.736 69.408 150.49 68.775 148.843 68.348 c
  147.116 67.901 145.286 67.491 143.353 67.118 c
  141.44 66.722 139.64 66.215 137.953 65.598 c
  134.08 64.212 131.28 62.295 129.553 59.848 c
  127.846 57.375 126.976 54.295 126.943 50.608 c
  126.896 45.662 128.766 41.595 132.553 38.408 c
  136.36 35.202 141.26 33.548 147.253 33.448 c
  150.266 33.398 153.246 33.693 156.193 34.334 c
  159.153 34.951 161.716 35.754 163.883 36.744 c
  164 48.944 l
  162.74 48.965 l
  160.88 47.285 158.6 45.895 155.9 44.795 c
  153.22 43.675 150.487 43.139 147.7 43.185 c
  146.713 43.202 145.73 43.302 144.75 43.484 c
  143.79 43.643 142.86 43.944 141.96 44.387 c
  141.16 44.757 140.477 45.317 139.91 46.067 c
  139.342 46.794 139.063 47.621 139.072 48.547 c
  139.085 49.954 139.559 51.027 140.492 51.767 c
  141.425 52.487 143.175 53.137 145.742 53.717 c
  147.429 54.093 149.042 54.46 150.582 54.817 c
  152.142 55.172 153.819 55.669 155.612 56.307 c
  159.132 57.581 161.735 59.357 163.422 61.637 c
  165.129 63.891 165.999 66.851 166.032 70.517 c
  f
  218 59.8 m
  218.081 68.267 216.051 75.033 211.91 80.1 c
  207.77 85.14 202.003 87.723 194.61 87.85 c
  187.277 87.973 181.477 85.583 177.21 80.68 c
  172.977 75.753 170.82 69.053 170.74 60.58 c
  170.658 52.047 172.688 45.28 176.83 40.28 c
  180.97 35.24 186.737 32.657 194.13 32.53 c
  201.463 32.407 207.263 34.797 211.53 39.7 c
  215.783 44.58 217.95 51.28 218.03 59.8 c
  h
  202.5 73.5 m
  203.633 71.86 204.467 69.943 205 67.75 c
  205.533 65.53 205.785 62.933 205.757 59.96 c
  205.726 56.773 205.383 54.067 204.727 51.84 c
  204.07 49.613 203.22 47.82 202.177 46.46 c
  201.117 45.047 199.897 44.033 198.517 43.42 c
  197.157 42.8 195.737 42.502 194.257 42.527 c
  192.757 42.552 191.344 42.885 190.017 43.526 c
  188.71 44.167 187.51 45.21 186.417 46.656 c
  185.404 48.003 184.58 49.859 183.947 52.226 c
  183.333 54.566 183.041 57.283 183.071 60.376 c
  183.101 63.543 183.435 66.239 184.071 68.466 c
  184.728 70.666 185.578 72.459 186.621 73.846 c
  187.661 75.233 188.871 76.246 190.251 76.886 c
  191.631 77.529 193.081 77.838 194.601 77.813 c
  196.121 77.788 197.564 77.431 198.931 76.743 c
  200.298 76.03 201.488 74.95 202.501 73.503 c
  f
  261 85.6 m
  227.9 86.153 l
  227.391 33.053 l
  239.191 32.855 l
  239.601 75.755 l
  260.801 75.4 l
  f
  311 58.3 m
  311.047 63.247 310.114 67.713 308.2 71.7 c
  306.287 75.633 303.853 78.673 300.9 80.82 c
  298.68 82.427 296.24 83.563 293.58 84.23 c
  267.91 85.59 l
  267.401 32.49 l
  284.001 32.212 l
  287.734 32.15 290.961 32.465 293.681 33.157 c
  296.394 33.824 298.681 34.807 300.541 36.107 c
  303.721 38.294 306.234 41.274 308.081 45.047 c
  309.941 48.8 310.898 53.234 310.951 58.347 c
  h
  298.8 58.397 m
  298.767 54.897 298.183 51.921 297.05 49.467 c
  295.937 46.987 294.183 45.064 291.79 43.697 c
  290.57 43.031 289.323 42.587 288.05 42.367 c
  286.797 42.127 284.897 42.028 282.35 42.07 c
  279.36 42.12 l
  279.678 75.42 l
  282.668 75.37 l
  285.481 75.323 287.541 75.146 288.848 74.838 c
  290.161 74.507 291.438 73.937 292.678 73.128 c
  294.818 71.662 296.381 69.732 297.368 67.338 c
  298.348 64.918 298.821 61.948 298.788 58.428 c
  f
  `,EXPERIMENTAL:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  55.9 86.5 m
  32.9 86.873 l
  32.766 40.073 l
  55.766 39.7 l
  55.792 48.76 l
  40.992 49.001 l
  41.015 57.081 l
  54.815 56.857 l
  54.841 65.917 l
  41.041 66.141 l
  41.074 77.741 l
  55.874 77.5 l
  f
  91.6 85.9 m
  82.12 86.054 l
  75.22 70.754 l
  68.28 86.254 l
  59.23 86.401 l
  70.43 62.601 l
  59.33 39.501 l
  68.79 39.347 l
  75.45 53.847 l
  82.22 39.147 l
  91.3 39 l
  80.3 61.9 l
  f
  122 53.4 m
  122 55.493 121.757 57.553 121.27 59.58 c
  120.777 61.58 120.071 63.27 119.15 64.65 c
  117.89 66.517 116.477 67.933 114.91 68.9 c
  113.363 69.867 111.43 70.37 109.11 70.41 c
  104.01 70.493 l
  104.054 85.793 l
  95.854 85.926 l
  95.72 39.126 l
  109.22 38.907 l
  111.24 38.874 112.943 39.108 114.33 39.61 c
  115.723 40.091 116.956 40.837 118.03 41.85 c
  119.316 43.063 120.296 44.63 120.97 46.55 c
  121.656 48.47 122.003 50.78 122.01 53.48 c
  h
  113.52 53.821 m
  113.52 52.501 113.275 51.374 112.784 50.441 c
  112.297 49.488 111.734 48.824 111.094 48.451 c
  110.241 47.962 109.407 47.703 108.594 47.674 c
  107.781 47.624 106.697 47.61 105.344 47.632 c
  103.934 47.655 l
  103.974 61.655 l
  106.324 61.617 l
  107.717 61.595 108.864 61.45 109.764 61.184 c
  110.677 60.918 111.437 60.401 112.044 59.634 c
  112.569 58.954 112.945 58.151 113.174 57.224 c
  113.413 56.278 113.531 55.134 113.527 53.794 c
  f
  151 84.9 m
  128 85.273 l
  127.866 38.473 l
  150.866 38.1 l
  150.892 47.16 l
  136.092 47.401 l
  136.115 55.481 l
  149.915 55.257 l
  149.941 64.317 l
  136.141 64.541 l
  136.174 76.141 l
  150.974 75.9 l
  f
  176 52.1 m
  176 50.927 175.833 49.923 175.5 49.09 c
  175.17 48.257 174.607 47.607 173.81 47.14 c
  173.254 46.813 172.604 46.625 171.86 46.574 c
  171.12 46.502 170.26 46.474 169.28 46.49 c
  166.31 46.538 l
  166.346 59.138 l
  168.866 59.098 l
  170.173 59.076 171.269 58.964 172.156 58.762 c
  173.036 58.558 173.776 58.115 174.376 57.432 c
  174.943 56.772 175.353 56.052 175.606 55.272 c
  175.874 54.471 176.006 53.411 176.003 52.092 c
  h
  188.9 84.4 m
  178.9 84.563 l
  170.18 67.563 l
  166.4 67.624 l
  166.449 84.824 l
  158.289 84.956 l
  158.155 38.156 l
  171.955 37.933 l
  173.835 37.903 175.452 38.034 176.805 38.326 c
  178.158 38.619 179.428 39.279 180.615 40.306 c
  181.815 41.333 182.765 42.68 183.465 44.346 c
  184.178 45.993 184.542 48.073 184.555 50.586 c
  184.565 54.046 184.025 56.876 182.935 59.076 c
  181.862 61.276 180.315 63.116 178.295 64.596 c
  f
  210 84 m
  191.4 84.302 l
  191.376 76.002 l
  196.586 75.917 l
  196.5 45.717 l
  191.29 45.802 l
  191.266 37.502 l
  209.866 37.2 l
  209.89 45.5 l
  204.68 45.585 l
  204.766 75.785 l
  209.976 75.7 l
  f
  250 83.3 m
  241.84 83.432 l
  241.75 52.032 l
  235.91 72.432 l
  230.25 72.524 l
  224.3 52.224 l
  224.39 83.624 l
  216.66 83.75 l
  216.526 36.95 l
  226.046 36.795 l
  233.266 60.195 l
  240.336 36.595 l
  249.856 36.44 l
  f
  281 82.8 m
  258 83.173 l
  257.866 36.373 l
  280.866 36 l
  280.892 45.06 l
  266.092 45.301 l
  266.115 53.381 l
  279.915 53.157 l
  279.941 62.217 l
  266.141 62.441 l
  266.174 74.041 l
  280.974 73.8 l
  f
  316 82.3 m
  308.1 82.428 l
  294.5 50.528 l
  294.592 82.628 l
  287.072 82.75 l
  286.938 35.95 l
  296.738 35.791 l
  308.438 62.391 l
  308.361 35.591 l
  315.881 35.469 l
  f
  349 44 m
  339.07 44.161 l
  339.178 81.961 l
  330.978 82.094 l
  330.87 44.294 l
  320.94 44.455 l
  320.914 35.395 l
  349.014 34.939 l
  f
  384 81.2 m
  375.52 81.338 l
  373.29 71.908 l
  361.49 72.099 l
  359.32 81.599 l
  351.06 81.733 l
  362.66 34.733 l
  372.1 34.58 l
  h
  371.3 63.4 m
  367.34 46.7 l
  363.48 63.6 l
  f
  411 80.7 m
  388.1 81.072 l
  387.966 34.272 l
  396.166 34.139 l
  396.274 71.939 l
  410.974 71.7 l
  f
  `,FOR_COMMENT:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  61.6 49.9 m
  46.8 50.184 l
  46.866 58.134 l
  60.566 57.871 l
  60.635 66.141 l
  46.935 66.404 l
  47.087 84.704 l
  38.837 84.862 l
  38.48 42.162 l
  61.48 41.72 l
  f
  98.7 62.3 m
  98.757 69.1 97.334 74.533 94.43 78.6 c
  91.523 82.653 87.49 84.73 82.33 84.83 c
  77.163 84.929 73.097 83.006 70.13 79.06 c
  67.157 75.1 65.643 69.7 65.59 62.86 c
  65.533 55.993 66.956 50.527 69.86 46.46 c
  72.767 42.407 76.8 40.33 81.96 40.23 c
  87.113 40.131 91.18 42.055 94.16 46 c
  97.147 49.927 98.667 55.327 98.72 62.2 c
  h
  87.8 73.3 m
  88.593 71.98 89.177 70.437 89.55 68.67 c
  89.924 66.883 90.101 64.793 90.081 62.4 c
  90.06 59.833 89.818 57.657 89.357 55.87 c
  88.896 54.077 88.299 52.633 87.567 51.54 c
  86.82 50.407 85.964 49.59 84.997 49.09 c
  84.044 48.591 83.047 48.352 82.007 48.372 c
  80.954 48.392 79.964 48.66 79.037 49.176 c
  78.117 49.691 77.274 50.531 76.507 51.696 c
  75.794 52.783 75.217 54.276 74.777 56.176 c
  74.346 58.063 74.141 60.249 74.162 62.736 c
  74.183 65.283 74.417 67.449 74.864 69.236 c
  75.325 71.009 75.922 72.453 76.654 73.566 c
  80.171 76.533 81.187 76.782 82.254 76.761 c
  83.321 76.741 84.334 76.453 85.294 75.899 c
  86.254 75.326 87.091 74.459 87.804 73.299 c
  f
  123 53.6 m
  122.991 52.527 122.818 51.61 122.48 50.85 c
  122.143 50.09 121.569 49.497 120.76 49.07 c
  120.196 48.775 119.539 48.605 118.79 48.562 c
  118.043 48.5 117.173 48.478 116.18 48.497 c
  113.18 48.555 l
  113.276 60.055 l
  115.826 60.006 l
  117.153 59.981 118.259 59.873 119.146 59.684 c
  120.039 59.495 120.786 59.088 121.386 58.464 c
  121.957 57.86 122.37 57.2 122.626 56.484 c
  122.893 55.751 123.022 54.781 123.012 53.574 c
  h
  136.2 83 m
  126.1 83.194 l
  117.2 67.694 l
  113.38 67.767 l
  113.511 83.467 l
  105.261 83.625 l
  104.904 40.925 l
  118.804 40.658 l
  120.704 40.622 122.341 40.734 123.714 40.995 c
  125.087 41.256 126.374 41.853 127.574 42.785 c
  128.794 43.719 129.761 44.945 130.474 46.465 c
  131.207 47.965 131.584 49.862 131.604 52.155 c
  131.63 55.315 131.097 57.899 130.004 59.905 c
  128.924 61.919 127.367 63.605 125.334 64.965 c
  f
  169 83.2 m
  166.607 83.246 164.393 82.819 162.36 81.92 c
  160.333 81.02 158.587 79.657 157.12 77.83 c
  155.653 76.003 154.503 73.71 153.67 70.95 c
  152.857 68.19 152.433 64.993 152.4 61.36 c
  152.372 57.973 152.728 54.893 153.47 52.12 c
  154.21 49.347 155.3 46.963 156.74 44.97 c
  158.12 43.05 159.837 41.553 161.89 40.48 c
  163.957 39.407 166.213 38.847 168.66 38.8 c
  170.013 38.774 171.23 38.856 172.31 39.046 c
  173.403 39.217 174.413 39.456 175.34 39.763 c
  176.307 40.108 177.18 40.502 177.96 40.943 c
  178.753 41.368 179.447 41.764 180.04 42.133 c
  180.127 52.533 l
  179.177 52.551 l
  178.77 52.1 178.253 51.563 177.627 50.941 c
  177.017 50.321 176.32 49.711 175.537 49.111 c
  174.737 48.514 173.877 48.014 172.957 47.611 c
  168.83 47.059 167.723 47.329 166.677 47.846 c
  165.63 48.345 164.663 49.168 163.777 50.316 c
  162.937 51.423 162.257 52.88 161.737 54.686 c
  161.233 56.493 160.992 58.68 161.014 61.246 c
  161.036 63.926 161.335 66.16 161.912 67.946 c
  162.502 69.733 163.236 71.136 164.112 72.156 c
  164.998 73.19 165.985 73.926 167.072 74.366 c
  168.158 74.786 169.225 74.985 170.272 74.965 c
  171.278 74.946 172.271 74.726 173.251 74.305 c
  174.245 73.885 175.155 73.321 175.981 72.615 c
  176.681 72.047 177.332 71.44 177.931 70.795 c
  178.531 70.152 179.024 69.599 179.411 69.135 c
  180.275 69.119 l
  180.361 79.319 l
  179.561 79.813 178.794 80.276 178.061 80.709 c
  177.327 81.144 176.561 81.524 175.761 81.849 c
  174.714 82.271 173.731 82.596 172.811 82.824 c
  171.891 83.052 170.624 83.181 169.011 83.213 c
  f
  218 60 m
  218.057 66.8 216.634 72.233 213.73 76.3 c
  210.823 80.353 206.79 82.43 201.63 82.53 c
  196.463 82.629 192.397 80.706 189.43 76.76 c
  186.457 72.8 184.943 67.4 184.89 60.56 c
  184.833 53.693 186.256 48.227 189.16 44.16 c
  192.067 40.107 196.1 38.03 201.26 37.93 c
  206.413 37.831 210.48 39.755 213.46 43.7 c
  216.447 47.627 217.967 53.027 218.02 59.9 c
  h
  207.1 71 m
  207.893 69.68 208.477 68.137 208.85 66.37 c
  209.224 64.583 209.401 62.493 209.381 60.1 c
  209.36 57.533 209.118 55.357 208.657 53.57 c
  208.196 51.777 207.599 50.333 206.867 49.24 c
  206.12 48.107 205.264 47.29 204.297 46.79 c
  203.344 46.291 202.347 46.052 201.307 46.072 c
  200.254 46.092 199.264 46.36 198.337 46.876 c
  197.417 47.391 196.574 48.231 195.807 49.396 c
  195.094 50.483 194.517 51.976 194.077 53.876 c
  193.646 55.763 193.441 57.949 193.462 60.436 c
  193.483 62.983 193.717 65.149 194.164 66.936 c
  194.625 68.709 195.222 70.153 195.954 71.266 c
  199.471 74.233 200.487 74.482 201.554 74.461 c
  202.621 74.441 203.634 74.153 204.594 73.599 c
  205.554 73.026 206.391 72.159 207.104 70.999 c
  f
  258 80.6 m
  249.75 80.758 l
  249.511 52.158 l
  243.701 70.858 l
  237.981 70.968 l
  231.861 52.468 l
  232.1 81.068 l
  224.28 81.218 l
  223.923 38.518 l
  233.553 38.333 l
  240.963 59.633 l
  247.993 38.033 l
  257.623 37.848 l
  f
  300 79.8 m
  291.75 79.958 l
  291.511 51.358 l
  285.701 70.058 l
  279.981 70.168 l
  273.861 51.668 l
  274.1 80.268 l
  266.28 80.418 l
  265.923 37.718 l
  275.553 37.533 l
  282.963 58.833 l
  289.993 37.233 l
  299.623 37.048 l
  f
  332 79.2 m
  308.7 79.646 l
  308.343 36.946 l
  331.643 36.5 l
  331.712 44.77 l
  316.712 45.058 l
  316.774 52.438 l
  330.674 52.171 l
  330.743 60.441 l
  316.843 60.708 l
  316.931 71.308 l
  331.931 71.02 l
  f
  368 78.5 m
  360.01 78.653 l
  346.11 49.553 l
  346.355 78.853 l
  338.755 78.999 l
  338.398 36.299 l
  348.308 36.109 l
  360.208 60.409 l
  360.004 35.909 l
  367.604 35.763 l
  f
  401 43.4 m
  391 43.593 l
  391.288 78.093 l
  382.998 78.252 l
  382.71 43.752 l
  372.71 43.945 l
  372.641 35.675 l
  401.041 35.131 l
  f  
  `,TOP_SECRET:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  67.5 47.4 m
  55 47.623 l
  55.357 87.423 l
  45.057 87.607 l
  44.7 47.807 l
  32.2 48.03 l
  32.114 38.48 l
  67.314 37.851 l
  f
  113 61.7 m
  113.071 69.567 111.304 75.867 107.7 80.6 c
  104.093 85.287 99.06 87.687 92.6 87.8 c
  86.187 87.915 81.12 85.695 77.4 81.14 c
  73.713 76.56 71.833 70.327 71.76 62.44 c
  71.689 54.507 73.455 48.207 77.06 43.54 c
  80.667 38.853 85.667 36.453 92.06 36.34 c
  98.453 36.226 103.52 38.446 107.26 43 c
  110.967 47.533 112.853 53.767 112.92 61.7 c
  h
  99.5 74.4 m
  100.487 72.88 101.213 71.097 101.68 69.05 c
  102.144 66.983 102.364 64.57 102.339 61.81 c
  102.312 58.85 102.013 56.333 101.44 54.26 c
  100.867 52.193 100.127 50.527 99.22 49.26 c
  98.3 47.947 97.237 47.003 96.03 46.43 c
  94.843 45.854 93.607 45.577 92.32 45.6 c
  91.013 45.623 89.783 45.933 88.63 46.528 c
  87.49 47.123 86.443 48.093 85.49 49.438 c
  84.61 50.691 83.893 52.418 83.34 54.618 c
  82.805 56.798 82.551 59.325 82.577 62.198 c
  82.603 65.138 82.894 67.645 83.449 69.718 c
  84.022 71.765 84.762 73.431 85.669 74.718 c
  86.576 76.005 87.629 76.948 88.829 77.548 c
  90.029 78.146 91.292 78.433 92.619 78.409 c
  93.939 78.385 95.196 78.053 96.389 77.413 c
  97.582 76.75 98.619 75.747 99.499 74.403 c
  f
  153 51.9 m
  153.02 54.113 152.726 56.287 152.12 58.42 c
  151.513 60.533 150.637 62.317 149.49 63.77 c
  147.917 65.743 146.153 67.247 144.2 68.28 c
  142.26 69.307 139.833 69.847 136.92 69.9 c
  130.51 70.014 l
  130.654 86.114 l
  120.354 86.298 l
  119.911 36.898 l
  136.811 36.596 l
  139.351 36.551 141.488 36.789 143.221 37.311 c
  144.974 37.81 146.528 38.59 147.881 39.651 c
  149.501 40.924 150.741 42.571 151.601 44.591 c
  152.474 46.611 152.924 49.048 152.951 51.901 c
  h
  142.4 52.388 m
  142.388 50.995 142.073 49.805 141.457 48.818 c
  140.84 47.811 140.127 47.115 139.317 46.728 c
  138.237 46.217 137.19 45.948 136.177 45.922 c
  135.157 45.874 133.8 45.865 132.107 45.895 c
  130.337 45.927 l
  130.47 60.727 l
  133.42 60.674 l
  135.173 60.643 136.61 60.485 137.73 60.199 c
  138.87 59.913 139.82 59.367 140.58 58.559 c
  141.235 57.839 141.701 56.989 141.98 56.009 c
  142.275 55.009 142.416 53.803 142.403 52.389 c
  f
  211 69.1 m
  211.044 73.967 209.407 77.967 206.09 81.1 c
  202.797 84.187 198.297 85.783 192.59 85.89 c
  189.283 85.949 186.393 85.647 183.92 84.983 c
  181.467 84.296 179.163 83.42 177.01 82.353 c
  176.904 70.553 l
  178.034 70.533 l
  180.181 72.593 182.571 74.166 185.204 75.253 c
  187.857 76.333 190.401 76.853 192.834 76.813 c
  193.459 76.802 194.279 76.721 195.294 76.57 c
  196.314 76.419 197.144 76.183 197.784 75.862 c
  198.564 75.45 199.204 74.94 199.704 74.332 c
  200.217 73.726 200.468 72.836 200.457 71.662 c
  200.447 70.575 200.064 69.652 199.307 68.892 c
  198.567 68.112 197.48 67.522 196.047 67.122 c
  194.54 66.707 192.947 66.327 191.267 65.982 c
  189.6 65.613 188.034 65.143 186.567 64.572 c
  183.194 63.285 180.757 61.505 179.257 59.232 c
  177.77 56.939 177.01 54.079 176.977 50.652 c
  176.936 46.052 178.562 42.285 181.857 39.352 c
  185.17 36.372 189.437 34.835 194.657 34.742 c
  197.284 34.695 199.877 34.969 202.437 35.565 c
  205.017 36.138 207.247 36.885 209.127 37.805 c
  209.229 49.205 l
  208.129 49.225 l
  206.509 47.658 204.522 46.368 202.169 45.355 c
  199.836 44.315 197.456 43.815 195.029 43.855 c
  194.169 43.87 193.312 43.963 192.459 44.133 c
  191.619 44.281 190.809 44.561 190.029 44.973 c
  189.336 45.317 188.742 45.837 188.249 46.533 c
  187.754 47.206 187.511 47.973 187.519 48.833 c
  187.531 50.139 187.941 51.139 188.749 51.833 c
  189.562 52.506 191.086 53.109 193.319 53.643 c
  194.786 53.993 196.192 54.333 197.539 54.663 c
  198.899 54.992 200.359 55.452 201.919 56.043 c
  204.986 57.229 207.252 58.879 208.719 60.993 c
  210.206 63.086 210.962 65.836 210.989 69.243 c
  f
  248 84 m
  219.1 84.515 l
  218.657 35.115 l
  247.557 34.6 l
  247.643 44.15 l
  229.043 44.483 l
  229.119 53.003 l
  246.419 52.694 l
  246.505 62.244 l
  229.205 62.553 l
  229.314 74.753 l
  247.914 74.42 l
  f
  274 84.5 m
  271.033 84.553 268.287 84.06 265.76 83.02 c
  263.247 81.98 261.08 80.403 259.26 78.29 c
  257.433 76.177 256.007 73.527 254.98 70.34 c
  253.967 67.153 253.443 63.453 253.41 59.24 c
  253.375 55.327 253.815 51.76 254.73 48.54 c
  255.65 45.34 257 42.583 258.78 40.27 c
  260.493 38.05 262.623 36.32 265.17 35.08 c
  267.73 33.84 270.53 33.193 273.57 33.14 c
  275.25 33.11 276.76 33.205 278.1 33.424 c
  279.46 33.621 280.713 33.897 281.86 34.253 c
  283.06 34.652 284.147 35.108 285.12 35.623 c
  286.107 36.114 286.97 36.574 287.71 37.003 c
  287.817 49.003 l
  286.637 49.024 l
  286.132 48.502 285.492 47.882 284.717 47.164 c
  283.957 46.451 283.094 45.747 282.127 45.054 c
  281.14 44.361 280.07 43.784 278.917 43.324 c
  277.77 42.858 276.544 42.637 275.237 42.66 c
  273.79 42.686 272.417 42.998 271.117 43.596 c
  269.817 44.172 268.62 45.122 267.527 46.446 c
  266.487 47.726 265.644 49.409 264.997 51.496 c
  264.372 53.589 264.073 56.116 264.1 59.076 c
  264.128 62.169 264.498 64.749 265.21 66.816 c
  265.943 68.883 266.85 70.503 267.93 71.676 c
  269.03 72.876 270.253 73.729 271.6 74.236 c
  272.947 74.721 274.27 74.951 275.57 74.928 c
  276.823 74.906 278.053 74.651 279.26 74.165 c
  280.487 73.678 281.617 73.028 282.65 72.215 c
  283.517 71.558 284.323 70.858 285.07 70.115 c
  285.817 69.375 286.427 68.735 286.9 68.195 c
  287.97 68.176 l
  288.076 79.976 l
  287.083 80.547 286.133 81.083 285.226 81.586 c
  284.319 82.089 283.366 82.525 282.366 82.896 c
  281.066 83.383 279.846 83.76 278.706 84.026 c
  277.566 84.289 275.996 84.439 273.996 84.475 c
  f
  318 48.5 m
  317.989 47.26 317.774 46.203 317.355 45.33 c
  316.936 44.45 316.223 43.767 315.215 43.28 c
  314.515 42.939 313.702 42.743 312.775 42.693 c
  311.848 42.621 310.768 42.596 309.535 42.618 c
  305.805 42.685 l
  305.924 55.985 l
  309.084 55.928 l
  310.731 55.899 312.104 55.775 313.204 55.556 c
  314.311 55.338 315.237 54.868 315.984 54.146 c
  316.691 53.446 317.201 52.686 317.514 51.866 c
  317.846 51.02 318.006 49.9 317.993 48.506 c
  h
  334.4 82.5 m
  321.8 82.724 l
  310.8 64.824 l
  306.06 64.909 l
  306.222 83.009 l
  296.022 83.192 l
  295.579 33.792 l
  312.879 33.484 l
  315.239 33.442 317.269 33.571 318.969 33.873 c
  320.669 34.174 322.266 34.864 323.759 35.943 c
  325.272 37.023 326.472 38.439 327.359 40.193 c
  328.266 41.926 328.732 44.119 328.759 46.773 c
  328.792 50.419 328.132 53.406 326.779 55.733 c
  325.439 58.059 323.509 60.006 320.989 61.573 c
  f
  368 81.9 m
  339.1 82.415 l
  338.657 33.015 l
  367.557 32.5 l
  367.643 42.05 l
  349.043 42.383 l
  349.119 50.903 l
  366.419 50.594 l
  366.505 60.144 l
  349.205 60.453 l
  349.314 72.653 l
  367.914 72.32 l
  f
  407 41.3 m
  394.5 41.523 l
  394.857 81.323 l
  384.557 81.507 l
  384.2 41.707 l
  371.7 41.93 l
  371.614 32.38 l
  406.814 31.751 l
  f  
  `,FOR_PUBLIC_RELEASE:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  93.2 32.1 m
  78.5 32.323 l
  78.566 38.583 l
  92.166 38.376 l
  92.234 44.886 l
  78.634 45.093 l
  78.785 59.493 l
  70.605 59.618 l
  70.251 25.918 l
  93.151 25.57 l
  f
  130 41.8 m
  130.056 47.167 128.646 51.467 125.77 54.7 c
  122.89 57.893 118.89 59.53 113.77 59.61 c
  108.643 59.688 104.61 58.175 101.67 55.07 c
  98.723 51.95 97.223 47.717 97.17 42.37 c
  97.113 36.957 98.523 32.657 101.4 29.47 c
  104.28 26.277 108.28 24.64 113.4 24.56 c
  118.513 24.482 122.547 25.995 125.5 29.1 c
  128.46 32.187 129.97 36.453 130.03 41.9 c
  h
  119.2 50.49 m
  119.987 49.45 120.567 48.237 120.94 46.85 c
  121.311 45.443 121.486 43.797 121.466 41.91 c
  121.445 39.89 121.205 38.177 120.748 36.77 c
  120.291 35.363 119.701 34.227 118.978 33.36 c
  118.238 32.467 117.388 31.823 116.428 31.43 c
  115.481 31.037 114.495 30.849 113.468 30.865 c
  112.428 30.881 111.445 31.092 110.518 31.498 c
  109.611 31.904 108.775 32.564 108.008 33.478 c
  107.301 34.331 106.728 35.508 106.288 37.008 c
  105.861 38.495 105.657 40.215 105.678 42.168 c
  105.699 44.175 105.931 45.881 106.375 47.288 c
  106.832 48.681 107.422 49.818 108.145 50.698 c
  108.865 51.578 109.708 52.221 110.675 52.628 c
  111.635 53.035 112.645 53.231 113.705 53.215 c
  114.758 53.199 115.762 52.973 116.715 52.536 c
  117.668 52.085 118.495 51.401 119.195 50.486 c
  f
  154 34.9 m
  153.991 34.053 153.819 33.333 153.485 32.74 c
  153.15 32.142 152.58 31.675 151.775 31.34 c
  151.216 31.107 150.566 30.974 149.825 30.94 c
  149.085 30.891 148.222 30.874 147.235 30.889 c
  144.255 30.934 l
  144.35 39.994 l
  146.88 39.956 l
  148.194 39.936 149.294 39.851 150.18 39.702 c
  151.067 39.552 151.807 39.232 152.4 38.741 c
  152.966 38.265 153.376 37.745 153.63 37.181 c
  153.896 36.604 154.023 35.841 154.013 34.891 c
  h
  167.1 58.1 m
  157.1 58.253 l
  148.27 46.053 l
  144.48 46.111 l
  144.61 58.411 l
  136.43 58.536 l
  136.076 24.836 l
  149.876 24.626 l
  151.763 24.597 153.386 24.685 154.746 24.891 c
  156.106 25.096 157.383 25.566 158.576 26.301 c
  159.783 27.034 160.743 28.001 161.456 29.201 c
  162.183 30.381 162.556 31.874 162.576 33.681 c
  162.602 36.167 162.072 38.204 160.986 39.791 c
  159.919 41.377 158.376 42.704 156.356 43.771 c
  f
  212 34.4 m
  212.016 35.907 211.782 37.387 211.297 38.84 c
  210.812 40.28 210.112 41.497 209.197 42.49 c
  207.937 43.837 206.527 44.86 204.967 45.56 c
  203.42 46.26 201.48 46.63 199.147 46.67 c
  194.027 46.748 l
  194.142 57.748 l
  185.922 57.873 l
  185.568 24.173 l
  199.068 23.967 l
  201.095 23.936 202.801 24.098 204.188 24.454 c
  205.588 24.795 206.828 25.325 207.908 26.044 c
  209.201 26.911 210.191 28.034 210.878 29.414 c
  211.578 30.787 211.938 32.447 211.958 34.394 c
  h
  203.5 34.733 m
  203.49 33.786 203.239 32.976 202.746 32.303 c
  202.253 31.616 201.683 31.143 201.036 30.883 c
  200.176 30.534 199.339 30.351 198.526 30.333 c
  197.713 30.3 196.626 30.294 195.266 30.315 c
  193.856 30.336 l
  193.962 40.436 l
  196.322 40.4 l
  197.722 40.379 198.872 40.271 199.772 40.076 c
  200.685 39.882 201.445 39.508 202.052 38.956 c
  202.575 38.466 202.949 37.886 203.172 37.216 c
  203.407 36.536 203.52 35.713 203.51 34.746 c
  f
  246 44.7 m
  246.044 48.86 244.877 52.067 242.5 54.32 c
  240.127 56.573 236.593 57.733 231.9 57.8 c
  227.233 57.871 223.7 56.818 221.3 54.64 c
  218.893 52.46 217.667 49.3 217.62 45.16 c
  217.394 23.66 l
  225.664 23.534 l
  225.885 44.534 l
  225.91 46.867 226.393 48.601 227.335 49.734 c
  228.275 50.867 229.788 51.417 231.875 51.384 c
  233.928 51.353 235.422 50.779 236.355 49.664 c
  237.302 48.551 237.762 46.781 237.735 44.354 c
  237.514 23.354 l
  245.784 23.228 l
  f
  281 46.1 m
  281.017 47.727 280.718 49.187 280.103 50.48 c
  279.502 51.773 278.662 52.85 277.583 53.71 c
  276.336 54.723 274.96 55.453 273.453 55.9 c
  271.96 56.345 270.056 56.585 267.743 56.62 c
  253.843 56.832 l
  253.489 23.132 l
  265.889 22.944 l
  268.462 22.905 270.342 22.967 271.529 23.129 c
  272.729 23.292 273.919 23.672 275.099 24.269 c
  276.319 24.898 277.229 25.758 277.829 26.849 c
  278.44 27.922 278.753 29.162 278.768 30.569 c
  278.785 32.196 278.392 33.642 277.588 34.909 c
  276.788 36.156 275.648 36.156 274.168 34.909 c
  276.255 35.314 277.915 36.194 279.148 37.549 c
  280.388 38.902 281.021 40.702 281.048 42.949 c
  h
  270.3 32.4 m
  270.3 31.843 270.158 31.286 269.875 30.73 c
  269.612 30.176 269.142 29.769 268.465 29.51 c
  267.863 29.278 267.113 29.161 266.215 29.16 c
  265.328 29.143 264.078 29.147 262.465 29.172 c
  261.694 29.184 l
  261.769 36.304 l
  263.059 36.284 l
  264.359 36.264 265.466 36.225 266.379 36.166 c
  267.292 36.107 268.012 35.945 268.539 35.681 c
  269.279 35.323 269.759 34.87 269.979 34.321 c
  270.202 33.76 270.309 33.116 270.301 32.391 c
  h
  272.46 46.1 m
  272.449 45.033 272.24 44.217 271.834 43.65 c
  271.442 43.068 270.772 42.641 269.824 42.37 c
  269.179 42.184 268.293 42.092 267.164 42.094 c
  266.037 42.096 264.861 42.107 263.634 42.125 c
  261.834 42.153 l
  261.922 50.543 l
  262.522 50.534 l
  264.836 50.498 266.492 50.466 267.492 50.435 c
  268.492 50.405 269.412 50.195 270.252 49.805 c
  271.106 49.415 271.686 48.909 271.992 48.285 c
  272.314 47.647 272.471 46.921 272.462 46.105 c
  f
  310 55.9 m
  287 56.25 l
  286.646 22.55 l
  294.866 22.425 l
  295.152 49.525 l
  309.952 49.3 l
  f
  332 55.6 m
  313.3 55.884 l
  313.237 49.914 l
  318.467 49.834 l
  318.239 28.134 l
  313.009 28.214 l
  312.946 22.244 l
  331.646 21.96 l
  331.709 27.93 l
  326.479 28.01 l
  326.707 49.71 l
  331.937 49.63 l
  f
  353 55.9 m
  350.627 55.936 348.43 55.599 346.41 54.89 c
  344.403 54.183 342.67 53.11 341.21 51.67 c
  339.75 50.23 338.61 48.423 337.79 46.25 c
  336.983 44.077 336.563 41.56 336.53 38.7 c
  336.502 36.033 336.855 33.61 337.59 31.43 c
  338.323 29.25 339.403 27.373 340.83 25.8 c
  342.197 24.287 343.897 23.107 345.93 22.26 c
  347.977 21.413 350.213 20.973 352.64 20.94 c
  353.98 20.92 355.187 20.984 356.26 21.134 c
  357.347 21.268 358.347 21.456 359.26 21.699 c
  360.22 21.971 361.087 22.282 361.86 22.632 c
  362.647 22.967 363.337 23.28 363.93 23.573 c
  364.016 31.733 l
  363.074 31.747 l
  362.67 31.392 362.16 30.969 361.544 30.477 c
  360.939 29.989 360.249 29.509 359.474 29.037 c
  358.68 28.567 357.827 28.174 356.914 27.857 c
  355.994 27.54 355.014 27.389 353.974 27.404 c
  352.82 27.422 351.724 27.635 350.684 28.042 c
  349.644 28.435 348.687 29.082 347.814 29.982 c
  346.98 30.856 346.307 32.002 345.794 33.422 c
  345.294 34.849 345.055 36.572 345.077 38.592 c
  345.099 40.699 345.396 42.459 345.968 43.872 c
  346.554 45.279 347.28 46.382 348.148 47.182 c
  349.028 47.996 350.004 48.576 351.078 48.922 c
  352.151 49.252 353.211 49.41 354.258 49.394 c
  355.258 49.379 356.241 49.206 357.208 48.874 c
  358.188 48.543 359.091 48.1 359.918 47.544 c
  360.611 47.096 361.254 46.62 361.848 46.114 c
  362.442 45.608 362.929 45.171 363.308 44.804 c
  364.165 44.791 l
  364.249 52.841 l
  363.456 53.23 362.696 53.597 361.969 53.941 c
  361.243 54.284 360.483 54.582 359.689 54.835 c
  358.649 55.168 357.673 55.424 356.759 55.603 c
  355.846 55.783 354.589 55.885 352.989 55.909 c
  f
  130 74.7 m
  129.991 73.853 129.819 73.133 129.485 72.54 c
  129.15 71.942 128.58 71.475 127.775 71.14 c
  127.216 70.907 126.566 70.774 125.825 70.74 c
  125.085 70.691 124.222 70.674 123.235 70.689 c
  120.255 70.734 l
  120.35 79.794 l
  122.88 79.756 l
  124.194 79.736 125.294 79.651 126.18 79.502 c
  127.067 79.352 127.807 79.032 128.4 78.541 c
  128.966 78.065 129.376 77.545 129.63 76.981 c
  129.896 76.404 130.023 75.641 130.013 74.691 c
  h
  143.1 97.9 m
  133.1 98.053 l
  124.27 85.853 l
  120.48 85.911 l
  120.61 98.211 l
  112.43 98.336 l
  112.076 64.636 l
  125.876 64.426 l
  127.763 64.397 129.386 64.485 130.746 64.691 c
  132.106 64.896 133.383 65.366 134.576 66.101 c
  135.783 66.834 136.743 67.801 137.456 69.001 c
  138.183 70.181 138.556 71.674 138.576 73.481 c
  138.602 75.967 138.072 78.004 136.986 79.591 c
  135.919 81.177 134.376 82.504 132.356 83.571 c
  f
  170 97.4 m
  146.9 97.751 l
  146.546 64.051 l
  169.646 63.7 l
  169.714 70.21 l
  154.814 70.437 l
  154.876 76.247 l
  168.676 76.037 l
  168.744 82.547 l
  154.944 82.757 l
  155.032 91.077 l
  169.932 90.85 l
  f
  200 97 m
  177 97.35 l
  176.646 63.65 l
  184.866 63.525 l
  185.152 90.625 l
  199.952 90.4 l
  f
  228 96.5 m
  204.9 96.851 l
  204.546 63.151 l
  227.646 62.8 l
  227.714 69.31 l
  212.814 69.537 l
  212.876 75.347 l
  226.676 75.137 l
  226.744 81.647 l
  212.944 81.857 l
  213.032 90.177 l
  227.932 89.95 l
  f
  264 96 m
  255.5 96.129 l
  253.22 89.359 l
  241.42 89.539 l
  239.29 96.379 l
  231 96.505 l
  242.4 62.705 l
  251.87 62.561 l
  h
  251.2 83.2 m
  247.15 71.2 l
  243.36 83.3 l
  f
  294 84.9 m
  294.035 88.213 292.728 90.93 290.08 93.05 c
  287.447 95.157 283.847 96.243 279.28 96.31 c
  276.64 96.35 274.33 96.144 272.35 95.692 c
  270.39 95.225 268.55 94.628 266.83 93.902 c
  266.745 85.832 l
  267.645 85.818 l
  269.358 87.225 271.268 88.295 273.375 89.028 c
  275.495 89.762 277.525 90.115 279.465 90.088 c
  279.965 90.081 280.622 90.025 281.435 89.922 c
  282.248 89.82 282.912 89.659 283.425 89.44 c
  284.05 89.16 284.56 88.813 284.955 88.4 c
  285.365 87.987 285.566 87.38 285.557 86.58 c
  285.549 85.84 285.243 85.21 284.637 84.69 c
  284.046 84.157 283.179 83.757 282.037 83.49 c
  280.837 83.207 279.564 82.948 278.217 82.712 c
  276.884 82.461 275.63 82.141 274.457 81.752 c
  271.764 80.872 269.817 79.659 268.617 78.112 c
  267.43 76.546 266.824 74.596 266.797 72.262 c
  266.764 69.129 268.064 66.556 270.697 64.542 c
  273.344 62.516 276.744 61.469 280.897 61.402 c
  282.997 61.37 285.07 61.557 287.117 61.963 c
  289.177 62.354 290.96 62.861 292.467 63.483 c
  292.549 71.233 l
  291.671 71.247 l
  290.377 70.18 288.791 69.3 286.911 68.607 c
  285.044 67.893 283.141 67.553 281.201 67.587 c
  280.514 67.597 279.831 67.66 279.151 67.777 c
  278.477 67.877 277.831 68.068 277.211 68.349 c
  276.656 68.583 276.183 68.937 275.791 69.409 c
  275.395 69.867 275.201 70.39 275.208 70.979 c
  275.217 71.865 275.545 72.545 276.193 73.019 c
  276.84 73.476 278.057 73.886 279.843 74.249 c
  281.016 74.487 282.139 74.719 283.213 74.944 c
  284.299 75.168 285.466 75.482 286.713 75.885 c
  289.166 76.691 290.976 77.818 292.143 79.265 c
  293.329 80.691 293.936 82.565 293.963 84.885 c
  f
  323 95.1 m
  299.9 95.451 l
  299.546 61.751 l
  322.646 61.4 l
  322.714 67.91 l
  307.815 68.137 l
  307.876 73.947 l
  321.676 73.737 l
  321.744 80.247 l
  307.944 80.457 l
  308.032 88.777 l
  322.932 88.55 l
  f  
  `,NOT_FOR_PUBLIC_RELEASE:`33.5 13.4 m
  404.5 6.92 l
  419.6 6.657 431.9 18.52 432.1 33.62 c
  432.89 78.92 l
  433.153 94.02 421.29 106.32 406.19 106.52 c
  35.19 113 l
  20.09 113.263 7.79 101.4 7.59 86.3 c
  6.8 41 l
  6.537 25.9 18.4 13.6 33.5 13.4 c
  s
  140 57.9 m
  132.53 58.021 l
  119.53 35.121 l
  119.759 58.221 l
  112.649 58.336 l
  112.315 24.636 l
  121.585 24.486 l
  132.785 43.586 l
  132.594 24.286 l
  139.704 24.171 l
  f
  177 40.5 m
  177.053 45.867 175.723 50.167 173.01 53.4 c
  170.297 56.593 166.53 58.23 161.71 58.31 c
  156.877 58.388 153.077 56.875 150.31 53.77 c
  147.53 50.65 146.113 46.417 146.06 41.07 c
  146.006 35.657 147.336 31.357 150.05 28.17 c
  152.763 24.977 156.53 23.34 161.35 23.26 c
  166.17 23.182 169.97 24.695 172.75 27.8 c
  175.543 30.887 176.967 35.153 177.02 40.6 c
  h
  166.8 49.19 m
  167.547 48.15 168.093 46.937 168.44 45.55 c
  168.789 44.143 168.955 42.497 168.936 40.61 c
  168.916 38.59 168.69 36.877 168.259 35.47 c
  167.828 34.063 167.271 32.927 166.589 32.06 c
  165.896 31.167 165.096 30.523 164.189 30.13 c
  163.296 29.737 162.366 29.549 161.399 29.565 c
  160.419 29.581 159.492 29.792 158.619 30.198 c
  157.759 30.604 156.972 31.264 156.259 32.178 c
  155.594 33.031 155.054 34.208 154.639 35.708 c
  154.236 37.195 154.045 38.915 154.064 40.868 c
  154.084 42.875 154.303 44.581 154.721 45.988 c
  155.152 47.381 155.709 48.518 156.391 49.398 c
  157.071 50.278 157.864 50.921 158.771 51.328 c
  159.678 51.735 160.628 51.931 161.621 51.915 c
  162.614 51.899 163.561 51.673 164.461 51.236 c
  165.361 50.785 166.141 50.101 166.801 49.186 c
  f
  207 29.7 m
  197.61 29.852 l
  197.879 56.952 l
  190.129 57.077 l
  189.86 29.977 l
  180.47 30.129 l
  180.406 23.619 l
  206.906 23.19 l
  f
  247 29 m
  233.2 29.223 l
  233.262 35.483 l
  246.062 35.276 l
  246.127 41.786 l
  233.327 41.993 l
  233.47 56.393 l
  225.76 56.518 l
  225.426 22.818 l
  246.926 22.47 l
  f
  282 38.8 m
  282.053 44.167 280.723 48.467 278.01 51.7 c
  275.297 54.893 271.53 56.53 266.71 56.61 c
  261.877 56.688 258.077 55.175 255.31 52.07 c
  252.53 48.95 251.113 44.717 251.06 39.37 c
  251.006 33.957 252.336 29.657 255.05 26.47 c
  257.763 23.277 261.53 21.64 266.35 21.56 c
  271.17 21.482 274.97 22.995 277.75 26.1 c
  280.543 29.187 281.967 33.453 282.02 38.9 c
  h
  271.8 47.49 m
  272.547 46.45 273.093 45.237 273.44 43.85 c
  273.789 42.443 273.955 40.797 273.936 38.91 c
  273.916 36.89 273.69 35.177 273.259 33.77 c
  272.828 32.363 272.271 31.227 271.589 30.36 c
  270.896 29.467 270.096 28.823 269.189 28.43 c
  268.296 28.037 267.366 27.849 266.399 27.865 c
  265.419 27.881 264.492 28.092 263.619 28.498 c
  262.759 28.904 261.972 29.564 261.259 30.478 c
  260.594 31.331 260.054 32.508 259.639 34.008 c
  259.236 35.495 259.045 37.215 259.064 39.168 c
  259.084 41.175 259.303 42.881 259.721 44.288 c
  260.152 45.681 260.709 46.818 261.391 47.698 c
  262.071 48.578 262.864 49.221 263.771 49.628 c
  264.678 50.035 265.628 50.231 266.621 50.215 c
  267.614 50.199 268.561 49.973 269.461 49.536 c
  270.361 49.085 271.141 48.401 271.801 47.486 c
  f
  304 31.9 m
  303.992 31.053 303.83 30.333 303.514 29.74 c
  303.199 29.142 302.662 28.675 301.904 28.34 c
  301.377 28.107 300.763 27.974 300.064 27.94 c
  299.364 27.891 298.551 27.874 297.624 27.889 c
  294.814 27.934 l
  294.904 36.994 l
  297.284 36.956 l
  298.524 36.936 299.561 36.851 300.394 36.702 c
  301.227 36.552 301.924 36.232 302.484 35.741 c
  303.018 35.265 303.405 34.745 303.644 34.181 c
  303.894 33.604 304.014 32.841 304.005 31.891 c
  h
  316.3 55.1 m
  306.83 55.253 l
  298.51 43.053 l
  294.94 43.111 l
  295.062 55.411 l
  287.352 55.536 l
  287.018 21.836 l
  300.018 21.626 l
  301.791 21.597 303.321 21.685 304.608 21.891 c
  305.888 22.096 307.091 22.566 308.218 23.301 c
  309.358 24.034 310.261 25.001 310.928 26.201 c
  311.615 27.381 311.965 28.874 311.978 30.681 c
  312.003 33.167 311.506 35.204 310.488 36.791 c
  309.481 38.377 308.028 39.704 306.128 40.771 c
  f
  52 75.7 m
  52.015 77.207 51.794 78.687 51.337 80.14 c
  50.88 81.58 50.22 82.797 49.357 83.79 c
  48.17 85.137 46.84 86.16 45.367 86.86 c
  43.907 87.56 42.08 87.93 39.887 87.97 c
  35.057 88.048 l
  35.166 99.048 l
  27.416 99.173 l
  27.082 65.473 l
  39.882 65.267 l
  41.795 65.236 43.405 65.398 44.712 65.754 c
  46.032 66.095 47.202 66.625 48.222 67.344 c
  49.442 68.211 50.375 69.334 51.022 70.714 c
  51.682 72.087 52.022 73.747 52.042 75.694 c
  h
  43.99 76.033 m
  43.981 75.086 43.744 74.276 43.279 73.603 c
  42.814 72.916 42.278 72.443 41.669 72.183 c
  40.856 71.834 40.066 71.651 39.299 71.633 c
  38.532 71.6 37.509 71.594 36.229 71.615 c
  34.899 71.636 l
  34.999 81.736 l
  37.219 81.7 l
  38.539 81.679 39.622 81.571 40.469 81.376 c
  41.329 81.182 42.046 80.808 42.619 80.256 c
  43.112 79.766 43.462 79.186 43.669 78.516 c
  43.891 77.836 43.997 77.013 43.988 76.046 c
  f
  83.9 86 m
  83.941 90.16 82.841 93.367 80.6 95.62 c
  78.36 97.873 75.04 99.033 70.64 99.1 c
  66.24 99.171 62.907 98.118 60.64 95.94 c
  58.373 93.76 57.217 90.6 57.17 86.46 c
  56.957 64.96 l
  64.747 64.834 l
  64.955 85.834 l
  64.978 88.167 65.431 89.901 66.315 91.034 c
  67.202 92.167 68.628 92.717 70.595 92.684 c
  72.535 92.653 73.942 92.079 74.815 90.964 c
  75.708 89.851 76.142 88.081 76.115 85.654 c
  75.907 64.654 l
  83.697 64.528 l
  f
  117 87.3 m
  117.016 88.927 116.734 90.387 116.155 91.68 c
  115.589 92.973 114.799 94.05 113.785 94.91 c
  112.612 95.923 111.312 96.653 109.885 97.1 c
  108.478 97.545 106.685 97.785 104.505 97.82 c
  91.405 98.032 l
  91.071 64.332 l
  102.771 64.144 l
  105.191 64.105 106.961 64.167 108.081 64.329 c
  109.214 64.492 110.334 64.872 111.441 65.469 c
  112.594 66.098 113.451 66.958 114.011 68.049 c
  114.587 69.122 114.882 70.362 114.896 71.769 c
  114.912 73.396 114.542 74.842 113.786 76.109 c
  113.033 77.356 111.959 77.356 110.566 76.109 c
  112.533 76.514 114.096 77.394 115.256 78.749 c
  116.429 80.102 117.026 81.902 117.046 84.149 c
  h
  106.9 73.6 m
  106.9 73.043 106.767 72.486 106.5 71.93 c
  106.252 71.376 105.812 70.969 105.18 70.71 c
  104.612 70.478 103.905 70.361 103.06 70.36 c
  102.227 70.343 101.05 70.347 99.53 70.372 c
  98.803 70.384 l
  98.874 77.504 l
  100.084 77.484 l
  101.31 77.464 102.354 77.425 103.214 77.366 c
  104.074 77.307 104.75 77.145 105.244 76.881 c
  105.937 76.523 106.39 76.07 106.604 75.521 c
  106.814 74.96 106.915 74.316 106.908 73.591 c
  h
  108.93 87.3 m
  108.919 86.233 108.723 85.417 108.34 84.85 c
  107.971 84.268 107.341 83.841 106.45 83.57 c
  105.843 83.384 105.006 83.292 103.94 83.294 c
  102.873 83.296 101.763 83.307 100.61 83.325 c
  98.91 83.353 l
  98.993 91.743 l
  99.558 91.733 l
  101.738 91.698 103.298 91.666 104.238 91.635 c
  105.178 91.605 106.045 91.395 106.838 91.005 c
  107.645 90.615 108.191 90.109 108.478 89.485 c
  108.781 88.847 108.929 88.121 108.921 87.305 c
  f
  144 97.2 m
  122.3 97.55 l
  121.966 63.85 l
  129.716 63.725 l
  129.985 90.825 l
  143.885 90.6 l
  f
  165 96.9 m
  147.4 97.184 l
  147.341 91.214 l
  152.271 91.134 l
  152.056 69.434 l
  147.126 69.514 l
  147.067 63.544 l
  164.667 63.26 l
  164.726 69.23 l
  159.796 69.31 l
  160.011 91.01 l
  164.941 90.93 l
  f
  185 97.2 m
  182.767 97.236 180.697 96.899 178.79 96.19 c
  176.897 95.483 175.263 94.41 173.89 92.97 c
  172.517 91.53 171.443 89.723 170.67 87.55 c
  169.91 85.377 169.513 82.86 169.48 80 c
  169.454 77.333 169.786 74.91 170.478 72.73 c
  171.171 70.55 172.188 68.673 173.528 67.1 c
  174.821 65.587 176.425 64.407 178.338 63.56 c
  180.271 62.713 182.381 62.273 184.668 62.24 c
  185.935 62.22 187.071 62.284 188.078 62.434 c
  189.105 62.568 190.048 62.756 190.908 62.999 c
  191.815 63.271 192.631 63.582 193.358 63.932 c
  194.105 64.267 194.755 64.58 195.308 64.873 c
  195.389 73.033 l
  194.501 73.047 l
  194.12 72.692 193.637 72.269 193.051 71.777 c
  192.481 71.289 191.831 70.809 191.101 70.337 c
  190.354 69.867 189.551 69.474 188.691 69.157 c
  187.824 68.84 186.901 68.689 185.921 68.704 c
  184.828 68.722 183.794 68.935 182.821 69.342 c
  181.841 69.735 180.938 70.382 180.111 71.282 c
  179.324 72.156 178.691 73.302 178.211 74.722 c
  177.74 76.149 177.515 77.872 177.535 79.892 c
  177.556 81.999 177.836 83.759 178.375 85.172 c
  178.928 86.579 179.611 87.682 180.425 88.482 c
  181.252 89.296 182.172 89.876 183.185 90.222 c
  184.198 90.552 185.195 90.71 186.175 90.694 c
  187.115 90.679 188.042 90.506 188.955 90.174 c
  189.882 89.843 190.732 89.4 191.505 88.844 c
  192.16 88.396 192.767 87.92 193.325 87.414 c
  193.886 86.908 194.346 86.471 194.705 86.104 c
  195.513 86.091 l
  195.593 94.141 l
  194.846 94.53 194.129 94.897 193.443 95.241 c
  192.763 95.584 192.046 95.882 191.293 96.135 c
  190.313 96.468 189.393 96.724 188.533 96.903 c
  f
  232 72.4 m
  231.992 71.553 231.83 70.833 231.514 70.24 c
  231.199 69.642 230.662 69.175 229.904 68.84 c
  229.377 68.607 228.763 68.474 228.064 68.44 c
  227.364 68.391 226.551 68.374 225.624 68.389 c
  222.814 68.434 l
  222.904 77.494 l
  225.284 77.456 l
  226.524 77.436 227.56 77.351 228.394 77.202 c
  229.227 77.052 229.924 76.732 230.484 76.241 c
  231.018 75.765 231.404 75.245 231.644 74.681 c
  231.894 74.104 232.014 73.341 232.005 72.391 c
  h
  244.3 95.6 m
  234.83 95.753 l
  226.51 83.553 l
  222.94 83.611 l
  223.062 95.911 l
  215.352 96.036 l
  215.018 62.336 l
  228.018 62.126 l
  229.791 62.097 231.321 62.185 232.608 62.391 c
  233.888 62.596 235.091 63.066 236.218 63.801 c
  237.358 64.534 238.261 65.501 238.928 66.701 c
  239.615 67.881 239.965 69.374 239.978 71.181 c
  240.003 73.667 239.506 75.704 238.488 77.291 c
  237.481 78.877 236.028 80.204 234.128 81.271 c
  f
  270 95.2 m
  248.3 95.551 l
  247.966 61.851 l
  269.666 61.5 l
  269.731 68.01 l
  255.731 68.237 l
  255.788 74.047 l
  268.788 73.837 l
  268.853 80.347 l
  255.853 80.557 l
  255.935 88.877 l
  269.935 88.65 l
  f
  298 94.7 m
  276.3 95.05 l
  275.966 61.35 l
  283.716 61.225 l
  283.985 88.325 l
  297.885 88.1 l
  f
  324 94.3 m
  302.3 94.651 l
  301.966 60.951 l
  323.666 60.6 l
  323.731 67.11 l
  309.731 67.337 l
  309.788 73.147 l
  322.788 72.937 l
  322.853 79.447 l
  309.853 79.657 l
  309.935 87.977 l
  323.935 87.75 l
  f
  359 93.7 m
  350.99 93.829 l
  348.84 87.059 l
  337.74 87.239 l
  335.73 94.079 l
  327.92 94.205 l
  338.72 60.405 l
  347.64 60.261 l
  h
  346.9 80.9 m
  343.09 68.9 l
  339.52 81 l
  f
  387 82.7 m
  387.033 86.013 385.8 88.73 383.3 90.85 c
  380.82 92.957 377.42 94.043 373.1 94.11 c
  370.613 94.15 368.437 93.944 366.57 93.492 c
  364.723 93.025 362.987 92.428 361.36 91.702 c
  361.28 83.632 l
  362.128 83.618 l
  363.741 85.025 365.541 86.095 367.528 86.828 c
  369.528 87.562 371.445 87.915 373.278 87.888 c
  373.749 87.881 374.369 87.825 375.138 87.722 c
  375.905 87.62 376.528 87.459 377.008 87.24 c
  377.597 86.96 378.077 86.613 378.448 86.2 c
  378.834 85.787 379.023 85.18 379.016 84.38 c
  379.009 83.64 378.72 83.01 378.149 82.49 c
  377.592 81.957 376.772 81.557 375.689 81.29 c
  374.556 81.007 373.356 80.748 372.089 80.512 c
  370.836 80.261 369.656 79.941 368.549 79.552 c
  366.009 78.672 364.172 77.459 363.039 75.912 c
  361.919 74.346 361.349 72.396 361.329 70.062 c
  361.298 66.929 362.525 64.356 365.009 62.342 c
  367.509 60.316 370.729 59.269 374.669 59.202 c
  376.649 59.17 378.602 59.357 380.529 59.763 c
  382.469 60.154 384.149 60.661 385.569 61.283 c
  385.646 69.033 l
  384.818 69.047 l
  383.598 67.98 382.101 67.1 380.328 66.407 c
  378.568 65.693 376.775 65.353 374.948 65.387 c
  374.302 65.397 373.655 65.46 373.008 65.577 c
  372.376 65.677 371.766 65.868 371.178 66.149 c
  370.655 66.383 370.209 66.737 369.838 67.209 c
  369.465 67.667 369.282 68.19 369.288 68.779 c
  369.297 69.665 369.606 70.345 370.217 70.819 c
  370.827 71.276 371.974 71.686 373.657 72.049 c
  374.764 72.287 375.824 72.519 376.837 72.744 c
  377.864 72.968 378.964 73.282 380.137 73.685 c
  382.444 74.491 384.15 75.618 385.257 77.065 c
  386.377 78.491 386.947 80.365 386.967 82.685 c
  f
  414 92.9 m
  392.3 93.251 l
  391.966 59.551 l
  413.666 59.2 l
  413.731 65.71 l
  399.731 65.937 l
  399.788 71.747 l
  412.788 71.537 l
  412.853 78.047 l
  399.853 78.257 l
  399.935 86.577 l
  413.935 86.35 l
  f
  `},standardStampCreationInfos={"/Draft":{textStreamData:standardStampForms.DRAFT,color:standardStampColors.redColor,subject:"Draft",bbox:standardStampBBox,rect:standardStampRect},"/Approved":{textStreamData:standardStampForms.APPROVED,color:standardStampColors.greenColor,subject:"Approved",bbox:standardStampBBox,rect:standardStampRect},"/NotApproved":{textStreamData:standardStampForms.NOT_APPROVED,color:standardStampColors.redColor,subject:"Not Approved",bbox:standardStampBBox,rect:standardStampRect},"/Departmental":{textStreamData:standardStampForms.DEPARTMENTAL,color:standardStampColors.blueColor,subject:"Departmental",bbox:standardStampBBox,rect:standardStampRect},"/Confidential":{textStreamData:standardStampForms.CONFIDENTIAL,color:standardStampColors.redColor,subject:"Confidential",bbox:standardStampBBox,rect:standardStampRect},"/Final":{textStreamData:standardStampForms.FINAL,color:standardStampColors.redColor,subject:"Final",bbox:standardStampBBox,rect:standardStampRect},"/Expired":{textStreamData:standardStampForms.EXPIRED,color:standardStampColors.redColor,subject:"Expired",bbox:standardStampBBox,rect:standardStampRect},"/AsIs":{textStreamData:standardStampForms.AS_IS,color:standardStampColors.redColor,subject:"As Is",bbox:standardStampBBox,rect:standardStampRect},"/Sold":{textStreamData:standardStampForms.SOLD,color:standardStampColors.blueColor,subject:"Sold",bbox:standardStampBBox,rect:standardStampRect},"/Experimental":{textStreamData:standardStampForms.EXPERIMENTAL,color:standardStampColors.blueColor,subject:"Experimental",bbox:standardStampBBox,rect:standardStampRect},"/ForComment":{textStreamData:standardStampForms.FOR_COMMENT,color:standardStampColors.greenColor,subject:"For Comment",bbox:standardStampBBox,rect:standardStampRect},"/TopSecret":{textStreamData:standardStampForms.TOP_SECRET,color:standardStampColors.redColor,subject:"Top Secret",bbox:standardStampBBox,rect:standardStampRect},"/ForPublicRelease":{textStreamData:standardStampForms.FOR_PUBLIC_RELEASE,color:standardStampColors.greenColor,subject:"For Public Release",bbox:standardStampBBox,rect:standardStampRect},"/NotForPublicRelease":{textStreamData:standardStampForms.NOT_FOR_PUBLIC_RELEASE,color:standardStampColors.redColor,subject:"Not For Public Release",bbox:standardStampBBox,rect:standardStampRect}};class StampAnnotation extends MarkupAnnotation{Name=stampTypes.DRAFT;IT="/Stamp";_customImageData;constructor(){super(annotationTypes.STAMP)}static createFromDto(e){if(e.annotationType!=="/Stamp")throw new Error("Invalid annotation type");const C=DateString.fromDate(new Date(e.dateCreated)),F=DateString.fromDate(new Date(e.dateModified)),$=new XFormStream;$.LastModified=F,$.Filter="/FlateDecode",$.Resources=new ResourceDict,$.Matrix=e.matrix||[1,0,0,1,0,0];const Y=new StampAnnotation;Y.$name=e.uuid,Y.NM=LiteralString.fromString(e.uuid),Y.T=LiteralString.fromString(e.author||"unknown"),Y.M=F,Y.CreationDate=C,Y.Name=e.stampType,Y.apStream=$;const V=standardStampCreationInfos[e.stampType];if(V){const te=new XFormStream;te.LastModified=F,te.Filter="/FlateDecode",te.setTextStreamData(V.textStreamData);const se=V.color,ne=V.subject,ee=V.bbox,ie=e.rect||V.rect||V.bbox;te.BBox=ee;const ae=se[0].toFixed(3),re=se[1].toFixed(3),oe=se[2].toFixed(3),ce=`${ae} ${re} ${oe} rg ${ae} ${re} ${oe} RG`;$.BBox=ee,$.Resources.setXObject("/Fm",te),$.setTextStreamData(`q 1 0 0 -1 0 ${ee[3]} cm ${ce} 1 j 8.58 w /Fm Do Q`),Y.Rect=ie,Y.Subj=LiteralString.fromString(ne),Y.Contents=e.textContent?LiteralString.fromString(e.textContent):Y.Subj,Y.C=se,Y.CA=1}else if(e.stampImageData?.length&&!(e.stampImageData.length%4)){const te=new Uint8Array(e.stampImageData);Y._customImageData=te;const se=new ImageStream,ne=new DecodeParamsDict;ne.setIntProp("/Predictor",12),ne.setIntProp("/Colors",1),ne.setIntProp("/BitsPerComponent",8),ne.setIntProp("/Columns",e.bbox[2]),se.DecodeParms=ne,se.Filter="/FlateDecode",se.BitsPerComponent=8,se.Width=e.bbox[2],se.Height=e.bbox[3],se.ColorSpace=colorSpaces.GRAYSCALE,se.streamData=te.filter((ae,re)=>(re+1)%4===0);const ee=new ImageStream,ie=new DecodeParamsDict;ie.setIntProp("/Predictor",12),ie.setIntProp("/Colors",3),ie.setIntProp("/BitsPerComponent",8),ie.setIntProp("/Columns",e.bbox[2]),ee.DecodeParms=ie,ee.Filter="/FlateDecode",ee.BitsPerComponent=8,ee.Width=e.bbox[2],ee.Height=e.bbox[3],ee.ColorSpace=colorSpaces.RGB,ee.streamData=te.filter((ae,re)=>(re+1)%4!==0),ee.sMask=se,$.BBox=e.bbox,$.Resources.setXObject("/Im",ee),$.setTextStreamData(`q ${e.bbox[2]} 0 0 ${e.bbox[3]} 0 0 cm /Im Do Q`),Y.Rect=e.rect,Y.Subj=e.stampSubject?LiteralString.fromString(e.stampSubject):LiteralString.fromString(e.stampType),Y.Contents=e.textContent?LiteralString.fromString(e.textContent):Y.Subj}else throw new Error("Custom stamp has no valid image data");return Y._added=!0,Y.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new StampAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Name&&$.push(...F.encode("/Name "),...F.encode(this.Name)),this.IT&&$.push(...F.encode("/IT "),...F.encode(this.IT));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){return{annotationType:"/Stamp",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,stampType:this.Name,stampSubject:this.Subj?.literal,stampImageData:this._customImageData?[...this._customImageData]:null}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Name":V=await this.parseNamePropAsync(te,C,V);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Name)throw new Error("Not all required properties parsed")}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}const textNoteForms={NOTE:`25 10 m
  175 10 l
  175 10 190 10 190 25 c
  190 135 l
  190 135 190 150 175 150 c
  95 150 l
  10 190 l
  35 150 l
  25 150 l
  25 150 10 150 10 135 c
  10 25 l
  10 25 10 10 25 10 c
  b  
  35 35 m
  165 35 l
  S  
  35 55 m
  165 55 l
  S
  35 75 m
  125 75 l
  S
  35 95 m
  165 95 l
  S
  35 115 m
  115 115 l
  S
  `},textNoteCreationInfos={"/Note":{textStreamData:textNoteForms.NOTE,fillColor:[1,1,.4],subject:"Note",bBox:[0,0,200,200],rect:[0,0,25,25]}};class TextAnnotation extends MarkupAnnotation{Open=!1;Name=annotationIconTypes.NOTE;State;StateModel;constructor(){super(annotationTypes.TEXT)}static createStandard(e,C,F=annotationIconTypes.NOTE){const $=new Date().toISOString(),Y={uuid:UUID.getRandomUuid(),annotationType:"/Text",pageId:null,dateCreated:$,dateModified:$,author:e||"unknown",textContent:null,rect:null,matrix:null,color:C,textNoteType:F};return this.createFromDto(Y)}static createFromDto(e){if(e.annotationType!=="/Text")throw new Error("Invalid annotation type");const C=DateString.fromDate(new Date(e.dateCreated)),F=DateString.fromDate(new Date(e.dateModified)),$=new XFormStream;$.LastModified=F,$.Filter="/FlateDecode";const Y=textNoteCreationInfos[e.textNoteType];if(!Y)throw new Error(`Stamp type '${e.textNoteType}' is not supported`);$.setTextStreamData(Y.textStreamData);const V=e.color,te=Y.fillColor,se=Y.subject,ne=Y.bBox;$.BBox=ne;const ee=V[0].toFixed(3),ie=V[1].toFixed(3),ae=V[2].toFixed(3),re=te[0].toFixed(3),oe=te[1].toFixed(3),ce=te[2].toFixed(3),he=`${re} ${oe} ${ce} rg ${ee} ${ie} ${ae} RG`,de=new XFormStream;de.LastModified=F,de.BBox=ne,de.Matrix=e.matrix||[1,0,0,1,0,0],de.Resources=new ResourceDict,de.Resources.setXObject("/Fm",$),de.Filter="/FlateDecode",de.setTextStreamData(`q 1 0 0 -1 0 ${ne[3]} cm ${he} 1 j 8.58 w /Fm Do Q`);const pe=new TextAnnotation;return pe.$name=e.uuid,pe.NM=LiteralString.fromString(e.uuid),pe.T=LiteralString.fromString(e.author||"unknown"),pe.M=F,pe.CreationDate=C,pe.Contents=e.textContent?LiteralString.fromString(e.textContent):LiteralString.fromString(se),pe.Subj=LiteralString.fromString(se),pe.Name=e.textNoteType,pe.State=e.textNoteState,pe.StateModel=e.textNoteStateModel,pe.Rect=e.rect||Y.rect,pe.C=V,pe.CA=1,pe.apStream=de,pe._added=!0,pe.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new TextAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Open&&$.push(...F.encode("/Open "),...F.encode(" "+this.Open)),this.Name&&$.push(...F.encode("/Name "),...F.encode(this.Name)),this.State&&$.push(...F.encode("/State "),...F.encode(this.State)),this.StateModel&&$.push(...F.encode("/StateModel "),...F.encode(this.StateModel));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect();return{annotationType:"/Text",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,color:e,textNoteType:this.Name,textNoteState:this.State,textNoteStateModel:this.StateModel}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Open":V=await this.parseBoolPropAsync(te,C,V);break;case"/Name":const ne=await C.parseNameAtAsync(V,!0);if(ne&&Object.values(annotationIconTypes).includes(ne.value))this.Name=ne.value,V=ne.end+1;else throw new Error("Can't parse /Name property value");break;case"/State":const ee=await C.parseNameAtAsync(V,!0);if(ee&&Object.values(annotationMarkedStates).concat(Object.values(annotationReviewStates)).includes(ee.value))this.State=ee.value,V=ee.end+1;else throw new Error("Can't parse /State property value");break;case"/StateModel":const ie=await C.parseNameAtAsync(V,!0);if(ie&&Object.values(annotationStateModelTypes).includes(ie.value))this.StateModel=ie.value,V=ie.end+1;else throw new Error("Can't parse /StateModel property value");break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}renderHandles(){return[]}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class InkAnnotation extends MarkupAnnotation{InkList;constructor(){super(annotationTypes.INK)}static createFromDto(e){if(e.annotationType!=="/Ink")throw new Error("Invalid annotation type");const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new InkAnnotation;return F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,F.InkList=e.inkList,F.Rect=e.rect,F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new InkAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.InkList&&$.push(...F.encode("/InkList "),...this.encodeNestedPrimitiveArray(this.InkList));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect();return{annotationType:"/Ink",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,inkList:this.InkList,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/InkList":if(V=await C.skipEmptyAsync(V),await C.getValueTypeAtAsync(V)===valueTypes.ARRAY){const ee=[];let ie=++V;for(;;){const ae=await C.parseNumberArrayAtAsync(ie);if(!ae)break;ee.push(ae.value),ie=ae.end+1}this.InkList=ee;break}throw new Error("Can't parse /InkList property value");default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.InkList?.length)throw new Error("Not all required properties parsed");await this.bakeRotationAsync()}generateApStream(){const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.LJ=lineJoinStyles.ROUND,V.LC=lineCapStyles.ROUND,V.D=[[$,Y],0];let se=`q ${this.getColorString()} /GS0 gs`,ne,ee;this.InkList.forEach(ie=>{ne=ie[0],ee=ie[1],se+=`
${ne} ${ee} m`;for(let ae=2;ae<ie.length;ae=ae+2)ne=ie[ae],ee=ie[ae+1],se+=`
${ne} ${ee} l`;se+=`
S`}),se+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(se),this.apStream=e}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy();let $,Y,V,te,se,ne;const ee=new u;F.InkList.forEach(ae=>{for(let re=0;re<ae.length;re=re+2)$=ae[re],Y=ae[re+1],ee.set($,Y).applyMat3(e),ae[re]=ee.x,ae[re+1]=ee.y,(!V||ee.x<V)&&(V=ee.x),(!te||ee.y<te)&&(te=ee.y),(!se||ee.x>se)&&(se=ee.x),(!ne||ee.y>ne)&&(ne=ee.y)});const ie=(F.BS?.W??F.Border?.width??1)/2;if(V-=ie,te-=ie,se+=ie,ne+=ie,this.Rect=[V,te,se,ne],this._bBox){const ae=F.getLocalBB();ae.ll.set(V,te),ae.lr.set(se,te),ae.ur.set(se,ne),ae.ul.set(V,ne)}if(this.generateApStream(),F.M=DateString.fromDate(new Date),F.$onEditAction){const ae=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(ae,!1),await F.updateRenderAsync()}:void 0)}}async bakeRotationAsync(){const e=this.getCurrentRotation(),C=(this.Rect[0]+this.Rect[2])/2,F=(this.Rect[1]+this.Rect[3])/2,$=new l().applyTranslation(-C,-F).applyRotation(e).applyTranslation(C,F);await this.applyCommonTransformAsync($)}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class GeometricAnnotation extends MarkupAnnotation{IC;constructor(e){super(e)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.IC&&$.push(...F.encode("/IC "),...this.encodePrimitiveArray(this.IC,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/IC":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}}class SquareAnnotation extends GeometricAnnotation{static cloudArcSize=20;RD;_cloud;constructor(){super(annotationTypes.SQUARE)}static createFromDto(e){if(e.annotationType!=="/Square")throw new Error("Invalid annotation type");const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new SquareAnnotation;return F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,F.Rect=e.rect,F.RD=e.rectMargins,F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F._cloud=e.cloud,F.generateApStream(e.bbox,e.matrix),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new SquareAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.RD&&$.push(...F.encode("/RD "),...this.encodePrimitiveArray(this.RD,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect();return{annotationType:"/Square",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,rectMargins:this.RD,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,cloud:this._cloud,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/RD":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}generateApStream(e,C){const F=new XFormStream;F.Filter="/FlateDecode",F.LastModified=DateString.fromDate(new Date);const $=e?[e[0],e[1],e[2],e[3]]:[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];F.BBox=$;const Y=C?[C[0],C[1],C[2],C[3],C[4],C[5]]:[1,0,0,1,0,0];F.Matrix=Y;const V=this.CA||1,te=this.strokeWidth,se=this.BS?.D[0]??this.Border?.dash??3,ne=this.BS?.D[1]??this.Border?.gap??0,ee=new GraphicsStateDict;if(ee.AIS=!0,ee.BM="/Normal",ee.CA=V,ee.ca=V,ee.LW=te,ee.D=[[se,ne],0],!this.RD){const Ie=this._cloud?SquareAnnotation.cloudArcSize/2:te/2;this.RD||=[Ie,Ie,Ie,Ie]}const ie=calcPdfBBoxToRectMatrices($,this.Rect,Y).matAA,ae=l.invert(ie).toFloatShortArray(),{r:re}=F.matrix.getTRS(),oe=new l().applyRotation(re),ce=new u($[0],$[1]),he=new u($[2],$[1]),de=new u($[2],$[3]),pe=new u($[0],$[3]),[fe,ye,_e,Ee]=this.RD,be=new u(fe,Ee).applyMat3(oe),Ae=new u(-_e,Ee).applyMat3(oe),we=new u(-_e,-ye).applyMat3(oe),Te=new u(fe,-ye).applyMat3(oe),Me=u.applyMat3(ce,ie).add(be),Be=u.applyMat3(he,ie).add(Ae),$e=u.applyMat3(de,ie).add(we),Fe=u.applyMat3(pe,ie).add(Te);let We=`q ${this.getColorString()} /GS0 gs`;if(We+=`
${ae[0]} ${ae[1]} ${ae[2]} ${ae[3]} ${ae[4]} ${ae[5]} cm`,this._cloud){ee.LC=lineCapStyles.ROUND,ee.LJ=lineJoinStyles.ROUND;const Ie=CloudCurveData.buildFromPolyline([Me.clone(),Be.clone(),$e.clone(),Fe.clone(),Me.clone()],SquareAnnotation.cloudArcSize);We+=`
${Ie.start.x} ${Ie.start.y} m`,Ie.curves.forEach(Oe=>{We+=`
${Oe[0].x} ${Oe[0].y} ${Oe[1].x} ${Oe[1].y} ${Oe[2].x} ${Oe[2].y} c`}),We+=`
S`}else ee.LC=lineCapStyles.SQUARE,ee.LJ=lineJoinStyles.MITER,We+=`
${Me.x} ${Me.y} m`,We+=`
${Be.x} ${Be.y} l`,We+=`
${$e.x} ${$e.y} l`,We+=`
${Fe.x} ${Fe.y} l`,We+=`
s`;We+=`
Q`,F.Resources=new ResourceDict,F.Resources.setGraphicsState("/GS0",ee),F.setTextStreamData(We),this.apStream=F}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy();F.applyRectTransform(e);const $=F.apStream;if($){const Y=l.multiply($.matrix,e);F.generateApStream($.BBox,Y.toFloatShortArray())}if(F.M=DateString.fromDate(new Date),F.$onEditAction){const Y=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(Y,!1),await F.updateRenderAsync()}:void 0)}}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class CircleAnnotation extends GeometricAnnotation{static cloudArcSize=20;RD;_cloud;constructor(){super(annotationTypes.CIRCLE)}static createFromDto(e){if(e.annotationType!=="/Circle")throw new Error("Invalid annotation type");const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new CircleAnnotation;return F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,F.Rect=e.rect,F.RD=e.rectMargins,F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F._cloud=e.cloud,F.generateApStream(e.bbox,e.matrix),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new CircleAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.RD&&$.push(...F.encode("/RD "),...this.encodePrimitiveArray(this.RD,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect();return{annotationType:"/Circle",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,rectMargins:this.RD,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,cloud:this._cloud,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/RD":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}}generateApStream(e,C){const F=new XFormStream;F.Filter="/FlateDecode",F.LastModified=DateString.fromDate(new Date);const $=e?[e[0],e[1],e[2],e[3]]:[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];F.BBox=$;const Y=C?[C[0],C[1],C[2],C[3],C[4],C[5]]:[1,0,0,1,0,0];F.Matrix=Y;const V=this.CA||1,te=this.strokeWidth,se=this.BS?.D[0]??this.Border?.dash??3,ne=this.BS?.D[1]??this.Border?.gap??0,ee=new GraphicsStateDict;if(ee.AIS=!0,ee.BM="/Normal",ee.CA=V,ee.ca=V,ee.LW=te,ee.D=[[se,ne],0],ee.LC=lineCapStyles.ROUND,ee.LJ=lineJoinStyles.ROUND,!this.RD){const le=this._cloud?CircleAnnotation.cloudArcSize/2:te/2;this.RD||=[le,le,le,le]}const ie=calcPdfBBoxToRectMatrices($,this.Rect,Y).matAA,ae=l.invert(ie).toFloatShortArray(),{r:re}=F.matrix.getTRS(),oe=new l().applyRotation(re),ce=new u($[0],$[1]),he=new u($[2],$[1]),de=new u($[2],$[3]),pe=new u($[0],$[3]),[fe,ye,_e,Ee]=this.RD,be=new u(fe,Ee).applyMat3(oe),Ae=new u(-_e,Ee).applyMat3(oe),we=new u(-_e,-ye).applyMat3(oe),Te=new u(fe,-ye).applyMat3(oe),Me=u.applyMat3(ce,ie).add(be),Be=u.applyMat3(he,ie).add(Ae),$e=u.applyMat3(de,ie).add(we),Fe=u.applyMat3(pe,ie).add(Te),Xe=u.add(Me,$e).multiplyByScalar(.5),We=u.add(Me,Fe).multiplyByScalar(.5),Ie=u.add(Fe,$e).multiplyByScalar(.5),Oe=u.add(Be,$e).multiplyByScalar(.5),Pe=u.add(Me,Be).multiplyByScalar(.5),ge=u.subtract(Oe,We).multiplyByScalar(.5),ue=u.subtract(Ie,Pe).multiplyByScalar(.5);let ve=`q ${this.getColorString()} /GS0 gs`;if(ve+=`
${ae[0]} ${ae[1]} ${ae[2]} ${ae[3]} ${ae[4]} ${ae[5]} cm`,this._cloud){const le=CloudCurveData.buildFromEllipse(ge.getMagnitude(),ue.getMagnitude(),CircleAnnotation.cloudArcSize,new l().applyRotation(re).applyTranslation(Xe.x,Xe.y));ve+=`
${le.start.x} ${le.start.y} m`,le.curves.forEach(me=>{ve+=`
${me[0].x} ${me[0].y} ${me[1].x} ${me[1].y} ${me[2].x} ${me[2].y} c`}),ve+=`
S`}else{const le=BEZIER_CONSTANT,me=u.multiplyByScalar(ge,le),Ce=u.multiplyByScalar(ue,le),Se=u.add(u.add(Xe,ue),me),Re=u.add(u.add(Xe,Ce),ge),ke=u.add(u.subtract(Xe,Ce),ge),De=u.add(u.subtract(Xe,ue),me),Ne=u.subtract(u.subtract(Xe,ue),me),Ge=u.subtract(u.subtract(Xe,Ce),ge),Le=u.subtract(u.add(Xe,Ce),ge),ze=u.subtract(u.add(Xe,ue),me);ve+=`
${Ie.x} ${Ie.y} m`,ve+=`
${Se.x} ${Se.y} ${Re.x} ${Re.y} ${Oe.x} ${Oe.y} c`,ve+=`
${ke.x} ${ke.y} ${De.x} ${De.y} ${Pe.x} ${Pe.y} c`,ve+=`
${Ne.x} ${Ne.y} ${Ge.x} ${Ge.y} ${We.x} ${We.y} c`,ve+=`
${Le.x} ${Le.y} ${ze.x} ${ze.y} ${Ie.x} ${Ie.y} c`,ve+=`
s`}ve+=`
Q`,F.Resources=new ResourceDict,F.Resources.setGraphicsState("/GS0",ee),F.setTextStreamData(ve),this.apStream=F}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy();F.applyRectTransform(e);const $=F.apStream;if($){const Y=l.multiply($.matrix,e);F.generateApStream($.BBox,Y.toFloatShortArray())}if(F.M=DateString.fromDate(new Date),F.$onEditAction){const Y=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(Y,!1),await F.updateRenderAsync()}:void 0)}}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class PolyAnnotation extends GeometricAnnotation{Vertices;IT;Measure;constructor(e){super(e)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.Vertices&&$.push(...F.encode("/Vertices "),...this.encodePrimitiveArray(this.Vertices,F)),this.IT&&$.push(...F.encode("/IT "),...F.encode(this.IT)),this.Measure&&$.push(...F.encode("/Measure "),...this.Measure.toArray(e));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/Vertices":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/IT":const ne=await C.parseNameAtAsync(V,!0);if(ne&&Object.values(polyIntents).includes(ne.value)){this.IT=ne.value,V=ne.end+1;break}throw new Error("Can't parse /IT property value");case"/Measure":const ee=await C.getValueTypeAtAsync(V);if(ee===valueTypes.REF){const ie=await ObjectId.parseRefAsync(C,V);if(ie&&e.parseInfoGetterAsync){const ae=await e.parseInfoGetterAsync(ie.value.id);if(ae){const re=await MeasureDict.parseAsync(ae);if(re){this.Measure=re.value,V=re.end+1;break}}}throw new Error("Can't parse /Measure value reference")}else if(ee===valueTypes.DICTIONARY){const ie=await C.getDictBoundsAtAsync(V);if(ie){const ae=await MeasureDict.parseAsync({parser:C,bounds:ie});if(ae){this.Measure=ae.value,V=ae.end+1;break}}throw new Error("Can't parse /Measure value dictionary")}throw new Error(`Unsupported /Measure property value type: ${ee}`);default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.Vertices)throw new Error("Not all required properties parsed")}}class PolygonAnnotation extends PolyAnnotation{static cloudArcSize=20;constructor(){super(annotationTypes.POLYGON)}static createFromDto(e){if(e.annotationType!=="/Polygon")throw new Error("Invalid annotation type");const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new PolygonAnnotation;return F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,F.Rect=e.rect,F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.IT=e.cloud?polyIntents.CLOUD:polyIntents.POLYGON_DIMENSION,F.Vertices=e.vertices,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new PolygonAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){return super.toArray(e)}toDto(){const e=this.getColorRect();return{annotationType:"/Polygon",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,vertices:this.Vertices,cloud:this.IT===polyIntents.CLOUD,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e),await this.bakeRotationAsync()}generateApStream(){if(!this.Vertices?.length||this.Vertices.length<6)return;const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.D=[[$,Y],0];const te=this.getColorString(),se=this.Vertices;let ne=`q ${te} /GS0 gs`;if(this.IT===polyIntents.CLOUD){V.LC=lineCapStyles.ROUND,V.LJ=lineJoinStyles.ROUND;const ee=[];for(let ae=0;ae<se.length;ae=ae+2)ee.push(new u(se[ae],se[ae+1]));ee.push(new u(se[0],se[1]));const ie=CloudCurveData.buildFromPolyline(ee,PolygonAnnotation.cloudArcSize);ne+=`
${ie.start.x} ${ie.start.y} m`,ie.curves.forEach(ae=>{ne+=`
${ae[0].x} ${ae[0].y} ${ae[1].x} ${ae[1].y} ${ae[2].x} ${ae[2].y} c`}),ne+=`
S`}else{V.LC=lineCapStyles.SQUARE,V.LJ=lineJoinStyles.MITER;let ee,ie;ne+=`
${se[0]} ${se[1]} m`;for(let ae=2;ae<se.length;ae=ae+2)ee=se[ae],ie=se[ae+1],ne+=`
${ee} ${ie} l`;ne+=`
s`}ne+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(ne),this.apStream=e}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy();let $,Y,V,te,se,ne;const ee=new u,ie=F.Vertices;for(let oe=0;oe<ie.length;oe=oe+2)$=ie[oe],Y=ie[oe+1],ee.set($,Y).applyMat3(e),ie[oe]=ee.x,ie[oe+1]=ee.y,(!V||ee.x<V)&&(V=ee.x),(!te||ee.y<te)&&(te=ee.y),(!se||ee.x>se)&&(se=ee.x),(!ne||ee.y>ne)&&(ne=ee.y);const ae=(F.BS?.W??F.Border?.width??1)/2,re=F.IT===polyIntents.CLOUD?PolygonAnnotation.cloudArcSize/2+ae:ae;if(V-=re,te-=re,se+=re,ne+=re,F.Rect=[V,te,se,ne],F._bBox){const oe=F.getLocalBB();oe.ll.set(V,te),oe.lr.set(se,te),oe.ur.set(se,ne),oe.ul.set(V,ne)}if(F.generateApStream(),F.M=DateString.fromDate(new Date),F.$onEditAction){const oe=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(oe,!1),await F.updateRenderAsync()}:void 0)}}async bakeRotationAsync(){const e=this.getCurrentRotation(),C=(this.Rect[0]+this.Rect[2])/2,F=(this.Rect[1]+this.Rect[3])/2,$=new l().applyTranslation(-C,-F).applyRotation(e).applyTranslation(C,F);await this.applyCommonTransformAsync($)}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class PolylineAnnotation extends PolyAnnotation{LE=[lineEndingTypes.NONE,lineEndingTypes.NONE];constructor(){super(annotationTypes.POLYLINE)}static createFromDto(e){if(e.annotationType!=="/Polyline")throw new Error("Invalid annotation type");const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new PolylineAnnotation;return F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,F.Rect=e.rect,F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.IT=polyIntents.POLYLINE_DIMENSION,F.LE=e.endingType||[lineEndingTypes.NONE,lineEndingTypes.NONE],F.Vertices=e.vertices,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new PolylineAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.LE&&$.push(...F.encode("/LE "),...this.encodePrimitiveArray(this.LE,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect();return{annotationType:"/PolyLine",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,vertices:this.Vertices,endingType:this.LE,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/LE":const ne=await C.parseNameArrayAtAsync(V,!0);if(ne&&Object.values(lineEndingTypes).includes(ne.value[0])&&Object.values(lineEndingTypes).includes(ne.value[1]))this.LE=[ne.value[0],ne.value[1]],V=ne.end+1;else throw new Error("Can't parse /LE property value");break;default:V=await C.skipToNextNameAsync(V,Y-1);break}await this.bakeRotationAsync()}generateApStream(){if(!this.Vertices?.length||this.Vertices.length<4)return;const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.D=[[$,Y],0],V.LC=lineCapStyles.SQUARE,V.LJ=lineJoinStyles.MITER;const te=this.getColorString(),se=this.Vertices;let ne=`q ${te} /GS0 gs`,ee,ie;ne+=`
${se[0]} ${se[1]} m`;for(let ae=2;ae<se.length;ae=ae+2)ee=se[ae],ie=se[ae+1],ne+=`
${ee} ${ie} l`;ne+=`
S`,ne+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(ne),this.apStream=e}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy();let $,Y,V,te,se,ne;const ee=new u,ie=F.Vertices;for(let re=0;re<ie.length;re=re+2)$=ie[re],Y=ie[re+1],ee.set($,Y).applyMat3(e),ie[re]=ee.x,ie[re+1]=ee.y,(!V||ee.x<V)&&(V=ee.x),(!te||ee.y<te)&&(te=ee.y),(!se||ee.x>se)&&(se=ee.x),(!ne||ee.y>ne)&&(ne=ee.y);const ae=(F.BS?.W??F.Border?.width??1)/2;if(V-=ae,te-=ae,se+=ae,ne+=ae,F.Rect=[V,te,se,ne],F._bBox){const re=F.getLocalBB();re.ll.set(V,te),re.lr.set(se,te),re.ur.set(se,ne),re.ul.set(V,ne)}if(F.generateApStream(),F.M=DateString.fromDate(new Date),F.$onEditAction){const re=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(re,!1),await F.updateRenderAsync()}:void 0)}}async bakeRotationAsync(){const e=this.getCurrentRotation(),C=(this.Rect[0]+this.Rect[2])/2,F=(this.Rect[1]+this.Rect[3])/2,$=new l().applyTranslation(-C,-F).applyRotation(e).applyTranslation(C,F);await this.applyCommonTransformAsync($)}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class LineAnnotation extends GeometricAnnotation{IT=lineIntents.DIMENSION;L;LE=[lineEndingTypes.NONE,lineEndingTypes.NONE];LLE=0;LL=0;LLO=0;Cap=!1;CP=lineCaptionPositions.INLINE;CO=[0,0];Measure;_scaleHandleActive;_rtStyle;_rtText;_fontMap;_svgTemp=new SvgTempPath;get offsetY(){return(Math.abs(this.LL||0)+(this.LLO||0))*(this.LL<0?-1:1)}get minMargin(){const e=this.strokeWidth,C=e/2;let F=0;return this.LE[0]!==lineEndingTypes.NONE||this.LE[1]!==lineEndingTypes.NONE?F=(Math.max(e*LINE_END_MULTIPLIER,LINE_END_MIN_SIZE)+e)/2:F=C,F}constructor(){super(annotationTypes.LINE)}static async createFromDtoAsync(e,C){if(e.annotationType!=="/Line")throw new Error("Invalid annotation type");const F=new BorderStyleDict;F.W=e.strokeWidth,e.strokeDashGap&&(F.D=e.strokeDashGap);const $=new LineAnnotation;return $.$name=e.uuid,$.NM=LiteralString.fromString(e.uuid),$.T=LiteralString.fromString(e.author),$.M=DateString.fromDate(new Date(e.dateModified)),$.CreationDate=DateString.fromDate(new Date(e.dateCreated)),$.Contents=e.textContent?LiteralString.fromString(e.textContent):null,$.Rect=e.rect,$.C=e.color.slice(0,3),$.CA=e.color[3],$.BS=F,$.IT=e.intent||lineIntents.DIMENSION,$.LE=e.endingType||[lineEndingTypes.NONE,lineEndingTypes.NONE],$.L=e.vertices,$.LL=e.leaderLineLength||0,$.LLE=e.leaderLineExtension||0,$.LLO=e.leaderLineOffset||0,$.Cap=e.caption,$.CP=e.captionPosition||lineCaptionPositions.INLINE,$.CO=e.captionOffset||[0,0],$._fontMap=C,await $.generateApStreamAsync(),$._added=!0,$.initProxy()}static async parseAsync(e,C){if(!e)throw new Error("Parsing information not passed");try{const F=new LineAnnotation;return await F.parsePropsAsync(e),F._fontMap=C,{value:F.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(F){return console.log(F.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.L&&$.push(...F.encode("/L "),...this.encodePrimitiveArray(this.L,F)),this.LE&&$.push(...F.encode("/LE "),...this.encodePrimitiveArray(this.LE,F)),this.LL&&$.push(...F.encode("/LL "),...F.encode(" "+this.LL)),this.LLE&&$.push(...F.encode("/LLE "),...F.encode(" "+this.LLE)),this.Cap&&$.push(...F.encode("/Cap "),...F.encode(" "+this.Cap)),this.IT&&$.push(...F.encode("/IT "),...F.encode(this.IT)),this.LLO&&$.push(...F.encode("/LLO "),...F.encode(" "+this.LLO)),this.CP&&$.push(...F.encode("/CP "),...F.encode(this.CP)),this.Measure&&$.push(...F.encode("/Measure "),...this.Measure.toArray(e)),this.CO&&$.push(...F.encode("/CO "),...this.encodePrimitiveArray(this.CO,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect();return{annotationType:"/Line",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,vertices:this.L,intent:this.IT,endingType:this.LE,leaderLineLength:this.LL,leaderLineExtension:this.LLE,leaderLineOffset:this.LLO,caption:this.Cap,captionPosition:this.CP,captionOffset:this.CO,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async setTextContentAsync(e,C=!0){await super.setTextContentAsync(e,C),await this.updateStreamAsync()}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/L":case"/CO":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/LE":const ne=await C.parseNameArrayAtAsync(V,!0);if(ne&&Object.values(lineEndingTypes).includes(ne.value[0])&&Object.values(lineEndingTypes).includes(ne.value[1]))this.LE=[ne.value[0],ne.value[1]],V=ne.end+1;else throw new Error("Can't parse /LE property value");break;case"/IT":const ee=await C.parseNameAtAsync(V,!0);if(ee&&Object.values(lineIntents).includes(ee.value)){this.IT=ee.value,V=ee.end+1;break}throw new Error("Can't parse /IT property value");case"/CP":const ie=await C.parseNameAtAsync(V,!0);if(ie&&Object.values(lineCaptionPositions).includes(ie.value))this.CP=ie.value,V=ie.end+1;else throw new Error("Can't parse /CP property value");break;case"/LL":case"/LLE":case"/LLO":V=await this.parseNumberPropAsync(te,C,V,!1);break;case"/Cap":V=await this.parseBoolPropAsync(te,C,V);break;case"/Measure":const ae=await C.getValueTypeAtAsync(V);if(ae===valueTypes.REF){const re=await ObjectId.parseRefAsync(C,V);if(re&&e.parseInfoGetterAsync){const oe=await e.parseInfoGetterAsync(re.value.id);if(oe){const ce=await MeasureDict.parseAsync(oe);if(ce){this.Measure=ce.value,V=ce.end+1;break}}}throw new Error("Can't parse /BS value reference")}else if(ae===valueTypes.DICTIONARY){const re=await C.getDictBoundsAtAsync(V);if(re){const oe=await MeasureDict.parseAsync({parser:C,bounds:re});if(oe){this.Measure=oe.value,V=oe.end+1;break}}throw new Error("Can't parse /Measure value dictionary")}throw new Error(`Unsupported /Measure property value type: ${ae}`);default:V=await C.skipToNextNameAsync(V,Y-1);break}if(this.RC){const ee=new DOMParser().parseFromString(this.RC.literal,"text/xml")?.querySelector("body");if(ee){const ie=ee.getAttribute("style"),ae=ee.querySelector("p");this._rtStyle=ie||"",this._rtText=ae?.textContent||""}}}async applyCommonTransformAsync(e,C=!0){const F=this.getProxy(),[$,Y,V,te]=F.L,se=new u($,Y).applyMat3(e),ne=new u(V,te).applyMat3(e);if(F.L=[se.x,se.y,ne.x,ne.y],await F.generateApStreamAsync(),F.M=DateString.fromDate(new Date),F.$onEditAction){const ee=l.invert(e);F.$onEditAction(C?async()=>{await F.applyCommonTransformAsync(ee,!1),await F.updateRenderAsync()}:void 0)}}async updateStreamAsync(){const e=this.getProxy();await e.generateApStreamAsync(),await e.updateRenderAsync()}async calculateStreamBboxAsync(){const[e,C,F,$]=this.L,Y=new u(F-e,$-C).getMagnitude(),V=this.strokeWidth,te=V/2,se=this.minMargin,ne=4*se,ee=Y>ne?Y-ne:Y,ie=await this.updateTextDataAsync({maxWidth:ee,fontSize:9,strokeWidth:V,textAlign:"center",pivotPoint:this.CP===lineCaptionPositions.INLINE?"center":"bottom-margin"}),ae=Math.max(Math.abs(this.LL||0)+(this.LLO||0)+te,se),re=Math.max((this.LLE||0)+te,se),oe=ae+re,ce=this.LL<0?se:oe,he=this.LL<0?oe:se;let de=-se,pe=-he,fe=Y+se,ye=ce;if(ie){const Ee=this.offsetY,[be,Ae,we,Te]=ie.relativeRect;de=Math.min(de,be+Y/2),pe=Math.min(pe,Ae+Ee),fe=Math.max(fe,we+Y/2),ye=Math.max(ye,Te+Ee)}return[new u(de,pe),new u(fe,ye)]}calculateStreamMatrix(){const[e,C,F,$]=this.L,Y=new u(e,C),V=new u(F,$),te=u.subtract(V,Y).getMagnitude(),se=new u,ne=new u(te,0);return l.from4Vec2(se,ne,Y,V)}updateRect(e,C){const F=this.getLocalBB();F.ll.set(e[0].x,e[0].y).applyMat3(C),F.lr.set(e[1].x,e[0].y).applyMat3(C),F.ur.set(e[1].x,e[1].y).applyMat3(C),F.ul.set(e[0].x,e[1].y).applyMat3(C);const{min:$,max:Y}=u.minMax(F.ll,F.lr,F.ur,F.ul);this.Rect=[$.x,$.y,Y.x,Y.y]}getLineEndsStreamCoords(e){const C=l.invert(e),F=new u(this.L[0],this.L[1]).applyMat3(C).truncate(),$=new u(this.L[2],this.L[3]).applyMat3(C).truncate(),Y=this.offsetY;return F.y+=Y,$.y+=Y,[F,$]}getLineStreamPart(e,C){let F="";return F+=`
${e.x} ${e.y} m`,F+=`
${C.x} ${C.y} l`,F+=`
S`,this.LL&&(this.LL>0?(F+=`
${e.x} ${e.y-Math.abs(this.LL)} m`,F+=`
${e.x} ${e.y+this.LLE} l`,F+=`
S`,F+=`
${C.x} ${C.y-Math.abs(this.LL)} m`,F+=`
${C.x} ${C.y+this.LLE} l`,F+=`
S`):(F+=`
${e.x} ${e.y+Math.abs(this.LL)} m`,F+=`
${e.x} ${e.y-this.LLE} l`,F+=`
S`,F+=`
${C.x} ${C.y+Math.abs(this.LL)} m`,F+=`
${C.x} ${C.y-this.LLE} l`,F+=`
S`)),F}async getTextStreamPartAsync(e,C){const F=this._textData;if(!F)return"";const[$,Y,V,te]=F.relativeRect,se=new u($,Y).add(e),ne=new u(V,te).add(e),ee=`
q 1 g 1 G
${se.x} ${se.y} m
${se.x} ${ne.y} l
${ne.x} ${ne.y} l
${ne.x} ${se.y} l
f
Q`;let ie=`
q 0 g 0 G`;const ae=9;for(const re of F.lines){if(!re.text)continue;const oe=new u(re.relativeRect[0],re.relativeRect[1]).add(e);let ce="";for(const he of re.text){const de=C.encoding.codeMap.get(he);de&&(ce+=de.toString(16).padStart(2,"0"))}ie+=`
BT 0 Tc 0 Tw 100 Tz ${C.name} ${ae} Tf 0 Tr`,ie+=`
1 0 0 1 ${oe.x} ${oe.y+ae*.2} Tm`,ie+=`
<${ce}> Tj`,ie+=`
ET`}return ie+=`
Q`,ee+ie}async generateApStreamAsync(){if(!this.L)return;const e=await this.calculateStreamBboxAsync(),C=this.calculateStreamMatrix();this.updateRect(e,C);const F=new XFormStream;F.Filter="/FlateDecode",F.LastModified=DateString.fromDate(new Date),F.BBox=[e[0].x,e[0].y,e[1].x,e[1].y],F.Matrix=C.toFloatShortArray(),F.Resources=new ResourceDict;const $=this.CA||1,Y=this.strokeWidth,V=this.BS?.D[0]??this.Border?.dash??3,te=this.BS?.D[1]??this.Border?.gap??0,se=new GraphicsStateDict;se.AIS=!0,se.BM="/Normal",se.CA=$,se.ca=$,se.LW=Y,se.D=[[V,te],0],se.LC=lineCapStyles.SQUARE,se.LJ=lineJoinStyles.MITER,F.Resources.setGraphicsState("/GS0",se);const ne="arial",ee=this._fontMap?.get(ne);if(!ee||!ee.encoding?.codeMap)throw new Error(`Suitable font is not found in the font map: '${ne}'`);F.Resources.setFont(ee.name,ee);const ie=this.getColorString(),[ae,re]=this.getLineEndsStreamCoords(C),oe=this.getLineStreamPart(ae,re),ce=this.getLineEndingStreamPart(ae,this.LE[0],Y,"left"),he=this.getLineEndingStreamPart(re,this.LE[1],Y,"right"),de=await this.getTextStreamPartAsync(u.add(ae,re).multiplyByScalar(.5),ee),pe=`q ${ie} /GS0 gs`+oe+ce+he+de+`
Q`;F.setTextStreamData(pe),this.apStream=F}renderHandles(){return[...this.renderLineEndHandles(),this.renderRotationHandle()]}renderLineEndHandles(){const e=document.createElementNS("http://www.w3.org/2000/svg","line");e.classList.add("annotation-handle","scale"),e.setAttribute("data-handle-name","start"),e.setAttribute("x1",this.L[0]+""),e.setAttribute("y1",this.L[1]+""),e.setAttribute("x2",this.L[0]+""),e.setAttribute("y2",this.L[1]+.1+""),e.addEventListener("pointerdown",this.onLineEndHandlePointerDown);const C=document.createElementNS("http://www.w3.org/2000/svg","line");return C.classList.add("annotation-handle","scale"),C.setAttribute("data-handle-name","end"),C.setAttribute("x1",this.L[2]+""),C.setAttribute("y1",this.L[3]+""),C.setAttribute("x2",this.L[2]+""),C.setAttribute("y2",this.L[3]+.1+""),C.addEventListener("pointerdown",this.onLineEndHandlePointerDown),[e,C]}onLineEndHandlePointerDown=e=>{if(!e.isPrimary)return;const C=e.target;C.setPointerCapture(e.pointerId),C.addEventListener("pointerup",this.onLineEndHandlePointerUp),C.addEventListener("pointerout",this.onLineEndHandlePointerUp);const F=C.dataset.handleName;switch(F){case"start":this._scaleHandleActive="start";break;case"end":this._scaleHandleActive="end";break;default:throw new Error(`Invalid handle name: ${F}`)}this._moved=!1,this._transformationTimer=setTimeout(()=>{this._transformationTimer=null,this._svgTemp.insertAfter(this._renderedControls),C.addEventListener("pointermove",this.onLineEndHandlePointerMove)},200),e.stopPropagation()};onLineEndHandlePointerMove=e=>{if(!e.isPrimary||!this._scaleHandleActive)return;const C=new u(this.L[0],this.L[1]),F=new u(this.L[2],this.L[3]);let $,Y;this._scaleHandleActive==="start"?($=this.convertClientCoordsToPage(e.clientX,e.clientY),Y=F.clone()):($=C.clone(),Y=this.convertClientCoordsToPage(e.clientX,e.clientY)),this._tempTransformationMatrix=l.from4Vec2(C,F,$,Y),this._svgTemp.set("none","blue",this.strokeWidth,[$,Y]),this._moved=!0};onLineEndHandlePointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onLineEndHandlePointerMove),C.removeEventListener("pointerup",this.onLineEndHandlePointerUp),C.removeEventListener("pointerout",this.onLineEndHandlePointerUp),C.releasePointerCapture(e.pointerId),this._svgTemp.remove(),this.applyTempTransformAsync()};initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class TextMarkupAnnotation extends MarkupAnnotation{QuadPoints;constructor(e){super(e)}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.QuadPoints&&$.push(...F.encode("/QuadPoints "),...this.encodePrimitiveArray(this.QuadPoints,F));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/QuadPoints":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;default:V=await C.skipToNextNameAsync(V,Y-1);break}if(!this.QuadPoints)throw new Error("Not all required properties parsed")}onTranslationPointerDown=e=>{};renderHandles(){return[]}}class HighlightAnnotation extends TextMarkupAnnotation{constructor(){super(annotationTypes.HIGHLIGHT)}static createFromDto(e){if(e.annotationType!=="/Highlight")throw new Error("Invalid annotation type");if(!e?.quadPoints?.length||e.quadPoints.length%8)return;const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new HighlightAnnotation;if(F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,e.rect)F.Rect=e.rect;else{const $=[];for(let te=0;te<e.quadPoints.length;te+=2)$.push(new u(e.quadPoints[te],e.quadPoints[te+1]));const{min:Y,max:V}=u.minMax(...$);F.Rect=[Y.x,Y.y,V.x,V.y]}return F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.QuadPoints=e.quadPoints,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new HighlightAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){return super.toArray(e)}toDto(){const e=this.getColorRect();return{annotationType:"/Highlight",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,quadPoints:this.QuadPoints,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e)}generateApStream(){if(!this.QuadPoints?.length||this.QuadPoints.length%8)return;const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.LC=lineCapStyles.SQUARE,V.LJ=lineJoinStyles.MITER,V.D=[[$,Y],0],V.BM=blendModes.MULTIPLY;let se=`q ${this.getColorString()} /GS0 gs`;const ne=new u,ee=new u,ie=new u,ae=new u,re=this.QuadPoints;for(let oe=0;oe<re.length;oe+=8)ne.set(re[oe+4],re[oe+5]),ee.set(re[oe+6],re[oe+7]),ie.set(re[oe+2],re[oe+3]),ae.set(re[oe+0],re[oe+1]),se+=`
${ne.x} ${ne.y} m`,se+=`
${ee.x} ${ee.y} l`,se+=`
${ie.x} ${ie.y} l`,se+=`
${ae.x} ${ae.y} l`,se+=`
f`;se+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(se),this.apStream=e}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class UnderlineAnnotation extends TextMarkupAnnotation{constructor(){super(annotationTypes.UNDERLINE)}static createFromDto(e){if(e.annotationType!=="/Underline")throw new Error("Invalid annotation type");if(!e?.quadPoints?.length||e.quadPoints.length%8)return;const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new UnderlineAnnotation;if(F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,e.rect)F.Rect=e.rect;else{const $=[];for(let se=0;se<e.quadPoints.length;se+=2)$.push(new u(e.quadPoints[se],e.quadPoints[se+1]));const{min:Y,max:V}=u.minMax(...$),te=e.strokeWidth?e.strokeWidth/2:1;F.Rect=[Y.x-te,Y.y-te,V.x+te,V.y+te]}return F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.QuadPoints=e.quadPoints,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new UnderlineAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){return super.toArray(e)}toDto(){const e=this.getColorRect();return{annotationType:"/Underline",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,quadPoints:this.QuadPoints,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e)}generateApStream(){if(!this.QuadPoints?.length||this.QuadPoints.length%8)return;const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.LC=lineCapStyles.SQUARE,V.LJ=lineJoinStyles.MITER,V.D=[[$,Y],0];let se=`q ${this.getColorString()} /GS0 gs`;const ne=new u,ee=new u,ie=this.QuadPoints;for(let ae=0;ae<ie.length;ae+=8)ne.set(ie[ae+4],ie[ae+5]),ee.set(ie[ae+6],ie[ae+7]),se+=`
${ne.x} ${ne.y} m`,se+=`
${ee.x} ${ee.y} l`,se+=`
S`;se+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(se),this.apStream=e}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class StrikeoutAnnotation extends TextMarkupAnnotation{constructor(){super(annotationTypes.STRIKEOUT)}static createFromDto(e){if(e.annotationType!=="/Strikeout")throw new Error("Invalid annotation type");if(!e?.quadPoints?.length||e.quadPoints.length%8)return;const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new StrikeoutAnnotation;if(F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,e.rect)F.Rect=e.rect;else{const $=[];for(let te=0;te<e.quadPoints.length;te+=2)$.push(new u(e.quadPoints[te],e.quadPoints[te+1]));const{min:Y,max:V}=u.minMax(...$);F.Rect=[Y.x,Y.y,V.x,V.y]}return F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.QuadPoints=e.quadPoints,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new StrikeoutAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){return super.toArray(e)}toDto(){const e=this.getColorRect();return{annotationType:"/Strikeout",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,quadPoints:this.QuadPoints,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e)}generateApStream(){if(!this.QuadPoints?.length||this.QuadPoints.length%8)return;const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.LC=lineCapStyles.SQUARE,V.LJ=lineJoinStyles.MITER,V.D=[[$,Y],0];let se=`q ${this.getColorString()} /GS0 gs`;const ne=new u,ee=new u,ie=new u,ae=new u,re=new u,oe=new u,ce=this.QuadPoints;for(let he=0;he<ce.length;he+=8)ne.set(ce[he+4],ce[he+5]),ee.set(ce[he+6],ce[he+7]),ie.set(ce[he+2],ce[he+3]),ae.set(ce[he+0],ce[he+1]),re.setFromVec2(ne).add(ae).multiplyByScalar(.5),oe.setFromVec2(ee).add(ie).multiplyByScalar(.5),se+=`
${re.x} ${re.y} m`,se+=`
${oe.x} ${oe.y} l`,se+=`
S`;se+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(se),this.apStream=e}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class SquigglyAnnotation extends TextMarkupAnnotation{static squiggleSize=6;constructor(){super(annotationTypes.SQUIGGLY)}static createFromDto(e){if(e.annotationType!=="/Squiggly")throw new Error("Invalid annotation type");if(!e?.quadPoints?.length||e.quadPoints.length%8)return;const C=new BorderStyleDict;C.W=e.strokeWidth,e.strokeDashGap&&(C.D=e.strokeDashGap);const F=new SquigglyAnnotation;if(F.$name=e.uuid,F.NM=LiteralString.fromString(e.uuid),F.T=LiteralString.fromString(e.author),F.M=DateString.fromDate(new Date(e.dateModified)),F.CreationDate=DateString.fromDate(new Date(e.dateCreated)),F.Contents=e.textContent?LiteralString.fromString(e.textContent):null,e.rect)F.Rect=e.rect;else{const $=[];for(let se=0;se<e.quadPoints.length;se+=2)$.push(new u(e.quadPoints[se],e.quadPoints[se+1]));const{min:Y,max:V}=u.minMax(...$),te=this.squiggleSize/2+(e.strokeWidth||2)/2;F.Rect=[Y.x-te,Y.y-te,V.x+te,V.y+te]}return F.C=e.color.slice(0,3),F.CA=e.color[3],F.BS=C,F.QuadPoints=e.quadPoints,F.generateApStream(),F._added=!0,F.initProxy()}static async parseAsync(e){if(!e)throw new Error("Parsing information not passed");try{const C=new SquigglyAnnotation;return await C.parsePropsAsync(e),{value:C.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(C){return console.log(C.message),null}}toArray(e){return super.toArray(e)}toDto(){const e=this.getColorRect();return{annotationType:"/Squiggly",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,quadPoints:this.QuadPoints,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0]}}async parsePropsAsync(e){await super.parsePropsAsync(e)}generateApStream(){if(!this.QuadPoints?.length||this.QuadPoints.length%8)return;const e=new XFormStream;e.Filter="/FlateDecode",e.LastModified=DateString.fromDate(new Date),e.BBox=[this.Rect[0],this.Rect[1],this.Rect[2],this.Rect[3]];const C=this.CA||1,F=this.strokeWidth,$=this.BS?.D[0]??this.Border?.dash??3,Y=this.BS?.D[1]??this.Border?.gap??0,V=new GraphicsStateDict;V.AIS=!0,V.BM="/Normal",V.CA=C,V.ca=C,V.LW=F,V.LC=lineCapStyles.SQUARE,V.LJ=lineJoinStyles.MITER,V.D=[[$,Y],0];let se=`q ${this.getColorString()} /GS0 gs`;const ne=new u,ee=new u,ie=this.QuadPoints;for(let ae=0;ae<ie.length;ae+=8){ne.set(ie[ae+4],ie[ae+5]),ee.set(ie[ae+6],ie[ae+7]);const re=buildSquigglyLine(ne,ee,SquigglyAnnotation.squiggleSize);if(re?.length){se+=`
${re[0].x} ${re[0].y} m`;for(let oe=1;oe<re.length;oe++)se+=`
${re[oe].x} ${re[oe].y} l`;se+=`
S`}}se+=`
Q`,e.Resources=new ResourceDict,e.Resources.setGraphicsState("/GS0",V),e.setTextStreamData(se),this.apStream=e}initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class FreeTextAnnotation extends MarkupAnnotation{DA;Q=justificationTypes.LEFT;DS;CL;IT=freeTextIntents.PLAIN_TEXT;RD;LE=lineEndingTypes.NONE;_defaultStyle;_rtStyle;_rtText;_fontMap;_svgTemp=new SvgTempPath;_pointsTemp;get pointsStreamCS(){const C=this.strokeWidth/2,[F,$,Y,V]=this.apStream.BBox,[te,se,ne,ee]=this.RD||[C,C,C,C],ie=new u(F+te,$+se),ae=new u(Y-ne,V-ee),re=new u(ae.x,ie.y),oe=new u(ie.x,ae.y),ce=u.add(ie,oe).multiplyByScalar(.5),he=u.add(oe,ae).multiplyByScalar(.5),de=u.add(re,ae).multiplyByScalar(.5),pe=u.add(ie,re).multiplyByScalar(.5),fe=this.CL;let ye,_e,Ee;return fe&&(fe.length===6?(ye=new u(fe[4],fe[5]),Ee=new u(fe[2],fe[3]),_e=new u(fe[0],fe[1])):fe.length===4&&(ye=new u(fe[2],fe[3]),_e=new u(fe[0],fe[1]))),{bl:ie,tr:ae,br:re,tl:oe,l:ce,t:he,r:de,b:pe,cob:ye,cok:Ee,cop:_e}}get pointsPageCS(){const e=this.pointsStreamCS,{matAA:C}=calcPdfBBoxToRectMatrices(this.apStream.BBox,this.Rect,this.apStream.Matrix);return{bl:e.bl.applyMat3(C),tr:e.tr.applyMat3(C),br:e.br.applyMat3(C),tl:e.tl.applyMat3(C),l:e.l.applyMat3(C),t:e.t.applyMat3(C),r:e.r.applyMat3(C),b:e.b.applyMat3(C),cob:e.cob?e.cob.applyMat3(C):null,cok:e.cok?e.cok.applyMat3(C):null,cop:e.cop?e.cop.applyMat3(C):null}}get minMargin(){const e=this.strokeWidth,C=e/2;let F;return this.LE&&this.LE!==lineEndingTypes.NONE?F=(Math.max(e*LINE_END_MULTIPLIER,LINE_END_MIN_SIZE)+e)/2:F=C,F}constructor(){super(annotationTypes.FREE_TEXT)}static async createFromDtoAsync(e,C){if(e.annotationType!=="/FreeText")throw new Error("Invalid annotation type");const F=new BorderStyleDict;F.W=e.strokeWidth,e.strokeDashGap&&(F.D=e.strokeDashGap);const $=new FreeTextAnnotation;$.$name=e.uuid,$.NM=LiteralString.fromString(e.uuid),$.T=LiteralString.fromString(e.author),$.M=DateString.fromDate(new Date(e.dateModified)),$.CreationDate=DateString.fromDate(new Date(e.dateCreated)),$.Contents=e.textContent?LiteralString.fromString(e.textContent):null,$.Rect=e.rect,$.C=e.color.slice(0,3),$.CA=e.color[3],$.BS=F,$.IT=e.intent||freeTextIntents.PLAIN_TEXT,$.LE=e.calloutEndingType||lineEndingTypes.NONE,$.Q=e.justification||justificationTypes.LEFT,$._fontMap=C;const{bl:Y,tr:V,br:te,tl:se,l:ne,t:ee,r:ie,b:ae,cob:re,cok:oe,cop:ce}=e.points,he={bl:new u(Y[0],Y[1]),tr:new u(V[0],V[1]),br:new u(te[0],te[1]),tl:new u(se[0],se[1]),l:new u(ne[0],ne[1]),t:new u(ee[0],ee[1]),r:new u(ie[0],ie[1]),b:new u(ae[0],ae[1]),cob:re?new u(re[0],re[1]):null,cok:oe?new u(oe[0],oe[1]):null,cop:ce?new u(ce[0],ce[1]):null};return await $.generateApStreamAsync(he),$._added=!0,$.initProxy()}static async parseAsync(e,C){if(!e)throw new Error("Parsing information not passed");try{const F=new FreeTextAnnotation;return await F.parsePropsAsync(e),F._fontMap=C,{value:F.initProxy(),start:e.bounds.start,end:e.bounds.end}}catch(F){return console.log(F.message),null}}toArray(e){const C=super.toArray(e),F=new TextEncoder,$=[];this.DA&&$.push(...F.encode("/DA "),...this.DA.toArray(e)),this.Q&&$.push(...F.encode("/Q "),...F.encode(" "+this.Q)),this.DS&&$.push(...F.encode("/DS "),...this.DS.toArray(e)),this.RC&&$.push(...F.encode("/RC "),...this.RC.toArray(e)),this.CL&&$.push(...F.encode("/CL "),...this.encodePrimitiveArray(this.CL,F)),this.IT&&$.push(...F.encode("/IT "),...F.encode(this.IT)),this.RD&&$.push(...F.encode("/RD "),...this.encodePrimitiveArray(this.RD,F)),this.LE&&$.push(...F.encode("/LE "),...F.encode(this.LE));const Y=[...C.subarray(0,2),...$,...C.subarray(2,C.length)];return new Uint8Array(Y)}toDto(){const e=this.getColorRect(),{bl:C,tr:F,br:$,tl:Y,l:V,t:te,r:se,b:ne,cob:ee,cok:ie,cop:ae}=this.pointsPageCS,re={bl:C.truncate().toFloatArray(),tr:F.truncate().toFloatArray(),br:$.truncate().toFloatArray(),tl:Y.truncate().toFloatArray(),l:V.truncate().toFloatArray(),t:te.truncate().toFloatArray(),r:se.truncate().toFloatArray(),b:ne.truncate().toFloatArray(),cob:ee?ee.truncate().toFloatArray():null,cok:ie?ie.truncate().toFloatArray():null,cop:ae?ae.truncate().toFloatArray():null};return{annotationType:"/FreeText",uuid:this.$name,pageId:this.$pageId,dateCreated:this.CreationDate?.date?.toISOString()||new Date().toISOString(),dateModified:this.M?this.M instanceof LiteralString?this.M.literal:this.M.date.toISOString():new Date().toISOString(),author:this.T?.literal,textContent:this.Contents?.literal,rect:this.Rect,bbox:this.apStream?.BBox,matrix:this.apStream?.Matrix,points:re,color:e,strokeWidth:this.BS?.W??this.Border?.width??1,strokeDashGap:this.BS?.D??[3,0],intent:this.IT,justification:this.Q,calloutEndingType:this.LE}}async setTextContentAsync(e,C=!0){await super.setTextContentAsync(e,C),await this.updateStreamAsync(null)}async parsePropsAsync(e){await super.parsePropsAsync(e);const{parser:C,bounds:F}=e,$=F.contentStart||F.start,Y=F.contentEnd||F.end;let V=await C.skipToNextNameAsync($,Y-1),te,se;for(;se=await C.parseNameAtAsync(V),se;)switch(V=se.end+1,te=se.value,te){case"/DA":case"/DS":case"/RC":V=await this.parseLiteralPropAsync(te,C,V,e.cryptInfo);break;case"/Q":const ne=await C.parseNumberAtAsync(V,!0);if(ne&&Object.values(justificationTypes).includes(ne.value))this.Q=ne.value,V=ne.end+1;else throw new Error("Can't parse /Q property value");break;case"/LE":const ee=await C.parseNameAtAsync(V,!0);if(ee&&Object.values(lineEndingTypes).includes(ee.value))this.LE=ee.value,V=ee.end+1;else throw new Error("Can't parse /LE property value");break;case"/CL":case"/RD":V=await this.parseNumberArrayPropAsync(te,C,V,!0);break;case"/IT":const ie=await C.parseNameAtAsync(V,!0);if(ie){if(ie.value==="/FreeTextTypewriter"){this.IT=freeTextIntents.CLICK_TO_TYPE,V=ie.end+1;break}else if(Object.values(freeTextIntents).includes(ie.value)){this.IT=ie.value,V=ie.end+1;break}}throw new Error("Can't parse /IT property value");default:V=await C.skipToNextNameAsync(V,Y-1);break}if(this.DS&&(this._defaultStyle=this.DS.literal),this.RC){const ee=new DOMParser().parseFromString(this.RC.literal,"text/xml")?.querySelector("body");if(ee){const ie=ee.getAttribute("style"),ae=ee.querySelector("p");this._rtStyle=ie||"",this._rtText=ae?.textContent||""}}if(!this.DA)throw new Error("Not all required properties parsed");(!this.C||this.C[0]===1&&this.C[1]===1&&this.C[2]===1)&&(this.C=[1,0,0])}calculateStreamMatrix(e,C){const F=u.subtract(C,e).getMagnitude(),$=new u,Y=new u(F,0);return l.from4Vec2($,Y,e,C)}calculateStreamBbox(e,C){const{bl:F,tr:$,br:Y,tl:V,l:te,t:se,r:ne,b:ee,cob:ie,cok:ae,cop:re}=e,oe=this.minMargin,ce=l.invert(C),he=u.applyMat3(F,ce).truncate(),de=u.applyMat3($,ce).truncate(),pe=u.applyMat3(Y,ce).truncate(),fe=u.applyMat3(V,ce).truncate(),ye=u.applyMat3(te,ce).truncate(),_e=u.applyMat3(se,ce).truncate(),Ee=u.applyMat3(ne,ce).truncate(),be=u.applyMat3(ee,ce).truncate(),Ae=ie?u.applyMat3(ie,ce).truncate():null,we=ae?u.applyMat3(ae,ce).truncate():null,Te=re?u.applyMat3(re,ce).truncate():null,Me=[he,de,pe,fe,we,Te].filter(We=>We),{min:Be,max:$e}=u.minMax(...Me),Fe=new u(Be.x-oe,Be.y-oe),Xe=new u($e.x+oe,$e.y+oe);return{bbox:[Fe,Xe],points:{bl:he,tr:de,br:pe,tl:fe,l:ye,t:_e,r:Ee,b:be,cob:Ae,cok:we,cop:Te}}}updateAnnotCoords(e,C,F){const{bl:$,tr:Y,cob:V,cok:te,cop:se}=e,[ne,ee]=F,ie=this.getLocalBB();ie.ll.set(ne.x,ne.y).applyMat3(C).truncate(),ie.lr.set(ee.x,ne.y).applyMat3(C).truncate(),ie.ur.set(ee.x,ee.y).applyMat3(C).truncate(),ie.ul.set(ne.x,ee.y).applyMat3(C).truncate();const{min:ae,max:re}=u.minMax(ie.ll,ie.lr,ie.ur,ie.ul);this.Rect=[ae.x,ae.y,re.x,re.y],se&&V?(te?this.CL=[se.x,se.y,te.x,te.y,V.x,V.y]:this.CL=[se.x,se.y,V.x,V.y],this.IT=freeTextIntents.WITH_CALLOUT):(this.CL=void 0,this.IT=freeTextIntents.PLAIN_TEXT),this.RD=[$.x-ne.x,$.y-ne.y,ee.x-Y.x,ee.y-Y.y]}getColorString(){const[e,C,F]=this.getColorRect();return`${e} ${C} ${F} RG 1 g`}getCalloutStreamPart(e){let C="";if(e.cop&&e.cob){C+=`
${e.cob.x} ${e.cob.y} m`,e.cok&&(C+=`
${e.cok.x} ${e.cok.y} l`),C+=`
${e.cop.x} ${e.cop.y} l`,C+=`
S`;const F=e.cok?[e.cok,e.cop]:[e.cob,e.cop],[$,Y]=F,V=new u(0,0),te=new u(u.subtract(Y,$).getMagnitude()),se=l.from4Vec2(V,te,$,Y),ne=this.getLineEndingStreamPart(te,this.LE,this.strokeWidth,"right"),ee=se.toFloatShortArray();C+=`
q ${ee[0].toFixed(5)} ${ee[1].toFixed(5)} ${ee[2].toFixed(5)} ${ee[3].toFixed(5)} ${ee[4].toFixed(5)} ${ee[5].toFixed(5)} cm`,C+=ne,C+=`
Q`}return C}async getTextStreamPartAsync(e,C){const F=this.strokeWidth,$=e.br.x-e.bl.x-2*F;if($<=0)return"";const Y=12;let V;this.Q?V=this.Q===justificationTypes.CENTER?"center":"right":V="left";const te=await this.updateTextDataAsync({maxWidth:$,fontSize:Y,strokeWidth:F,textAlign:V,pivotPoint:"top-left"});if(!te)return"";let se=`
q 0 g 0 G`;const ne=C.encoding.codeMap;for(const ee of te.lines){if(!ee.text)continue;const ie=new u(ee.relativeRect[0],ee.relativeRect[1]).add(e.tl).add(new u(F,-F)).truncate();let ae="";for(const re of ee.text){const oe=ne.get(re);oe&&(ae+=oe.toString(16).padStart(2,"0"))}se+=`
BT 0 Tc 0 Tw 100 Tz ${C.name} ${Y} Tf 0 Tr`,se+=`
1 0 0 1 ${ie.x} ${ie.y+Y*.2} Tm`,se+=`
<${ae}> Tj`,se+=`
ET`}return se+=`
Q`,se}async generateApStreamAsync(e){if(!e)throw new Error("No key annotation point coordinates passed");const C=this.calculateStreamMatrix(e.tl,e.tr),{bbox:F,points:$}=this.calculateStreamBbox(e,C);this.updateAnnotCoords($,C,F);const Y=new XFormStream;Y.Filter="/FlateDecode",Y.LastModified=DateString.fromDate(new Date),Y.BBox=[F[0].x,F[0].y,F[1].x,F[1].y],Y.Matrix=C.toFloatShortArray(),Y.Resources=new ResourceDict;const V=this.CA||1,te=this.strokeWidth,se=this.BS?.D[0]??this.Border?.dash??3,ne=this.BS?.D[1]??this.Border?.gap??0,ee=new GraphicsStateDict;ee.AIS=!0,ee.BM="/Normal",ee.CA=V,ee.ca=V,ee.LW=te,ee.D=[[se,ne],0],ee.LC=lineCapStyles.SQUARE,ee.LJ=lineJoinStyles.MITER,Y.Resources.setGraphicsState("/GS0",ee);const ie="arial",ae=this._fontMap?.get(ie);if(!ae||!ae.encoding?.codeMap)throw new Error(`Suitable font is not found in the font map: '${ie}'`);Y.Resources.setFont(ae.name,ae);const re=this.getColorString(),oe=this.getCalloutStreamPart($),ce=`
${$.bl.x} ${$.bl.y} m
${$.br.x} ${$.br.y} l
${$.tr.x} ${$.tr.y} l
${$.tl.x} ${$.tl.y} l
b`,he=await this.getTextStreamPartAsync($,ae),de=`q ${re} /GS0 gs`+oe+ce+he+`
Q`;Y.setTextStreamData(de),this.apStream=Y}async updateStreamAsync(e,C=!0){const F=this.getProxy(),$=F.pointsPageCS;await F.generateApStreamAsync(e||$),await F.updateRenderAsync(),e&&F.$onEditAction&&F.$onEditAction(C?async()=>{await F.updateStreamAsync($,!1)}:void 0)}renderHandles(){const e=this.pointsPageCS;return[...this.renderTextBoxCornerHandles(e),...this.renderCalloutHandles(e),this.renderRotationHandle()]}renderTextBoxCornerHandles(e){const{bl:C,br:F,tr:$,tl:Y}=e,V=new Map;V.set("tb-bl",C),V.set("tb-br",F),V.set("tb-tr",$),V.set("tb-tl",Y);const te=[];return["tb-bl","tb-br","tb-tr","tb-tl"].forEach(se=>{const{x:ne,y:ee}=V.get(se),ie=document.createElementNS("http://www.w3.org/2000/svg","line");ie.classList.add("annotation-handle","scale"),ie.setAttribute("data-handle-name",se),ie.setAttribute("x1",ne+""),ie.setAttribute("y1",ee+""),ie.setAttribute("x2",ne+""),ie.setAttribute("y2",ee+.1+""),ie.addEventListener("pointerdown",this.onTextBoxCornerHandlePointerDown),te.push(ie)}),te}onTextBoxCornerHandlePointerDown=e=>{if(!e.isPrimary)return;const C=e.target;C.setPointerCapture(e.pointerId),C.addEventListener("pointerup",this.onTextBoxCornerHandlePointerUp),C.addEventListener("pointerout",this.onTextBoxCornerHandlePointerUp),this._pointsTemp=this.pointsPageCS,this._moved=!1,this._transformationTimer=setTimeout(()=>{this._transformationTimer=null,this._svgTemp.insertAfter(this._renderedControls),C.addEventListener("pointermove",this.onTextBoxCornerHandlePointerMove)},200),e.stopPropagation()};onTextBoxCornerHandlePointerMove=e=>{if(!e.isPrimary)return;const F=e.target.dataset.handleName,$=this._pointsTemp,Y=this.convertClientCoordsToPage(e.clientX,e.clientY),V=u.subtract($.br,$.bl).getMagnitude(),te=u.subtract($.tl,$.bl).getMagnitude(),se=l.from4Vec2($.bl,$.br,new u,new u(V,0));let ne;switch(F){case"tb-bl":ne=$.tr;break;case"tb-br":ne=$.tl;break;case"tb-tr":ne=$.bl;break;case"tb-tl":ne=$.br;break;default:return}const ee=u.applyMat3(Y,se),ie=u.applyMat3(ne,se),ae=Math.abs(ee.x-ie.x),re=Math.abs(ee.y-ie.y),oe=ae/V,ce=re/te,{r:he}=se.getTRS(),de=new l().applyTranslation(-ne.x,-ne.y).applyRotation(he).applyScaling(oe,ce).applyRotation(-he).applyTranslation(ne.x,ne.y);$.bl.applyMat3(de),$.br.applyMat3(de),$.tr.applyMat3(de),$.tl.applyMat3(de),$.l.applyMat3(de),$.t.applyMat3(de),$.r.applyMat3(de),$.b.applyMat3(de),$.cob?.applyMat3(de),this._svgTemp.set("lightblue","blue",this.strokeWidth,[$.bl,$.br,$.tr,$.tl],!0),this._moved=!0};onTextBoxCornerHandlePointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onTextBoxCornerHandlePointerMove),C.removeEventListener("pointerup",this.onTextBoxCornerHandlePointerUp),C.removeEventListener("pointerout",this.onTextBoxCornerHandlePointerUp),C.releasePointerCapture(e.pointerId),this._svgTemp.remove(),this._moved&&this.updateStreamAsync(this._pointsTemp)};renderCalloutHandles(e){const C=[];if(!e.cop)return C;if(["l","t","r","b"].forEach(Y=>{const V=e[Y],te=document.createElementNS("http://www.w3.org/2000/svg","line");te.classList.add("annotation-handle","helper"),te.setAttribute("data-handle-name",`co-pivot-${Y}`),te.setAttribute("x1",V.x+""),te.setAttribute("y1",V.y+""),te.setAttribute("x2",V.x+""),te.setAttribute("y2",V.y+.1+""),te.addEventListener("pointerdown",this.onSideHandlePointerUp),C.push(te)}),e.cok){const Y=e.cok,V=document.createElementNS("http://www.w3.org/2000/svg","line");V.classList.add("annotation-handle","translation"),V.setAttribute("data-handle-name","co-knee"),V.setAttribute("x1",Y.x+""),V.setAttribute("y1",Y.y+""),V.setAttribute("x2",Y.x+""),V.setAttribute("y2",Y.y+.1+""),V.addEventListener("pointerdown",this.onCalloutHandlePointerDown),C.push(V)}const F=e.cop,$=document.createElementNS("http://www.w3.org/2000/svg","line");return $.classList.add("annotation-handle","translation"),$.setAttribute("data-handle-name","co-pointer"),$.setAttribute("x1",F.x+""),$.setAttribute("y1",F.y+""),$.setAttribute("x2",F.x+""),$.setAttribute("y2",F.y+.1+""),$.addEventListener("pointerdown",this.onCalloutHandlePointerDown),C.push($),C}onSideHandlePointerUp=e=>{if(!e.isPrimary)return;const F=e.target.dataset.handleName,$=this.pointsPageCS;switch(F){case"co-pivot-l":if(u.equals($.cob,$.l))return;$.cob.setFromVec2($.l);break;case"co-pivot-t":if(u.equals($.cob,$.t))return;$.cob.setFromVec2($.t);break;case"co-pivot-r":if(u.equals($.cob,$.r))return;$.cob.setFromVec2($.r);break;case"co-pivot-b":if(u.equals($.cob,$.b))return;$.cob.setFromVec2($.b);break;default:return}this.updateStreamAsync($)};onCalloutHandlePointerDown=e=>{if(!e.isPrimary)return;const C=e.target;C.setPointerCapture(e.pointerId),C.addEventListener("pointerup",this.onCalloutHandlePointerUp),C.addEventListener("pointerout",this.onCalloutHandlePointerUp),this._pointsTemp=this.pointsPageCS,this._moved=!1,this._transformationTimer=setTimeout(()=>{this._transformationTimer=null,this._svgTemp.insertAfter(this._renderedControls),C.addEventListener("pointermove",this.onCalloutHandlePointerMove)},200),e.stopPropagation()};onCalloutHandlePointerMove=e=>{if(!e.isPrimary)return;switch(e.target.dataset.handleName){case"co-knee":this._pointsTemp.cok.setFromVec2(this.convertClientCoordsToPage(e.clientX,e.clientY));break;case"co-pointer":this._pointsTemp.cop.setFromVec2(this.convertClientCoordsToPage(e.clientX,e.clientY));break;default:return}this._svgTemp.set("none","blue",this.strokeWidth,this._pointsTemp.cok?[this._pointsTemp.cob,this._pointsTemp.cok,this._pointsTemp.cop]:[this._pointsTemp.cob,this._pointsTemp.cop]),this._moved=!0};onCalloutHandlePointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onCalloutHandlePointerMove),C.removeEventListener("pointerup",this.onCalloutHandlePointerUp),C.removeEventListener("pointerout",this.onCalloutHandlePointerUp),C.releasePointerCapture(e.pointerId),this._svgTemp.remove(),this._moved&&this.updateStreamAsync(this._pointsTemp)};initProxy(){return super.initProxy()}getProxy(){return super.getProxy()}}class AnnotationParser{static async ParseAnnotationFromInfoAsync(e,C){const F=await e.parser.parseDictSubtypeAsync(e.bounds);let $;switch(F){case annotationTypes.STAMP:$=await StampAnnotation.parseAsync(e);break;case annotationTypes.TEXT:$=await TextAnnotation.parseAsync(e);break;case annotationTypes.INK:$=await InkAnnotation.parseAsync(e);break;case annotationTypes.SQUARE:$=await SquareAnnotation.parseAsync(e);break;case annotationTypes.CIRCLE:$=await CircleAnnotation.parseAsync(e);break;case annotationTypes.POLYGON:$=await PolygonAnnotation.parseAsync(e);break;case annotationTypes.POLYLINE:$=await PolylineAnnotation.parseAsync(e);break;case annotationTypes.LINE:$=await LineAnnotation.parseAsync(e,C);break;case annotationTypes.HIGHLIGHT:$=await HighlightAnnotation.parseAsync(e);break;case annotationTypes.SQUIGGLY:$=await SquigglyAnnotation.parseAsync(e);break;case annotationTypes.STRIKEOUT:$=await StrikeoutAnnotation.parseAsync(e);break;case annotationTypes.UNDERLINE:$=await UnderlineAnnotation.parseAsync(e);break;case annotationTypes.FREE_TEXT:$=await FreeTextAnnotation.parseAsync(e,C);break}return $?.value}static async ParseAnnotationFromDtoAsync(e,C){let F;switch(e.annotationType){case"/Stamp":F=StampAnnotation.createFromDto(e);break;case"/Text":F=TextAnnotation.createFromDto(e);break;case"/Ink":F=InkAnnotation.createFromDto(e);break;case"/Square":F=SquareAnnotation.createFromDto(e);break;case"/Circle":F=CircleAnnotation.createFromDto(e);break;case"/Polygon":F=PolygonAnnotation.createFromDto(e);break;case"/Polyline":F=PolylineAnnotation.createFromDto(e);break;case"/Line":F=await LineAnnotation.createFromDtoAsync(e,C);break;case"/Highlight":F=HighlightAnnotation.createFromDto(e);break;case"/Squiggly":F=SquigglyAnnotation.createFromDto(e);break;case"/Strikeout":F=StrikeoutAnnotation.createFromDto(e);break;case"/Underline":F=UnderlineAnnotation.createFromDto(e);break;default:throw new Error(`Unsupported annotation type: ${e.annotationType}`)}return F}}const annotSelectionRequestEvent="tspdf-annotselectionrequest",annotFocusRequestEvent="tspdf-annotfocusrequest",annotChangeEvent="tspdf-annotchange",docServiceStateChangeEvent="tspdf-docservicechange";class AnnotSelectionRequestEvent extends CustomEvent{constructor(e){super(annotSelectionRequestEvent,{detail:e})}}class AnnotFocusRequestEvent extends CustomEvent{constructor(e){super(annotFocusRequestEvent,{detail:e})}}class AnnotEvent extends CustomEvent{constructor(e){super(annotChangeEvent,{detail:e})}}class DocServiceStateChangeEvent extends CustomEvent{constructor(e){super(docServiceStateChangeEvent,{detail:e})}}class DocumentService{_eventService;get eventService(){return this._eventService}_userName;get userName(){return this._userName}_initPromise;_data;_docParser;_version;_xrefs;_referenceData;_encryption;_authResult;_catalog;_pages;_pageById=new Map;_annotIdsByPageId=new Map;_supportedAnnotsByPageId;_focusedAnnotation;get focusedAnnotation(){return this._focusedAnnotation}_selectedAnnotation;get selectedAnnotation(){return this._selectedAnnotation}_fontMap;get fontMap(){return this._fontMap}_lastCommands=[];get size(){return this._xrefs?.length?this._xrefs[0].size:0}get encrypted(){return!!this._encryption}get authenticated(){return!this._encryption||!!this._authResult}constructor(e,C,F){if(!e)throw new Error("Event controller is not defined");this._data=C,this._userName=F,this._fontMap=FontDict.newFontMap(),this._eventService=e,this._eventService.addListener(annotSelectionRequestEvent,this.onAnnotationSelectionRequest),this._eventService.addListener(annotFocusRequestEvent,this.onAnnotationFocusRequest),this._initPromise=this.initAsync()}static async createNewAsync(e,C,F){const $=new DocumentService(e,C,F);return await $._initPromise,$}destroy(){this._initPromise.then(()=>{this._lastCommands.length=0,this.emitStateChanged(),this.getAllSupportedAnnotationsAsync().then(e=>e.forEach(C=>{C.$onEditAction=null,C.$onRenderUpdatedAction=null})),this._eventService.removeListener(annotSelectionRequestEvent,this.onAnnotationSelectionRequest),this._eventService.removeListener(annotFocusRequestEvent,this.onAnnotationFocusRequest),this._docParser?.destroy(),BgDataParser.destroy()})}tryAuthenticate(e=""){return this.authenticated?!0:this.authenticate(e)}getPlainData(){return this._data.slice()}async undoAsync(){await this.undoCommandAsync()}async getDataWithoutSupportedAnnotationsAsync(){const e=await this.getSupportedAnnotationMapAsync(),C=[];e?.size&&e.forEach(($,Y)=>{$.slice().forEach(te=>{te.deleted||(te.markAsDeleted(!0),C.push(te))})});const F=await this.getDataWithUpdatedAnnotationsAsync();return C.forEach($=>$.markAsDeleted(!1)),F}async getDataWithUpdatedAnnotationsAsync(){const e=await this.getSupportedAnnotationMapAsync(),C=[];return e.forEach((Y,V)=>{const te=this._pageById.get(V);if(te){const se=this._annotIdsByPageId.get(V).slice()||[];C.push({page:te,allAnnotationIds:se,supportedAnnotations:Y||[]})}else console.log(`Page with id '${V}' not found`)}),new DataUpdater(this._data,this._xrefs[0],this._referenceData,this._authResult).getDataWithUpdatedAnnotations(C)}async getPageAnnotationsAsync(e){return(await this.getSupportedAnnotationMapAsync()).get(e)||[]}async serializeAnnotationsAsync(e=!1){const C=[];return(await this.getSupportedAnnotationMapAsync()).forEach(($,Y)=>{$.forEach(V=>{(!e||V.added)&&C.push(V.toDto())})}),C}async appendAnnotationToPageAsync(e,C){await this.appendAnnotationAsync(e,C,!0,"add")}async appendSerializedAnnotationsAsync(e){let C;for(const F of e)C=await AnnotationParser.ParseAnnotationFromDtoAsync(F,this._fontMap),await this.appendAnnotationAsync(F.pageId,C,!1,"import")}removeAnnotationFromPage(e){this.removeAnnotation(e,!0)}removeSelectedAnnotation(){const e=this._selectedAnnotation;e&&this.removeAnnotation(e,!0)}setSelectedAnnotation(e){if(e===this._selectedAnnotation)return;this._selectedAnnotation&&(this._selectedAnnotation.$translationEnabled=!1,this._selectedAnnotation?.lastRenderResult?.controls?.classList.remove("selected"));const C=e?.lastRenderResult?.controls;return C?(e.$translationEnabled=!0,C.classList.add("selected"),this._selectedAnnotation=e):this._selectedAnnotation=null,this._eventService.dispatchEvent(new AnnotEvent({type:"select",annotations:this._selectedAnnotation?[this._selectedAnnotation.toDto()]:[]})),this._selectedAnnotation}setFocusedAnnotation(e){if(e===this._focusedAnnotation)return;this._focusedAnnotation&&(this._focusedAnnotation.$translationEnabled=!1,this._focusedAnnotation?.lastRenderResult?.controls?.classList.remove("focused"));const C=e?.lastRenderResult?.controls;return C?(e.$translationEnabled=!0,C.classList.add("focused"),this._focusedAnnotation=e):this._focusedAnnotation=null,this._eventService.dispatchEvent(new AnnotEvent({type:"focus",annotations:this._focusedAnnotation?[this._focusedAnnotation.toDto()]:[]})),this._focusedAnnotation}getSelectedAnnotationTextContent(){return this._selectedAnnotation?.Contents?.literal}async setSelectedAnnotationTextContentAsync(e){await this._selectedAnnotation?.setTextContentAsync(e)}async parseXrefsAsync(){const e=new XrefParser(this._docParser);if(this._version=await e.getPdfVersionAsync(),!this._version)throw new Error("Error parsing PDF version number");const C=await e.getLastXrefIndexAsync();if(!C)throw new Error("File doesn't contain update section");const F=await e.parseAllXrefsAsync(C.value);if(!F.length)throw new Error("Failed to parse cross-reference sections");this._xrefs=F,this._referenceData=new ReferenceData(F)}async initAsync(){this._docParser=BgDataParser.tryGetParser(this._data.slice())??SyncDataParser.tryGetParser(this._data),await this.parseXrefsAsync(),await this.parseEncryptionAsync()}pushCommand(e){this._lastCommands.push(e),this.emitStateChanged()}async undoCommandAsync(){if(!this._lastCommands.length)return;await this._lastCommands.pop().undo(),this.emitStateChanged()}emitStateChanged(){this._eventService.dispatchEvent(new DocServiceStateChangeEvent({undoableCount:this._lastCommands.length}))}async appendAnnotationAsync(e,C,F,$){if(!C)throw new Error("Annotation is not defined");const Y=this._pageById.get(e);if(!Y)throw new Error(`Page with id ${e} is not found`);C.markAsDeleted(!1),C.$pageId=Y.id,C.$onEditAction=this.getOnAnnotEditAction(C),C.$onRenderUpdatedAction=this.getOnAnnotRenderUpdatedAction(C);const V=await this.getSupportedAnnotationMapAsync(),te=V.get(e);te?te.push(C):V.set(e,[C]),F&&this.pushCommand({timestamp:Date.now(),undo:async()=>{this.removeAnnotation(C,!1),this.selectedAnnotation===C&&this.setSelectedAnnotation(null)}}),this._eventService.dispatchEvent(new AnnotEvent({type:$,annotations:[C.toDto()]}))}removeAnnotation(e,C){e&&(e.markAsDeleted(!0),this.setSelectedAnnotation(null),C&&this.pushCommand({timestamp:Date.now(),undo:async()=>{await this.appendAnnotationAsync(e.$pageId,e,!1,"add")}}),this._eventService.dispatchEvent(new AnnotEvent({type:"delete",annotations:[e.toDto()]})))}getOnAnnotEditAction(e){return e?C=>{e.$pageId&&(C&&this.pushCommand({timestamp:Date.now(),undo:C}),this._eventService.dispatchEvent(new AnnotEvent({type:"edit",annotations:[e.toDto()]})))}:null}getOnAnnotRenderUpdatedAction(e){return e?()=>this._eventService.dispatchEvent(new AnnotEvent({type:"render",annotations:[e.toDto()]})):null}getObjectParseInfoAsync=async e=>{if(!e)return null;const C=this._referenceData?.getOffset(e);if(isNaN(C))return null;const F=await ObjectId.parseAsync(this._docParser,C);if(!F)return null;const $=await this._docParser.getIndirectObjectBoundsAtAsync(F.end+1,!0);if(!$)return null;const Y=this.getObjectParseInfoAsync,V={parser:this._docParser,bounds:$,parseInfoGetterAsync:Y,cryptInfo:{ref:{id:F.value.id,generation:F.value.generation},stringCryptor:this._authResult?.stringCryptor,streamCryptor:this._authResult?.streamCryptor}};if(F.value.id===e)return V;const te=await ObjectStream.parseAsync(V);if(!te)return;const se=await te.value.getObjectDataAsync(e);return se?(se.parseInfoGetterAsync=Y,se):null};authenticate(e){if(this.authenticated)return!0;const C=this._encryption.toCryptOptions(),F=this._xrefs[0].id[0].hex,$=new DataCryptHandler(C,F);return this._authResult=$.authenticate(e),this.authenticated}checkAuthentication(){if(!this.authenticated)throw new Error("Unauthorized access to file data")}async parseEncryptionAsync(){const e=this._xrefs[0].encrypt;if(!e)return;const C=await this.getObjectParseInfoAsync(e.id),F=await EncryptionDict.parseAsync(C);if(!F)throw new Error("Encryption dict can't be parsed");this._encryption=F.value}async parsePagesAsync(e,C){if(C.Kids.length)for(const F of C.Kids){const $=await this.getObjectParseInfoAsync(F.id);if(!$)continue;const Y=await $.parser.parseDictTypeAsync($.bounds);if(Y===dictTypes.PAGE_TREE){const V=await PageTreeDict.parseAsync($);V&&await this.parsePagesAsync(e,V.value)}else if(Y===dictTypes.PAGE){const V=await PageDict.parseAsync($);V&&e.push(V.value)}}}async parsePageTreeAsync(){const e=this._xrefs[0].root,C=await this.getObjectParseInfoAsync(e.id),F=await CatalogDict.parseAsync(C);if(!F)throw new Error("Document root catalog not found");this._catalog=F.value;const $=F.value.Pages,Y=await this.getObjectParseInfoAsync($.id),V=await PageTreeDict.parseAsync(Y);if(!V)throw new Error("Document root page tree not found");const te=[];await this.parsePagesAsync(te,V.value),this._pages=te,this._pageById.clear(),te.forEach(se=>this._pageById.set(se.ref.id,se))}async parseSupportedAnnotationsAsync(){this.checkAuthentication(),this._catalog||await this.parsePageTreeAsync();const e=new Map,C=new Map;for(const F of this._pages){const $=[];if(Array.isArray(F.Annots))$.push(...F.Annots);else if(F.Annots instanceof ObjectId){const te=await this.getObjectParseInfoAsync(F.Annots.id);if(te){const se=await ObjectId.parseRefArrayAsync(te.parser,te.bounds.contentStart);se?.value?.length&&$.push(...se.value)}}e.set(F.ref.id,$);const Y=async te=>{const se=await this.getObjectParseInfoAsync(te.id);se.rect=F.MediaBox;const ne=await AnnotationParser.ParseAnnotationFromInfoAsync(se,this._fontMap);return ne&&(ne.$pageId=F.id,ne.$onEditAction=this.getOnAnnotEditAction(ne),ne.$onRenderUpdatedAction=this.getOnAnnotRenderUpdatedAction(ne)),ne},V=(await Promise.all($.map(te=>Y(te)))).filter(te=>te);C.set(F.id,V)}this._annotIdsByPageId=e,this._supportedAnnotsByPageId=C}async getSupportedAnnotationMapAsync(){return this.checkAuthentication(),this._supportedAnnotsByPageId?this._supportedAnnotsByPageId:(await this.parseSupportedAnnotationsAsync(),this._supportedAnnotsByPageId)}async getAllSupportedAnnotationsAsync(){const e=[];return(await this.getSupportedAnnotationMapAsync()).forEach((F,$)=>{e.push(...F)}),e}onAnnotationSelectionRequest=e=>{e.detail?.annotation?this.setSelectedAnnotation(e.detail.annotation):this.setSelectedAnnotation(null)};onAnnotationFocusRequest=e=>{e.detail?.annotation?this.setFocusedAnnotation(e.detail.annotation):this.setFocusedAnnotation(null)}}class PageAnnotationView{_docService;_pageInfo;_viewbox;_rendered=new Set;_container;_svg;_destroyed;constructor(e,C,F){if(!e||!C||!F)throw new Error("Required argument not found");this._pageInfo=C,this._viewbox=[0,0,F.x,F.y],this._docService=e,this._container=document.createElement("div"),this._container.classList.add("page-annotations"),this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.classList.add("page-annotations-controls"),this._svg.setAttribute("data-page-id",C.id+""),this._svg.setAttribute("viewBox",`0 0 ${F.x} ${F.y}`),this._svg.setAttribute("transform","scale(1, -1)"),this._svg.addEventListener("pointerdown",$=>{$.target===this._svg&&e.setSelectedAnnotation(null)})}destroy(){this._destroyed=!0,this.remove(),this._container=null,this._rendered.forEach(e=>{e.$onPointerDownAction=null,e.$onPointerEnterAction=null,e.$onPointerLeaveAction=null}),this._rendered.clear()}remove(){this._container?.remove(),this._docService.eventService.removeListener(annotChangeEvent,this.onAnnotationSelectionChange)}async appendAsync(e){if(this._destroyed)return;if(e.append(this._container),!await this.renderAnnotationsAsync()){this._container?.remove();return}this._docService.eventService.addListener(annotChangeEvent,this.onAnnotationSelectionChange)}async renderAnnotationsAsync(){if(this._destroyed)return!1;this.clear();const e=(await this._docService.getPageAnnotationsAsync(this._pageInfo.id)).filter(F=>!F.deleted)||[],C=async F=>{let $;this._rendered.has(F)?$=F.lastRenderResult||await F.renderAsync(this._pageInfo):(F.$onPointerDownAction=Y=>{this._docService.eventService.dispatchEvent(new AnnotSelectionRequestEvent({annotation:F}))},F.$onPointerEnterAction=Y=>{this._docService.eventService.dispatchEvent(new AnnotFocusRequestEvent({annotation:F}))},F.$onPointerLeaveAction=Y=>{this._docService.eventService.dispatchEvent(new AnnotFocusRequestEvent({annotation:null}))},$=await F.renderAsync(this._pageInfo)),$&&!this._destroyed&&(this._rendered.add(F),this._svg.append($.controls),this._container.append($.content))};return await Promise.all(e.map(F=>C(F))),this._destroyed?!1:(this._container.append(this._svg),!0)}clear(){this._container.innerHTML="",this._svg.innerHTML=""}onAnnotationSelectionChange=e=>{!this._destroyed&&e.detail.type==="select"&&(e.detail.annotations?.length?this._container.style.touchAction="none":this._container.style.touchAction="")}}class PageComparisonView{_comparisonService;_subjectPageInfo;_subjectPageHeight;_container;_svg;_lastRenderResult;_destroyed;constructor(e,C,F){if(!e||!C||!F)throw new Error("Required argument not found");this._comparisonService=e,this._subjectPageInfo=C,this._subjectPageHeight=F.y,this._container=document.createElement("div"),this._container.classList.add("page-comparison"),this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.classList.add("page-comparison-areas"),this._svg.setAttribute("data-page-id",C.id+""),this._svg.setAttribute("viewBox",`0 0 ${F.x} ${F.y}`),this._svg.setAttribute("transform","scale(1, -1)"),this._container.append(this._svg)}destroy(){this._destroyed=!0,this.remove(),this._container=null,this._lastRenderResult=null}remove(){this._container?.remove()}async appendAsync(e,C,F){if(this.remove(),this._destroyed||!C)return;const $=this._comparisonService.getComparisonResultForPage(this._subjectPageInfo.index);if(!$?.areas?.length||((!this._lastRenderResult||this._lastRenderResult.pageProxy!==C||this._lastRenderResult.scale!==F)&&(this._lastRenderResult=await this.renderPageAsync(C,F)),!this._lastRenderResult))return;this.clear(),e.append(this._container);const[Y,V]=$.offset;for(const te of $.areas){const se=document.createElementNS("http://www.w3.org/2000/svg","g");se.classList.add("comparison-area"),se.addEventListener("pointerdown",this.onAreaPointerDown),se.addEventListener("pointerenter",this.onAreaPointerEnter),se.addEventListener("pointerleave",this.onAreaPointerLeave);const ne=te[0],ee=te[1],ie=this._subjectPageHeight-Math.max(te[1],te[3]),ae=Math.max(Math.abs(te[2]-te[0]),1),re=Math.max(Math.abs(te[3]-te[1]),1),oe=ae*F,ce=re*F,he=document.createElement("canvas");he.width=oe,he.height=ce,he.getContext("2d").scale(1,-1),he.getContext("2d").drawImage(this._lastRenderResult.canvas,(ne+Y)*F,(ee+V)*F,oe,ce,0,0,oe,-ce);const de=he.toDataURL("image/png"),pe=document.createElementNS("http://www.w3.org/2000/svg","image");pe.classList.add("comparison-area-image"),pe.setAttribute("x",ne+""),pe.setAttribute("y",ie+""),pe.setAttribute("width",ae+""),pe.setAttribute("height",re+""),pe.setAttribute("href",de);const fe=document.createElementNS("http://www.w3.org/2000/svg","rect");fe.classList.add("comparison-area-rect"),fe.setAttribute("x",ne+""),fe.setAttribute("y",ie+""),fe.setAttribute("width",ae+""),fe.setAttribute("height",re+""),se.append(pe),se.append(fe),this._svg.append(se)}}clear(){this._svg.innerHTML=""}async renderPageAsync(e,C){if(!e)return null;const F=e.getViewport({scale:C,rotation:0}),{width:$,height:Y}=F,V=document.createElement("canvas");V.width=$,V.height=Y;const se={canvasContext:V.getContext("2d"),viewport:F,enableWebGL:!0};return await e.render(se).promise,{canvas:V,pageProxy:e,scale:C}}onAreaPointerDown=e=>{const C=e.target.closest(".comparison-area");C&&(C.classList.contains("transparent")?(C.classList.remove("transparent"),C.classList.add("opaque")):C.classList.contains("opaque")?C.classList.remove("opaque"):C.classList.add("transparent"))};onAreaPointerEnter=e=>{const C=e.target;C.classList.remove("opaque"),C.classList.add("transparent")};onAreaPointerLeave=e=>{const C=e.target;C.classList.remove("opaque"),C.classList.remove("transparent")}}class PageView{static validRotationValues=[0,90,180,270];index;number;id;generation;_modeService;_docManagerService;_pageProxy;_defaultViewport;_currentViewport;_dimensions;_previewContainer;get previewContainer(){return this._previewContainer}_previewRendered;_viewOuterContainer;get viewContainer(){return this._viewOuterContainer}_viewInnerContainer;_viewCanvas;$viewRendered;set _viewRendered(e){this.$viewRendered=e,this._viewOuterContainer.setAttribute("data-loaded",e+"")}get _viewRendered(){return this.$viewRendered}_text;_annotations;_comparison;_renderTask;_renderPromise;_rotation=0;get rotation(){return this._rotation}set rotation(e){!PageView.validRotationValues.includes(e)||this._rotation===e||(this._rotation=e,this.refreshDimensions())}_scale=1;get scale(){return this._scale}set scale(e){e<=0||this._scale===e||(this._scale=e,this.refreshDimensions())}get width(){return this._dimensions.width}get height(){return this._dimensions.height}_dimensionsIsValid;_lastRenderMode;get modeNotChanged(){return this._lastRenderMode===this._modeService.mode}get viewValid(){return this._dimensionsIsValid&&this._viewRendered}_destroyed;constructor(e,C,F,$){if(!e)throw new Error("Mode service is not defined");if(!C)throw new Error("Loader service is not defined");this._modeService=e,this._docManagerService=C;const Y=C.getPageProxy("main",F);if(!Y)throw new Error("Page proxy is not defined");this._pageProxy=Y,this._defaultViewport=Y.getViewport({scale:1,rotation:0}),this._rotation=Y.rotate,this.index=F,this.number=Y.pageNumber,this.id=Y.ref.num,this.generation=Y.ref.gen,this.initDom($)}destroy(){this._destroyed=!0,this._previewContainer.remove(),this._viewOuterContainer.remove(),this._pageProxy.cleanup()}async renderPreviewAsync(e=!1){if(this._renderPromise&&(e&&this.cancelRenderTask(),await this._renderPromise),!(!e&&this._previewRendered))return this._renderPromise=this.runPreviewRenderAsync(),this._renderPromise}async renderViewAsync(e=!1){if(this._renderPromise&&(e&&this.cancelRenderTask(),await this._renderPromise),!(!e&&this.viewValid&&this.modeNotChanged))return this._renderPromise=this.runViewRenderAsync(e),this._renderPromise}clearPreview(){this._previewContainer.innerHTML=""}clearView(){this._comparison?.destroy(),this._comparison=null,this._annotations?.destroy(),this._annotations=null,this._text?.destroy(),this._text=null,this._viewCanvas?.remove(),this._viewRendered=!1}rotateCounterClockwise(){this._rotation?this.rotation=this._rotation-90:this.rotation=270}rotateClockwise(){this._rotation===270?this.rotation=0:this.rotation=(this._rotation||0)+90}initDom(e){const{width:C,height:F}=this._defaultViewport;e=Math.max(e??0,50);const $=e*(F/C);this._dimensions={width:C,height:F,previewWidth:e,previewHeight:$},this._previewContainer=document.createElement("div"),this._previewContainer.classList.add("page-preview"),this._previewContainer.setAttribute("data-page-number",this.number+""),this._previewContainer.setAttribute("data-page-id",this.id+""),this._previewContainer.setAttribute("data-page-gen",this.generation+""),this._previewContainer.style.width=this._dimensions.previewWidth+"px",this._previewContainer.style.height=this._dimensions.previewHeight+"px",this._viewOuterContainer=document.createElement("div"),this._viewOuterContainer.classList.add("page-container"),this._viewOuterContainer.setAttribute("data-page-number",this.number+""),this._viewOuterContainer.setAttribute("data-page-id",this.id+""),this._viewOuterContainer.setAttribute("data-page-gen",this.generation+""),this._viewInnerContainer=document.createElement("div"),this._viewInnerContainer.classList.add("page"),this._viewInnerContainer.setAttribute("data-page-number",this.number+""),this._viewInnerContainer.setAttribute("data-page-id",this.id+""),this._viewInnerContainer.setAttribute("data-page-gen",this.generation+""),this._viewOuterContainer.append(this._viewInnerContainer),this.refreshDimensions()}refreshDimensions(){const e=window.devicePixelRatio;this._currentViewport=this._defaultViewport.clone({scale:this.scale*e}),this._dimensions.scaledWidth=this._dimensions.width*this._scale,this._dimensions.scaledHeight=this._dimensions.height*this._scale,this._dimensions.scaledDprWidth=this._dimensions.scaledWidth*e,this._dimensions.scaledDprHeight=this._dimensions.scaledHeight*e;const C=this._dimensions.scaledWidth+"px",F=this._dimensions.scaledHeight+"px";switch(this._viewCanvas&&(this._viewCanvas.style.width=C,this._viewCanvas.style.height=F),this._viewInnerContainer.style.width=C,this._viewInnerContainer.style.height=F,this.rotation){case 0:this._viewOuterContainer.style.width=C,this._viewOuterContainer.style.height=F,this._viewInnerContainer.style.transform="";break;case 90:this._viewOuterContainer.style.width=F,this._viewOuterContainer.style.height=C,this._viewInnerContainer.style.transform="rotate(90deg) translateY(-100%)";break;case 180:this._viewOuterContainer.style.width=C,this._viewOuterContainer.style.height=F,this._viewInnerContainer.style.transform="rotate(180deg) translateX(-100%) translateY(-100%)";break;case 270:this._viewOuterContainer.style.width=F,this._viewOuterContainer.style.height=C,this._viewInnerContainer.style.transform="rotate(270deg) translateX(-100%)";break;default:throw new Error(`Invalid rotation degree: ${this.rotation}`)}this._dimensionsIsValid=!1}cancelRenderTask(){this._renderTask&&(this._renderTask.cancel(),this._renderTask=null)}async runRenderTaskAsync(e){if(this._destroyed)return!1;this.cancelRenderTask();try{this._renderTask=this._pageProxy.render(e),await this._renderTask.promise}catch(C){if(C instanceof pdfExports.RenderingCancelledException)return!1;console.log(C.message)}finally{this._renderTask=null}return!0}createPreviewCanvas(){const e=document.createElement("canvas");e.classList.add("page-canvas");const C=window.devicePixelRatio,{previewWidth:F,previewHeight:$}=this._dimensions;return e.style.width=F+"px",e.style.height=$+"px",e.width=F*C,e.height=$*C,e}createViewCanvas(){const e=document.createElement("canvas");return e.classList.add("page-canvas"),e.style.width=this._dimensions.scaledWidth+"px",e.style.height=this._dimensions.scaledHeight+"px",e.width=this._dimensions.scaledDprWidth,e.height=this._dimensions.scaledDprHeight,e}async runPreviewRenderAsync(){if(this._destroyed)return;const e=this.createPreviewCanvas(),C={canvasContext:e.getContext("2d"),viewport:this._defaultViewport.clone({scale:e.width/this._dimensions.width,rotation:0})};if(!await this.runRenderTaskAsync(C)){this._previewRendered=!1;return}this._previewContainer.innerHTML="",this._previewContainer.append(e),this._previewRendered=!0}async runViewRenderAsync(e){if(this._destroyed)return;const C=this._modeService.mode,F=this._scale;this.clearTextLayer(),!((e||!this.viewValid)&&!await this.renderCanvasLayerAsync(F))&&((C==="text"||C==="annotation")&&await this.renderTextLayerAsync(F),C!=="comparison"?await this.renderAnnotationLayerAsync():(this._annotations?.remove(),await this.renderComparisonLayerAsync()),this._lastRenderMode=C,F===this._scale&&(this._dimensionsIsValid=!0))}clearTextLayer(){this._text?.destroy(),this._text?.remove()}async renderCanvasLayerAsync(e){const C=this.createViewCanvas(),F={canvasContext:C.getContext("2d"),viewport:this._currentViewport,enableWebGL:!0};return!await this.runRenderTaskAsync(F)||e!==this._scale?!1:(this._viewCanvas?.remove(),this._viewInnerContainer.append(C),this._viewCanvas=C,this._viewRendered=!0,!0)}async renderTextLayerAsync(e){this._text=await PageTextView.appendPageTextAsync(this._pageProxy,this._viewInnerContainer,e)}async renderAnnotationLayerAsync(){if(!this._annotations){const{width:e,height:C}=this._dimensions;this._annotations=new PageAnnotationView(this._docManagerService.docService,this,new u(e,C))}await this._annotations.appendAsync(this._viewInnerContainer)}async renderComparisonLayerAsync(){const e=this._docManagerService.getPageProxy("compared",this.index);if(!e){this._comparison?.remove();return}if(!this._comparison){const{width:C,height:F}=this._dimensions;this._comparison=new PageComparisonView(this._docManagerService.comparisonService,this,new u(C,F))}await this._comparison.appendAsync(this._viewInnerContainer,e,this._scale)}}const currentPageChangeRequestEvent="tspdf-currentpagechangerequest";class CurrentPageChangeRequestEvent extends CustomEvent{constructor(e){super(currentPageChangeRequestEvent,{detail:e})}}const currentPageChangeEvent="tspdf-currentpagechange";class CurrentPageChangeEvent extends CustomEvent{constructor(e){super(currentPageChangeEvent,{detail:e})}}const pagesLoadedEvent="tspdf-pagesloaded";class PagesLoadedEvent extends CustomEvent{constructor(e){super(pagesLoadedEvent,{detail:e})}}const pagesRenderedEvent="tspdf-pagesrendered";class PagesRenderedEvent extends CustomEvent{constructor(e){super(pagesRenderedEvent,{detail:e})}}const scaleChangedEvent="tspdf-scalechanged";class ScaleChangedEvent extends CustomEvent{constructor(e){super(scaleChangedEvent,{detail:e})}}class PageService{_eventService;get eventService(){return this._eventService}_modeService;_docManagerService;_previewCanvasWidth;_visibleAdjPages;_currentPageIndex;get currentPageIndex(){return this._currentPageIndex||0}_pages=[];get pages(){return this._pages.slice()}set pages(e){this._pages.forEach(C=>C.destroy()),this._pages=e.slice(),this._eventService.dispatchEvent(new PagesLoadedEvent({pages:e.slice()})),this.setCurrentPageIndex(0)}_renderedPages=[];get renderedPages(){return this._renderedPages.slice()}get length(){return this._pages.length||0}get scale(){return this._renderedPages[0]?.scale||1}set scale(e){(!e||isNaN(e))&&(e=1),this._pages.forEach(C=>C.scale=e),this._eventService.dispatchEvent(new ScaleChangedEvent({scale:e}))}constructor(e,C,F,$){if(!e)throw new Error("Event service is not defined");if(!C)throw new Error("Mode service is not defined");if(!F)throw new Error("Doc manager service is not defined");this._modeService=C,this._eventService=e,this._docManagerService=F,this._previewCanvasWidth=$?.previewCanvasWidth||100,this._visibleAdjPages=$?.visibleAdjPages||0}destroy(){this._pages.forEach(e=>e.destroy)}getPage(e){return this._pages[e]}getCurrentPage(){return this._pages[this._currentPageIndex]}async reloadPagesAsync(){const e=this._docManagerService.pageCount,C=[];if(e)for(let F=0;F<e;F++){const $=new PageView(this._modeService,this._docManagerService,F,this._previewCanvasWidth);C.push($)}this.pages=C}requestSetCurrentPageIndex(e){e=n$1(e||0,0,this._pages.length-1),e!==this._currentPageIndex&&this._eventService.dispatchEvent(new CurrentPageChangeRequestEvent({pageIndex:e}))}renderVisiblePages(e,C){const F=this._pages,{minFinal:$,maxFinal:Y}=this.getVisiblePageIndices(e),V=[];for(let te=0;te<F.length;te++){const se=F[te];te>=$&&te<=Y?(V.push(se),se.renderViewAsync(C)):se.clearView()}this._renderedPages=V,this._eventService.dispatchEvent(new PagesRenderedEvent({pages:V.slice()})),this.updateCurrentPage(e)}renderVisiblePreviews(e){const C=this._pages,F=this.getVisiblePageIndices(e,!0);for(let $=0;$<C.length;$++){const Y=C[$];$>=F.minFinal&&$<=F.maxFinal&&Y.renderPreviewAsync()}}renderSpecifiedPages(e){e?.size&&this._renderedPages.forEach(C=>{e.has(C.id)&&C.renderViewAsync(!0)})}getPageCoordsUnderPointer(e,C){for(const F of this._renderedPages){const{left:$,top:Y,width:V,height:te}=F.viewContainer.getBoundingClientRect(),se=$+V,ne=Y+te;if(e<$||e>se||C<Y||C>ne)continue;let ee,ie;const ae=this.scale,re=F.rotation;switch(re){case 0:ee=(e-$)/ae,ie=(ne-C)/ae;break;case 90:ee=(C-Y)/ae,ie=(e-$)/ae;break;case 180:ee=(se-e)/ae,ie=(C-Y)/ae;break;case 270:ee=(ne-C)/ae,ie=(se-e)/ae;break;default:throw new Error(`Invalid rotation degree: ${re}`)}return{pageId:F.id,pageX:ee,pageY:ie,pageRotation:re}}return null}setCurrentPageIndex(e){const C=n$1(e||0,0,this._pages.length-1);if(C!==this._currentPageIndex){const F=this._currentPageIndex;this._currentPageIndex=C,this._pages[F]?.previewContainer.classList.remove("current"),this._pages[C]?.previewContainer.classList.add("current"),this._eventService.dispatchEvent(new CurrentPageChangeEvent({oldIndex:F,newIndex:C}))}}getVisiblePageIndices(e,C=!1){const F=this._pages;if(!F.length)return{actual:[],minFinal:null,maxFinal:null};const $=new Set,Y=e.getBoundingClientRect(),V=Y.top,te=Y.top+Y.height;for(let ne=0;ne<F.length;ne++){const ee=F[ne],ie=C?ee.previewContainer.getBoundingClientRect():ee.viewContainer.getBoundingClientRect(),ae=ie.top,re=ie.top+ie.height;if(ae<te&&re>V)$.add(ne);else if($.size)break}const se=[...$];return{actual:se,minFinal:Math.max(Math.min(...se)-this._visibleAdjPages,0),maxFinal:Math.min(Math.max(...se)+this._visibleAdjPages,F.length-1)}}updateCurrentPage(e){const C=this._pages,F=this.getVisiblePageIndices(e),{actual:$}=F;if($.length){if($.length===1){this.setCurrentPageIndex($[0]);return}}else{this.setCurrentPageIndex(0);return}const Y=e.getBoundingClientRect(),V=Y.top,te=Y.top+Y.height/2;for(const se of $){const ee=C[se].viewContainer.getBoundingClientRect().top;if(ee>V)if(ee>te){this.setCurrentPageIndex(se-1);return}else{this.setCurrentPageIndex(se);return}}throw new Error("Incorrect argument")}}const annotatorTypes=["geom","pen","stamp","text"],annotatorDataChangeEvent="tspdf-annotatordatachange";class AnnotatorDataChangeEvent extends CustomEvent{constructor(e){super(annotatorDataChangeEvent,{detail:e})}}const textSelectionChangeEvent="tspdf-textselectionchange";class TextSelectionChangeEvent extends CustomEvent{constructor(e){super(textSelectionChangeEvent,{detail:e})}}class Annotator{_docService;_pageService;_parent;_overlayContainer;get overlayContainer(){return this._overlayContainer}_overlay;_svgWrapper;_svgGroup;_parentMutationObserver;_parentResizeObserver;_lastPointerDownInfo;_pointerCoordsInPageCS;constructor(e,C,F){if(!e)throw new Error("Document service not defined");if(!C)throw new Error("Page service not defined");if(!F)throw new Error("Parent container not defined");this._docService=e,this._parent=F,this._pageService=C}destroy(){this._docService.eventService.removeListener(pagesRenderedEvent,this.onPagesRendered),this._parent?.removeEventListener("scroll",this.onParentScroll),this._parentMutationObserver?.disconnect(),this._parentResizeObserver?.disconnect(),this._overlayContainer.remove()}refreshViewBox(){const{width:e,height:C}=this._overlay.getBoundingClientRect();if(!e||!C)return;this._overlay.style.left=this._parent.scrollLeft+"px",this._overlay.style.top=this._parent.scrollTop+"px";const F=e/this._pageService.scale,$=C/this._pageService.scale;this._svgWrapper.setAttribute("viewBox",`0 0 ${F} ${$}`),this.refreshGroupPosition()}init(){const e=document.createElement("div");e.id="annotation-overlay-container";const C=document.createElement("div");C.id="annotation-overlay";const F=document.createElementNS("http://www.w3.org/2000/svg","svg");F.classList.add("abs-stretch","no-margin","no-padding"),F.setAttribute("transform","matrix(1 0 0 -1 0 0)"),F.setAttribute("opacity","0.5");const $=document.createElementNS("http://www.w3.org/2000/svg","g");F.append($),C.append(F),e.append(C),this._overlayContainer=e,this._overlay=C,this._svgWrapper=F,this._svgGroup=$,this._parent.append(this._overlayContainer),this.refreshViewBox(),this.initEventHandlers()}initEventHandlers(){this._overlay.addEventListener("pointerdown",this.onOverlayPointerDown),this._parent.addEventListener("scroll",this.onParentScroll);const e=new ResizeObserver(F=>{this.refreshViewBox()}),C=new MutationObserver(F=>{const $=F[0];$&&($.addedNodes.forEach(Y=>{Y.classList.contains("page")&&e.observe(Y)}),$.removedNodes.forEach(Y=>e.unobserve(Y)),this.refreshViewBox())});e.observe(this._parent),C.observe(this._parent,{attributes:!1,childList:!0,subtree:!1}),this._parentMutationObserver=C,this._parentResizeObserver=e,this._docService.eventService.addListener(pagesRenderedEvent,this.onPagesRendered)}onPagesRendered=e=>{this.refreshViewBox()};onParentScroll=()=>{this.refreshViewBox()};onOverlayPointerDown=e=>{e.isPrimary&&(this._lastPointerDownInfo={timestamp:performance.now(),clientX:e.clientX,clientY:e.clientY})};updatePointerCoords(e,C){const F=this._pageService.getPageCoordsUnderPointer(e,C);F?this._svgGroup.classList.remove("annotation-out-of-page"):this._svgGroup.classList.add("annotation-out-of-page"),this._pointerCoordsInPageCS=F}}class GeometricAnnotator extends Annotator{_color;_strokeWidth;_cloudMode;_pageId;constructor(e,C,F,$){super(e,C,F),this._color=$?.color||[0,0,0,1],this._strokeWidth=$?.strokeWidth||3,this._cloudMode=$?.cloudMode||!1}destroy(){this.clearGroup(),super.destroy()}init(){super.init()}emitDataChanged(e,C,F,$){this._docService.eventService.dispatchEvent(new AnnotatorDataChangeEvent({annotatorType:"geom",elementCount:e,undoable:$,clearable:F,saveable:C}))}clearGroup(){this._svgGroup.innerHTML="",this.emitDataChanged(0)}refreshGroupPosition(){if(!this._pageId&&this._pageId!==0)return;const e=this._pageService.renderedPages.find(he=>he.id===this._pageId);if(!e){this._svgGroup.setAttribute("transform","scale(0)");return}const{height:C,width:F,top:$,left:Y}=e.viewContainer.getBoundingClientRect(),V=$+C,te=Y+F,{height:se,top:ne,left:ee}=this._overlay.getBoundingClientRect(),ie=ne+se,ae=e.rotation,re=e.scale;let oe,ce;switch(ae){case 0:oe=(Y-ee)/re,ce=(ie-V)/re;break;case 90:oe=(Y-ee)/re,ce=(ie-$)/re;break;case 180:oe=(te-ee)/re,ce=(ie-$)/re;break;case 270:oe=(te-ee)/re,ce=(ie-V)/re;break;default:throw new Error(`Invalid rotation degree: ${ae}`)}this._svgGroup.setAttribute("transform",`translate(${oe} ${ce}) rotate(${-ae})`)}buildLineEndingPath(e,C,F,$){const Y=Math.max(F*LINE_END_MULTIPLIER,LINE_END_MIN_SIZE);let V="";switch(C){case lineEndingTypes.ARROW_OPEN:return $==="left"?(V+=`M${e.x+Y},${e.y+Y/2}`,V+=` L${e.x},${e.y}`,V+=` L${e.x+Y},${e.y-Y/2}`):(V+=`M${e.x-Y},${e.y+Y/2}`,V+=` L${e.x},${e.y}`,V+=` L${e.x-Y},${e.y-Y/2}`),V;case lineEndingTypes.ARROW_OPEN_R:return $==="left"?(V+=`M${e.x},${e.y+Y/2}`,V+=` L${e.x+Y},${e.y}`,V+=` L${e.x},${e.y-Y/2}`):(V+=`M${e.x},${e.y+Y/2}`,V+=` L${e.x-Y},${e.y}`,V+=` L${e.x},${e.y-Y/2}`),V;case lineEndingTypes.ARROW_CLOSED:return $==="left"?(V+=`M${e.x+Y},${e.y+Y/2}`,V+=` L${e.x},${e.y}`,V+=` L${e.x+Y},${e.y-Y/2}`):(V+=`M${e.x-Y},${e.y+Y/2}`,V+=` L${e.x},${e.y}`,V+=` L${e.x-Y},${e.y-Y/2}`),V+=" Z",V;case lineEndingTypes.ARROW_CLOSED_R:return $==="left"?(V+=`M${e.x+Y},${e.y}`,V+=` L${e.x},${e.y+Y/2}`,V+=` L${e.x},${e.y-Y/2}`):(V+=`M${e.x-Y},${e.y}`,V+=` L${e.x},${e.y-Y/2}`,V+=` L${e.x},${e.y+Y/2}`),V+=" Z",V;case lineEndingTypes.BUTT:return V+=`M${e.x},${e.y+Y/2}`,V+=` L${e.x},${e.y-Y/2}`,V;case lineEndingTypes.SLASH:return V+=`M${e.x+Y/2},${e.y+Y/2}`,V+=` L${e.x-Y/2},${e.y-Y/2}`,V;case lineEndingTypes.DIAMOND:return V+=`M${e.x},${e.y+Y/2}`,V+=` L${e.x+Y/2},${e.y}`,V+=` L${e.x},${e.y-Y/2}`,V+=` L${e.x-Y/2},${e.y}`,V+=" Z",V;case lineEndingTypes.SQUARE:return V+=`M${e.x-Y/2},${e.y+Y/2}`,V+=` L${e.x+Y/2},${e.y+Y/2}`,V+=` L${e.x+Y/2},${e.y-Y/2}`,V+=` L${e.x-Y/2},${e.y-Y/2}`,V+=" Z",V;case lineEndingTypes.CIRCLE:const te=BEZIER_CONSTANT,se=Y/2,ne=te*se,ee=e.x-se,ie=e.y-se,ae=e.x+se,re=e.y+se;return V+=`M${e.x},${re}`,V+=` C${e.x+ne},${re} ${ae},${e.y+ne} ${ae},${e.y}`,V+=` C${ae},${e.y-ne} ${e.x+ne},${ie} ${e.x},${ie}`,V+=` C${e.x-ne},${ie} ${ee},${e.y-ne} ${ee},${e.y}`,V+=` C${ee},${e.y+ne} ${e.x-ne},${re} ${e.x},${re}`,V+=" Z",V;case lineEndingTypes.NONE:default:return""}}}class GeometricLineAnnotator extends GeometricAnnotator{_down;_vertices;constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}destroy(){super.destroy()}undo(){this.clear()}clear(){this._vertices=null,this.clearGroup()}async saveAnnotationAsync(){if(!this._vertices)return;const e=this._pageId,C=this.buildAnnotationDto(),F=await LineAnnotation.createFromDtoAsync(C,this._docService.fontMap);await this._docService.appendAnnotationToPageAsync(e,F),this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}redrawLine(e,C){this._svgGroup.innerHTML="";const[F,$,Y,V]=this._color||[0,0,0,1];this._vertices=[e.x,e.y,C.x,C.y];const te=document.createElementNS("http://www.w3.org/2000/svg","path");te.setAttribute("fill","none"),te.setAttribute("stroke",`rgba(${F*255},${$*255},${Y*255},${V})`),te.setAttribute("stroke-width",this._strokeWidth+""),te.setAttribute("stroke-linecap","square");const se=`M ${e.x},${e.y} L ${C.x},${C.y}`;te.setAttribute("d",se),this._svgGroup.append(te)}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;this._pageId=te,this._down=new u(Y,V),this.clear(),this.refreshGroupPosition();const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary||!this._down)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$,te=new u(Y,V);this.redrawLine(this._down,te)};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this._vertices&&this.emitDataChanged(2,!0,!0)};buildAnnotationDto(){const e=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Line",pageId:null,dateCreated:e,dateModified:e,author:this._docService.userName||"unknown",textContent:null,rect:null,vertices:this._vertices,intent:lineIntents.DIMENSION,color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null}}}class GeometricArrowAnnotator extends GeometricLineAnnotator{constructor(e,C,F,$){super(e,C,F,$||{})}redrawLine(e,C){this._svgGroup.innerHTML="";const[F,$,Y,V]=this._color||[0,0,0,1];this._vertices=[e.x,e.y,C.x,C.y];const te=new u(e.x,e.y),se=new u(C.x,C.y),ne=new u,ee=new u(u.subtract(se,te).getMagnitude(),0),ie=l.from4Vec2(ne,ee,te,se),ae=document.createElementNS("http://www.w3.org/2000/svg","path");ae.setAttribute("fill","none"),ae.setAttribute("stroke",`rgba(${F*255},${$*255},${Y*255},${V})`),ae.setAttribute("stroke-width",this._strokeWidth+""),ae.setAttribute("stroke-linecap","square");let re=`M ${ne.x},${ne.y} L ${ee.x},${ee.y}`;const oe=Math.max(this._strokeWidth*LINE_END_MULTIPLIER,LINE_END_MIN_SIZE);re+=` M ${ee.x-oe},${ee.y+oe/2}`,re+=` L ${ee.x},${ee.y}`,re+=` L ${ee.x-oe},${ee.y-oe/2}`,ae.setAttribute("d",re),ae.setAttribute("transform",`matrix(${ie.toFloatShortArray().join(" ")})`),this._svgGroup.append(ae)}buildAnnotationDto(){const e=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Line",pageId:null,dateCreated:e,dateModified:e,author:this._docService.userName||"unknown",textContent:null,rect:null,vertices:this._vertices,intent:lineIntents.ARROW,endingType:[lineEndingTypes.NONE,lineEndingTypes.ARROW_OPEN],color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null}}}class GeometricCircleAnnotator extends GeometricAnnotator{_down;_rect;constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}destroy(){super.destroy()}undo(){this.clear()}clear(){this._rect=null,this.clearGroup()}async saveAnnotationAsync(){if(!this._rect)return;const e=this._pageId,C=this.buildAnnotationDto(),F=CircleAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(e,F),this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}redrawCircle(e,C){this._svgGroup.innerHTML="";const F=this._strokeWidth*2;if(C.x-e.x<=F||C.y-e.y<=F){this._rect=null;return}const[$,Y,V,te]=this._color||[0,0,0,1];this._rect=[e.x,e.y,C.x,C.y];const se=document.createElementNS("http://www.w3.org/2000/svg","path");se.setAttribute("fill","none"),se.setAttribute("stroke",`rgba(${$*255},${Y*255},${V*255},${te})`),se.setAttribute("stroke-width",this._strokeWidth+""),se.setAttribute("stroke-linecap","round"),se.setAttribute("stroke-linejoin","round");let ne;const ee=(C.x-e.x)/2,ie=(C.y-e.y)/2,ae=new u(e.x+ee,e.y+ie);if(this._cloudMode){const re=CloudCurveData.buildFromEllipse(ee,ie,CircleAnnotation.cloudArcSize,new l().applyTranslation(ae.x,ae.y));ne="M"+re.start.x+","+re.start.y,re.curves.forEach(oe=>{ne+=` C${oe[0].x},${oe[0].y} ${oe[1].x},${oe[1].y} ${oe[2].x},${oe[2].y}`})}else{const re=BEZIER_CONSTANT,oe=re*ee,ce=re*ie;ne="M"+ae.x+","+C.y,ne+=` C${ae.x+oe},${C.y} ${C.x},${ae.y+ce} ${C.x},${ae.y}`,ne+=` C${C.x},${ae.y-ce} ${ae.x+oe},${e.y} ${ae.x},${e.y}`,ne+=` C${ae.x-oe},${e.y} ${e.x},${ae.y-ce} ${e.x},${ae.y}`,ne+=` C${e.x},${ae.y+ce} ${ae.x-oe},${C.y} ${ae.x},${C.y}`}se.setAttribute("d",ne),this._svgGroup.append(se)}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;this._pageId=te,this._down=new u(Y,V),this.clear(),this.refreshGroupPosition();const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary||!this._down)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$,{min:te,max:se}=u.minMax(this._down,new u(Y,V));this.redrawCircle(te,se)};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this._rect&&this.emitDataChanged(2,!0,!0)};buildAnnotationDto(){const e=this._strokeWidth/2+(this._cloudMode?CircleAnnotation.cloudArcSize/2:0),C=e,F=e,$=e,Y=e,V=[C,F,$,Y],[te,se,ne,ee]=this._rect,ie=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Circle",pageId:null,dateCreated:ie,dateModified:ie,author:this._docService.userName||"unknown",textContent:null,rect:[te-C,se-Y,ne+$,ee+F],rectMargins:V,cloud:this._cloudMode,color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null}}}class GeometricPolygonAnnotator extends GeometricAnnotator{_points=[];constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}destroy(){super.destroy()}undo(){this._points.length&&(this._points.pop(),this.redraw(),this.emitPointsDataChanged())}clear(){this._points?.length&&(this._points.length=0,this.clearGroup())}async saveAnnotationAsync(){if(this._points.length<3)return;const e=this._pageId,C=this.buildAnnotationDto(),F=PolygonAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(e,F),this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}emitPointsDataChanged(){const e=this._points.length;this.emitDataChanged(e,e>1,e>0,e>2)}redraw(){if(this._svgGroup.innerHTML="",this._points.length<2)return;const[e,C,F,$]=this._color||[0,0,0,1],Y=document.createElementNS("http://www.w3.org/2000/svg","path");Y.setAttribute("fill","none"),Y.setAttribute("stroke",`rgba(${e*255},${C*255},${F*255},${$})`),Y.setAttribute("stroke-width",this._strokeWidth+"");let V;if(this._cloudMode){Y.setAttribute("stroke-linecap","round"),Y.setAttribute("stroke-linejoin","round");const te=CloudCurveData.buildFromPolyline([...this._points,this._points[0]],PolygonAnnotation.cloudArcSize);V="M"+te.start.x+","+te.start.y,te.curves.forEach(se=>{V+=` C${se[0].x},${se[0].y} ${se[1].x},${se[1].y} ${se[2].x},${se[2].y}`}),Y.setAttribute("d",V)}else{Y.setAttribute("stroke-linecap","square"),Y.setAttribute("stroke-linejoin","miter");const te=this._points[0];V="M"+te.x+","+te.y;for(let se=1;se<this._points.length;se++){const ne=this._points[se];V+=" L"+ne.x+","+ne.y}V+=" Z"}Y.setAttribute("d",V),this._svgGroup.append(Y)}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;this._pageId=te,this.refreshGroupPosition(),this._points.length||this._points.push(new u(Y,V)),this._points.push(new u(Y,V));const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$;this._points[this._points.length-1].set(Y,V),this.redraw()};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this.emitPointsDataChanged()};buildAnnotationDto(){const e=this._strokeWidth/2+(this._cloudMode?PolygonAnnotation.cloudArcSize/2:0);let C,F,$,Y,V;const te=this._points,se=[];for(let ie=0;ie<te.length;ie++)V=te[ie],(!C||V.x<C)&&(C=V.x),(!F||V.y<F)&&(F=V.y),(!$||V.x>$)&&($=V.x),(!Y||V.y>Y)&&(Y=V.y),se.push(V.x,V.y);const ne=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Polygon",pageId:null,dateCreated:ne,dateModified:ne,author:this._docService.userName||"unknown",textContent:null,rect:[C-e,F-e,$+e,Y+e],vertices:se,cloud:this._cloudMode,color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null}}}class GeometricPolylineAnnotator extends GeometricAnnotator{_points=[];constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}destroy(){super.destroy()}undo(){this._points.length&&(this._points.pop(),this.redraw(),this.emitPointsDataChanged())}clear(){this._points?.length&&(this._points.length=0,this.clearGroup())}async saveAnnotationAsync(){if(this._points.length<2)return;const e=this._pageId,C=this.buildAnnotationDto(),F=PolylineAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(e,F),this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}emitPointsDataChanged(){const e=this._points.length;this.emitDataChanged(e,e>1,e>0,e>2)}redraw(){if(this._svgGroup.innerHTML="",this._points.length<2)return;const[e,C,F,$]=this._color||[0,0,0,1],Y=document.createElementNS("http://www.w3.org/2000/svg","path");Y.setAttribute("fill","none"),Y.setAttribute("stroke",`rgba(${e*255},${C*255},${F*255},${$})`),Y.setAttribute("stroke-width",this._strokeWidth+""),Y.setAttribute("stroke-linecap","square"),Y.setAttribute("stroke-linejoin","miter");const V=this._points[0];let te="M"+V.x+","+V.y;for(let se=1;se<this._points.length;se++){const ne=this._points[se];te+=" L"+ne.x+","+ne.y}Y.setAttribute("d",te),this._svgGroup.append(Y)}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;this._pageId=te,this.refreshGroupPosition(),this._points.length||this._points.push(new u(Y,V)),this._points.push(new u(Y,V));const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$;this._points[this._points.length-1].set(Y,V),this.redraw()};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this.emitPointsDataChanged()};buildAnnotationDto(){const e=this._strokeWidth/2;let C,F,$,Y,V;const te=this._points,se=[];for(let ie=0;ie<te.length;ie++)V=te[ie],(!C||V.x<C)&&(C=V.x),(!F||V.y<F)&&(F=V.y),(!$||V.x>$)&&($=V.x),(!Y||V.y>Y)&&(Y=V.y),se.push(V.x,V.y);const ne=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Polyline",pageId:null,dateCreated:ne,dateModified:ne,author:this._docService.userName||"unknown",textContent:null,rect:[C-e,F-e,$+e,Y+e],vertices:se,color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null}}}class GeometricSquareAnnotator extends GeometricAnnotator{_down;_rect;constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}destroy(){super.destroy()}undo(){this.clear()}clear(){this._rect=null,this.clearGroup()}async saveAnnotationAsync(){if(!this._rect)return;const e=this._pageId,C=this.buildAnnotationDto(),F=SquareAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(e,F),this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}redrawRect(e,C){this._svgGroup.innerHTML="";const F=this._strokeWidth*2;if(C.x-e.x<=F||C.y-e.y<=F){this._rect=null;return}const[$,Y,V,te]=this._color||[0,0,0,1];if(this._rect=[e.x,e.y,C.x,C.y],this._cloudMode){const se=document.createElementNS("http://www.w3.org/2000/svg","path");se.setAttribute("fill","none"),se.setAttribute("stroke",`rgba(${$*255},${Y*255},${V*255},${te})`),se.setAttribute("stroke-width",this._strokeWidth+""),se.setAttribute("stroke-linecap","round"),se.setAttribute("stroke-linejoin","round");const ne=CloudCurveData.buildFromPolyline([new u(e.x,e.y),new u(C.x,e.y),new u(C.x,C.y),new u(e.x,C.y),new u(e.x,e.y)],SquareAnnotation.cloudArcSize);let ee="M"+ne.start.x+","+ne.start.y;ne.curves.forEach(ie=>{ee+=` C${ie[0].x},${ie[0].y} ${ie[1].x},${ie[1].y} ${ie[2].x},${ie[2].y}`}),se.setAttribute("d",ee),this._svgGroup.append(se)}else{const se=document.createElementNS("http://www.w3.org/2000/svg","rect");se.setAttribute("fill","none"),se.setAttribute("stroke",`rgba(${$*255},${Y*255},${V*255},${te})`),se.setAttribute("stroke-width",this._strokeWidth+""),se.setAttribute("x",e.x+""),se.setAttribute("y",e.y+""),se.setAttribute("width",C.x-e.x+""),se.setAttribute("height",C.y-e.y+""),this._svgGroup.append(se)}}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;this._pageId=te,this._down=new u(Y,V),this.clear(),this.refreshGroupPosition();const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary||!this._down)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$,{min:te,max:se}=u.minMax(this._down,new u(Y,V));this.redrawRect(te,se)};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this._rect&&this.emitDataChanged(2,!0,!0)};buildAnnotationDto(){const e=this._strokeWidth/2+(this._cloudMode?SquareAnnotation.cloudArcSize/2:0),C=e,F=e,$=e,Y=e,V=[C,F,$,Y],[te,se,ne,ee]=this._rect,ie=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Square",pageId:null,dateCreated:ie,dateModified:ie,author:this._docService.userName||"unknown",textContent:null,rect:[te-C,se-Y,ne+$,ee+F],rectMargins:V,cloud:this._cloudMode,color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null}}}const geometricAnnotatorTypes=["square","circle","line","arrow","polyline","polygon"];class GeometricAnnotatorFactory{_lastType;_lastColor;_lastStrokeWidth;_lastCloudMode;createAnnotator(e,C,F,$,Y){if(!e)throw new Error("Document service is not defined");if(!C)throw new Error("Page service is not defined");if(!F)throw new Error("Parent container is not defined");Y||=this._lastType||"square",this._lastType=Y;const V=$?.color||this._lastColor||[0,0,0,.9];this._lastColor=V;const te=$?.strokeWidth||this._lastStrokeWidth||3;this._lastStrokeWidth=te;const se=$?.cloudMode??this._lastCloudMode??!1;this._lastCloudMode=se;const ne={color:V,strokeWidth:te,cloudMode:se};switch(Y){case"square":return new GeometricSquareAnnotator(e,C,F,ne);case"circle":return new GeometricCircleAnnotator(e,C,F,ne);case"line":return new GeometricLineAnnotator(e,C,F,ne);case"arrow":return new GeometricArrowAnnotator(e,C,F,ne);case"polyline":return new GeometricPolylineAnnotator(e,C,F,ne);case"polygon":return new GeometricPolygonAnnotator(e,C,F,ne);default:throw new Error(`Invalid geometric annotator type: ${Y}`)}}}class PenAnnotator extends Annotator{_annotationPathData;_color;_strokeWidth;constructor(e,C,F,$){super(e,C,F),this.init(),this._color=$?.color||[0,0,0,.9],this._strokeWidth=$?.strokeWidth||3}destroy(){this.removeTempPenData(),super.destroy()}undo(){this._annotationPathData?.removeLastPath(),this.emitDataChanged()}clear(){this.removeTempPenData()}async saveAnnotationAsync(){if(!this._annotationPathData)return;const e=this._annotationPathData.id,C=this.buildAnnotationDto(this._annotationPathData),F=InkAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(e,F),this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}refreshGroupPosition(){if(!this._annotationPathData)return;const e=this._pageService.renderedPages.find(he=>he.id===this._annotationPathData.id);if(!e){this._annotationPathData.group.setAttribute("transform","scale(0)");return}const{height:C,width:F,top:$,left:Y}=e.viewContainer.getBoundingClientRect(),V=$+C,te=Y+F,{height:se,top:ne,left:ee}=this._overlay.getBoundingClientRect(),ie=ne+se,ae=e.rotation,re=e.scale;let oe,ce;switch(ae){case 0:oe=(Y-ee)/re,ce=(ie-V)/re;break;case 90:oe=(Y-ee)/re,ce=(ie-$)/re;break;case 180:oe=(te-ee)/re,ce=(ie-$)/re;break;case 270:oe=(te-ee)/re,ce=(ie-V)/re;break;default:throw new Error(`Invalid rotation degree: ${ae}`)}this._annotationPathData.group.setAttribute("transform",`translate(${oe} ${ce}) rotate(${-ae})`)}removeTempPenData(){this._annotationPathData&&(this._annotationPathData.group.remove(),this._annotationPathData=null,this.emitDataChanged())}resetTempPenData(e){this.removeTempPenData(),this._annotationPathData=new SvgSmoothPath({id:e,color:this._color,strokeWidth:this._strokeWidth}),this._svgGroup.append(this._annotationPathData.group),this.refreshGroupPosition()}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;(!this._annotationPathData||te!==this._annotationPathData.id)&&this.resetTempPenData(te),this._annotationPathData.newPath(new u(Y,V));const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary||!this._annotationPathData)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;!$||$.pageId!==this._annotationPathData.id||this._annotationPathData.addPosition(new u($.pageX,$.pageY))};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this._annotationPathData?.endPath(),this.emitDataChanged()};emitDataChanged(){const e=this._annotationPathData?.pathCount||0;this._docService.eventService.dispatchEvent(new AnnotatorDataChangeEvent({annotatorType:"pen",elementCount:e,undoable:e>1,clearable:e>0,saveable:e>0}))}buildAnnotationDto(e){const C=[],F=[];e.paths.forEach(ee=>{const ie=[];ee.positions.forEach(ae=>{C.push(ae),ie.push(ae.x,ae.y)}),F.push(ie)});const{min:$,max:Y}=u.minMax(...C),V=e.strokeWidth/2,te=[$.x-V,$.y-V,Y.x+V,Y.y+V],se=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/Ink",pageId:null,dateCreated:se,dateModified:se,author:this._docService.userName||"unknown",textContent:null,rect:te,matrix:[1,0,0,1,0,0],inkList:F,color:e.color,strokeWidth:e.strokeWidth,strokeDashGap:null}}}const supportedStampTypes=[{type:"/Draft",name:"Draft"},{type:"/Approved",name:"Approved"},{type:"/NotApproved",name:"Not Approved"},{type:"/Departmental",name:"Departmental"},{type:"/Confidential",name:"Confidential"},{type:"/Final",name:"Final"},{type:"/Expired",name:"Expired"},{type:"/AsIs",name:"As Is"},{type:"/Sold",name:"Sold"},{type:"/Experimental",name:"Experimental"},{type:"/ForComment",name:"For Comment"},{type:"/TopSecret",name:"Top Secret"},{type:"/ForPublicRelease",name:"For Public"},{type:"/NotForPublicRelease",name:"Not For Public"}];class StampAnnotator extends Annotator{_type;_creationInfo;_tempAnnotation;_pageId;constructor(e,C,F,$,Y){if(super(e,C,F),!$)throw new Error("Stamp type is not defined");this._type=$,this._creationInfo=Y,this.init()}destroy(){this._tempAnnotation=null,super.destroy()}undo(){this.clear()}clear(){this._tempAnnotation=null}async saveAnnotationAsync(){!this._pageId||!this._tempAnnotation||(await this._docService.appendAnnotationToPageAsync(this._pageId,this._tempAnnotation),await this.createTempStampAnnotationAsync())}init(){super.init(),this._overlay.addEventListener("pointermove",this.onPointerMove),this._overlay.addEventListener("pointerup",this.onPointerUp),this.createTempStampAnnotationAsync()}createStandardStamp(e,C){const F=new Date().toISOString(),$={uuid:UUID.getRandomUuid(),annotationType:"/Stamp",pageId:null,dateCreated:F,dateModified:F,author:C||"unknown",textContent:null,rect:null,matrix:null,stampType:e,stampSubject:null,stampImageData:null};return StampAnnotation.createFromDto($)}createCustomStamp(e,C){const F=new Date().toISOString(),$={uuid:UUID.getRandomUuid(),annotationType:"/Stamp",pageId:null,dateCreated:F,dateModified:F,author:C||"unknown",textContent:null,rect:e.rect||e.bbox,bbox:e.bbox,matrix:null,stampType:e.type,stampSubject:e.subject,stampImageData:[...e.imageData]};return StampAnnotation.createFromDto($)}async createTempStampAnnotationAsync(){let e;if(standardStampCreationInfos[this._type])e=this.createStandardStamp(this._type,this._docService.userName);else if(this._creationInfo)e=this.createCustomStamp(this._creationInfo,this._docService.userName);else throw new Error(`Unsupported stamp type: ${this._type}`);const C=await e.renderApStreamAsync();this._svgGroup.innerHTML="",this._svgGroup.append(...C.clipPaths),this._svgGroup.append(...C.elements.map(F=>F.element)),this._tempAnnotation=e}onPointerMove=e=>{if(!e.isPrimary)return;const{clientX:C,clientY:F}=e,{height:$,top:Y,left:V}=this._parent.getBoundingClientRect(),te=Y+$,se=(C-V)/this._pageService.scale,ne=(te-F)/this._pageService.scale;if(this._tempAnnotation){const[ee,ie,ae,re]=this._tempAnnotation.Rect;this._svgGroup.setAttribute("transform",`translate(${se-(ae-ee)/2} ${ne-(re-ie)/2})`)}this.updatePointerCoords(C,F)};onPointerUp=async e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;if(e.pointerType==="touch"&&performance.now()-this._lastPointerDownInfo?.timestamp>700){const ee=this._lastPointerDownInfo?.clientX||0,ie=this._lastPointerDownInfo?.clientY||0;if(!(Math.abs(h(C,F,ee,ie))>7.5))return}const $=this._pageService.getPageCoordsUnderPointer(C,F);if(this._pointerCoordsInPageCS=$,!$||!this._tempAnnotation)return;const{pageId:Y,pageX:V,pageY:te,pageRotation:se}=this._pointerCoordsInPageCS;await this._tempAnnotation.moveToAsync(new u(V,te)),se&&await this._tempAnnotation.rotateByAsync(-se/180*Math.PI),this._pageId=Y,await this.saveAnnotationAsync()};refreshGroupPosition(){}}class TextAnnotator extends Annotator{_color;_strokeWidth;constructor(e,C,F,$){super(e,C,F),this._color=$?.color||[0,0,0,1],this._strokeWidth=$?.strokeWidth||3}emitDataChanged(e,C,F,$){this._docService.eventService.dispatchEvent(new AnnotatorDataChangeEvent({annotatorType:"text",elementCount:e,undoable:$,clearable:F,saveable:C}))}}class TextMarkupAnnotator extends TextAnnotator{_svgGroupByPageId=new Map;_coordsByPageId=new Map;constructor(e,C,F,$){super(e,C,F,$)}destroy(){this._docService.eventService.removeListener(textSelectionChangeEvent,this.onTextSelectionChange),this.clearGroup(),super.destroy()}undo(){this.clear()}clear(){this._coordsByPageId.clear(),this.clearGroup()}init(){super.init(),this._docService.eventService.addListener(textSelectionChangeEvent,this.onTextSelectionChange)}clearGroup(){this._svgGroupByPageId.forEach(e=>e.innerHTML=""),this.emitDataChanged(0)}refreshGroupPosition(){const{height:e,top:C,left:F}=this._overlay.getBoundingClientRect(),$=C+e,Y=this._pageService.scale;this._pageService.renderedPages.forEach(V=>{const{height:te,width:se,top:ne,left:ee}=V.viewContainer.getBoundingClientRect(),ie=ne+te,ae=ee+se,re=V.rotation;let oe,ce;switch(re){case 0:oe=(ee-F)/Y,ce=($-ie)/Y;break;case 90:oe=(ee-F)/Y,ce=($-ne)/Y;break;case 180:oe=(ae-F)/Y,ce=($-ne)/Y;break;case 270:oe=(ae-F)/Y,ce=($-ie)/Y;break;default:throw new Error(`Invalid rotation degree: ${re}`)}let he;this._svgGroupByPageId.has(V.id)?he=this._svgGroupByPageId.get(V.id):(he=document.createElementNS("http://www.w3.org/2000/svg","g"),this._svgGroupByPageId.set(V.id,he),this._svgGroup.append(he)),he.setAttribute("transform",`translate(${oe} ${ce}) rotate(${-re})`)})}updateCoords(e){this._coordsByPageId.clear();for(const C of e){const F=this._pageService.getPageCoordsUnderPointer(C.bottomLeft.x,C.bottomLeft.y),$=this._pageService.getPageCoordsUnderPointer(C.bottomRight.x,C.bottomRight.y),Y=this._pageService.getPageCoordsUnderPointer(C.topRight.x,C.topRight.y),V=this._pageService.getPageCoordsUnderPointer(C.topLeft.x,C.topLeft.y);if(!F||!$||!Y||!V)continue;if(new Set([F.pageId,$.pageId,Y.pageId,V.pageId]).size>1)throw new Error("Not all the text selection corners are inside the same page");const te=[V.pageX,V.pageY,Y.pageX,Y.pageY,F.pageX,F.pageY,$.pageX,$.pageY],se=F.pageId;this._coordsByPageId.has(se)?this._coordsByPageId.get(se).push(te):this._coordsByPageId.set(se,[te])}this.redraw(),this._coordsByPageId?.size?this.emitDataChanged(this._coordsByPageId.size,!0,!0):this.emitDataChanged(0)}onTextSelectionChange=e=>{this.updateCoords(e?.detail?.selectionInfos||[])};buildAnnotationDtos(e){const C=new Date().toISOString(),F=[];return this._coordsByPageId.forEach(($,Y)=>{const V={uuid:UUID.getRandomUuid(),annotationType:e,pageId:Y,dateCreated:C,dateModified:C,author:this._docService.userName||"unknown",textContent:null,rect:null,quadPoints:$.flat(),color:this._color,strokeWidth:this._strokeWidth,strokeDashGap:null};F.push(V)}),F}}class TextHighlightAnnotator extends TextMarkupAnnotator{constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}async saveAnnotationAsync(){if(!this._coordsByPageId.size)return;const e=this.buildAnnotationDtos("/Highlight");for(const C of e){const F=HighlightAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(C.pageId,F)}this.clear()}redraw(){const[e,C,F,$]=this._color||[0,0,0,1];this._svgGroupByPageId.forEach((Y,V)=>{Y.innerHTML="";const te=this._coordsByPageId.get(V);te?.length&&te.forEach(se=>{const[ne,ee,ie,ae,re,oe,ce,he]=se,de=document.createElementNS("http://www.w3.org/2000/svg","path");de.setAttribute("fill",`rgba(${e*255},${C*255},${F*255},${$})`),de.setAttribute("stroke","none"),de.setAttribute("d",`M ${re},${oe} L ${ce},${he} L ${ie},${ae} L ${ne},${ee} Z`),Y.append(de)})})}}class TextSquigglyAnnotator extends TextMarkupAnnotator{constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}async saveAnnotationAsync(){if(!this._coordsByPageId.size)return;const e=this.buildAnnotationDtos("/Squiggly");for(const C of e){const F=SquigglyAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(C.pageId,F)}this.clear()}redraw(){const[e,C,F,$]=this._color||[0,0,0,1];this._svgGroupByPageId.forEach((Y,V)=>{Y.innerHTML="";const te=this._coordsByPageId.get(V);te?.length&&te.forEach(se=>{const[,,,,ne,ee,ie,ae]=se,re=buildSquigglyLine(new u(ne,ee),new u(ie,ae),SquigglyAnnotation.squiggleSize);if(re?.length){let oe=`M ${re[0].x},${re[0].y} `;for(let he=1;he<re.length;he++)oe+=`L ${re[he].x},${re[he].y} `;const ce=document.createElementNS("http://www.w3.org/2000/svg","path");ce.setAttribute("fill","none"),ce.setAttribute("stroke",`rgba(${e*255},${C*255},${F*255},${$})`),ce.setAttribute("stroke-width",this._strokeWidth+""),ce.setAttribute("stroke-linecap","square"),ce.setAttribute("d",oe),Y.append(ce)}})})}}class TextStrikeoutAnnotator extends TextMarkupAnnotator{constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}async saveAnnotationAsync(){if(!this._coordsByPageId.size)return;const e=this.buildAnnotationDtos("/Strikeout");for(const C of e){const F=StrikeoutAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(C.pageId,F)}this.clear()}redraw(){const[e,C,F,$]=this._color||[0,0,0,1];this._svgGroupByPageId.forEach((Y,V)=>{Y.innerHTML="";const te=this._coordsByPageId.get(V),se=new u,ne=new u,ee=new u,ie=new u,ae=new u,re=new u;te?.length&&te.forEach(oe=>{const[ce,he,de,pe,fe,ye,_e,Ee]=oe;se.set(fe,ye),ne.set(_e,Ee),ee.set(de,pe),ie.set(ce,he),ae.setFromVec2(se).add(ie).multiplyByScalar(.5),re.setFromVec2(ne).add(ee).multiplyByScalar(.5);const be=document.createElementNS("http://www.w3.org/2000/svg","path");be.setAttribute("fill","none"),be.setAttribute("stroke",`rgba(${e*255},${C*255},${F*255},${$})`),be.setAttribute("stroke-width",this._strokeWidth+""),be.setAttribute("stroke-linecap","square"),be.setAttribute("d",`M ${ae.x},${ae.y} L ${re.x},${re.y}`),Y.append(be)})})}}class TextUnderlineAnnotator extends TextMarkupAnnotator{constructor(e,C,F,$){super(e,C,F,$||{}),this.init()}async saveAnnotationAsync(){if(!this._coordsByPageId.size)return;const e=this.buildAnnotationDtos("/Underline");for(const C of e){const F=UnderlineAnnotation.createFromDto(C);await this._docService.appendAnnotationToPageAsync(C.pageId,F)}this.clear()}redraw(){const[e,C,F,$]=this._color||[0,0,0,1];this._svgGroupByPageId.forEach((Y,V)=>{Y.innerHTML="";const te=this._coordsByPageId.get(V);te?.length&&te.forEach(se=>{const[,,,,ne,ee,ie,ae]=se,re=document.createElementNS("http://www.w3.org/2000/svg","path");re.setAttribute("fill","none"),re.setAttribute("stroke",`rgba(${e*255},${C*255},${F*255},${$})`),re.setAttribute("stroke-width",this._strokeWidth+""),re.setAttribute("stroke-linecap","square"),re.setAttribute("d",`M ${ne},${ee} L ${ie},${ae}`),Y.append(re)})})}}class TextNoteAnnotator extends TextAnnotator{_viewer;_pageId;_tempAnnotation;constructor(e,C,F,$){super(e,C,F.container,$||{}),this._viewer=F,this.init()}destroy(){this._tempAnnotation=null,super.destroy()}undo(){this.clear()}clear(){this._tempAnnotation=null}async saveAnnotationAsync(){if(!this._pageId||!this._tempAnnotation)return;const e=this._tempAnnotation?.Contents?.literal,C=await this._viewer.showTextDialogAsync(e);C!==null&&(await this._tempAnnotation.setTextContentAsync(C),await this._docService.appendAnnotationToPageAsync(this._pageId,this._tempAnnotation)),await this.createTempNoteAnnotationAsync()}init(){super.init(),this._overlay.addEventListener("pointermove",this.onPointerMove),this._overlay.addEventListener("pointerup",this.onPointerUp),this.createTempNoteAnnotationAsync()}async createTempNoteAnnotationAsync(){const e=TextAnnotation.createStandard(this._docService.userName,this._color),C=await e.renderApStreamAsync();this._svgGroup.innerHTML="",this._svgGroup.append(...C.clipPaths),this._svgGroup.append(...C.elements.map(F=>F.element)),this._tempAnnotation=e}onPointerMove=e=>{if(!e.isPrimary)return;const{clientX:C,clientY:F}=e,{height:$,top:Y,left:V}=this._parent.getBoundingClientRect(),te=Y+$,se=(C-V)/this._pageService.scale,ne=(te-F)/this._pageService.scale,[ee,ie,ae,re]=this._tempAnnotation.Rect;this._svgGroup.setAttribute("transform",`translate(${se-(ae-ee)/4} ${ne-(re-ie)/4})`),this.updatePointerCoords(C,F)};onPointerUp=async e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;if(e.pointerType==="touch"&&performance.now()-this._lastPointerDownInfo?.timestamp>700){const oe=this._lastPointerDownInfo?.clientX||0,ce=this._lastPointerDownInfo?.clientY||0;if(!(Math.abs(h(C,F,oe,ce))>7.5))return}const $=this._pageService.getPageCoordsUnderPointer(C,F);if(this._pointerCoordsInPageCS=$,!$||!this._tempAnnotation)return;const{pageId:Y,pageX:V,pageY:te,pageRotation:se}=this._pointerCoordsInPageCS,[ne,ee,ie,ae]=this._tempAnnotation.Rect;await this._tempAnnotation.moveToAsync(new u(V+(ie-ne)/4,te+(ae-ee)/4)),se&&await this._tempAnnotation.rotateByAsync(-se/180*Math.PI,new u(V,te)),this._pageId=Y,await this.saveAnnotationAsync()};refreshGroupPosition(){}}class FreeTextAnnotator extends TextAnnotator{_viewer;_pageId;_down;_rect;constructor(e,C,F,$){super(e,C,F.container,$||{}),this._viewer=F,this.init()}destroy(){this.emitDataChanged(0),super.destroy()}undo(){this.clear()}clear(){this._rect=null,this._svgGroup.innerHTML="",this.emitDataChanged(0)}async saveAnnotationAsync(){if(!this._pageId||!this._rect)return;const e=await this._viewer.showTextDialogAsync("");if(e!==null){const C=this._pageId,F=this.buildAnnotationDto(e);if(F){const $=await FreeTextAnnotation.createFromDtoAsync(F,this._docService.fontMap);await this._docService.appendAnnotationToPageAsync(C,$)}}this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}redrawRect(e,C){this._svgGroup.innerHTML="";const F=this._strokeWidth*2;if(C.x-e.x<=F||C.y-e.y<=F){this._rect=null;return}const[$,Y,V,te]=this._color||[0,0,0,1];this._rect=[e.x,e.y,C.x,C.y];const se=document.createElementNS("http://www.w3.org/2000/svg","rect");se.setAttribute("fill","white"),se.setAttribute("stroke",`rgba(${$*255},${Y*255},${V*255},${te})`),se.setAttribute("stroke-width",this._strokeWidth+""),se.setAttribute("x",e.x+""),se.setAttribute("y",e.y+""),se.setAttribute("width",C.x-e.x+""),se.setAttribute("height",C.y-e.y+""),this._svgGroup.append(se)}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;this._pageId=te,this._down=new u(Y,V),this.clear(),this.refreshGroupPosition();const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary||!this._down)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$,{min:te,max:se}=u.minMax(this._down,new u(Y,V));this.redrawRect(te,se)};onPointerUp=async e=>{if(!e.isPrimary)return;const C=e.target;C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),this._rect&&await this.saveAnnotationAsync()};refreshGroupPosition(){if(!this._pageId&&this._pageId!==0)return;const e=this._pageService.renderedPages.find(he=>he.id===this._pageId);if(!e){this._svgGroup.setAttribute("transform","scale(0)");return}const{height:C,width:F,top:$,left:Y}=e.viewContainer.getBoundingClientRect(),V=$+C,te=Y+F,{height:se,top:ne,left:ee}=this._overlay.getBoundingClientRect(),ie=ne+se,ae=e.rotation,re=e.scale;let oe,ce;switch(ae){case 0:oe=(Y-ee)/re,ce=(ie-V)/re;break;case 90:oe=(Y-ee)/re,ce=(ie-$)/re;break;case 180:oe=(te-ee)/re,ce=(ie-$)/re;break;case 270:oe=(te-ee)/re,ce=(ie-V)/re;break;default:throw new Error(`Invalid rotation degree: ${ae}`)}this._svgGroup.setAttribute("transform",`translate(${oe} ${ce}) rotate(${-ae})`)}buildAnnotationDto(e){const C=this._strokeWidth/2,F=C,$=C,Y=C,V=C,[te,se,ne,ee]=this._rect,ie=(te+ne)/2,ae=(se+ee)/2,re={bl:[te,se],tr:[ne,ee],br:[ne,se],tl:[te,ee],l:[te,ae],t:[ie,ee],r:[ne,ae],b:[ie,se]},oe=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/FreeText",pageId:null,dateCreated:oe,dateModified:oe,author:this._docService.userName||"unknown",textContent:e,rect:[te-F,se-V,ne+Y,ee+$],points:re,color:[this._color[0],this._color[1],this._color[2],1],strokeWidth:this._strokeWidth,strokeDashGap:null}}}class FreeTextCalloutAnnotator extends TextAnnotator{_viewer;_pageId;_down;_rect;_points;constructor(e,C,F,$){super(e,C,F.container,$||{}),this._viewer=F,this.init()}destroy(){this.emitDataChanged(0),super.destroy()}undo(){this.clear()}clear(){this._rect=null,this._points=null,this._svgGroup.innerHTML="",this.emitDataChanged(0)}async saveAnnotationAsync(){if(!this._pageId||!this._rect)return;const e=await this._viewer.showTextDialogAsync("");if(e!==null){const C=this._pageId,F=this.buildAnnotationDto(e);if(F){const $=await FreeTextAnnotation.createFromDtoAsync(F,this._docService.fontMap);await this._docService.appendAnnotationToPageAsync(C,$)}}this.clear()}init(){super.init(),this._overlay.addEventListener("pointerdown",this.onPointerDown)}initPoints(){const[e,C,F,$]=this._rect,Y=(e+F)/2,V=(C+$)/2,te={bl:[e,C],tr:[F,$],br:[F,C],tl:[e,$],l:[e,V],t:[Y,$],r:[F,V],b:[Y,C]};this._points=te,this.emitDataChanged(2,!0,!0)}redrawRect(e,C){this._svgGroup.innerHTML="";const F=this._strokeWidth*2;if(C.x-e.x<=F||C.y-e.y<=F){this._rect=null;return}const[$,Y,V,te]=this._color||[0,0,0,1];this._rect=[e.x,e.y,C.x,C.y];const se=document.createElementNS("http://www.w3.org/2000/svg","rect");se.setAttribute("fill","white"),se.setAttribute("stroke",`rgba(${$*255},${Y*255},${V*255},${te})`),se.setAttribute("stroke-width",this._strokeWidth+""),se.setAttribute("x",e.x+""),se.setAttribute("y",e.y+""),se.setAttribute("width",C.x-e.x+""),se.setAttribute("height",C.y-e.y+""),this._svgGroup.append(se)}redrawCallout(){const e=this._svgGroup.lastChild;e.remove(),this._svgGroup.innerHTML="";const[C,F,$,Y]=this._color||[0,0,0,1],V=document.createElementNS("http://www.w3.org/2000/svg","path");V.setAttribute("fill","none"),V.setAttribute("stroke",`rgba(${C*255},${F*255},${$*255},${Y})`),V.setAttribute("stroke-width",this._strokeWidth+"");let te=`M${this._points.cob[0]},${this._points.cob[1]} `;this._points.cok&&(te+=`L${this._points.cok[0]},${this._points.cok[1]} `),te+=`L${this._points.cop[0]},${this._points.cop[1]}`,V.setAttribute("d",te),this._svgGroup.append(V),this._svgGroup.append(e)}onPointerDown=e=>{if(!e.isPrimary||e.button===2)return;const{clientX:C,clientY:F}=e;this.updatePointerCoords(C,F);const $=this._pointerCoordsInPageCS;if(!$)return;const{pageX:Y,pageY:V,pageId:te}=$;te!==this._pageId&&this.clear(),this._pageId=te,this._down=new u(Y,V),this.refreshGroupPosition();const se=e.target;se.addEventListener("pointermove",this.onPointerMove),se.addEventListener("pointerup",this.onPointerUp),se.addEventListener("pointerout",this.onPointerUp),se.setPointerCapture(e.pointerId)};onPointerMove=e=>{if(!e.isPrimary||!this._down)return;const{clientX:C,clientY:F}=e;if(this.updatePointerCoords(C,F),!this._points){const $=this._pointerCoordsInPageCS;if(!$||$.pageId!==this._pageId)return;const{pageX:Y,pageY:V}=$,{min:te,max:se}=u.minMax(this._down,new u(Y,V));this.redrawRect(te,se)}};onPointerUp=e=>{if(!e.isPrimary)return;const C=e.target;if(C.removeEventListener("pointermove",this.onPointerMove),C.removeEventListener("pointerup",this.onPointerUp),C.removeEventListener("pointerout",this.onPointerUp),C.releasePointerCapture(e.pointerId),!this._rect)return;if(!this._points){this.initPoints();return}const F=this._pointerCoordsInPageCS;if(!F||F.pageId!==this._pageId)return;const{pageX:$,pageY:Y}=F,V=new u($,Y),{l:te,b:se,r:ne,t:ee}=this._points,ie=new u(te[0],te[1]),ae=new u(se[0],se[1]),re=new u(ne[0],ne[1]),oe=new u(ee[0],ee[1]);let ce=ie,he=u.subtract(V,ie).getMagnitude();const de=u.subtract(V,ae).getMagnitude();de<he&&(he=de,ce=ae);const pe=u.subtract(V,re).getMagnitude();pe<he&&(he=pe,ce=re);const fe=u.subtract(V,oe).getMagnitude();fe<he&&(he=fe,ce=oe),this._points.cob=ce.toFloatArray(),this._points.cop?this._points.cok=V.toFloatArray():this._points.cop=V.toFloatArray(),this.redrawCallout()};refreshGroupPosition(){if(!this._pageId&&this._pageId!==0)return;const e=this._pageService.renderedPages.find(he=>he.id===this._pageId);if(!e){this._svgGroup.setAttribute("transform","scale(0)");return}const{height:C,width:F,top:$,left:Y}=e.viewContainer.getBoundingClientRect(),V=$+C,te=Y+F,{height:se,top:ne,left:ee}=this._overlay.getBoundingClientRect(),ie=ne+se,ae=e.rotation,re=e.scale;let oe,ce;switch(ae){case 0:oe=(Y-ee)/re,ce=(ie-V)/re;break;case 90:oe=(Y-ee)/re,ce=(ie-$)/re;break;case 180:oe=(te-ee)/re,ce=(ie-$)/re;break;case 270:oe=(te-ee)/re,ce=(ie-V)/re;break;default:throw new Error(`Invalid rotation degree: ${ae}`)}this._svgGroup.setAttribute("transform",`translate(${oe} ${ce}) rotate(${-ae})`)}buildAnnotationDto(e){let C;this._points.cob?C=(Math.max(this._strokeWidth*LINE_END_MULTIPLIER,LINE_END_MIN_SIZE)+this._strokeWidth)/2:C=this._strokeWidth/2;const F=C,$=C,Y=C,V=C,{bl:te,tr:se,br:ne,tl:ee,l:ie,t:ae,r:re,b:oe,cob:ce,cok:he,cop:de}=this._points,{min:pe,max:fe}=u.minMax(new u(te[0],te[1]),new u(se[0],se[1]),new u(ne[0],ne[1]),new u(ee[0],ee[1]),new u(ie[0],ie[1]),new u(ae[0],ae[1]),new u(re[0],re[1]),new u(oe[0],oe[1]),ce?new u(ce[0],ce[1]):new u(te[0],te[1]),he?new u(he[0],he[1]):new u(te[0],te[1]),de?new u(de[0],de[1]):new u(te[0],te[1])),ye=new Date().toISOString();return{uuid:UUID.getRandomUuid(),annotationType:"/FreeText",pageId:null,dateCreated:ye,dateModified:ye,author:this._docService.userName||"unknown",textContent:e,rect:[pe.x-F,pe.y-V,fe.x+Y,fe.y+$],points:this._points,intent:this._points.cob?freeTextIntents.WITH_CALLOUT:freeTextIntents.PLAIN_TEXT,calloutEndingType:this._points.cob?lineEndingTypes.ARROW_OPEN:null,color:[this._color[0],this._color[1],this._color[2],1],strokeWidth:this._strokeWidth,strokeDashGap:null}}}const textAnnotatorTypes=["highlight","strikeout","squiggly","underline","note","freeText","freeTextCallout"];class TextAnnotatorFactory{_lastType;_lastColor;_lastStrokeWidth;createAnnotator(e,C,F,$,Y){if(!e)throw new Error("Document service is not defined");if(!C)throw new Error("Page service is not defined");if(!F)throw new Error("Viewer is not defined");Y||=this._lastType||"highlight",this._lastType=Y;const V=$?.color||this._lastColor||[0,0,0,.9];this._lastColor=V;const te=$?.strokeWidth||this._lastStrokeWidth||2;this._lastStrokeWidth=te;const se={color:V,strokeWidth:te};switch(Y){case"note":return new TextNoteAnnotator(e,C,F,se);case"freeText":return new FreeTextAnnotator(e,C,F,se);case"freeTextCallout":return new FreeTextCalloutAnnotator(e,C,F,se);case"highlight":return new TextHighlightAnnotator(e,C,F.container,se);case"squiggly":return new TextSquigglyAnnotator(e,C,F.container,se);case"strikeout":return new TextStrikeoutAnnotator(e,C,F.container,se);case"underline":return new TextUnderlineAnnotator(e,C,F.container,se);default:throw new Error(`Invalid geometric annotator type: ${Y}`)}}}class AnnotatorService{_annotationColors=[[0,0,0,.5],[.804,0,0,.5],[0,.804,0,.5],[0,0,.804,.5],[1,.5,0,.5],[1,.2,1,.5]];_docService;_pageService;_customStampService;_viewer;_contextMenu;_geometricFactory;_textFactory;_viewerResizeObserver;_mode;get mode(){return this._mode}set mode(e){this.setMode(e)}_strokeColor=this._annotationColors[0];_strokeWidth=3;_stampType=supportedStampTypes[0].type;_stampCreationInfo;_geometricCloudMode=!1;_geometricSubmode=geometricAnnotatorTypes[0];_textSubmode=textAnnotatorTypes[0];_annotator;get annotator(){return this._annotator}constructor(e,C,F,$){if(!e)throw new Error("Document service is not defined");if(!C)throw new Error("Page service is not defined");if(!F)throw new Error("Custom stamp service is not defined");if(!$)throw new Error("Viewer is not defined");this._docService=e,this._pageService=C,this._customStampService=F,this._viewer=$,this.init()}destroy(){this._docService.eventService.removeListener(pagesRenderedEvent,this.onPagesRendered),this._viewer.container.removeEventListener("contextmenu",this.onContextMenu),this._viewerResizeObserver?.disconnect(),this._contextMenu?.destroy(),this._annotator?.destroy()}init(){this._docService.eventService.addListener(pagesRenderedEvent,this.onPagesRendered),this._viewer.container.addEventListener("contextmenu",this.onContextMenu);const e=new ResizeObserver(C=>{this._contextMenu?.hide()});e.observe(this._viewer.container),this._viewerResizeObserver=e,this._contextMenu=new ContextMenu,this._geometricFactory=new GeometricAnnotatorFactory,this._textFactory=new TextAnnotatorFactory}setMode(e){switch(e||=this._mode,this._contextMenu.content=[],this._annotator?.destroy(),this._docService.setSelectedAnnotation(null),this._mode=e,this._mode==="text"&&(this._textSubmode==="highlight"||this._textSubmode==="squiggly"||this._textSubmode==="strikeout"||this._textSubmode==="underline")?this._viewer.container.classList.add("mode-text-markup"):this._viewer.container.classList.remove("mode-text-markup"),e){case"select":this._contextMenu.enabled=!1;return;case"stamp":this._annotator=new StampAnnotator(this._docService,this._pageService,this._viewer.container,this._stampType,this._stampCreationInfo);break;case"pen":this._annotator=new PenAnnotator(this._docService,this._pageService,this._viewer.container,{strokeWidth:this._strokeWidth,color:this._strokeColor});break;case"geometric":this._annotator=this._geometricFactory.createAnnotator(this._docService,this._pageService,this._viewer.container,{strokeWidth:this._strokeWidth,color:this._strokeColor,cloudMode:this._geometricCloudMode},this._geometricSubmode);break;case"text":this._strokeWidth=2,this._annotator=this._textFactory.createAnnotator(this._docService,this._pageService,this._viewer,{strokeWidth:this._strokeWidth,color:this._strokeColor},this._textSubmode);break;default:throw new Error(`Invalid annotation mode: ${e}`)}const C=this.buildContextMenuContent();this._contextMenu.content=C,this._contextMenu.enabled=!0}onContextMenu=e=>{this._contextMenu.enabled&&(e.preventDefault(),this._contextMenu.show(new u(e.clientX,e.clientY),this._viewer.container))};onPagesRendered=e=>{this._contextMenu.hide()};buildContextMenuContent(){switch(this._mode){case"select":return[];case"stamp":return[this.buildCustomStampButtons(),this.buildStampTypePicker()];case"pen":return[this.buildStrokeColorPicker(),this.buildStrokeWidthSlider(!1)];case"geometric":return[this.buildGeometricSubmodePicker(),this.buildStrokeColorPicker(),this.buildStrokeWidthSlider(!0)];case"text":return[this.buildTextSubmodePicker(),this.buildStrokeColorPicker()];default:throw new Error(`Invalid annotation mode: ${this._mode}`)}}buildCustomStampButtons(){const e=DomUtils.htmlToElements(HtmlTemplates.stampContextButtonsHtml)[0];if(e.querySelector(".stamp-load-image").addEventListener("click",()=>{this._customStampService.startLoadingImage()}),e.querySelector(".stamp-draw-image").addEventListener("click",()=>{this._customStampService.startDrawing()}),this._stampCreationInfo){const C=e.querySelector(".stamp-delete");C.addEventListener("click",()=>{this._customStampService.removeCustomStamp(this._stampType)}),C.classList.remove("disabled")}return e}buildStampTypePicker(){const e=supportedStampTypes,C=document.createElement("div");return C.classList.add("context-menu-content","column"),[...e,...this._customStampService.getCustomStamps()].forEach(F=>{const $=document.createElement("div");$.classList.add("context-menu-stamp-select-button"),F.type===this._stampType&&$.classList.add("on"),$.addEventListener("click",()=>{this._stampType=F.type,F.imageData?this._stampCreationInfo=F:this._stampCreationInfo=null,this.setMode()});const Y=document.createElement("div");Y.innerHTML=F.name,$.append(Y),C.append($)}),C}buildGeometricSubmodePicker(){const e=document.createElement("div");return e.classList.add("context-menu-content","row"),geometricAnnotatorTypes.forEach(C=>{const F=document.createElement("div");F.classList.add("panel-button"),C===this._geometricSubmode&&F.classList.add("on"),F.addEventListener("click",()=>{this._geometricSubmode=C,this.setMode()}),F.innerHTML=Icons.geometricIcons[C],e.append(F)}),e}buildTextSubmodePicker(){const e=document.createElement("div");return e.classList.add("context-menu-content","row"),textAnnotatorTypes.forEach(C=>{const F=document.createElement("div");F.classList.add("panel-button"),C===this._textSubmode&&F.classList.add("on"),F.addEventListener("click",()=>{this._textSubmode=C,this.setMode()}),F.innerHTML=Icons.textIcons[C],e.append(F)}),e}buildStrokeColorPicker(){const e=document.createElement("div");return e.classList.add("context-menu-content","row"),this._annotationColors.forEach(C=>{const F=document.createElement("div");F.classList.add("panel-button"),C===this._strokeColor&&F.classList.add("on"),F.addEventListener("click",()=>{this._strokeColor=C,this.setMode()});const $=document.createElement("div");$.classList.add("context-menu-color-icon"),$.style.backgroundColor=`rgb(${C[0]*255},${C[1]*255},${C[2]*255})`,F.append($),e.append(F)}),e}buildStrokeWidthSlider(e){const C=!e||this._geometricSubmode==="polyline"||this._geometricSubmode==="line"||this._geometricSubmode==="arrow",F=document.createElement("div");F.classList.add("context-menu-content","row");const $=document.createElement("div");$.classList.add("panel-button"),C?$.classList.add("disabled"):(this._geometricCloudMode&&$.classList.add("on"),$.addEventListener("click",()=>{this._geometricCloudMode=!0,this.setMode()})),$.innerHTML=Icons.lineTypeIcons.cloudy,F.append($);const Y=document.createElement("div");Y.classList.add("panel-button"),C?Y.classList.add("disabled"):(this._geometricCloudMode||Y.classList.add("on"),Y.addEventListener("click",()=>{this._geometricCloudMode=!1,this.setMode()})),Y.innerHTML=Icons.lineTypeIcons.straight,F.append(Y);const V=document.createElement("input");return V.setAttribute("type","range"),V.setAttribute("min","1"),V.setAttribute("max","32"),V.setAttribute("step","1"),V.setAttribute("value",this._strokeWidth+""),V.classList.add("context-menu-slider"),V.addEventListener("change",()=>{this._strokeWidth=V.valueAsNumber,this.setMode()}),F.append(V),F}}const viewerModes=["text","hand","annotation","comparison"];class ModeService{enabledModes;_mode;get mode(){return this._mode}set mode(e){this._onModeChangeStarted?.size&&this._onModeChangeStarted.forEach(C=>C()),!(!e||e===this._mode)&&(this._mode=e)}_onModeChangeStarted=new Set;constructor(e){const C=[];if(viewerModes.forEach(F=>{(!e?.disabledModes?.length||!e.disabledModes.includes(F))&&C.push(F)}),!C.length)throw new Error("All viewer modes are disabled");this.enabledModes=C}addOnModeChangeStarted(e){this._onModeChangeStarted.add(e)}removeOnModeChangeStarted(e){this._onModeChangeStarted.delete(e)}}class PdfLoaderService{_eventService;_pdfLoadingTask;_pdfDocument;_pdfPageProxies;get pageCount(){return this._pdfDocument?.numPages||0}get docLoaded(){return!!this._pdfDocument}_docService;get docService(){return this._docService}get docProxy(){return this._pdfDocument}_fileName;get fileName(){return this._fileName}constructor(e){if(!e)throw new Error("Event controller is not defined");this._eventService=e}destroy(){this._pdfLoadingTask?.destroy(),this._pdfDocument&&(this._pdfDocument.cleanup(),this._pdfDocument.destroy()),this._docService?.destroy()}async openPdfAsync(e,C,F,$,Y){await this.closePdfAsync();let V,te;try{V=await DomUtils.loadFileDataAsync(e)}catch(ie){throw new Error(`Cannot load file data: ${ie.message}`)}const se=await DocumentService.createNewAsync(this._eventService,V,F);let ne;for(;;){if(!se.tryAuthenticate(ne)){if(ne=await $(),ne===null)throw new Error("File loading cancelled: authentication aborted");continue}break}try{if(this._pdfLoadingTask)return await this.closePdfAsync(),this.openPdfAsync(V,F,C,$,Y);const ie=await se.getDataWithoutSupportedAnnotationsAsync();this._pdfLoadingTask=pdfExports.getDocument({data:ie,password:ne}),Y&&(this._pdfLoadingTask.onProgress=Y),te=await this._pdfLoadingTask.promise,this._pdfLoadingTask=null}catch(ie){throw new Error(`Cannot open PDF: ${ie.message}`)}this._pdfDocument=te;const ee=new Map;for(let ie=0;ie<te.numPages;ie++){const ae=await this._pdfDocument?.getPage(ie+1);ee.set(ie,ae)}this._pdfPageProxies=ee,this._docService=se,this._fileName=C}async closePdfAsync(){this._pdfLoadingTask&&(this._pdfLoadingTask.destroyed||await this._pdfLoadingTask.destroy(),this._pdfLoadingTask=null),this._pdfPageProxies=null,this._pdfDocument?.destroy(),this._pdfDocument=null,this._docService?.destroy(),this._docService=null,this._fileName=null}getPage(e){return this._pdfPageProxies?.size?this._pdfPageProxies.get(e):null}}class ComparisonService{_maxChangedPixels;_comparisonResult;constructor(){}destroy(){}getComparisonResult(){return this._comparisonResult}getComparisonResultForPage(e){return this.getComparisonResult()?.get(e)}clearComparisonResult(){return this._comparisonResult=null}async compareAsync(e,C,F){const $=new Map;if(!e||!C)return $;const Y=e.numPages,V=C.numPages;for(let te=0;te<Y;te++){const se=await e.getPage(te+1),ne=te<V?await C.getPage(te+1):null,ee=await this.comparePagesAsync(se,ne,F?.get(te));$.set(te,ee)}return this._comparisonResult=$,this._comparisonResult}async comparePagesAsync(e,C,F){const $=await this.renderPageAsync(e),Y=await this.renderPageAsync(C);return await this.compareImageDataAsync($,Y,{offset:F})}async renderPageAsync(e){if(!e)return null;const C=e.getViewport({scale:1,rotation:0}),{width:F,height:$}=C,Y=document.createElement("canvas");Y.width=F,Y.height=$;const V=Y.getContext("2d"),te={canvasContext:V,viewport:C,enableWebGL:!0};return await e.render(te).promise,V.getImageData(0,0,F,$)}async compareImageDataAsync(e,C,F){const $=F?.threshold??5,Y=F?.offset||[0,0];if(!e)return{areas:[],offset:[0,0]};if(!C)return{areas:[[0,0,e.width,e.height]],offset:[0,0]};const V=[],te=e.width,se=e.height,ne=C.width,ee=C.height,ie=e.data,ae=C.data;let re,oe,ce,he;for(let pe=0;pe<te;pe++)for(let fe=0;fe<se;fe++)ce=pe+Y[0],he=fe+Y[1],!(ce<0||he<0||ce>=ne||he>=ee)&&(re=(te*fe+pe)*4,oe=(ne*he+ce)*4,(ie[re]!==ae[oe]||ie[re+1]!==ae[oe+1]||ie[re+2]!==ae[oe+2]||ie[re+3]!==ae[oe+3])&&this.addPixelToAabbs(V,pe,fe,$,te,se));return{areas:this.mergeIntersectingAabbs(V),offset:Y}}addPixelToAabbs(e,C,F,$,Y,V){let te;const se=Math.max(C-$,0),ne=Math.max(F-$,0),ee=Math.min(C+$,Y),ie=Math.min(F+$,V);for(let ae=0;ae<e.length;ae++){const[re,oe,ce,he]=e[ae];if(Math.max(se,re)<Math.min(ee,ce)&&Math.max(ne,oe)<Math.min(ie,he)){e[ae]=[Math.min(se,re),Math.min(ne,oe),Math.max(ee,ce),Math.max(ie,he)],te=!0;break}}te||e.push([se,ne,ee,ie])}async compareImageDataDbscanAsync(e,C,F=10){if(!e)return[];if(!C)return[[0,0,e.width,e.height]];const $=this.getChangedPixels(e,C);if($.length>this._maxChangedPixels)return[[0,0,e.width,e.height]];const Y=await DBSCAN.runAsync($,F,1),V=this.convertClustersToAabbs(Y);return this.mergeIntersectingAabbs(V)}getChangedPixels(e,C){const F=e.width,$=e.height,Y=C.width,V=C.height,te=e.data,se=C.data,ne=[];let ee,ie;for(let ae=0;ae<F;ae++)for(let re=0;re<$;re++){if(ae>=Y||re>=V){ne.push(new u(ae,re));continue}ee=(F*re+ae)*4,ie=(Y*re+ae)*4,(te[ee]!==se[ie]||te[ee+1]!==se[ie+1]||te[ee+2]!==se[ie+2]||te[ee+3]!==se[ie+3])&&ne.push(new u(ae,re))}return ne}convertClustersToAabbs(e){const C=[];for(const F of e){if(!F?.length)continue;let $;for(const Y of F){if(!$){$=[Y.x,Y.y,Y.x,Y.y];continue}Y.x<$[0]?$[0]=Y.x:Y.x>$[2]&&($[2]=Y.x),Y.y<$[1]?$[1]=Y.y:Y.y>$[3]&&($[3]=Y.y)}C.push($)}return C}mergeIntersectingAabbs(e){const C=[];for(const[F,$,Y,V]of e){let te;for(let se=0;se<C.length;se++){const[ne,ee,ie,ae]=C[se];if(Math.max(F,ne)<Math.min(Y,ie)&&Math.max($,ee)<Math.min(V,ae)){C[se]=[Math.min(F,ne),Math.min($,ee),Math.max(Y,ie),Math.max(V,ae)],te=!0;break}}te||C.push([F,$,Y,V])}return C}}class DBSCAN{_distance;_minPoints;_points;_clusters=[];_noise=[];_visited;_assigned;constructor(e,C,F){this._points=e??[],this._distance=Math.max(C,0)||1,this._minPoints=Math.max(F,1),this._visited=new Array(e.length),this._assigned=new Array(e.length)}static async runAsync(e,C,F){return new DBSCAN(e,C??1,F??1).runClustering()}runClustering(){if(!this._points.length)return[];for(let e=0;e<this._points.length;e++)if(!this._visited[e]){this._visited[e]=!0;const C=this.getPointNeighbourIds(e);if(C.length<this._minPoints)this._noise.push(e);else{const F=this._clusters.length;this._clusters.push([]),this.addPointToCluster(e,F),this.expandCluster(F,C)}}return this._clusters}expandCluster(e,C){for(let F=0;F<C.length;F++){const $=C[F];if(!this._visited[$]){this._visited[$]=!0;const Y=this.getPointNeighbourIds($);Y.length>=this._minPoints&&C.push(...Y)}this._assigned[$]||this.addPointToCluster($,e)}}addPointToCluster(e,C){this._clusters[C].push(this._points[e]),this._assigned[e]=!0}getPointNeighbourIds(e){const C=[];for(let F=0;F<this._points.length;F++)u.getDistance(this._points[e],this._points[F])<this._distance&&C.push(F);return C}}const docChangeEvent="tspdf-docchangeevent";class DocChangeEvent extends CustomEvent{constructor(e){super(docChangeEvent,{detail:e})}}class DocManagerService{_eventService;_dummyDiv=document.createElement("div");_docLoaders;_comparisonService;get comparisonService(){return this._comparisonService}get docService(){return this._docLoaders.main.docService}get pageCount(){return this._docLoaders.main.pageCount}get docLoaded(){return this._docLoaders.main.docLoaded}get fileName(){return this._docLoaders.main.fileName}constructor(e){if(!e)throw new Error("Main event service is not defined");this._eventService=e,this._docLoaders={main:new PdfLoaderService(e),compared:new PdfLoaderService(new EventService(this._dummyDiv))},this._comparisonService=new ComparisonService}destroy(){this._comparisonService.destroy(),Object.keys(this._docLoaders).forEach(e=>{this._docLoaders[e].destroy()})}async openPdfAsync(e,C,F,$,Y,V){await this._docLoaders[e].openPdfAsync(C,F,$,Y,V),e==="main"?(await this.closePdfAsync("compared"),this._eventService.dispatchEvent(new DocChangeEvent({action:"open",type:"main"}))):e==="compared"&&(await this.runComparisonAsync(),this._eventService.dispatchEvent(new DocChangeEvent({action:"open",type:"compared"})))}async closePdfAsync(e){await this._docLoaders[e].closePdfAsync(),e==="main"?(await this.closePdfAsync("compared"),this._eventService.dispatchEvent(new DocChangeEvent({action:"close",type:"main"}))):e==="compared"&&(await this._comparisonService.clearComparisonResult(),this._eventService.dispatchEvent(new DocChangeEvent({action:"close",type:"compared"})))}async runComparisonAsync(){await this._comparisonService.compareAsync(this._docLoaders.main.docProxy,this._docLoaders.compared.docProxy)}getPageProxy(e,C){return this._docLoaders[e].getPage(C)}getComparisonResultForPage(e){return this._comparisonService.getComparisonResultForPage(e)}}class Viewer{_minScale;_maxScale;_pageService;_container;get container(){return this._container}_modeService;_scale=1;get scale(){return this._scale}_pointerInfo={lastPos:null,downPos:null,downScroll:null};_pinchInfo={active:!1,lastDist:0,minDist:10,sensitivity:.025,target:null};_dialogClose;constructor(e,C,F,$){if(!e)throw new Error("Mode service is not defined");if(!C)throw new Error("Page service is not defined");if(!F)throw new Error("Container is not defined");this._modeService=e,this._pageService=C,this._container=F,this._minScale=$?.minScale||.25,this._maxScale=$?.maxScale||4,this._modeService.addOnModeChangeStarted(()=>{this?._dialogClose&&this._dialogClose()}),this.init()}destroy(){this._pageService.eventService.removeListener(pagesLoadedEvent,this.onPagesLoaded),this._pageService.eventService.removeListener(currentPageChangeRequestEvent,this.onScrollRequest),this._container.removeEventListener("scroll",this.onScroll),this._container.removeEventListener("wheel",this.onWheelZoom),this._container.removeEventListener("pointermove",this.onPointerMove),this._container.removeEventListener("pointerdown",this.onPointerDownScroll),this._container.removeEventListener("touchstart",this.onTouchZoom)}zoomOut(){this.zoomOutCentered()}zoomIn(){this.zoomInCentered()}zoomFitViewer(){const e=this._container.getBoundingClientRect().width,C=this._pageService.getCurrentPage().viewContainer.getBoundingClientRect().width,F=n$1((e-20)/C*this._scale,this._minScale,this._maxScale);this.setScale(F),this.scrollToPage(this._pageService.currentPageIndex)}zoomFitPage(){const{width:e,height:C}=this._container.getBoundingClientRect(),{width:F,height:$}=this._pageService.getCurrentPage().viewContainer.getBoundingClientRect(),Y=n$1((e-20)/F*this._scale,this._minScale,this._maxScale),V=n$1((C-20)/$*this._scale,this._minScale,this._maxScale);this.setScale(Math.min(Y,V)),this.scrollToPage(this._pageService.currentPageIndex)}renderVisible(e){this._pageService.renderVisiblePages(this._container,e)}async showTextDialogAsync(e){if(this._dialogClose)return;const C=DomUtils.htmlToElements(HtmlTemplates.textDialogHtml)[0];C.style.top=this._container.scrollTop+"px",C.style.left=this._container.scrollLeft+"px",this._container.append(C),this._container.classList.add("dialog-shown");let F=e||"";const $=C.querySelector(".text-input");$.placeholder="Enter text...",$.value=F,$.addEventListener("change",()=>F=$.value);const V=await new Promise((te,se)=>{const ne=()=>{te(F||"")},ee=()=>{te(null)};C.addEventListener("click",ie=>{ie.target===C&&ee()}),C.querySelector(".text-ok").addEventListener("click",ne),C.querySelector(".text-cancel").addEventListener("click",ee),this._dialogClose=()=>te(null)});return this._dialogClose=null,C.remove(),this._container.classList.remove("dialog-shown"),V}scrollToPage(e){if(!this._pageService.pages.length)return;const{top:C}=this._container.getBoundingClientRect(),{top:F}=this._pageService.getPage(e).viewContainer.getBoundingClientRect(),$=F-(C-this._container.scrollTop)-20;this._container.scrollTo(this._container.scrollLeft,$)}init(){this._container.addEventListener("scroll",this.onScroll),this._container.addEventListener("wheel",this.onWheelZoom,{passive:!1}),this._container.addEventListener("pointermove",this.onPointerMove),this._container.addEventListener("pointerdown",this.onPointerDownScroll),this._container.addEventListener("touchstart",this.onTouchZoom),this._pageService.eventService.addListener(pagesLoadedEvent,this.onPagesLoaded),this._pageService.eventService.addListener(currentPageChangeRequestEvent,this.onScrollRequest)}onPagesLoaded=e=>{e.detail.pages?.forEach(C=>{C.scale=this._scale,this._container.append(C.viewContainer)}),this.renderVisible()};onScrollRequest=e=>{this.scrollToPage(e.detail.pageIndex)};onPointerMove=e=>{const{clientX:C,clientY:F}=e;this._pointerInfo.lastPos=new u(C,F)};onScroll=e=>{this.renderVisible()};onPointerDownScroll=e=>{if(this._modeService.mode!=="hand")return;const{clientX:C,clientY:F}=e;this._pointerInfo.downPos=new u(C,F),this._pointerInfo.downScroll=new u(this._container.scrollLeft,this._container.scrollTop);const $=te=>{const{x:se,y:ne}=this._pointerInfo.downPos,{x:ee,y:ie}=this._pointerInfo.downScroll,ae=te.clientX-se,re=te.clientY-ne;this._container.scrollTo(ee-ae,ie-re)},Y=te=>{this._pointerInfo.downPos=null,this._pointerInfo.downScroll=null;const se=te.target;se.removeEventListener("pointermove",$),se.removeEventListener("pointerup",Y),se.removeEventListener("pointerout",Y),se.releasePointerCapture(te.pointerId)},V=e.target;V.setPointerCapture(e.pointerId),V.addEventListener("pointermove",$),V.addEventListener("pointerup",Y),V.addEventListener("pointerout",Y)};setScale(e,C=null){if(!e||e===this._scale)return;let F,$,Y;if(C)for(const V of this._pageService.pages){const{x:te,y:se}=C,{x:ne,y:ee,width:ie,height:ae}=V.viewContainer.getBoundingClientRect();if(ne<=te&&ne+ie>=te&&ee<=se&&ee+ae>=se){F=V.viewContainer,$=(te-ne)/ie,Y=(se-ee)/ae;break}}if(this._scale=e,this._pageService.scale=e,F&&(this._container.scrollHeight>this._container.clientHeight||this._container.scrollWidth>this._container.clientWidth)){const{x:V,y:te}=C,{x:se,y:ne,width:ee,height:ie}=F.getBoundingClientRect(),ae=se+ee*$,re=ne+ie*Y;let oe=this._container.scrollLeft+(ae-V),ce=this._container.scrollTop+(re-te);if(oe=oe<0?0:oe,ce=ce<0?0:ce,ce!==this._container.scrollTop||oe!==this._container.scrollLeft){this._container.scrollTo(oe,ce);return}}setTimeout(()=>this.renderVisible(),0)}zoom(e,C=null){const F=n$1(this._scale+e,this._minScale,this._maxScale);this.setScale(F,C||this.getCenterPosition())}zoomOutCentered(e=null){this.zoom(-.25,e)}zoomInCentered(e=null){this.zoom(.25,e)}getCenterPosition(){const{x:e,y:C,width:F,height:$}=this._container.getBoundingClientRect();return new u(e+F/2,C+$/2)}onWheelZoom=e=>{e.ctrlKey&&(e.preventDefault(),e.deltaY>0?this.zoomOutCentered(this._pointerInfo.lastPos):this.zoomInCentered(this._pointerInfo.lastPos))};onTouchZoom=e=>{if(e.touches.length!==2)return;const C=e.touches[0],F=e.touches[1];this._pinchInfo.active=!0,this._pinchInfo.lastDist=h(C.clientX,C.clientY,F.clientX,F.clientY);const $=V=>{if(V.touches.length!==2)return;const te=V.touches[0],se=V.touches[1],ne=h(te.clientX,te.clientY,se.clientX,se.clientY),ee=ne-this._pinchInfo.lastDist,ie=Math.floor(ee/this._pinchInfo.minDist);if(ie){const ae=new u((se.clientX+te.clientX)/2,(se.clientY+te.clientY)/2);this._pinchInfo.lastDist=ne,this.zoom(ie*this._pinchInfo.sensitivity,ae)}},Y=V=>{this._pinchInfo.active=!1,this._pinchInfo.lastDist=0,e.target.removeEventListener("touchmove",$),e.target.removeEventListener("touchend",Y),e.target.removeEventListener("touchcancel",Y)};e.target.addEventListener("touchmove",$),e.target.addEventListener("touchend",Y),e.target.addEventListener("touchcancel",Y)}}class Previewer{_pageService;_container;_hidden=!0;get hidden(){return this._hidden}constructor(e,C){if(!e)throw new Error("Page service is not defined");if(!C)throw new Error("Container is not defined");this._pageService=e,this._container=C,this.init()}destroy(){this._pageService.eventService.removeListener(pagesLoadedEvent,this.onPagesLoaded),this._pageService.eventService.removeListener(currentPageChangeEvent,this.onCurrentPageChanged)}show(){this._hidden=!1,setTimeout(()=>this.renderVisible(),1e3)}hide(){this._hidden=!0}renderVisible(){this._hidden||this._pageService.renderVisiblePreviews(this._container)}init(){this._container.addEventListener("scroll",this.onPreviewerScroll),this._pageService.eventService.addListener(pagesLoadedEvent,this.onPagesLoaded),this._pageService.eventService.addListener(currentPageChangeEvent,this.onCurrentPageChanged)}scrollToPreview(e){if(!this._pageService.pages.length)return;const{top:C,height:F}=this._container.getBoundingClientRect(),{top:$,height:Y}=this._pageService.getPage(e).previewContainer.getBoundingClientRect(),V=C+F/2,se=$+Y/2-V+this._container.scrollTop;this._container.scrollTo(0,se)}onPagesLoaded=e=>{e.detail.pages?.forEach(C=>{C.previewContainer.addEventListener("click",this.onPreviewerPageClick),this._container.append(C.previewContainer)}),this.renderVisible()};onCurrentPageChanged=e=>{this.scrollToPreview(e.detail.newIndex)};onPreviewerPageClick=e=>{let C=e.target,F;for(;C&&!F;){const $=C.dataset.pageNumber;$?F=+$:C=C.parentElement}F&&this._pageService.requestSetCurrentPageIndex(F-1)};onPreviewerScroll=e=>{this.renderVisible()}}class TsPdfViewer{_userName;_outerContainer;_shadowRoot;_mainContainer;_eventService;_modeService;_docManagerService;_pageService;_customStampsService;get _docService(){return this._docManagerService?.docService}_spinner;_viewer;_previewer;_annotatorService;_fileButtons;_comparableFileButtons;_fileInput;_comparableFileInput;_fileOpenAction;_fileSaveAction;_fileCloseAction;_comparableFileOpenAction;_comparableFileCloseAction;_annotChangeCallback;_customStampChangeCallback;_mainContainerRObserver;_panelsHidden;_timers={hidePanels:0};constructor(e){if(!e)throw new Error("No options provided");const C=document.querySelector(e.containerSelector);if(C)if(C instanceof HTMLDivElement)this._outerContainer=C;else throw new Error("Container is not a DIV element");else throw new Error("Container not found");if(!e.workerSource)throw new Error("Worker source path not defined");pdfExports.GlobalWorkerOptions.workerSrc=e.workerSource,this._userName=e.userName||"Guest",this._fileButtons=e.fileButtons||[],this._fileOpenAction=e.fileOpenAction,this._fileSaveAction=e.fileSaveAction,this._fileCloseAction=e.fileCloseAction,this._comparableFileButtons=e.comparableFileButtons||[],this._comparableFileOpenAction=e.comparableFileOpenAction,this._comparableFileCloseAction=e.comparableFileCloseAction,this._annotChangeCallback=e.annotChangeCallback,this._customStampChangeCallback=e.customStampChangeCallback;const F=e.visibleAdjPages||0,$=e.previewWidth||100,Y=e.minScale||.25,V=e.maxScale||4;this._shadowRoot=this._outerContainer.attachShadow({mode:"open"}),this._shadowRoot.innerHTML=styles+mainHtml,this._mainContainer=this._shadowRoot.querySelector("div#main-container"),this._eventService=new EventService(this._mainContainer),this._modeService=new ModeService({disabledModes:e.disabledModes||[]}),this._docManagerService=new DocManagerService(this._eventService),this._pageService=new PageService(this._eventService,this._modeService,this._docManagerService,{previewCanvasWidth:$,visibleAdjPages:F}),this._customStampsService=new CustomStampService(this._mainContainer,this._eventService),this._customStampsService.importCustomStamps(e.customStamps),this._spinner=new Spinner,this._previewer=new Previewer(this._pageService,this._shadowRoot.querySelector("#previewer")),this._viewer=new Viewer(this._modeService,this._pageService,this._shadowRoot.querySelector("#viewer"),{minScale:Y,maxScale:V}),this._viewer.container.addEventListener("contextmenu",te=>te.preventDefault()),this.initMainContainerEventHandlers(),this.initViewControls(),this.initFileButtons(),this.initModeSwitchButtons(),this.initAnnotationButtons(),this._eventService.addListener(docChangeEvent,this.onDocChangeAsync),this._eventService.addListener(annotChangeEvent,this.onAnnotationChange),this._eventService.addListener(currentPageChangeEvent,this.onCurrentPagesChanged),this._eventService.addListener(annotatorDataChangeEvent,this.onAnnotatorDataChanged),this._eventService.addListener(customStampEvent,this.onCustomStampChanged),this._eventService.addListener(docServiceStateChangeEvent,this.onDocServiceStateChange),document.addEventListener("selectionchange",this.onTextSelectionChange)}destroy(){this._annotChangeCallback=null,this._annotatorService?.destroy(),this._docManagerService.destroy(),this._viewer.destroy(),this._previewer.destroy(),this._pageService.destroy(),this._customStampsService.destroy(),this._eventService.destroy(),this._mainContainerRObserver?.disconnect(),this._shadowRoot.innerHTML="",document.removeEventListener("selectionchange",this.onTextSelectionChange)}async openPdfAsync(e,C){await this.openDocAsync("main",e,C)}async closePdfAsync(){await this.closeDocAsync("main")}async openComparedPdfAsync(e,C){this._docManagerService.docLoaded&&(await this.openDocAsync("compared",e,C),this.setMode("comparison"))}async closeComparedPdfAsync(){await this.closeDocAsync("compared"),this.setMode()}async importAnnotationsAsync(e){try{await this._docService?.appendSerializedAnnotationsAsync(e)}catch(C){console.log(`Error while importing annotations: ${C.message}`)}}async importAnnotationsFromJsonAsync(e){try{const C=JSON.parse(e);await this._docService?.appendSerializedAnnotationsAsync(C)}catch(C){console.log(`Error while importing annotations: ${C.message}`)}}async exportAnnotationsAsync(){return await this._docService?.serializeAnnotationsAsync(!0)}async exportAnnotationsToJsonAsync(){const e=await this._docService?.serializeAnnotationsAsync(!0);return JSON.stringify(e)}importCustomStamps(e){try{this._customStampsService.importCustomStamps(e)}catch(C){console.log(`Error while importing custom stamps: ${C.message}`)}}importCustomStampsFromJson(e){try{const C=JSON.parse(e);this._customStampsService.importCustomStamps(C)}catch(C){console.log(`Error while importing custom stamps: ${C.message}`)}}exportCustomStamps(){return this._customStampsService.getCustomStamps()}exportCustomStampsToJson(){const e=this._customStampsService.getCustomStamps();return JSON.stringify(e)}async getCurrentPdfAsync(){const e=await this._docService?.getDataWithUpdatedAnnotationsAsync();return e?.length?new Blob([e],{type:"application/pdf"}):null}onTextSelectionChange=()=>{const e=this._shadowRoot.getSelection?this._shadowRoot.getSelection():document.getSelection();if(e.rangeCount&&this._eventService.hasListenersForKey(textSelectionChangeEvent)){const C=getSelectionInfosFromSelection(e);this._eventService.dispatchEvent(new TextSelectionChangeEvent({selectionInfos:C}))}};async openDocAsync(e,C,F){this._spinner.show(this._mainContainer);try{await this._docManagerService.openPdfAsync(e,C,F,this._userName,this.showPasswordDialogAsync,this.onPdfLoadingProgress)}catch($){throw $}finally{this._spinner.hide()}}async closeDocAsync(e){await this._docManagerService.closePdfAsync(e)}initMainContainerEventHandlers(){const e=new ResizeObserver(C=>{const{width:F}=this._mainContainer.getBoundingClientRect();F<721?this._mainContainer.classList.add("mobile"):this._mainContainer.classList.remove("mobile"),F<400?this._mainContainer.classList.add("compact"):this._mainContainer.classList.remove("compact")});e.observe(this._mainContainer),this._mainContainerRObserver=e,this._mainContainer.addEventListener("pointermove",this.onMainContainerPointerMove)}initViewControls(){const e=this._shadowRoot.getElementById("paginator-input");e.addEventListener("input",this.onPaginatorInput),e.addEventListener("change",this.onPaginatorChange),this._shadowRoot.querySelector("#paginator-prev").addEventListener("click",this.onPaginatorPrevClick),this._shadowRoot.querySelector("#paginator-next").addEventListener("click",this.onPaginatorNextClick),this._shadowRoot.querySelector("#rotate-clockwise").addEventListener("click",this.onRotateClockwiseClick),this._shadowRoot.querySelector("#rotate-counter-clockwise").addEventListener("click",this.onRotateCounterClockwiseClick),this._shadowRoot.querySelector("#zoom-out").addEventListener("click",this.onZoomOutClick),this._shadowRoot.querySelector("#zoom-in").addEventListener("click",this.onZoomInClick),this._shadowRoot.querySelector("#zoom-fit-viewer").addEventListener("click",this.onZoomFitViewerClick),this._shadowRoot.querySelector("#zoom-fit-page").addEventListener("click",this.onZoomFitPageClick),this._shadowRoot.querySelector("#toggle-previewer").addEventListener("click",this.onPreviewerToggleClick)}initFileButtons(){const e=this._shadowRoot.querySelector("#button-open-file"),C=this._shadowRoot.querySelector("#button-save-file"),F=this._shadowRoot.querySelector("#button-close-file");this._fileButtons.includes("open")?(this._fileInput=this._shadowRoot.getElementById("open-file-input"),this._fileInput.addEventListener("change",this.onFileInput),e.addEventListener("click",this._fileOpenAction||this.onOpenFileButtonClick)):e.remove(),this._fileButtons.includes("save")?C.addEventListener("click",this._fileSaveAction||this.onSaveFileButtonClickAsync):C.remove(),this._fileButtons.includes("close")?F.addEventListener("click",this._fileCloseAction||this.onCloseFileButtonClick):F.remove();const $=this._shadowRoot.querySelector("#button-command-comparison-open"),Y=this._shadowRoot.querySelector("#button-command-comparison-close");this._comparableFileButtons.includes("open")?(this._comparableFileInput=this._shadowRoot.getElementById("open-comparable-file-input"),this._comparableFileInput.addEventListener("change",this.onComparableFileInput),$.addEventListener("click",this._comparableFileOpenAction||this.onComparableOpenFileButtonClick)):$.remove(),this._comparableFileButtons.includes("close")?Y.addEventListener("click",this._comparableFileCloseAction||this.onComparableCloseFileButtonClick):Y.remove()}onFileInput=()=>{const e=this._fileInput.files;e.length!==0&&(this.openDocAsync("main",e[0],e[0].name),this._fileInput.value=null)};onOpenFileButtonClick=()=>{this._fileInput.click()};onSaveFileButtonClickAsync=async()=>{const e=await this.getCurrentPdfAsync();e&&DomUtils.downloadFile(e,this._docManagerService?.fileName||`file_${new Date().toISOString()}.pdf`)};onCloseFileButtonClick=()=>{this.closeDocAsync("main")};onComparableFileInput=()=>{const e=this._comparableFileInput.files;e.length!==0&&(this.openDocAsync("compared",e[0],e[0].name),this._comparableFileInput.value=null)};onComparableOpenFileButtonClick=()=>{this._comparableFileInput.click()};onComparableCloseFileButtonClick=()=>{this.closeDocAsync("compared")};initModeSwitchButtons(){const e=this._shadowRoot.querySelectorAll('*[id^="button-mode-"]'),C=this._modeService.enabledModes;e.forEach(F=>{const $=/button-mode-(.+)/.exec(F.id)[1];C.includes($)?F.addEventListener("click",this.onViewerModeButtonClick):F.classList.add("disabled")})}initAnnotationButtons(){this._shadowRoot.querySelectorAll('*[id^="button-annotation-mode-"]').forEach(e=>{e.addEventListener("click",this.onAnnotationModeButtonClick)}),this._shadowRoot.querySelector("#button-annotation-edit-text").addEventListener("click",this.onAnnotationEditTextButtonClick),this._shadowRoot.querySelector("#button-annotation-delete").addEventListener("click",this.onAnnotationDeleteButtonClick),this._shadowRoot.querySelectorAll(".button-annotation-undo").forEach(e=>e.addEventListener("click",this.annotatorUndo)),this._shadowRoot.querySelectorAll(".button-annotation-clear").forEach(e=>e.addEventListener("click",this.annotatorClear)),this._shadowRoot.querySelectorAll(".button-annotation-save").forEach(e=>e.addEventListener("click",this.annotatorSave)),this._shadowRoot.querySelector("#button-command-undo").addEventListener("click",this.docServiceUndo)}setMode(e){e=e||this._modeService.enabledModes[0]||"text",viewerModes.forEach(C=>{this._mainContainer.classList.remove("mode-"+C),this._shadowRoot.querySelector("#button-mode-"+C).classList.remove("on")}),this.setAnnotationMode("select"),this._mainContainer.classList.add("mode-"+e),this._shadowRoot.querySelector("#button-mode-"+e).classList.add("on"),this._modeService.mode=e,this._viewer.renderVisible()}onViewerModeButtonClick=e=>{const C=e.target.closest('*[id^="button-mode-"]');if(!C)return;const F=/button-mode-(.+)/.exec(C.id)[1];this.setMode(F)};onZoomOutClick=()=>{this._viewer.zoomOut()};onZoomInClick=()=>{this._viewer.zoomIn()};onZoomFitViewerClick=()=>{this._viewer.zoomFitViewer()};onZoomFitPageClick=()=>{this._viewer.zoomFitPage()};onRotateCounterClockwiseClick=()=>{this.rotateCounterClockwise()};onRotateClockwiseClick=()=>{this.rotateClockwise()};rotateCounterClockwise(){this._docService&&(this._pageService.getCurrentPage().rotateCounterClockwise(),this.setAnnotationMode(this._annotatorService.mode))}rotateClockwise(){this._docService&&(this._pageService.getCurrentPage().rotateClockwise(),this.setAnnotationMode(this._annotatorService.mode))}onPaginatorInput=e=>{e.target instanceof HTMLInputElement&&(e.target.value=e.target.value.replace(/[^\d]+/g,""))};onPaginatorChange=e=>{if(e.target instanceof HTMLInputElement){const C=Math.max(Math.min(+e.target.value,this._docManagerService.pageCount),1);C+""!==e.target.value&&(e.target.value=C+""),this._pageService.requestSetCurrentPageIndex(C-1)}};onPaginatorPrevClick=()=>{this.moveToPrevPage()};onPaginatorNextClick=()=>{this.moveToNextPage()};onCurrentPagesChanged=e=>{const{newIndex:C}=e.detail;this._shadowRoot.getElementById("paginator-input").value=C+1+""};moveToPrevPage(){if(!this._docService)return;const e=n$1(this._pageService.currentPageIndex-1,0,this._pageService.length-1);this._pageService.requestSetCurrentPageIndex(e)}moveToNextPage(){if(!this._docService)return;const e=n$1(this._pageService.currentPageIndex+1,0,this._pageService.length-1);this._pageService.requestSetCurrentPageIndex(e)}annotatorUndo=()=>{this._annotatorService.annotator?.undo()};annotatorClear=()=>{this._annotatorService.annotator?.clear()};annotatorSave=()=>{this._annotatorService.annotator?.saveAnnotationAsync()};onCustomStampChanged=e=>{this.setAnnotationMode("stamp"),this._customStampChangeCallback&&this._customStampChangeCallback(e.detail)};onAnnotationChange=e=>{if(!e.detail)return;const C=e.detail.annotations;switch(e.detail.type){case"focus":C?.length?this._mainContainer.classList.add("annotation-focused"):this._mainContainer.classList.remove("annotation-focused");const F=C[0];F?(this._shadowRoot.querySelector("#focused-annotation-author").textContent=F.author||"",this._shadowRoot.querySelector("#focused-annotation-date").textContent=new Date(F.dateModified||F.dateCreated).toDateString(),this._shadowRoot.querySelector("#focused-annotation-text").textContent=F.textContent||""):(this._shadowRoot.querySelector("#focused-annotation-author").textContent="",this._shadowRoot.querySelector("#focused-annotation-date").textContent="",this._shadowRoot.querySelector("#focused-annotation-text").textContent="");break;case"select":C?.length?(this._mainContainer.classList.add("annotation-selected"),this._mainContainer.classList.add("annotation-focused")):(this._mainContainer.classList.remove("annotation-selected"),this._mainContainer.classList.remove("annotation-focused"));break;case"add":case"delete":case"render":case"import":if(C?.length){const $=new Set(C.map(Y=>Y.pageId));this._pageService.renderSpecifiedPages($)}break}this._annotChangeCallback&&this._annotChangeCallback(e.detail)};onAnnotatorDataChanged=e=>{annotatorTypes.forEach(C=>{this._mainContainer.classList.remove(C+"-annotator-data-saveable"),this._mainContainer.classList.remove(C+"-annotator-data-undoable"),this._mainContainer.classList.remove(C+"-annotator-data-clearable")}),e.detail.saveable&&this._mainContainer.classList.add(e.detail.annotatorType+"-annotator-data-saveable"),e.detail.undoable&&this._mainContainer.classList.add(e.detail.annotatorType+"-annotator-data-undoable"),e.detail.clearable&&this._mainContainer.classList.add(e.detail.annotatorType+"-annotator-data-clearable")};setAnnotationMode(e){if(!this._annotatorService||!e)return;const C=this._annotatorService.mode;this._shadowRoot.querySelector(`#button-annotation-mode-${C}`)?.classList.remove("on"),this._shadowRoot.querySelector(`#button-annotation-mode-${e}`)?.classList.add("on"),this._annotatorService.mode=e}onAnnotationEditTextButtonClick=async()=>{const e=this._docService?.getSelectedAnnotationTextContent(),C=await this._viewer.showTextDialogAsync(e);C!==null&&await this._docService?.setSelectedAnnotationTextContentAsync(C)};onAnnotationDeleteButtonClick=()=>{this._docService?.removeSelectedAnnotation()};onAnnotationModeButtonClick=e=>{const C=e.target.closest('*[id^="button-annotation-mode-"]');if(!C)return;const F=/button-annotation-mode-(.+)/.exec(C.id)[1];this.setAnnotationMode(F)};onMainContainerPointerMove=e=>{const{clientX:C,clientY:F}=e,{x:$,y:Y,width:V,height:te}=this._mainContainer.getBoundingClientRect(),se=C-$,ne=F-Y,ee=V-se,ie=te-ne;Math.min(se,ee,ne,ie)>150?this.hidePanels():this.showPanels()};hidePanels(){!this._panelsHidden&&!this._timers.hidePanels&&(this._timers.hidePanels=setTimeout(()=>{this._docManagerService?.docLoaded&&(this._mainContainer.classList.add("hide-panels"),this._panelsHidden=!0,this._timers.hidePanels=null)},5e3))}showPanels(){this._timers.hidePanels&&(clearTimeout(this._timers.hidePanels),this._timers.hidePanels=null),this._panelsHidden&&(this._mainContainer.classList.remove("hide-panels"),this._panelsHidden=!1)}onPdfLoadingProgress=e=>{};docServiceUndo=()=>{this._docService?.undoAsync()};onDocChangeAsync=async e=>{e.detail.type==="main"&&(e.detail.action==="open"?(this.setMode(),await this.refreshPagesAsync(),this._annotatorService=new AnnotatorService(this._docService,this._pageService,this._customStampsService,this._viewer),this.setAnnotationMode("select"),this._mainContainer.classList.remove("disabled")):e.detail.action==="close"&&(this._mainContainer.classList.add("disabled"),this._mainContainer.classList.remove("annotation-focused"),this._mainContainer.classList.remove("annotation-selected"),this.setMode(),this._annotatorService?.destroy(),await this.refreshPagesAsync(),this.showPanels())),e.detail.type==="compared"&&(e.detail.action==="open"?this._mainContainer.classList.add("comparison-loaded"):e.detail.action==="close"&&this._mainContainer.classList.remove("comparison-loaded"),this._modeService.mode==="comparison"&&this._viewer.renderVisible(!0))};onDocServiceStateChange=e=>{e.detail.undoableCount?this._mainContainer.classList.add("undoable-commands"):this._mainContainer.classList.remove("undoable-commands")};async refreshPagesAsync(){const e=this._docManagerService.pageCount;this._shadowRoot.getElementById("paginator-total").innerHTML=e+"",await this._pageService.reloadPagesAsync()}onPreviewerToggleClick=()=>{this.togglePreviewer()};togglePreviewer(){this._previewer.hidden?(this._mainContainer.classList.remove("hide-previewer"),this._shadowRoot.querySelector("div#toggle-previewer").classList.add("on"),this._previewer.show()):(this._mainContainer.classList.add("hide-previewer"),this._shadowRoot.querySelector("div#toggle-previewer").classList.remove("on"),this._previewer.hide())}showPasswordDialogAsync=async()=>new Promise((C,F)=>{const $=DomUtils.htmlToElements(passwordDialogHtml)[0];this._mainContainer.append($);let Y="";const V=$.querySelector(".password-input");V.placeholder="Enter password...",V.addEventListener("change",()=>Y=V.value);const te=()=>{$.remove(),C(Y)},se=()=>{$.remove(),C(null)};$.addEventListener("click",ne=>{ne.target===$&&se()}),$.querySelector(".password-ok").addEventListener("click",te),$.querySelector(".password-cancel").addEventListener("click",se)});onViewerKeyDown=e=>{switch(e.code){case"KeyO":e.ctrlKey&&e.altKey&&(e.preventDefault(),this._fileButtons.includes("open")&&(this._fileOpenAction?this._fileOpenAction():this.onOpenFileButtonClick&&this.onOpenFileButtonClick()));break;case"KeyS":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this._fileButtons.includes("save")&&(this._fileSaveAction?this._fileSaveAction():this.onSaveFileButtonClickAsync&&this.onSaveFileButtonClickAsync()));break;case"KeyX":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this._fileButtons.includes("close")&&(this._fileCloseAction?this._fileCloseAction():this.onCloseFileButtonClick&&this.onCloseFileButtonClick()));break;case"KeyT":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this.togglePreviewer());break;case"Digit1":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this.setMode("text"));break;case"Digit2":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this.setMode("hand"));break;case"Digit3":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this.setMode("annotation"));break;case"Digit4":this._docService&&e.ctrlKey&&e.altKey&&(e.preventDefault(),this.setMode("comparison"));break;case"ArrowLeft":e.preventDefault(),this.moveToPrevPage();break;case"ArrowRight":e.preventDefault(),this.moveToNextPage();break;case"ArrowUp":e.preventDefault(),this._viewer.zoomIn();break;case"ArrowDown":e.preventDefault(),this._viewer.zoomOut();break;case"Comma":e.preventDefault(),this.rotateCounterClockwise();break;case"Period":e.preventDefault(),this.rotateClockwise();break;case"Escape":e.preventDefault(),this._annotatorService.annotator?.clear();break;case"Backspace":e.preventDefault(),this._annotatorService.annotator?.undo();break;case"Enter":e.preventDefault(),this._annotatorService.annotator?.saveAnnotationAsync();break;case"KeyZ":e.ctrlKey&&(e.preventDefault(),this._docService?.undoAsync());break;default:return}}}function SetThemeMode(J,e){const C=window.matchMedia("(prefers-color-scheme: dark)");console.log(C.matches);const F=C.matches?"dark":"light",$=C.matches?"light":"dark";for(var Y=0;Y<e.styleSheets.length;Y++)for(var V=0;V<e.styleSheets[Y].cssRules.length;V++){let te=e.styleSheets[Y].cssRules[V];te&&te.media&&te.media.mediaText.includes("prefers-color-scheme")&&(J.mode=="LIGHT"?(te.media.appendMedium(`(prefers-color-scheme: ${F})`),te.media.mediaText.includes($)&&te.media.deleteMedium(`(prefers-color-scheme: ${$})`)):J.mode=="DARK"&&(te.media.appendMedium(`(prefers-color-scheme: ${$})`),te.media.mediaText.includes(F)&&te.media.deleteMedium(`(prefers-color-scheme: ${F})`)))}}const style="";let currentHeight=800,currentWidth=600;const addSize=200;OBR.onReady(async()=>{const J=await OBR.theme.getTheme();J.mode,SetThemeMode(J,document),OBR.theme.onChange(e=>{e.mode,SetThemeMode(e,document)}),await RenderPDFReader()});async function RenderPDFReader(){const J={containerSelector:"#app",workerSource:"./pdf.worker.min.js",fileButtons:["open","save"],disabledModes:["comparison"],annotChangeCallback:$=>{$.type==="focus"||$.type==="select"||$.type==="render"||console.log($)}},e=new TsPdfViewer(J);await e.openPdfAsync("./example2.pdf");const C=document.querySelector("#app").shadowRoot.querySelector("#toggle-expand");C.onclick=async function(){currentHeight+=addSize,currentWidth+=addSize,await OBR.action.setHeight(currentHeight),await OBR.action.setWidth(currentWidth),setTimeout(()=>e.onZoomFitViewerClick(),250)};const F=document.querySelector("#app").shadowRoot.querySelector("#toggle-shrink");F.onclick=async function(){currentHeight-=addSize,currentWidth-=addSize,await OBR.action.setHeight(currentHeight),await OBR.action.setWidth(currentWidth),e.onZoomFitViewerClick(),setTimeout(()=>e.onZoomFitViewerClick(),250)}}
